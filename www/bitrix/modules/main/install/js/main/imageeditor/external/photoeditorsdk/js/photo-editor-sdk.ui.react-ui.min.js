(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom"));else if(typeof define==="function"&&define.amd)define(["photoeditorsdk","react","react-dom"],r);else if(typeof exports==="object")exports["PhotoEditorReactUI"]=r(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom"));else t["PhotoEditorReactUI"]=r(t["PhotoEditorSDK"],t["React"],t["ReactDOM"])})(typeof self!=="undefined"?self:this,function(e,t,r){return function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=59)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SharedConstants=t.PropTypes=t.ImageLoader=t.ImageFormat=t.ColorMatrix=t.now=t.Log=t.cancelAnimationFrame=t.requestAnimationFrame=t.SDK=t.EXIF=t.ReactDOM=t.UniformType=t.OptionType=t.RenderType=t.Base64=t.Color=t.SharedState=t.Constants=t.EventEmitter=t.SDKUtils=t.Vector2=t.ReactBEM=t.BaseComponent=t.Classnames=t.BEM=t.React=t.Utils=t.Promise=undefined;var n=r(7);var i=B(n);var o=r(16);var a=B(o);var s=r(62);var l=B(s);var u=r(33);var c=B(u);var f=r(35);var p=B(f);var d=r(36);var h=B(d);var v=r(37);var _=B(v);var m=r(67);var y=B(m);var g=r(68);var b=B(g);var k=r(83);var w=B(k);var O=r(84);var E=B(O);var S=r(85);var P=r(20);var C=B(P);var M=r(23);var j=B(M);var x=r(38);var R=B(x);function B(e){return e&&e.__esModule?e:{default:e}}var T=i.default.Base64;var D=i.default.Color;var F=i.default.Math.ColorMatrix;var I=i.default.EventEmitter;var A=i.default.EXIF;var z=i.default.OptionType;var N=i.default.Promise;var L=i.default.Utils;var V=i.default.RenderType;var U=i.default.ImageFormat;var W=i.default;var K=i.default.UniformType;var H=i.default.Math.Vector2;var $=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):r(39);t.Promise=N;t.Utils=b.default;t.React=a.default;t.BEM=h.default;t.Classnames=p.default;t.BaseComponent=y.default;t.ReactBEM=_.default;t.Vector2=H;t.SDKUtils=L;t.EventEmitter=I;t.Constants=w.default;t.SharedState=E.default;t.Color=D;t.Base64=T;t.RenderType=V;t.OptionType=z;t.UniformType=K;t.ReactDOM=l.default;t.EXIF=A;t.SDK=W;t.requestAnimationFrame=S.requestAnimationFrame;t.cancelAnimationFrame=S.cancelAnimationFrame;t.Log=C.default;t.now=$;t.ColorMatrix=F;t.ImageFormat=U;t.ImageLoader=j.default;t.PropTypes=c.default;t.SharedConstants=R.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(e,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;o(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));s.type=e;s.title=r;s.text=n;s.overlay=i;s.data=null;return s}n(t,[{key:"setData",value:function e(t){this.data=t;this.emit("update")}},{key:"close",value:function e(){this.emit("close")}}]);return t}(i.EventEmitter);var u=function(e){s(t,e);function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._modals=[];return e}n(t,[{key:"displayLoading",value:function e(t){var r=new l("loading",null,t);this.addModal(r);return r}},{key:"displayProgress",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=new l("progress",null,t);n.setData({progress:r});this.addModal(n);return n}},{key:"displayWarning",value:function e(t,r){var n=new l("warning",t,r);this.addModal(n);return n}},{key:"displayError",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=new l("error",t,r,n);this.addModal(i);return i}},{key:"addModal",value:function e(t){var r=this;this._modals.push(t);t.on("close",function(){r.removeModal(t)});t.on("update",function(){r.emit("update")});this.emit("update")}},{key:"removeModal",value:function e(t){var r=this._modals.indexOf(t);this._modals.splice(r,1);this.emit("update")}},{key:"getModals",value:function e(){return this._modals}}],[{key:"instance",get:function e(){if(!this._instance){this._instance=new t}return this._instance}}]);return t}(i.EventEmitter);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=12;var d=function(e){f(t,e);function t(){u(this,t);var e=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e.constructor.NATIVE_SCROLLBAR_WIDTH){e.constructor.NATIVE_SCROLLBAR_WIDTH=o.Utils.getScrollbarWidth()}e._needsStyleFixes=true;e._isDragging=false;e._bindAll("_onButtonDragStart","_onButtonDrag","_onButtonDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onListScroll");e.state={buttonSize:0,buttonPosition:0,buttonVisible:false};return e}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this.update()}},{key:"fixStyles",value:function e(){if(!o.Utils.isMobile()){this._updateListSize()}}},{key:"_onListScroll",value:function e(){if(this._isDragging)return;var r=this._getDirection();var n=void 0,i=void 0,o=void 0;if(r===t.HORIZONTAL){n=this._list.scrollWidth-this._list.offsetWidth;i=this._list.scrollLeft;o=this._node.offsetWidth-this.state.buttonSize}else if(r===t.VERTICAL){n=this._list.scrollHeight-this._list.offsetHeight;i=this._list.scrollTop;o=this._node.offsetHeight-this.state.buttonSize}var a=i/n;this.setState({buttonPosition:o*a})}},{key:"_onButtonDragStart",value:function e(t){this._isDragging=true;this._initialButtonPosition=this.state.buttonPosition||0}},{key:"_onButtonDrag",value:function e(r){var n=this._getDirection();var i=void 0;if(n===t.HORIZONTAL){i=this._initialButtonPosition+r.x}else if(n===t.VERTICAL){i=this._initialButtonPosition+r.y}this._setButtonPosition(i)}},{key:"_onButtonDragStop",value:function e(){this._isDragging=false}},{key:"_onBarDragStart",value:function e(r){var n=o.Utils.getEventPosition(r);this._initialPosition=n.clone();var i=this._node.getBoundingClientRect();var a=new o.Vector2(i.left,i.top);var s=n.clone().subtract(a);var l=this._getDirection();if(l===t.HORIZONTAL){this._setButtonPosition(s.x-this.state.buttonSize/2)}else if(l===t.VERTICAL){this._setButtonPosition(s.y-this.state.buttonSize/2)}document.addEventListener("mousemove",this._onBarDrag);document.addEventListener("touchmove",this._onBarDrag);document.addEventListener("mouseup",this._onBarDragStop);document.addEventListener("touchend",this._onBarDragStop)}},{key:"_onBarDrag",value:function e(r){var n=o.Utils.getEventPosition(r);var i=this._node.getBoundingClientRect();var a=new o.Vector2(i.left,i.top);var s=n.clone().subtract(a);var l=this._getDirection();if(l===t.HORIZONTAL){this._setButtonPosition(s.x-this.state.buttonSize/2)}else if(l===t.VERTICAL){this._setButtonPosition(s.y-this.state.buttonSize/2)}}},{key:"_onBarDragStop",value:function e(){document.removeEventListener("mousemove",this._onBarDrag);document.removeEventListener("touchmove",this._onBarDrag);document.removeEventListener("mouseup",this._onBarDragStop);document.removeEventListener("touchend",this._onBarDragStop)}},{key:"_setButtonPosition",value:function e(r){var n=this._getDirection();var i=void 0,o=void 0;if(n===t.HORIZONTAL){i=this._node.offsetWidth-this.state.buttonSize;o=this._list.scrollWidth-this._list.offsetWidth}else if(n===t.VERTICAL){i=this._node.offsetHeight-this.state.buttonSize;o=this._list.scrollHeight-this._list.offsetHeight}r=Math.max(0,r);r=Math.min(r,i);this.setState({buttonPosition:r});var a=r/i;var s=o*a;if(n===t.HORIZONTAL){this._list.scrollLeft=s}else if(n===t.VERTICAL){this._list.scrollTop=s}}},{key:"_updateButtonSize",value:function e(r){var n=0;var i=false;var o=void 0,a=void 0;var s=this._getDirection();if(s===t.HORIZONTAL){o=this._list.clientWidth;a=this._list.scrollWidth}else if(s===t.VERTICAL){o=this._list.offsetHeight;a=this._list.scrollHeight}n=o/a*o;i=a>o;this.setState({buttonSize:n,buttonVisible:i},r)}},{key:"_updateListSize",value:function e(){if(!this._list)return;var r=this._getDirection();if(r===t.HORIZONTAL){this._list.style.height="";var n=this._getFullListDimensions();this._listSize=n.y;this._listContentSize=this._list.offsetHeight}else if(r===t.VERTICAL){this._list.style.width="";var i=this._getFullListDimensions();this._listSize=i.x;this._listContentSize=this._list.offsetWidth}}},{key:"_getFullListDimensions",value:function e(){var t=this._list.getBoundingClientRect();return new o.Vector2(t.width,t.height)}},{key:"update",value:function e(){var r=this;if(o.Utils.isMobile()){return}var n=this.refs,i=n.root,a=n.list;this._node=i;this._list=a;var s=this._getDirection();this._updateButtonSize(function(){if(!r._listSize){r._updateListSize()}var e=r._listSize;if(r.state.buttonVisible){e+=r.constructor.NATIVE_SCROLLBAR_WIDTH}if(s===t.HORIZONTAL){r._list.style.height=e+"px";r._node.style.top=r._listContentSize-p+"px";r._node.style.width=r._list.offsetWidth+"px"}else if(s===t.VERTICAL){r._list.style.width=e+"px";r._node.style.left=r._listContentSize-p+"px";r._node.style.height=r._list.offsetHeight+"px"}});this._list.addEventListener("scroll",this._onListScroll)}},{key:"_getDirection",value:function e(){return this.props.direction||"horizontal"}},{key:"_getButtonStyle",value:function e(){var t=this._getDirection();if(t==="horizontal"){return{left:this.state.buttonPosition,width:this.state.buttonSize}}else{return{top:this.state.buttonPosition,height:this.state.buttonSize}}}},{key:"getList",value:function e(){return this.refs.list}},{key:"getRoot",value:function e(){return this.refs.root}},{key:"renderWithBEM",value:function e(){if(o.Utils.isMobile()){return this.props.children}var t=this._getButtonStyle();var r={display:this.state.buttonVisible?"block":"none"};var n=o.React.cloneElement(this.props.children,{ref:"list"});return o.ReactBEM.createElement("div",null,n,o.ReactBEM.createElement("div",{bem:"$b:scrollbar m:"+(this.props.direction||"horizontal")+" m:"+(this.state.buttonVisible?"visible":"invisible"),ref:"root",style:r,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},o.ReactBEM.createElement(s.default,{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},o.ReactBEM.createElement("div",{bem:"e:bar",style:t,onMouseDown:this._onButtonDown}))))}}]);return t}(o.BaseComponent);t.default=d;d.HORIZONTAL="horizontal";d.VERTICAL="vertical";d.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(110);var a=u(o);var s=r(111);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._hasBackButton=true;o._hasDoneButton=false;o._backButtonClicked=false;o._bindAll("_onBackClick","_onDoneClick");return o}n(t,[{key:"_onBackClick",value:function e(t){this._backButtonClicked=true;this.props.onSwitchControls("back")}},{key:"_onDoneClick",value:function e(t){this._onBackClick()}},{key:"renderControls",value:function e(){return null}},{key:"renderOverlayControls",value:function e(){return null}},{key:"renderWithBEM",value:function e(){var t=this.props.options&&this.props.options.forcedControl;var r=this._hasBackButton&&!t?i.ReactBEM.createElement(a.default,{onClick:this._onBackClick}):null;var n=this._hasDoneButton||t?i.ReactBEM.createElement(l.default,{onClick:this._onDoneClick}):null;return i.ReactBEM.createElement("div",{bem:"$b:controls",ref:"root"},this.renderOverlayControls(),i.ReactBEM.createElement("div",{bem:"e:table"},r,this.renderControls(),n))}}]);return t}(i.BaseComponent);t.default=d;d.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(){i(this,e)}n(e,[{key:"getInitialSharedState",value:function e(){return{}}},{key:"isAvailable",value:function e(t){return false}}],[{key:"getPreloadAssets",value:function e(){return[]}}]);return e}();o.topBarControlsComponent=null;o.controlsComponent=null;o.canvasControlsComponent=null;o.identifier=null;o.iconPath=null;o.languageKey=null;o.defaultOptions={};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onDragStart","_onDragMove","_onDragEnd");return s}n(t,[{key:"_onDragStart",value:function e(t){if(this.props.disabled)return;t.preventDefault();t.stopPropagation();this._initialMousePosition=i.Utils.getEventPosition(t);document.addEventListener("mousemove",this._onDragMove);document.addEventListener("touchmove",this._onDragMove);document.addEventListener("mouseup",this._onDragEnd);document.addEventListener("touchend",this._onDragEnd);var r=this.refs.element;var n=r.getBoundingClientRect();var o=new i.Vector2(n.left,n.top);var a=this._initialMousePosition.clone().subtract(o);this.props.onStart&&this.props.onStart(a,t)}},{key:"_onDragMove",value:function e(t){t.preventDefault();t.stopPropagation();var r=i.Utils.getEventPosition(t);if(!r)return;var n=r.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(n,t)}},{key:"_onDragEnd",value:function e(t){t.preventDefault();t.stopPropagation();t.stopImmediatePropagation();this._onDragMove(t);document.removeEventListener("mousemove",this._onDragMove);document.removeEventListener("touchmove",this._onDragMove);document.removeEventListener("mouseup",this._onDragEnd);document.removeEventListener("touchend",this._onDragEnd);this.props.onStop&&this.props.onStop(t)}},{key:"render",value:function e(){if(!this.props.children||this.props.children instanceof Array){throw new Error("DraggableComponent expects exactly one child.")}return i.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:"element"})}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(13);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onSliderValueChange");o.state={value:o.props.value};return o}n(t,[{key:"componentWillReceiveProps",value:function e(t){if(t.value!==this.state.value){this.state.value=t.value}}},{key:"_onSliderValueChange",value:function e(t){this.props.onChange&&this.props.onChange(t);this.setState({value:t})}},{key:"_renderSlider",value:function e(){var t=i.SDKUtils.defaults(this.props,{style:"",middleDot:false,minValue:1,maxValue:100,label:"Label",onChange:this._onSliderValueChange,value:this.state.value});return i.ReactBEM.createElement(a.default,t)}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:slider m:dark"},this._renderSlider())}}]);return t}(i.BaseComponent);t.default=f;f.contextTypes=i.BaseComponent.contextTypes},function(t,r){t.exports=e},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(88);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){l(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_renderHeader",value:function e(){if(!this.context.options.showHeader){return null}return i.ReactBEM.createElement(a.default,null)}},{key:"_renderScreen",value:function e(){return i.ReactBEM.createElement("div",null)}},{key:"renderWithBEM",value:function e(){var t="b:screen";if(!this.context.options.showHeader){t+=" m:noHeader"}return i.ReactBEM.createElement("div",{bem:t,className:!this.props.visible?"is-hidden":null},this._renderHeader(),this._renderScreen())}}]);return t}(i.BaseComponent);t.default=f;f.propTypes={editor:i.PropTypes.any};f.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){var e;a(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onCanvasZoomDone");return o}n(t,[{key:"_performHitTest",value:function e(t){var r=this.refs.container;var n=r.getBoundingClientRect();var i=new o.Vector2(n.left,n.top);var a=t.subtract(i);var s=this.context.editor;var l=s.controls.getAvailable();for(var u in l){var c=l[u];var f=c.clickAtPosition&&c.clickAtPosition(a,s);if(f){if(f.selectedSprite===this.getSharedState("selectedSprite")){return true}this.props.onSwitchControls(c,f);return true}}return false}},{key:"_onCanvasZoomDone",value:function e(){this.forceUpdate()}},{key:"_bindEvents",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_bindEvents",this).call(this);this.context.mediator.on(o.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)}},{key:"_unbindEvents",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_unbindEvents",this).call(this);this.context.mediator.off(o.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(38);var a=u(o);var s=r(22);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t,r){c(this,e);this._ui=t;this._options=r;this._categoriesById={};this._categories=[];this._stickersById={};this._addCategories(a.default.DEFAULTS.STICKER_CATEGORIES);var n=this._options,i=n.categories,o=n.replaceCategories;if(this._options.categories){this._addCategories(i,o)}else{this._updateCategoriesMap();this._updateAllCategory()}}n(e,[{key:"loadExternal",value:function e(t){var r=this;var n=new l.default(t);return n.load().then(function(e){r._addCategories(e.categories,r._options.replaceCategories)})}},{key:"_addCategories",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(r){this._categories=t.slice(0)}else{this._categories=i.Utils.mergeCategories(this._categories,t,"stickers")}this._updateCategoriesMap();this._updateAllCategory()}},{key:"_updateCategoriesMap",value:function e(){var t=this;this._categoriesById={};this._categories.forEach(function(e){t._categoriesById[e.identifier]=e});this._categories.forEach(function(e){e.stickers.forEach(function(e){t._stickersById[e.identifier]=e})});if(typeof this._options.availableStickers!=="undefined"&&this._options.availableStickers!==null){this._categories.forEach(function(e){e.stickers=e.stickers.filter(function(e){return t._options.availableStickers.indexOf(e.identifier)!==-1})});this._categories=this._categories.filter(function(e){return e.stickers.length>0})}this._updateAllCategory()}},{key:"_updateAllCategory",value:function e(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(function(e){return e.stickers}).reduce(function(e,t){return e.concat(t)},[])};this._categoriesById.all=this._allCategory}},{key:"getStickersForCategory",value:function e(t){if(!this._categoriesById[t]){throw new Error("Unknown sticker category '"+t+"'")}return this._categoriesById[t].stickers}},{key:"getStickerByIdentifier",value:function e(t){return this._stickersById[t]}},{key:"getCategories",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(t){return[this._allCategory].concat(this._categories)}return this._categories}},{key:"getCategory",value:function e(t){return this._categoriesById[t]}}],[{key:"getURLForSticker",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"base";var n=t.images;var o=r==="base"?n.mediaBase||n.mediaThumb:n.mediaThumb;var a=o.uris||[o.uri];if(typeof i.Utils.Browser!=="undefined"&&!i.Utils.Browser.getIEVersion()){var s=a.filter(function(e){return/\.svg$/i.test(e)});return s.length?s[0]:a[0]}else{var l=a.filter(function(e){return!/\.svg$/i.test(e)});return l.length?l[0]:a[0]}}}]);return e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderContent",value:function e(){return this.props.children}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},i.ReactBEM.createElement("div",{bem:"e:cell"},this.renderContent()))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);var a=r(5);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onKnobDragStart","_onKnobDrag","_onKnobDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onMiddleDotClick");o.state={value:o.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0};return o}i(t,[{key:"componentDidMount",value:function e(){this._setValue(this.state.value,false)}},{key:"componentWillReceiveProps",value:function e(t){if(t.value!==this.state.value){this._setValue(t.value,false)}}},{key:"_onMiddleDotClick",value:function e(){this._previousValue=this.state.value;var t=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(t,true,true)}},{key:"_onKnobDragStart",value:function e(t){this._previousValue=this.state.value;this._initialSliderPosition=this.state.sliderPosition;this._initialPosition=t}},{key:"_onKnobDrag",value:function e(t){var r=this.refs.bar;var n=r.offsetWidth;var i=this._initialSliderPosition+t.x;i=Math.max(0,Math.min(i,n));var o=i/n;var a=this.props.minValue+(this.props.maxValue-this.props.minValue)*o;this._setValue(a)}},{key:"_onKnobDragStop",value:function e(){this._setValue(this.state.value,true,true)}},{key:"_onBarDragStart",value:function e(t){this._previousValue=this.state.value;this._initialPosition=t.clone();var r=this.refs.bar;var n=r.offsetWidth;var i=t.x/n;var o=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;this._setValue(o)}},{key:"_onBarDrag",value:function e(t){var r=this._initialPosition.clone().add(t);var n=this.refs.bar;var i=n.offsetWidth;var o=r.x/i;var a=this.props.minValue+(this.props.maxValue-this.props.minValue)*o;a=Math.max(this.props.minValue,Math.min(this.props.maxValue,a));this._setValue(a)}},{key:"_onBarDragStop",value:function e(){this._setValue(this.state.value,true,true)}},{key:"_getKnobStyle",value:function e(){return{left:this.state.sliderPosition}}},{key:"_getForegroundStyle",value:function e(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}}},{key:"_displayMiddleDot",value:function e(){return this.props.middleDot!==false}},{key:"_setValue",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;t=Math.round(t);var i=this.props,o=i.minValue,a=i.maxValue;var s=(t-o)/(a-o);var l=this.refs.bar;var u=l.offsetWidth;var c=u*s;var f=s*u;var p=0;if(this._displayMiddleDot()){f=Math.abs(s-.5)*u;p=s<.5?u*.5-f:"50%"}this.setState({value:t,sliderPosition:c,foregroundWidth:f,foregroundLeft:p});if(r){this.props.onChange&&this.props.onChange(t,this._previousValue,n)}}},{key:"_buildValue",value:function e(t){if(t%1!==0){t=t.toFixed(2)}if(this.props.positiveValuePrefix&&t>=0){t=""+this.props.positiveValuePrefix+t}if(this.props.valueUnit){t+=this.props.valueUnit}return t}},{key:"renderWithBEM",value:function e(){var t=null;if(this._displayMiddleDot()){t=o.ReactBEM.createElement("div",{bem:"e:middleDot",onClick:this._onMiddleDotClick})}var r={style:this._getForegroundStyle()};var i="$b:slider"+(this.props.style?" m:"+this.props.style:"");return o.ReactBEM.createElement("div",{bem:i},o.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},o.ReactBEM.createElement(s.default,{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},o.ReactBEM.createElement("div",null,o.ReactBEM.createElement("div",{bem:"$e:background"}),o.ReactBEM.createElement("div",n({bem:"$e:foreground"},r)),o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},o.ReactBEM.createElement("div",{bem:"e:knob b:knob m:slider",style:this._getKnobStyle()})))),t),o.ReactBEM.createElement("div",{bem:"$e:labels"},o.ReactBEM.createElement("div",{bem:"e:label m:lowerBoundary"},this._buildValue(this.props.minValue)),o.ReactBEM.createElement("div",{bem:"e:label m:value"},this.props.label," ",this._buildValue(this.state.value)),o.ReactBEM.createElement("div",{bem:"e:label m:upperBoundary"},this._buildValue(this.props.maxValue))))}}]);return t}(o.BaseComponent);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);var a=r(144);var s=h(a);var l=r(145);var u=h(l);var c=r(146);var f=h(c);var p=r(10);var d=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var g=o.SDK.Operations.SpriteOperation,b=g.StickerSprite,k=g.TextSprite,w=g.BrushSprite;var O=function(e){y(t,e);function t(){var e,r;_(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++){i[a]=arguments[a]}var s=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._bindAll("_onCanvasClick","_onSpriteDragStart","_onSpriteDragStop","_onOperationUpdated","_onOperationRemoved","_onSpriteFlip","_onSpriteTakeToFront","_onSpriteRemove");s._canvasClickDisabled=false;s._events=(r={},v(r,o.Constants.EVENTS.OPERATION_UPDATED,s._onOperationUpdated),v(r,o.Constants.EVENTS.OPERATION_REMOVED,s._onOperationRemoved),r);return s}i(t,[{key:"_onOperationRemoved",value:function e(t){var r=this.getSharedState("selectedSprite");if(t!==this.getSharedState("operation")||!r)return;var n=this.context.editor;var i=n.operations.getOrCreate("sprite",{sprites:[r],enabled:false});this.setSharedState({operation:i,operationExistedBefore:false,initialOptions:{}})}},{key:"_onOperationUpdated",value:function e(t){var r=this.getSharedState("selectedSprite");if(t!==this.getSharedState("operation")||!r)return;var n=t.getSprites();if(n.indexOf(r)===-1){n.push(r)}this.forceUpdate()}},{key:"_onItemBlur",value:function e(){}},{key:"_onCanvasClick",value:function e(t){if(this._canvasClickDisabled)return;var r=this._performHitTest(o.Utils.getEventPosition(t));if(!r){if(this.getSharedState("selectedSprite")){this._onItemBlur()}this.props.onSwitchControls("home")}}},{key:"_onSpriteFlip",value:function e(t){var r=this.getSharedState("selectedSprite");switch(t){case"h":r.setFlipHorizontally(!r.getFlipHorizontally());break;case"v":r.setFlipVertically(!r.getFlipVertically());break}var n=this.context.editor;n.render()}},{key:"_onSpriteTakeToFront",value:function e(t){var r=this.getSharedState("operation");r.takeSpriteToFront(this.getSharedState("selectedSprite"));this.forceSharedUpdate();var n=this.context.editor;n.render()}},{key:"_onSpriteRemove",value:function e(){var t=this.getSharedState("operation");var r=this.getSharedState("selectedSprite");t.removeSprite(r);r.dispose();this.setSharedState({selectedSprite:null});var n=this.context.editor;n.render()}},{key:"_onSpriteDragStart",value:function e(){this._canvasClickDisabled=true}},{key:"_onSpriteDragStop",value:function e(){var t=this;setTimeout(function(){t._canvasClickDisabled=false},100)}},{key:"_getContainerStyle",value:function e(){var t=this.context.editor;var r=t.getCanvasDimensions();var n=t.getOutputDimensions();var i=r.clone().divide(2).subtract(n.clone().divide(2)),o=i.x,a=i.y;return{left:o,top:a,width:n.x,height:n.y}}},{key:"_getContainerProps",value:function e(){return{}}},{key:"_getInnerContainerProps",value:function e(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick}}},{key:"_getPropsForSprite",value:function e(t){var r={hideContent:true};return r}},{key:"_getComponentTypeForSprite",value:function e(t){if(t instanceof k){return s.default}else if(t instanceof b){return u.default}else if(t instanceof w){return f.default}}},{key:"_renderSpriteItems",value:function e(){var t=this;var r=this.getSharedState("operation");var i=r.getSprites();var a=this.getSharedState("selectedSprite");return i.map(function(e){var i=e===a;var s=t._getComponentTypeForSprite(e);var l=t._getPropsForSprite(e);return o.ReactBEM.createElement(s,n({operation:r,sharedState:t.props.sharedState,sprite:e,selected:i,onDragStart:t._onSpriteDragStart,onDragStop:t._onSpriteDragStop,onRemove:t._onSpriteRemove.bind(t,e),options:t.props.options,ref:"sprite-"+e.getId()},l))})}},{key:"_renderOverlayControls",value:function e(){return null}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",n({bem:"$b:canvasControls e:container m:full",ref:"container"},this._getContainerProps()),o.ReactBEM.createElement("div",n({bem:"b:canvasControls e:innerContainer",ref:"innerContainer"},this._getInnerContainerProps()),o.ReactBEM.createElement("div",{bem:"$b:spritesCanvasControls",ref:"container"},this._renderSpriteItems(),this._renderOverlayControls())))}}]);return t}(d.default);t.default=O;O.contextTypes=d.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);var a=r(157);var s=p(a);var l=r(20);var u=p(l);var c=r(47);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=function(){function e(t,r){d(this,e);this._ui=t;this._options=r;this._fonts=[];this._variationsByIdentifier={};this._fontsByFontFamily={};this._initFonts()}i(e,[{key:"_initFonts",value:function e(){var t=this;var r=this._options,n=r.fonts,i=r.replaceFonts,a=r.availableVariations;var l=o.Constants.DEFAULTS.FONTS;if(i){l=n}else{l=l.concat(n||[])}var c=void 0;l=l.map(function(e){var r=e.fontFamily;var n=e.variations;if(a){n=n.filter(function(e){return a.indexOf(e.identifier)!==-1})}if(n.length===0)return null;var i=new s.default({fontFamily:r});n=n.map(function(e){var n=new f.default(e);n.setFontFamily(r);n.setFont(i);if(e.default&&!c){c=n}if(n.getTextMetrics()==null){u.default.warn("Missing font metrics for "+n.getIdentifier()+". The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.")}t._variationsByIdentifier[n.getIdentifier()]=n;return n});i.setVariations(n);t._fontsByFontFamily[r]=i;return i}).filter(function(e){return e});if(!c){c=l[0].getVariations()[0]}this._defaultVariation=c;this._fonts=l}},{key:"getFonts",value:function e(){return this._fonts}},{key:"getFontByFontFamily",value:function e(t){return this._fontsByFontFamily[t]}},{key:"getVariationByIdentifier",value:function e(t){return this._variationsByIdentifier[t]}},{key:"getVariationsByIdentifier",value:function e(){return n({},this._variationsByIdentifier)}},{key:"getDefaultVariation",value:function e(){return this._defaultVariation}}]);return e}();t.default=h},function(e,r){e.exports=t},function(e,t,r){"use strict";function n(e){return function(){return e}}var i=function e(){};i.thatReturns=n;i.thatReturnsFalse=n(false);i.thatReturnsTrue=n(true);i.thatReturnsNull=n(null);i.thatReturnsThis=function(){return this};i.thatReturnsArgument=function(e){return e};e.exports=i},function(e,t,r){"use strict";var n=function e(t){};if({ENV:'"production"'}.NODE_ENV!=="production"){n=function e(t){if(t===undefined){throw new Error("invariant requires an error message argument")}}}function i(e,t,r,i,o,a,s,l){n(t);if(!e){var u;if(t===undefined){u=new Error("Minified exception occurred; use the non-minified dev environment "+"for the full error message and additional helpful warnings.")}else{var c=[r,i,o,a,s,l];var f=0;u=new Error(t.replace(/%s/g,function(){return c[f++]}));u.name="Invariant Violation"}u.framesToPop=1;throw u}}e.exports=i},function(e,t,r){"use strict";var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";e.exports=n},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.Logger=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(69);var o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}];var c=function e(){return console&&console.group&&console.groupCollapsed&&console.groupEnd};var f=function t(){return(!e||e&&e.browser)&&typeof navigator!=="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)};var p=function e(t,r){return["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: "+t+"; color: "+r+"; line-height: 20px; padding: 4px 0; font-weight: bold","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"]};var d=function(){function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"warn";var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:u;l(this,e);this._levels=[].concat(s(n));this._maxLevel=this.getLevelIndexByName(r);this._consoleFuncs={trace:function e(){if(c()){var t;(t=console).groupCollapsed.apply(t,arguments);console.trace();console.groupEnd()}else{var r;(r=console).trace.apply(r,arguments)}}};this._levels.forEach(function(e){var r=e.name;t[r]=function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}t._log.apply(t,[r,e].concat(i))}})}n(e,[{key:"getLevelIndexByName",value:function e(t){return o.default.Array.findIndex(this._levels,function(e){return e.name===t})}},{key:"getLevelObjectByName",value:function e(t){return o.default.Array.find(this._levels,function(e){return e.name===t})}},{key:"canLog",value:function e(t){var r=this.getLevelIndexByName(t);if(r<0){return false}return r>=this._maxLevel}},{key:"setLevel",value:function e(t){var r=this.getLevelIndexByName(t);if(r<0){return}this._maxLevel=r}},{key:"_log",value:function e(t,r){var n=this.getLevelObjectByName(t);if(!n||!this.canLog(t)){return}var i=n.name,a=n.type,l=n.background,u=n.color;for(var d=arguments.length,h=Array(d>2?d-2:0),v=2;v<d;v++){h[v-2]=arguments[v]}var _=h.filter(function(e){return e!==undefined}).map(function(e){if(e.toObject){return JSON.parse(JSON.stringify(e.toObject()))}return e});var m=this._consoleFuncs[a]||console[a]||console.log;var y=_.length;var g=p(l,u);if(!f()){var b=_.length;if(b<=0){m("PhotoEditorSDK | "+r+" ");return}if(b===1&&typeof _[0]==="string"){m("PhotoEditorSDK | "+r+" | "+_[0]);return}m.apply(undefined,["PhotoEditorSDK | "+r+" | "].concat(s(_)));return}if(y<=0){m.apply(undefined,["%c  %c PhotoEditorSDK %c  %c "+r+" %c %c  "].concat(s(g)));return}if(y===1&&typeof _[0]==="string"){m.apply(undefined,["%c  %c PhotoEditorSDK %c  %c "+r+" %c  "+_[0]+"  %c  "].concat(s(g)));return}if(c()){var k;(k=console).groupCollapsed.apply(k,["%c  %c PhotoEditorSDK %c  %c "+r+" %c"].concat(s(o.default.Array.init(g))));m.apply(undefined,s(_));console.groupEnd()}else{m.apply(undefined,["%c  %c PhotoEditorSDK %c  %c "+r+" %c"].concat(s(o.default.Array.init(g)),s(_)))}}},{key:"image",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=arguments[1];var e=new window.Image;var n=function r(){var n=e.width;var i=e.height;t&&console.log(t);console.log("%c+","\n        font-size: 1px;\n        padding: 0px "+Math.floor(n/2)+"px;\n        line-height: "+i+"px;\n        background: url("+e.src+");\n        color: transparent;\n        background-repeat: no-repeat;\n        background-size: "+n+"px "+i+"px;")};e.onload=n;if(r instanceof window.HTMLCanvasElement){e.src=r.toDataURL()}else if(r instanceof window.Image){e=r;n()}else if(typeof r==="string"){e.src=r}else{this.log(t,r)}return e}},{key:"texture",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var r=arguments[1];if(!r){this.log(t,"texture: null or undefined");return}var n=r.getBaseTexture();var i=n.getRenderers();var a=o.default.Array.find(i,function(e){return e&&e.constructor.type==="WebGL"});var s=n.getFrame(),l=s.width,u=s.height;if(a){var c=a.getContext();var f=n.getGLTextureForRenderer(a);this.logGlTexture(c,f,l,u,t)}else{h.image(t,n.getSource())}}},{key:"logGlTexture",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:150;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:150;var o=arguments[4];t.bindTexture(t.TEXTURE_2D,r);var a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var s=new Uint8Array(n*i*4);t.readPixels(0,0,n,i,t.RGBA,t.UNSIGNED_BYTE,s);t.deleteFramebuffer(a);var l=document.createElement("canvas");l.width=n;l.height=i;var u=l.getContext("2d");var c=u.createImageData(n,i);c.data.set(s);u.putImageData(c,0,0);return h.image(o,l)}}]);return e}();t.Logger=d;var h=new d("warn");t.default=h}).call(t,r(21))},function(e,t){var r=e.exports={};var n;var i;function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=o}}catch(e){n=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=a}}catch(e){i=a}})();function s(e){if(n===setTimeout){return setTimeout(e,0)}if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function l(e){if(i===clearTimeout){return clearTimeout(e)}if((i===a||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var u=[];var c=false;var f;var p=-1;function d(){if(!c||!f){return}c=false;if(f.length){u=f.concat(u)}else{p=-1}if(u.length){h()}}function h(){if(c){return}var e=s(d);c=true;var t=u.length;while(t){f=u;u=[];while(++p<t){if(f){f[p].run()}}p=-1;t=u.length}f=null;c=false;l(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new v(e,t));if(u.length===1&&!c){s(h)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function _(){}r.on=_;r.addListener=_;r.once=_;r.off=_;r.removeListener=_;r.removeAllListeners=_;r.emit=_;r.prependListener=_;r.prependOnceListener=_;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(73);var o=l(i);var a=r(76);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=5e3;var f=typeof window!=="undefined"?window:e;var p=function(){function e(t){u(this,e);this._url=t;this._parsedUrl=s.default.parse(this._url,true)}n(e,[{key:"_isJSONPRequest",value:function e(){var t=this._parsedUrl.query;for(var r in t){var n=t[r];if(n==="?"){return true}}return false}},{key:"load",value:function e(){if(this._isJSONPRequest()){return this._loadJSONP()}else{return this._loadJSON()}}},{key:"_loadJSON",value:function e(){var t=this;return new o.default(function(e,r){var n=void 0;if(f.XDomainRequest){n=new f.XDomainRequest;n.onload=function(){var t=JSON.parse(n.responseText);e(t)};n.onerror=function(e){r(e)};n.open("GET",t._url,true);n.send()}else if(f.XMLHttpRequest){n=new XMLHttpRequest;n.onreadystatechange=function(t){if(n.readyState===4){if(n.status===200){var i=JSON.parse(n.responseText);e(i)}else{r(new Error("HTTP Status "+n.status))}}};n.open("GET",t._url,true);n.send()}})}},{key:"_loadJSONP",value:function e(){var t=this;var r=false;var n=false;var i="pesdk"+Math.round(Math.random()*99999999999999);return new o.default(function(e,o){var a=t._createJSONPNode(i);f[i]=function(i){t._removeJSONPNode(a);if(!r){n=true;e(i)}};f.setTimeout(function(){if(!n){t._removeJSONPNode(a);r=true;o(new Error("Timeout of 5 seconds exceeded."))}},c)})}},{key:"_createJSONPNode",value:function e(t){var r=this._buildJSONPUrl(t);var n=document.querySelector("head");var i=document.createElement("script");i.src=r;n.appendChild(i);return i}},{key:"_removeJSONPNode",value:function e(t){t.parentNode.removeChild(t)}},{key:"_buildJSONPUrl",value:function e(t){var r=this._parsedUrl.query;var n=null;for(var i in r){if(r[i]==="?"){n=i;break}}delete this._parsedUrl.search;r[n]=t;return s.default.format(this._parsedUrl)}}]);return e}();t.default=p}).call(t,r(8))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){var r=[];var n=true;var i=false;var o=undefined;try{for(var a=e[Symbol.iterator](),s;!(n=(s=a.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){i=true;o=e}finally{try{if(!n&&a["return"])a["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();t.default={load:function e(t){var r=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{cors:true,value:"anonymous"};var o=function e(){if(t.substr(0,5)==="data:"||"boolean"!=="undefined"){return Promise.resolve([t,t])}};return o().then(function(e){var t=n(e,2),o=t[0],a=t[1];return r._createAndLoadImage(o,a,i)})},_createAndLoadImage:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{cors:true,value:"anonymous"};if(true){return new Promise(function(e,t){var i=new window.Image;i.addEventListener("load",function(){e(i)});i.addEventListener("error",function(){t(new Error("Failed to load image at "+r))});if(n.cors){i.crossOrigin=n.value}i.src=r})}},loadXHR:function e(t,r){return new Promise(function(e,n){var i=void 0;if(window.XDomainRequest){i=new window.XDomainRequest;if(r)i.overrideMimeType(r);i.onload=function(){e(i)};i.onerror=function(e){n(e)}}else if(window.XMLHttpRequest){i=new window.XMLHttpRequest;if(r)i.overrideMimeType(r);i.onreadystatechange=function(t){if(i.readyState===4){if(i.status===200){e(i)}else{n(new Error("HTTP Status "+i.status))}}}}i.open("GET",t,true);i.send()})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onClick");return s}n(t,[{key:"_onClick",value:function e(t){this.props.onClick&&this.props.onClick()}},{key:"_renderContent",value:function e(){return null}},{key:"renderWithBEM",value:function e(){var t="$e:row m:"+this._modifier;if(this.props.totalRows){t+=" m:row-"+this.props.totalRows}return i.ReactBEM.createElement("bem",{specifier:"b:splashScreen"},i.ReactBEM.createElement("div",{bem:t},this._renderContent()))}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={onClick:i.PropTypes.func};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(92);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onNewFile");return o}n(t,[{key:"componentDidMount",value:function e(){this._fileLoader=new a.default(this.refs.fileInput);this._fileLoader.on("file",this._onNewFile)}},{key:"componentWillUnmount",value:function e(){this._fileLoader.off("file",this._onNewFile);this._fileLoader.dispose();this._fileLoader=null}},{key:"_onNewFile",value:function e(t){this.props.onNewFile&&this.props.onNewFile(t)}},{key:"open",value:function e(){this._fileLoader.open()}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("input",{type:"file",accept:"image/*",bem:"b:hiddenFileInput",ref:"fileInput"})}}]);return t}(i.BaseComponent);t.default=f;f.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t="$e:button";if(this.props.style){t+=" m:"+this.props.style}if(this.props.icon){t+=" m:withIcon"}var r=null;if(this.props.icon){r=i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath(this.props.icon,true)})}return i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:t,onClick:this.props.onClick},r,i.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||"Button")))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r){o(this,e);this._ui=t;this._options=r;this._categoriesById={};this._filtersByIdentifier={identity:i.SDK.Operations.FilterOperation.Filters.IdentityFilter};this._categories=i.SharedConstants.DEFAULTS.FILTERS.slice(0);this._initCategories()}n(e,[{key:"instantiateFilterWithIdentifier",value:function e(t){var r=this;var n=this.getFilterByIdentifier(t);if(!n){return Promise.reject(new Error("Unknown filter with identifier `"+t+"`!"))}if(!(n.prototype instanceof i.SDK.Operations.FilterOperation.Filter)){var o=n.lutImage,a=n.resolution,s=n.horizontalTileCount,l=n.verticalTileCount;var u=void 0;if(this._ui.getPreloader){u=this._ui.getPreloader().getAsset(o)}var c=void 0;if(u){c=Promise.resolve(u)}else{c=i.ImageLoader.load(this._ui.getAssetPath(o))}return c.then(function(e){return i.ImageLoader.load(r._ui.getAssetPath(o)).then(function(e){return new i.SDK.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:e,resolution:a,horizontalTileCount:s,verticalTileCount:l})})})}else{return Promise.resolve(new n)}}},{key:"_initCategories",value:function e(){var t=this;if(this._options.categories){if(this._options.replaceCategories){this._categories=this._options.categories}else{this._categories=i.Utils.mergeCategories(this._categories,this._options.categories,"filters")}}if(this._options.availableFilters){var r=[];this._categories.forEach(function(e){var n=e.filters.filter(function(e){return t._options.availableFilters.indexOf(e.identifier)!==-1});if(n.length>0){r.push({identifier:e.identifier,defaultName:e.defaultName,filters:n})}});this._categories=r}var n={identifier:"all",defaultName:"All",filters:this._categories.length<=0?[]:this._categories.map(function(e){return e.filters}).reduce(function(e,t){return e.concat(t)})};this._categories.unshift(n);this._categoriesById.all=n;this._categories.forEach(function(e){t._categoriesById[e.identifier]=e});n.filters.forEach(function(e){t._filtersByIdentifier[e.identifier]=e})}},{key:"getFiltersForCategory",value:function e(t){if(!this._categoriesById[t]){throw new Error("Unknown filter category '"+t+"'")}return this._categoriesById[t].filters}},{key:"getFilterByIdentifier",value:function e(t){return this._filtersByIdentifier[t]}},{key:"getCategories",value:function e(){return this._categories}},{key:"getCategoryByIdentifier",value:function e(t){return this._categoriesById[t]}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){var e;a(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onItemDragStart","_onItemDragStop","_onItemDrag","_onSpriteUpdate");return o}n(t,[{key:"_getAbsoluteSpritePosition",value:function e(){var t=this.context.editor;var r=t.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(r)}},{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this.props.sprite.on("update",this._onSpriteUpdate)}},{key:"componentWillUnmount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this);this.props.sprite.off("update",this._onSpriteUpdate)}},{key:"componentWillReceiveProps",value:function e(t){this.props.sprite.off("update",this._onSpriteUpdate);t.sprite.on("update",this._onSpriteUpdate)}},{key:"_onSpriteUpdate",value:function e(){this.forceUpdate()}},{key:"_onItemDragStart",value:function e(){var t=this.props.sprite;this._initialPosition=t.getPosition();this.props.onDragStart&&this.props.onDragStart()}},{key:"_onItemDrag",value:function e(t){var r=this.props.sprite;var n=this.context.editor;var i=n.getOutputDimensions();var o=this._initialPosition.clone().add(t.divide(i));r.setPosition(o);n.render()}},{key:"_onItemDragStop",value:function e(){this.props.onDragStop&&this.props.onDragStop()}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(152);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._value=a.props.initialValue.clone();a._bindAll("_onButtonClick","_onValueChange","_onColorPickerOpen","_onColorPickerClose");a._events=u({},o.Constants.EVENTS.COLORPICKER_OPEN,a._onColorPickerOpen);a.state={overlayVisible:false};a._transparentPatternCanvas=o.Utils.createTransparentPatternCanvas();return a}n(t,[{key:"componentWillReceiveProps",value:function e(t){if(t.initialValue!==this.props.initialValue){this._value=t.initialValue.clone();this._renderColor()}}},{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderColor()}},{key:"componentDidUpdate",value:function e(){this._renderColor()}},{key:"_onColorPickerOpen",value:function e(t){if(t===this)return;this.setState({overlayVisible:false})}},{key:"_onColorPickerClose",value:function e(){this.setState({overlayVisible:false})}},{key:"_onButtonClick",value:function e(t){t.preventDefault();t.stopPropagation();if(!this.state.overlayVisible){this._emitEvent(o.Constants.EVENTS.COLORPICKER_OPEN,this)}this.setState({overlayVisible:!this.state.overlayVisible})}},{key:"_onValueChange",value:function e(t){this._value=t;this._renderColor();this.forceUpdate();this.props.onChange&&this.props.onChange(t)}},{key:"_renderColor",value:function e(){var t=this.refs.canvas;var r=t.getContext("2d");t.width=t.offsetWidth;t.height=t.offsetHeight;var n=r.createPattern(this._transparentPatternCanvas,"repeat");r.fillStyle=n;r.fillRect(0,0,t.width,t.height);r.fillStyle=this._value.toRGBA();r.fillRect(0,0,t.width,t.height)}},{key:"renderWithBEM",value:function e(){var t=null;if(this.state.overlayVisible){t=o.ReactBEM.createElement(s.default,{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha})}var r=this.state.overlayVisible?"is-active":null;return o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$b:colorPicker",className:r,onClick:this._onButtonClick},o.ReactBEM.createElement("canvas",{bem:"e:preview",ref:"canvas"}),o.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||this._t("generic.color")),t))}}]);return t}(o.BaseComponent);t.default=d;d.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(176);var a=u(o);var s=r(179);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t,r){c(this,e);this._ui=t;this._fonts=r;this._loadedFonts=[]}i(e,[{key:"setFonts",value:function e(t){this._fonts=t}},{key:"needsToLoad",value:function e(){var t=this;var r=function e(r){var n=void 0;t._fonts[r].getVariations().forEach(function(e){n=n||e.getProvider()});if(!n)return"continue";return{v:true}};for(var i=0;i<this._fonts.length;i++){var o=r(i);switch(o){case"continue":continue;default:if((typeof o==="undefined"?"undefined":n(o))==="object")return o.v}}}},{key:"fontLoaded",value:function e(t){var r=t.getFontFamily();return this._loadedFonts.indexOf(r)!==-1}},{key:"setFontLoaded",value:function e(t){if(!this.fontLoaded(t)){var r=t.getFontFamily();this._loadedFonts.push(r)}}},{key:"load",value:function e(){var t=this;var r=this._fonts;var n={google:new a.default(this._ui),file:new l.default(this._ui)};var i=function e(){for(var t in n){var r=n[t];r.dispose()}};r.filter(function(e){return!t.fontLoaded(e)}).forEach(function(e){e.getVariations().forEach(function(e){var t=e.getProvider();if(!t)return;var r=n[t];r.add(e)})});var o=[];for(var s in n){o.push(n[s].load())}return Promise.all(o).then(function(){i();r.forEach(function(e){t.setFontLoaded(e)})}).catch(function(e){i();throw e})}}]);return e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(53);var a=u(o);var s=r(55);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_serializeSticker",value:function e(r,n){var o=r.getInputDimensions(false);var a=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeSticker",this).call(this,r,n);if(n.getTintMode()!=="none"){a.options.tintColor=n.serializeOption("tintColor",true)}a.options.dimensions=n.getDimensions().clone().divide(o.min()).toObject();a.options.identifier=a.options.name;delete a.options.name;return a}},{key:"_serializePath",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializePath",this).call(this,r);var o=r.getBrush();if(o.hasOption("hardness")){n.hardness=o.getOption("hardness")}return n}},{key:"_serializeOperation",value:function e(r,n){if(r.constructor.identifier==="frame"){this._serializeFrameOperation(r,n);return null}if(r.constructor.identifier==="overlay"){this._serializeOverlayOperation(r,n);return null}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOperation",this).call(this,r,n)}},{key:"_serializeFrameOperation",value:function e(t,r){var n=r.filter(function(e){return e.type==="sprite"});var i=void 0;if(n.length){i=n.pop()}else{i={type:"sprite",options:{sprites:[]}};r.push(i)}i.options.sprites.push({type:"frame",options:this._getFrameOptions(t)})}},{key:"_serializeOverlayOperation",value:function e(t,r){if(!t.getIdentifier())return;var n=r.filter(function(e){return e.type==="sprite"});var i=void 0;if(n.length){i=n.pop()}else{i={type:"sprite",options:{sprites:[]}};r.push(i)}i.options.sprites.push({type:"overlay",options:{identifier:t.getIdentifier(),intensity:t.getAlpha(),blendMode:l.default[t.getBlendMode()]}})}},{key:"_getFrameOptions",value:function e(t){return{identifier:t.getFrame().identifier}}},{key:"_serializeOrientationOperation",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOrientationOperation",this).call(this,r);if(n.options.rotation===90||n.options.rotation===270){n.options.flipHorizontally=!n.options.flipHorizontally;n.options.flipVertically=!n.options.flipVertically}return n}},{key:"_serializeTransformOperation",value:function e(r){var n=this._editor.operations;if(n.exists("orientation")){r=r.clone();var o=n.get("orientation");r.rotate(-o.getRotation());if(o.getFlipVertically()){r.flip("vertical");r.setRotation(r.getRotation()*-1)}if(o.getFlipHorizontally()){r.flip("horizontal");r.setRotation(r.getRotation()*-1)}}var a=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeTransformOperation",this).call(this,r);a.type="transform";return a}},{key:"_serializeText",value:function e(r,n){var o=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeText",this).call(this,r,n);var a=r.getInputDimensions(false);o.options.fontIdentifier=n.getFontIdentifier();o.options.maxWidth=o.options.maxWidth*a.x/a.min();delete o.options.fontFamily;return o}},{key:"_serializeFilterOperation",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeFilterOperation",this).call(this,r);if(!n)return null;n.options.identifier=n.options.name;delete n.options.name;return n}},{key:"_serializeRadialFocusOperation",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeRadialFocusOperation",this).call(this,r);var o=n.options.options;o.start=o.position;delete o.position;o.end={x:o.start.x+o.radius,y:o.start.y};delete o.radius;return n}}]);return t}(a.default);t.default=d;d.version="2.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(54);var s=w(a);var l=r(48);var u=w(l);var c=r(182);var f=w(c);var p=r(11);var d=w(p);var h=r(49);var v=w(h);var _=r(30);var m=w(_);var y=r(23);var g=w(y);var b=r(55);var k=w(b);function w(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function E(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function S(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=o.SDKUtils.flipObject(k.default);var C=function(e){S(t,e);function t(){var e;O(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._frameManager=new u.default(o._ui,o._getOptions("frame"));var a=o._getOptions("overlay");if(a){o._overlayManager=new f.default(o._ui,a)}return o}n(t,[{key:"_deserializeSprite",value:function e(r,n){if(n.type==="frame"){return this._deserializeFrame(r,n)}if(n.type==="overlay"){return this._deserializeOverlay(r,n)}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeSprite",this).call(this,r,n)}},{key:"_deserializeOperation",value:function e(r){if(r.type==="transform"){return this._deserializeTransformOperation(r)}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOperation",this).call(this,r)}},{key:"_deserializeOrientationOperation",value:function e(r){if(r.options.rotation===90||r.options.rotation===270){r.options.flipHorizontally=!r.options.flipHorizontally;r.options.flipVertically=!r.options.flipVertically}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOrientationOperation",this).call(this,r)}},{key:"_deserializeTransformOperation",value:function e(r){var n=this;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeCropOperation",this).call(this,r).then(function(e){if(!e)return;var t=o.SDKUtils.Array.find(n._data.operations,function(e){return e.type==="orientation"});if(t){var r=t.options;var i=r.rotation,a=r.flipHorizontally,s=r.flipVertically;if(i===90||i===270){if(!a&&s||a&&!s){a=!a;s=!s}}e.rotate(r.rotation);if(a){e.flip("horizontal");e.setRotation(e.getRotation()*-1)}if(s){e.flip("vertical");e.setRotation(e.getRotation()*-1)}}return e})}},{key:"_deserializeFrame",value:function e(t,r){var n=this;var i=r.options.identifier;var a=this._frameManager.getFrameByIdentifier(i);if(!a){o.Log.warn("Deserializer","Unknown frame `"+i+"`. Skipping frame.");return Promise.resolve()}var s=new v.default(this._ui,a);return s.load().then(function(){n._editor.operations.getOrCreate("frame",{frame:s.getFrame()})})}},{key:"_deserializeOverlay",value:function e(t,r){var n=this;var i=r.options,a=i.blendMode,s=i.intensity,l=i.identifier;var u=this._overlayManager.getOverlayByIdentifier(l);if(!u){o.Log.warn("Deserializer","Unknown overlay `"+l+"`. Skipping overlay.");return Promise.resolve()}var c=this._editor.getUI().getAssetPath(u.image);return g.default.load(c).then(function(e){n._editor.operations.getOrCreate("overlay",{alpha:s,identifier:l,blendMode:parseInt(P[a||u.blendMode],10),image:e})})}},{key:"_createBrushForPath",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createBrushForPath",this).call(this,r);if(typeof r.hardness!=="undefined"&&n.hasOption("hardness")){n.setHardness(r.hardness)}return n}},{key:"_deserializeSticker",value:function e(t,r){var n=this;var i=o.SDK.Operations.SpriteOperation;var a=r.options;var s=this._stickerManager.getStickerByIdentifier(a.identifier);var l=d.default.getURLForSticker(s,"base");if(!s){o.Log.warn("Deserializer","Unknown sticker `"+a.identifier+"`. Skipping sprite.");return Promise.resolve()}var u=t.getInputDimensions(false);return new Promise(function(e,r){var c=new window.Image;c.addEventListener("load",function(){var r=i.StickerSprite.prototype.availableOptions.adjustments.structure;var n=a.rotation,l=a.flipHorizontally,f=a.flipVertically;var p={identifier:a.identifier,image:c,position:o.Vector2.fromObject(a.position),dimensions:o.Vector2.fromObject(a.dimensions).multiply(u.min()),rotation:n,flipHorizontally:l,flipVertically:f,adjustments:{}};if(typeof a.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(function(e){if(typeof a.adjustments[e]!=="undefined"){p.adjustments[e]=a.adjustments[e]+r[e].default}})}if(typeof a.tintColor!=="undefined"&&typeof s.tintMode!=="undefined"){p.tintColor=o.Color.fromArray(a.tintColor);p.tintMode=s.tintMode}e(t.createSticker(p))});c.crossOrigin=n._editor.getCrossOrigin();c.src=n._editor.getUI().getAssetPath(l)})}},{key:"_deserializeFilterOperation",value:function e(t){var r=this;var n=t.options;if(!this._filterManager.getFilterByIdentifier(n.identifier)){o.Log.warn("Deserializer","Unknown filter `"+n.identifier+"`");return Promise.resolve()}return this._filterManager.instantiateFilterWithIdentifier(n.identifier).then(function(e){var t=r._editor.operations.getOrCreate("filter");if(!t)return;t.set({identifier:n.identifier,filter:e,intensity:n.intensity});return t})}},{key:"_deserializeFocusOperation",value:function e(r){var n=r.options,a=n.options,s=n.type;if(s!=="radial")return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFocusOperation",this).call(this,r);var l=a.start,u=a.end,c=a.gradientRadius,f=a.blurRadius;var p=o.Vector2.fromObject(u).subtract(o.Vector2.fromObject(l)).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:o.Vector2.fromObject(l),radius:p,gradientRadius:c,blurRadius:f}))}},{key:"_deserializeText",value:function e(t,r){var n=r.options;var i=n.fontSize,a=n.lineHeight,s=n.fontIdentifier,l=n.alignment,u=n.rotation,c=n.maxWidth,f=n.color,p=n.backgroundColor;var d=new m.default(this._ui);var h=this._fontManager.getVariationByIdentifier(s);if(!h){h=this._fontManager.getDefaultFont()}else{d.setFonts([h.getFont()])}return d.load().then(function(){var e=t.getInputDimensions(false);var r=c*e.min()/e.x;return t.createText({fontSize:i,lineHeight:a,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),alignment:l,rotation:u,maxWidth:r,text:n.text,color:o.Color.fromArray(f),backgroundColor:o.Color.fromArray(p),position:o.Vector2.fromObject(n.position)})})}}]);return t}(s.default);t.default=C;C.version="2.0.0"},function(e,t,r){if({ENV:'"production"'}.NODE_ENV!=="production"){var n=typeof Symbol==="function"&&Symbol.for&&Symbol.for("react.element")||60103;var i=function(e){return typeof e==="object"&&e!==null&&e.$$typeof===n};var o=true;e.exports=r(63)(i,o)}else{e.exports=r(66)()}},function(e,t,r){"use strict";var n=r(17);var i=n;if({ENV:'"production"'}.NODE_ENV!=="production"){var o=function e(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++){n[i-1]=arguments[i]}var o=0;var a="Warning: "+t.replace(/%s/g,function(){return n[o++]});if(typeof console!=="undefined"){console.error(a)}try{throw new Error(a)}catch(e){}};i=function e(t,r){if(r===undefined){throw new Error("`warning(condition, format, ...args)` requires a warning "+"message argument")}if(r.indexOf("Failed Composite propType: ")===0){return}if(!t){for(var n=arguments.length,i=Array(n>2?n-2:0),a=2;a<n;a++){i[a-2]=arguments[a]}o.apply(undefined,[r].concat(i))}}}e.exports=i},function(e,t,r){var n,i;(function(){"use strict";var r={}.hasOwnProperty;function o(){var e=[];for(var t=0;t<arguments.length;t++){var n=arguments[t];if(!n)continue;var i=typeof n;if(i==="string"||i==="number"){e.push(n)}else if(Array.isArray(n)){e.push(o.apply(null,n))}else if(i==="object"){for(var a in n){if(r.call(n,a)&&n[a]){e.push(a)}}}}return e.join(" ")}if(typeof e!=="undefined"&&e.exports){e.exports=o}else if(true){!(n=[],i=function(){return o}.apply(t,n),i!==undefined&&(e.exports=i))}else{window.classNames=o}})()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o="__";var a="--";var s="pesdk-react-";var l=function(){function e(t,r,n){i(this,e);this._parent=t;this._type=r;this._name=n}n(e,[{key:"element",value:function t(r){return new e(this,"element",r)}},{key:"modifier",value:function t(r){return new e(this,"modifier",r)}},{key:"str",get:function e(){var t=this._parent?this._parent.str:"";switch(this._type){case"block":t+=""+s+this._name;break;case"element":t+=""+o+this._name;break;case"modifier":t+=""+a+this._name;break}return t}}]);return e}();t.default={block:function e(t){return new l(null,"block",t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=r(16);var o=c(i);var a=r(35);var s=c(a);var l=r(36);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function p(e){var t=[];for(var r=0;r<e.length;r++){if(e[r]instanceof Array){t=t.concat(p(e[r]))}else{t.push(e[r])}}return t}var d={b:"block",e:"element",m:"modifier"};var h={_parseBemSpecifier:function e(t){if(!t)return[];var r=t.split(" ");var n=r.map(function(e){var t=e.match(/^(\$)?([bem]):(.*)$/i);if(!t){throw new Error("Invalid BEM specifier: "+e)}var r=typeof t[1]!=="undefined";var n=d[t[2]];var i=t[3];return{type:n,name:i,pass:r}});return n},_getBemInfoForNode:function e(t){var r=t.type==="bem";var n=r?t.props.specifier:t.props.bem;if(r&&!n){throw new Error("<bem> elements should always have a `specifier` property")}var i=this._parseBemSpecifier(n);if(r){i.forEach(function(e){e.pass=true})}return{data:i,isBemNode:r}},createElement:function e(t,r){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++){i[o-2]=arguments[o]}r=r||{};i=i.filter(function(e){return e!==null&&typeof e!=="undefined"});return{type:t,props:r,children:i}},_isNodeBEMable:function e(t){return t!==null&&(typeof t==="undefined"?"undefined":n(t))==="object"&&!o.default.isValidElement(t)},_applyBEMClasses:function e(t){var r=this;if(!this._isNodeBEMable(t))return t;var n=t.props.className?[t.props.className]:[];var i=this._getBemInfoForNode(t);var o=t.props.__bemObject;var a=t.props.__bemObject;i.data.forEach(function(e){if(e.type==="block"){o=u.default.block(e.name);if(e.pass){a=u.default.block(e.name)}n.push(o.str)}else if(e.type==="element"){if(!o){throw new Error("Tried to create an element, but no parent block has been found.")}o=o.element(e.name);if(e.pass){a=a.element(e.name)}n.push(o.str)}else if(e.type==="modifier"){if(!o){throw new Error("Tried to create a modifier, but no parent block has been found.")}if(e.pass){a=a.modifier(e.name)}n.push(o.modifier(e.name).str)}});var l=(0,s.default)(n);if(l){t.props.className=l}t.children=p(t.children);t.children.forEach(function(e){if(!r._isNodeBEMable(e))return;e.props.__bemObject=a});t.children=t.children.map(function(e){return r._applyBEMClasses(e)});t.children=p(t.children);delete t.props.__bemObject;delete t.props.bem;if(i.isBemNode){if(t.children instanceof Array&&t.children.length===1){t=t.children[0]}else{t=t.children}}return t},_transformToReact:function e(t){var r=this;if(!this._isNodeBEMable(t))return t;t.children=t.children.map(function(e){return r._transformToReact(e)});return o.default.createElement.apply(o.default,[t.type,t.props].concat(f(t.children)))},transform:function e(t){t=this._applyBEMClasses(t);if(t instanceof Array){return t}t=this._transformToReact(t);return t}};t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_analog",defaultName:"Analog",filters:[{identifier:"imgly_lut_cool",defaultName:"Cool",lutImage:"filters/imgly_lut_cool_5_5_128.png"},{identifier:"imgly_lut_blues",defaultName:"Blues",lutImage:"filters/imgly_lut_blues_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Blue Shadows",lutImage:"filters/imgly_lut_blueshadows_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"KDynamic",lutImage:"filters/imgly_lut_kdynamic_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"}]},{identifier:"imgly_filters_bw",defaultName:"Black & White",filters:[{identifier:"imgly_lut_sin",defaultName:"Sin",lutImage:"filters/imgly_lut_sin_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"B & W",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Plate",lutImage:"filters/imgly_lut_plate_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"X400",lutImage:"filters/imgly_lut_x400_5_5_128.png"}]},{identifier:"imgly_filters_retro",defaultName:"Retro",filters:[{identifier:"imgly_lut_celsius",defaultName:"Celsius",lutImage:"filters/imgly_lut_celsius_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_k2",defaultName:"K2",lutImage:"filters/imgly_lut_k2_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia High",lutImage:"filters/imgly_lut_sepiahigh_5_5_128.png"},{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Eighties",lutImage:"filters/imgly_lut_eighties_5_5_128.png"},{identifier:"imgly_lut_elder",defaultName:"Elder",lutImage:"filters/imgly_lut_elder_5_5_128.png"},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Orchid",lutImage:"filters/imgly_lut_orchid_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"}]},{identifier:"imgly_filters_special",defaultName:"Special",filters:[{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Cotton Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"High Contrast",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_nogreen",defaultName:"No Green",lutImage:"filters/imgly_lut_nogreen_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Pola 669",lutImage:"filters/imgly_lut_pola669_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"}]},{identifier:"imgly_filters_summer",defaultName:"Summer",filters:[{identifier:"imgly_lut_texas",defaultName:"Texas",lutImage:"filters/imgly_lut_texas_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_chest",defaultName:"Chest",lutImage:"filters/imgly_lut_chest_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Evening",lutImage:"filters/imgly_lut_evening_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Fall",lutImage:"filters/imgly_lut_fall_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Front",lutImage:"filters/imgly_lut_front_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_sunset",defaultName:"Sunset",lutImage:"filters/imgly_lut_sunset_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"}]},{identifier:"imgly_filters_winter",defaultName:"Winter",filters:[{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_bleached",defaultName:"Bleached",lutImage:"filters/imgly_lut_bleached_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Bleached Blue",lutImage:"filters/imgly_lut_bleachedblue_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Breeze",lutImage:"filters/imgly_lut_breeze_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lenin",lutImage:"filters/imgly_lut_lenin_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_winter",defaultName:"Winter",lutImage:"filters/imgly_lut_winter_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:true,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}},function(e,t,r){(function(t){(function(){var r,n,i;if(typeof performance!=="undefined"&&performance!==null&&performance.now){e.exports=function(){return performance.now()}}else if(typeof t!=="undefined"&&t!==null&&t.hrtime){e.exports=function(){return(r()-i)/1e6};n=t.hrtime;r=function(){var e;e=n();return e[0]*1e9+e[1]};i=r()}else if(Date.now){e.exports=function(){return Date.now()-i};i=Date.now()}else{e.exports=function(){return(new Date).getTime()-i};i=(new Date).getTime()}}).call(this)}).call(t,r(21))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onClick");return s}n(t,[{key:"_onClick",value:function e(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion)}},{key:"renderWithBEM",value:function e(){var t=this.props.searchSuggestion;var r={backgroundImage:"url("+t.coverImage+")"};return i.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},i.ReactBEM.createElement("li",{bem:"e:item",style:r,onClick:this._onClick},i.ReactBEM.createElement("div",{bem:"e:overlay"}),i.ReactBEM.createElement("div",{bem:"e:name"},t.query)))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(1);var s=p(a);var l=r(103);var u=p(l);var c=r(2);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=240;var m=function(e){v(t,e);function t(){var e;d(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._needsStyleFixes=true;o._totalPhotosHeight=0;o.state={loading:false,photos:[]};return o}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._loadPhotos()}},{key:"componentDidUpdate",value:function e(){if(this.refs.scrollbar){this.refs.scrollbar.update()}}},{key:"_onPhotoClicked",value:function e(t){this.props.onPhotoClicked&&this.props.onPhotoClicked(t)}},{key:"_getHeadline",value:function e(){return this.props.library.name}},{key:"fixStyles",value:function e(){if(o.Utils.Browser.isIElte(11)){var t=this.refs.cell;var r=this.refs.scrollbar.getList();if(!(t&&r)){return}var n=t.offsetHeight;r.style.height=n+"px"}if(this.refs.scrollbar){this.refs.scrollbar.update()}}},{key:"_renderColumns",value:function e(){var t=this;var r=this.state.photos;var n=3;var i=[];var a=[];for(var s=0;s<n;s++){a.push([]);i.push(0)}r.forEach(function(e){var r=e.dimensions;var s=null;var l=Infinity;for(var c=0;c<n;c++){if(i[c]<l){s=c;l=i[c]}}a[s].push(o.ReactBEM.createElement(u.default,{photo:e.obj,onClick:t._onPhotoClicked.bind(t,e.obj)}));i[s]+=r.y});return a}},{key:"_renderPhotos",value:function e(){var t=this._renderColumns();return o.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},o.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},o.ReactBEM.createElement(f.default,{direction:"vertical",ref:"scrollbar"},o.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},o.ReactBEM.createElement("div",{bem:"e:innerContainer"},o.ReactBEM.createElement("div",{bem:"e:headline"},this._getHeadline()),o.ReactBEM.createElement("bem",{specifier:"e:photoList"},t.map(function(e){return o.ReactBEM.createElement("ul",{bem:"$e:list"},e)})))))))}},{key:"_loadPhotos",value:function e(){var t=this;this._totalPhotosHeight=0;var r=s.default.instance.displayProgress(this._t("loading.loading"));var n=this.context.options.photoRoll.provider;var i=new n;i.getPhotosForLibrary(this.props.library).then(function(e){return t._preloadPhotos(e,r)}).then(function(e){t.setState({photos:e,loading:false});r.close()}).catch(function(e){r.close();s.default.instance.displayError(t._t("errors.photoRollLoadFail.title"),t._t("errors.photoRollLoadFail.text",{error:e.message}))})}},{key:"_preloadPhotos",value:function e(t,r){var n=this;var i=t.length;var a=0;return Promise.all(t.map(function(e){return n._preloadPhoto(e).then(function(t){var s=new o.Vector2(t.width,t.height);s.multiply(_/t.width);n._totalPhotosHeight+=s.y;a++;r.setData({progress:a/i});return{obj:e,dimensions:s}})}))}},{key:"_preloadPhoto",value:function e(t){var r=this;return new Promise(function(e,n){var i=new window.Image;i.addEventListener("load",function(){e(i)});i.addEventListener("error",function(){e(i)});i.crossOrigin=r.props.crossOrigin||"anonymous";i.src=t.urls.thumb})}},{key:"renderWithBEM",value:function e(){if(!this.state.loading){return this._renderPhotos()}else{return o.ReactBEM.createElement("div",null)}}}]);return t}(o.BaseComponent);t.default=m;m.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(3);var a=u(o);var s=r(2);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._hasBackButton=false;return o}n(t,[{key:"_onItemClick",value:function e(t){this.props.onSwitchControls(t)}},{key:"_renderListItems",value:function e(){var t=this;var r=this.context.editor;var n=[];var o=function e(n){var o=r.controls.get(n);return i.ReactBEM.createElement("li",{bem:"e:item",key:o.identifier,"data-identifier":o.identifier,onClick:t._onItemClick.bind(t,o)},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withLabel"},i.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath(o.iconPath,true)}),i.ReactBEM.createElement("div",{bem:"e:label"},t._t(o.languageKey)))))};var a=this.context.options.editor.controlsOrder;a.forEach(function(e){if(Array.isArray(e)){var t=e;var i=[];t.forEach(function(e){if(!r.controls.isEnabled(e))return;i.push(o(e))});if(i.length){n.push(i)}}else{var a=e;if(!r.controls.isEnabled(a))return;n.push(o(a))}});var s=[];n.forEach(function(e){s=s.concat(e);if(e!==n[n.length-1]){s.push(i.ReactBEM.createElement("li",{bem:"e:separator"}))}});return s}},{key:"renderControls",value:function e(){var t=this._renderListItems();return i.ReactBEM.createElement("div",{bem:"e:cell m:list"},i.ReactBEM.createElement(l.default,null,i.ReactBEM.createElement("ul",{bem:"$e:list"},t)))}}]);return t}(a.default);t.default=d;d.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(120);var a=g(o);var s=r(122);var l=g(s);var u=r(123);var c=g(u);var f=r(124);var p=g(f);var d=r(168);var h=g(d);var v=r(169);var _=g(v);var m=r(170);var y=g(m);function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function k(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function w(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var O=function(e){w(t,e);function t(e,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;b(this,t);var o=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));o._ui=e;o._options=r;o._mediator=n;o._ready=false;o._padding=[0,0,0,0];o._shallow=i;if(!i){o._initSDK();o._onZoom=o._onZoom.bind(o);o._onUndo=o._onUndo.bind(o);o.history=new y.default(o,o._sdk,o._mediator);o.history.on("undo",o._onUndo);o.zoom=new _.default(o,o._sdk,o._mediator);o.zoom.on("set",o._onZoom);o._initSerializers()}o.operations=new c.default(o,o._sdk,o._mediator);o.controls=new p.default(o,o._sdk,o._mediator);o.features=new h.default(o,o._sdk,o._mediator);o._running=false;o._renderRequested=true;o._renderCallbacks=[];o._animationFrameRequest=null;o.render=o.render.bind(o);o._tick=o._tick.bind(o);return o}n(t,[{key:"setImage",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._options.editor.image;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var o=this._sdk.getRenderer();var a=new i.Vector2(r.naturalWidth,r.naturalHeight);var s=this.getMaxMegapixels()*1e6;var u=o.getMaxDimensions();if(n){this.reset()}var c=new l.default(r,s,u);var f=null;var p=function e(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;t._setImage(r,f,n);t._initWatermark();t._ready=true;t.emit("ready")};if(!c.needsResize()){p(r)}else{this.emit("resize");f=this._sdk.parseExif(r);c.resize().then(function(e){var r=e.canvas,n=e.dimensions,i=e.reason;r.src="data:image/jpeg;base64,";t.emit("resized",{dimensions:n,reason:i});p(r,n,i)})}}},{key:"_initWatermark",value:function e(){if(this._options.editor.watermarkImage){this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage})}}},{key:"_initSDK",value:function e(){var t=this._options,r=t.logLevel,n=t.displayWelcomeMessage,o=t.debug,a=t.license,s=t.crossOrigin;var l=this._options.editor,u=l.smoothDownscaling,c=l.smoothUpscaling,f=l.preferredRenderer,p=l.pixelRatio;var d={logLevel:r,debug:o,displayWelcomeMessage:n,pixelRatio:p,smoothDownscaling:u,smoothUpscaling:c,crossOrigin:s,transparent:true,license:a};this._sdk=new i.SDK(f,d)}},{key:"_onZoom",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.fixOffset();this.render(function(){r._mediator.emit(i.Constants.EVENTS.ZOOM_DONE);n&&n()})}},{key:"_onUndo",value:function e(){this.render()}},{key:"getRotation",value:function e(){return this._sdk.getRotation()}},{key:"setRotation",value:function e(t){this._sdk.setRotation(t)}},{key:"getSpriteScale",value:function e(){return this._sdk.getSpriteScale()}},{key:"setSpriteScale",value:function e(t){this._sdk.setSpriteScale(t)}},{key:"getCrossOrigin",value:function e(){return i.SDKUtils.getCrossOriginValue(this._options.crossOrigin||"anonymous")}},{key:"isToolAllowed",value:function e(t){if(this._shallow)return true;return this._sdk._l.isToolAllowed(t)}},{key:"isToolEnabled",value:function e(t){return this._options.editor.tools.indexOf(t)!==-1}},{key:"getMaxMegapixels",value:function e(){var t=this._options.editor.maxMegaPixels;return i.Utils.isMobile()?t.mobile:t.desktop}},{key:"getOutputDimensions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return this._sdk.getOutputDimensions(t)}},{key:"getOutputTextureDimensions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return this._sdk.getOutputTextureDimensions(t)}},{key:"getFinalDimensions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return this._sdk.getFinalDimensions(t)}},{key:"getCanvasDimensions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var r=this._sdk.getCanvas();var n=new i.Vector2(r.offsetWidth,r.offsetHeight);if(t){n.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2])}return n}},{key:"_setImage",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._options.editor.image;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._sdk.setAllOperationsToDirty();this._options.editor.image=t;this._sdk.setImage(t,r,n);this.zoom.set("auto");this.emit("new-image")}},{key:"export",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this._watermarkOperation){this._watermarkOperation.setEnabled(false)}this._sdk.setAllOperationsToDirty();var n=this._options.editor.export;var o=new a.default(this._sdk,n,r);return o.export().then(function(e){t.emit("export",e);t._mediator.emit(i.Constants.EVENTS.EXPORT,e,t);if(t._watermarkOperation){t._watermarkOperation.setEnabled(true);t._sdk.render()}t._sdk.setAllOperationsToDirty();return e})}},{key:"_initSerializers",value:function e(){this._serializers={"1.0.0":r(171).default,"1.0.1":r(180).default,"2.0.0":r(181).default,"2.0.1":r(183).default,"3.0.0":r(186).default,"3.1.0":r(187).default}}},{key:"serialize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"3.1.0";var n=this._serializers[r];if(!n){return i.Promise.reject(new Error("No serializer for version "+r+" found."))}var o=new n(this);return o.serialize(t)}},{key:"deserialize",value:function e(t){var r=this;var n=this._serializers[t.version];if(!n){return i.Promise.reject(new Error("No serializer for version "+t.version+" found."))}var o=new n(this);return o.deserialize(t).then(function(){r.zoom.set("auto")})}},{key:"_applyOffset",value:function e(){var t=this._offset.clone();t.x-=this._padding[1]/2;t.x+=this._padding[3]/2;t.y-=this._padding[2]/2;t.y+=this._padding[0]/2;this._sdk.setOffset(t)}},{key:"start",value:function e(){this.zoom.set("auto");this._animationFrameRequest=(0,i.requestAnimationFrame)(this._tick)}},{key:"stop",value:function e(){this._running=false;if(this._animationFrameRequest){(0,i.cancelAnimationFrame)(this._animationFrameRequest);this._renderCallbacks=[]}}},{key:"render",value:function e(t){this._renderRequested=true;if(t){this._renderCallbacks.push(t)}}},{key:"setOffset",value:function e(t){this._offset=this._clampOffset(t)}},{key:"getOffset",value:function e(){return this._offset}},{key:"fixOffset",value:function e(){this.setOffset(this._sdk.getOffset())}},{key:"_clampOffset",value:function e(t){var r=this._sdk.getRenderer();var n=new i.Vector2(r.getWidth(),r.getHeight());var o=this._sdk.getOutputDimensions(false);var a=n.clone().subtract(o).divide(2).clamp(null,new i.Vector2(0,0));var s=o.clone().subtract(n).divide(2).clamp(new i.Vector2(0,0),null);var l=t.clone().clamp(a,s).round();return l}},{key:"_tick",value:function e(){var t=this;if(this._renderRequested){var r=this._renderCallbacks.slice(0);this._renderCallbacks=[];this._render().then(function(){r.forEach(function(e){return e()});t._animationFrameRequest=(0,i.requestAnimationFrame)(t._tick)}).catch(function(e){i.Log.error("An error occurred while rendering: "+e.message)});this._renderRequested=false}else{this._animationFrameRequest=(0,i.requestAnimationFrame)(this._tick)}}},{key:"_render",value:function e(){var t=this;if(!this._ready)return i.Promise.resolve();this._applyOffset();return this._sdk.render().then(function(){t._lastOutputBounds=t._sdk.getSprite().getBounds()}).catch(function(e){t.emit("render-error",e)})}},{key:"reset",value:function e(){this._sdk.reset();this.history.reset();this.operations.reset()}},{key:"dispose",value:function e(){this.stop();this._sdk.dispose()}},{key:"isReady",value:function e(){return this._ready}},{key:"getRenderer",value:function e(){return this._sdk.getRenderer()}},{key:"getSDK",value:function e(){return this._sdk}},{key:"getInputDimensions",value:function e(){return this._sdk.getInputDimensions(false)}},{key:"getPadding",value:function e(){return this._padding}},{key:"setPadding",value:function e(t){if(!t){this._padding=[0,0,0,0]}else{this._padding=t}}},{key:"getImage",value:function e(){return this._options.editor.image}},{key:"getOptions",value:function e(){return this._options}},{key:"getUI",value:function e(){return this._ui}},{key:"getMediator",value:function e(){return this._mediator}},{key:"broadcastTransform",value:function e(t,r){var n=this;var o=new i.SDK.Operations.TransformOperation.TransformChange(t,r);var a=["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"];a.forEach(function(e){var t=n.operations.get(e);if(!t){return}t.transform(o)})}},{key:"broadcastFlip",value:function e(t){var r=this;var n=["mirrored-focus","radial-focus","sprite","selective-blur"];n.forEach(function(e){var n=r.operations.get(e);if(!n){return}n.flip(t)})}},{key:"broadcastRotate",value:function e(t){var r=this;var n=["transform","mirrored-focus","radial-focus","sprite","selective-blur"];n.forEach(function(e){var n=r.operations.get(e);if(!n){return}n.rotate(t)})}}]);return t}(i.EventEmitter);t.default=O},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(125);Object.defineProperty(t,"adjustments",{enumerable:true,get:function e(){return p(n).default}});var i=r(128);Object.defineProperty(t,"transform",{enumerable:true,get:function e(){return p(i).default}});var o=r(132);Object.defineProperty(t,"filter",{enumerable:true,get:function e(){return p(o).default}});var a=r(135);Object.defineProperty(t,"focus",{enumerable:true,get:function e(){return p(a).default}});var s=r(140);Object.defineProperty(t,"sticker",{enumerable:true,get:function e(){return p(s).default}});var l=r(148);Object.defineProperty(t,"text",{enumerable:true,get:function e(){return p(l).default}});var u=r(158);Object.defineProperty(t,"brush",{enumerable:true,get:function e(){return p(u).default}});var c=r(162);Object.defineProperty(t,"selectiveBlur",{enumerable:true,get:function e(){return p(c).default}});var f=r(165);Object.defineProperty(t,"frame",{enumerable:true,get:function e(){return p(f).default}});function p(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(134);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){l(this,t);var e=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._bindAll("_onButtonClick");e.state={overlayVisible:false};return e}n(t,[{key:"_onButtonClick",value:function e(t){t.preventDefault();t.stopPropagation();this.setState({overlayVisible:!this.state.overlayVisible})}},{key:"renderWithBEM",value:function e(){var t=null;if(this.state.overlayVisible){t=i.ReactBEM.createElement(a.default,{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange})}var r=this.state.overlayVisible?"is-active":null;return i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:categoryDropdown",className:r,onClick:this._onButtonClick},i.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.selectedItem.icon}),i.ReactBEM.createElement("div",{bem:"e:label"},this.props.selectedItem.label),t))}}]);return t}(i.BaseComponent);t.default=f;f.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){a(this,t);return s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderCanvas()}},{key:"componentDidUpdate",value:function e(){this._renderCanvas()}},{key:"_renderCanvas",value:function e(){var t=this.refs.canvas;var r=this.context.editor;var n=r.getSDK();var i=n.getPixelRatio();t.width=t.offsetWidth*i;t.height=t.offsetHeight*i;t.style.width=t.offsetWidth+"px";t.style.height=t.offsetHeight+"px";var o=t.getContext("2d");o.fillStyle="red";o.clearRect(0,0,t.width,t.height);o.font=(this.props.fontStyle||"")+" "+(this.props.fontWeight||"")+" "+24*i+"px "+this.props.fontFamily;o.textBaseline="middle";o.textAlign="center";o.fillStyle="white";o.fillText("Abc",t.width/2,t.height/2)}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("canvas",{bem:"b:fontFamily e:canvas",ref:"canvas"})}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(7);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"};var u=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"getLabel",value:function e(){var t=l[this._options.fontWeight];switch(this._options.fontStyle){case"italic":t+=" Italic";break}return t}}]);return t}(i.Configurable);t.default=u;u.prototype.availableOptions={identifier:{type:i.OptionType.STRING,required:true},fontFamily:{type:i.OptionType.STRING,required:true},fontWeight:{type:i.OptionType.ALL,default:400},fontStyle:{type:i.OptionType.STRING,default:"normal"},textMetrics:{type:i.OptionType.OBJECT,default:null},provider:{type:i.OptionType.STRING,available:["google","file"]},filePath:{type:i.OptionType.STRING},default:{type:i.OptionType.BOOLEAN,default:false},font:{type:i.OptionType.OBJECT}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r){o(this,e);this._ui=t;this._options=r;this._categoriesById={};this._categories=[];this._framesById={};this._addCategories(i.SharedConstants.DEFAULTS.FRAME_CATEGORIES);var n=this._options,a=n.categories,s=n.replaceCategories;if(this._options.categories){this._addCategories(a,s)}else{this._updateAllCategory()}}n(e,[{key:"_addCategories",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(n){this._categories=t.slice(0)}else{this._categories=i.Utils.mergeCategories(this._categories,t,"frames")}this._categoriesById={};this._categories.forEach(function(e){r._categoriesById[e.identifier]=e});var o=this._options.availableFrames;if(o){this._categories.forEach(function(e){e.frames=e.frames.filter(function(e){return o.indexOf(e.identifier)!==-1})})}this._categories.forEach(function(e){e.frames.forEach(function(e){r._framesById[e.identifier]=e})});this._updateAllCategory()}},{key:"_updateAllCategory",value:function e(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(function(e){return e.frames}).reduce(function(e,t){return e.concat(t)},[])};this._categoriesById.all=this._allCategory}},{key:"getFramesForCategory",value:function e(t){if(!this._categoriesById[t]){throw new Error("Unknown frame category '"+t+"'")}return this._categoriesById[t].frames}},{key:"getFrameByIdentifier",value:function e(t){return this._framesById[t]}},{key:"getCategories",value:function e(){return this._categories}},{key:"getCategory",value:function e(t){return this._categoriesById[t]}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=i.SDK.OptionType;var u=function(e){s(t,e);function t(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r));n._loaded=false;n._loading=false;n._ui=e;n._frame=i.SDK.Utils.deepClone(n._options);return n}n(t,[{key:"load",value:function e(){var t=this;if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=true;var r=this._frame.imageGroups;var n=[];["top","left","right","bottom"].forEach(function(e){if(!(e in r))return;var i=r[e];["start","mid","end"].forEach(function(r){if(!(r in i))return;n.push(t._loadPart(e,r))})});return Promise.all(n).then(function(){t._loaded=true;t._loading=false}).catch(function(e){t._loaded=false;t._loading=false})}},{key:"_loadPart",value:function e(t,r){var n=this;return new Promise(function(e,i){var o=n._frame.imageGroups;var a=o[t][r];var s=a;if(typeof a!=="string"&&"image"in a){s=a.image}var l=new window.Image;l.addEventListener("load",function(){if(typeof a!=="string"){n._frame.imageGroups[t][r].image=l}else{n._frame.imageGroups[t][r]=l}e(l)});l.addEventListener("error",function(){i(new Error("Failed to load image at "+s))});l.crossOrigin=n._ui.getEditor().getCrossOrigin();l.src=n._ui.getAssetPath(s)})}},{key:"getFrame",value:function e(){return this._frame}}]);return t}(i.SDK.Configurable);t.default=u;u.prototype.availableOptions={identifier:{type:l.STRING,required:true},defaultName:{type:l.STRING},thumbnail:{type:l.STRING},tintable:{type:l.BOOLEAN,default:false},layoutMode:{type:l.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:l.OBJECT,required:true}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=Math.PI*2;var s=function(){function e(t){o(this,e);this._editor=t;this._serializeOperations=this._serializeOperations.bind(this)}n(e,[{key:"serialize",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._options=i.SDKUtils.defaults(t,{image:true});var r={version:this.constructor.version};return this._serializeInputImage(r).then(this._serializeOperations)}},{key:"_serializeInputImage",value:function e(t){var r=this._editor.getImage();var n=r.width,o=r.height;if(!this._options.image){t.inputImage={width:n,height:o};return Promise.resolve(t)}var a=i.SDKUtils.createCanvas();a.width=r.width;a.height=r.height;var s=a.getContext("2d");s.drawImage(r,0,0);var l=a.toDataURL(i.ImageFormat.PNG);t.inputImage={type:i.ImageFormat.PNG,data:l.replace(/^data:image\/(.*?);base64,/,""),width:n,height:o};return Promise.resolve(t)}},{key:"_serializeOperations",value:function e(t){var r=this;var n=[];var i=this._editor.operations.getStack();i.forEach(function(e){var t=r._serializeOperation(e,n);if(t){n.push(t)}});t.operations=n.filter(function(e){return e});return Promise.resolve(t)}},{key:"_serializeOperation",value:function e(t,r){switch(t.constructor.identifier){case"transform":return this._serializeTransformOperation(t);case"orientation":return this._serializeOrientationOperation(t);case"filter":return this._serializeFilterOperation(t);case"adjustments":return this._serializeAdjustmentsOperation(t);case"sprite":return this._serializeSpriteOperation(t,r);case"radial-focus":return this._serializeRadialFocusOperation(t);case"mirrored-focus":return this._serializeLinearFocusOperation(t);default:i.Log.warn("Unable to serialize operation of type "+t.constructor.identifier)}}},{key:"_serializeTransformOperation",value:function e(t){var r=t.serializeOptions(["start","end","rotation"],true);r.rotation=(r.rotation+a)%a;return{type:"crop",options:r}}},{key:"_serializeOrientationOperation",value:function e(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],true)}}},{key:"_serializeFilterOperation",value:function e(t){if(t.getIdentifier()==="identity")return null;return{type:"filter",options:{intensity:t.getIntensity(),name:t.getIdentifier()}}}},{key:"_serializeAdjustmentsOperation",value:function e(t){var r=t.availableOptions;var n=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"];var i={};n.forEach(function(e){var n=r[e];var o=t.getOption(e);var a=n.minValue,s=n.midValue,l=n.maxValue;i[e]=o<=s?(o-a)/(s-a)-1:(o-s)/(l-s)});return{type:"adjustments",options:i}}},{key:"_serializeSpriteOperation",value:function e(t,r){var n=this;var i=r.filter(function(e){return e.type==="sprite"});var o=void 0;var a=true;if(i.length){o=i.pop();a=false}else{o={type:"sprite",options:{sprites:[]}}}t.getSprites().forEach(function(e){var r=null;if(e instanceof t.constructor.StickerSprite){r=n._serializeSticker(t,e)}else if(e instanceof t.constructor.TextSprite){r=n._serializeText(t,e)}else if(e instanceof t.constructor.BrushSprite){r=n._serializeBrush(t,e)}else if(e instanceof t.constructor.TextDesignSprite){r=n._serializeTextDesign&&n._serializeTextDesign(t,e)}if(r){o.options.sprites.push(r)}});if(a){return o}}},{key:"_serializeSticker",value:function e(t,r){var n=r.getAdjustments();var i=r.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],true);i.name=i.identifier;delete i.identifier;i.rotation=(i.rotation+a)%a;var o=n.availableOptions;i.adjustments={brightness:n.getBrightness()-o.brightness.default,saturation:n.getSaturation()-o.saturation.default,contrast:n.getContrast()-o.contrast.default};return{type:"sticker",options:i}}},{key:"_serializeText",value:function e(t,r){var n=r.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],true);n.rotation=(n.rotation+a)%a;return{type:"text",options:n}}},{key:"_serializeBrush",value:function e(t,r){var n=this;return{type:"brush",options:{paths:r.getPaths().map(function(e){return n._serializePath(e)})}}}},{key:"_serializePath",value:function e(t){var r=t.getBrush().serializeOptions(["color","size"],true);r.points=t.getControlPoints().map(function(e){return e.getPosition().toObject()});return r}},{key:"_serializeRadialFocusOperation",value:function e(t){return{type:"focus",options:{type:"radial",options:t.serializeOptions(["position","radius","gradientRadius","blurRadius"],true)}}}},{key:"_serializeLinearFocusOperation",value:function e(t){return{type:"focus",options:{type:"linear",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],true)}}}},{key:"_getInputDimensionsForOperation",value:function e(t){var r=false;var n=this._editor.getInputDimensions();this._editor.operations.getStack().forEach(function(e){if(e===t)r=true;if(r)return;n=e.getNewDimensions(n)});return n}}]);return e}();t.default=s;s.version="1.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(172);var i=m(n);var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var a=r(0);var s=r(27);var l=m(s);var u=r(11);var c=m(u);var f=r(175);var p=m(f);var d=r(15);var h=m(d);var v=r(30);var _=m(v);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function g(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function b(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var a=t[i](o);var s=a.value}catch(e){r(e);return}if(a.done){e(s)}else{return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function k(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=void 0;if(typeof a.SDK.Operations.SpriteOperation!=="undefined"){w=a.SDK.Operations.SpriteOperation.BrushSprite}var O=function(){function e(t,r){k(this,e);this._editor=t;this._ui=this._editor.getUI();this._data=r;this._filterManager=new l.default(this._ui,this._getOptions("filter"));this._stickerManager=new c.default(this._ui,this._getOptions("sticker"));this._brushManager=new p.default(this._ui,this._getOptions("brush"));this._fontManager=new h.default(this._ui,this._getOptions("text"))}o(e,[{key:"_getOptions",value:function e(t){var r=this._editor.controls;var n={};if(r&&r.get(t)){n=r.get(t).defaultOptions}var i=this._editor.getOptions();return a.SDKUtils.deepDefaults({},i.editor.controlsOptions[t]||{},n)}},{key:"deserialize",value:function e(){var t=this;return this._validateVersion().then(function(){return t._deserializeInputImage()}).then(function(){return t._deserializeOperations()})}},{key:"_validateVersion",value:function e(){if(this._data.version!==this.constructor.version){return Promise.reject(new Error("Invalid version "+this._data.version+", expected "+this.constructor.version))}return Promise.resolve()}},{key:"_deserializeInputImage",value:function e(){var t=this;return new Promise(function(e,r){var n=t._data.inputImage,i=n.data,o=n.type;if(i&&o){var a=new window.Image;a.addEventListener("load",function(){t._editor.setImage(a);e()});a.src="data:"+o+";base64,"+i}else{e()}})}},{key:"_deserializeOperations",value:function(){var e=b(i.default.mark(function e(){var t,r,n,o,a;return i.default.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:t=this._data.operations;r=[];n=0;case 3:if(!(n<t.length)){i.next=12;break}o=t[n];i.next=7;return this._deserializeOperation(o);case 7:a=i.sent;r.push(a);case 9:n++;i.next=3;break;case 12:return i.abrupt("return",r);case 13:case"end":return i.stop()}}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"_deserializeOperation",value:function e(t){switch(t.type){case"crop":return this._deserializeCropOperation(t);case"orientation":return this._deserializeOrientationOperation(t);case"filter":return this._deserializeFilterOperation(t);case"adjustments":return this._deserializeAdjustmentsOperation(t);case"sprite":return this._deserializeSpriteOperation(t);case"focus":return this._deserializeFocusOperation(t)}}},{key:"_deserializeCropOperation",value:function e(t){var r=t.options;var n=r.rotation;var i=a.Vector2.fromObject(r.start);var o=a.Vector2.fromObject(r.end);if(n>Math.PI){n-=Math.PI*2}var s={start:i,end:o};if(typeof n!=="undefined"){s.rotation=n}var l=this._editor.operations.getOrCreate("transform");this._editor.broadcastTransform(l,s);l.set(s);return Promise.resolve(l)}},{key:"_deserializeOrientationOperation",value:function e(t){var r=t.options;var n=this._editor.operations.getOrCreate("orientation");if(!n)return Promise.resolve();n.set(r);return Promise.resolve(n)}},{key:"_deserializeFilterOperation",value:function e(t){var r=this;var n=t.options;if(!this._filterManager.getFilterByIdentifier(n.name)){a.Log.warn("Deserializer","Unknown filter `"+n.name+"`");return Promise.resolve()}return this._filterManager.instantiateFilterWithIdentifier(n.name).then(function(e){var t=r._editor.operations.getOrCreate("filter");t.set({identifier:n.name,filter:e,intensity:n.intensity});return t})}},{key:"_deserializeAdjustmentsOperation",value:function e(t){var r=a.SDK.Operations.AdjustmentsOperation;var n=t.options;var i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"];var o={};i.forEach(function(e){if(typeof n[e]==="undefined")return;var t=r.prototype.availableOptions[e],i=t.minValue,a=t.midValue,s=t.maxValue;var l=n[e];l=l<0?a+(a-i)*l:a+(s-a)*l;o[e]=l});return Promise.resolve(this._editor.operations.getOrCreate("adjustments",o))}},{key:"_deserializeSpriteOperation",value:function e(t){var r=this;var n=t.options;var i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();var o=n.sprites.map(function(e){return r._deserializeSprite(i,e)}).filter(function(e){return e});return Promise.all(o).then(function(e){i.setSprites(e.filter(function(e){return e}));return i})}},{key:"_deserializeSprite",value:function e(t,r){switch(r.type){case"sticker":return this._deserializeSticker(t,r);case"text":return this._deserializeText(t,r);case"brush":return this._deserializeBrush(t,r);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(t,r)}}},{key:"_deserializeSticker",value:function e(t,r){var n=this;var i=a.SDK.Operations.SpriteOperation;var o=r.options;var s=this._stickerManager.getStickerByIdentifier(o.name);var l=this._stickerManager.getURLForSticker(s);if(!s){a.Log.warn("Deserializer","Unknown sticker '"+o.name+"'. Skipping sprite.");return Promise.resolve()}return new Promise(function(e,r){var s=new window.Image;s.addEventListener("load",function(){var r=i.StickerSprite.prototype.availableOptions.adjustments.structure;var n=o.rotation,l=o.flipHorizontally,u=o.flipVertically;var c={identifier:o.name,image:s,position:a.Vector2.fromObject(o.position),dimensions:a.Vector2.fromObject(o.dimensions),rotation:n,flipHorizontally:l,flipVertically:u,adjustments:{}};if(typeof o.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(function(e){if(typeof o.adjustments[e]!=="undefined"){c.adjustments[e]=o.adjustments[e]+r[e].default}})}e(t.createSticker(c))});s.crossOrigin=n._editor.getCrossOrigin();s.src=n._editor.getUI().getAssetPath(l)})}},{key:"_deserializeText",value:function e(t,r){var n=r.options;var i=n.fontSize,o=n.lineHeight,s=n.fontFamily,l=n.fontWeight,u=n.alignment,c=n.rotation,f=n.maxWidth,p=n.color,d=n.backgroundColor;var h=new _.default(this._ui);var v=this._fontManager.getFontByFontFamily(s);if(!v)v=this._fontManager.getDefaultFont();h.setFonts([v]);return h.load().then(function(){return t.createText({fontSize:i,lineHeight:o,fontFamily:s,fontWeight:l,alignment:u,rotation:c,maxWidth:f,text:n.text,color:a.Color.fromArray(p),backgroundColor:a.Color.fromArray(d),position:a.Vector2.fromObject(n.position)})})}},{key:"_deserializeBrush",value:function e(t,r){var n=this;var i=r.options;var o=i.paths;var a=t.createBrush();o.forEach(function(e){n._deserializeBrushPath(a,e)});return Promise.resolve(a)}},{key:"_deserializeBrushPath",value:function e(t,r){var n=r.points;var i=this._createBrushForPath(r);var o=t.createPath(i);o.setClosed(true);n.forEach(function(e){o.addControlPoint(a.Vector2.fromObject(e))})}},{key:"_createBrushForPath",value:function e(t){var r=t.color,n=t.size;var i=a.Color.fromArray(r);var o={color:i,size:n};var s=this._brushManager.getFirstBrush();if(s.prototype&&s.prototype instanceof w){var l=s;return new l(o)}else{var u=a.SDKUtils.extend({},s);delete u.image;var c=function(e){g(t,e);function t(){k(this,t);return y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(w);c.identifier=s.identifier;return new c(a.SDKUtils.extend({},u,o))}}},{key:"_deserializeFocusOperation",value:function e(t){var r=t.options.options;switch(t.options.type){case"radial":{var n=r.position,i=r.radius,o=r.gradientRadius,s=r.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:a.Vector2.fromObject(n),radius:i,gradientRadius:o,blurRadius:s}))}case"linear":{var l=r.start,u=r.end,c=r.size,f=r.gradientSize,p=r.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:a.Vector2.fromObject(l),end:a.Vector2.fromObject(u),size:c,gradientSize:f,blurRadius:p}))}}}},{key:"_getInputDimensionsForOperation",value:function e(t){var r=false;var n=this._editor.getInputDimensions();this._editor.operations.getStack().forEach(function(e){if(e===t)r=true;if(r)return;n=e.getNewDimensions(n)});return n}}]);return e}();t.default=O;O.version="1.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(177);var o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function e(t){s(this,e);this._ui=t;this._fonts=[];this._observers=[]}n(e,[{key:"add",value:function e(t){this._fonts.push(t)}},{key:"load",value:function e(){var t=this;if(this._fonts.length===0){return Promise.resolve()}this._observers=[];this._fonts.forEach(function(e){t._observers.push(new o.default(e))});return Promise.all(this._observers.map(function(e){return e.observe()}))}},{key:"dispose",value:function e(){this._observers.forEach(function(e){return e.dispose()})}}]);return e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(50);var o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function u(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c=Math.PI*2;var f=function(e){u(t,e);function t(){s(this,t);return l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_serializeTransformOperation",value:function e(t){var r=t.serializeOptions(["start","end","rotation","textureScale"],true);r.rotation=(r.rotation+c)%c;if(r.textureScale!==1){r.dimensions=t.getNewDimensions(t.getInputDimensions(false))}delete r.textureScale;return{type:"crop",options:r}}}]);return t}(o.default);t.default=f;f.version="1.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(51);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_deserializeOperation",value:function e(r){if(r.type==="selective-blur"){return this._deserializeSelectiveBlurOperation(r)}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeOperation",this).call(this,r)}},{key:"_deserializeCropOperation",value:function e(t){var r=t.options;var n=r.rotation;var i=o.Vector2.fromObject(r.start);var a=o.Vector2.fromObject(r.end);var s=r.dimensions?o.Vector2.fromObject(r.dimensions):null;if(n>Math.PI){n-=Math.PI*2}var l={start:i,end:a};if(typeof n!=="undefined")l.rotation=n;var u=this._editor.operations.getOrCreate("transform");if(!u)return Promise.resolve();this._editor.broadcastTransform(u,l);u.set(l);if(s){var c=a.clone().subtract(i);var f=u.getInputDimensions(false).multiply(c);u.setTextureScale(s.x/f.x)}return Promise.resolve(u)}}]);return t}(s.default);t.default=p;p.version="1.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n;var i=r(0);function o(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var a=i.SDK.Engine.Filters.OverlayFilter;t.default=(n={},o(n,a.BLEND_MODES.NORMAL,"normal"),o(n,a.BLEND_MODES.OVERLAY,"overlay"),o(n,a.BLEND_MODES.HARD_LIGHT,"hard light"),o(n,a.BLEND_MODES.SOFT_LIGHT,"soft light"),o(n,a.BLEND_MODES.MULTIPLY,"multiply"),o(n,a.BLEND_MODES.DARKEN,"darken"),o(n,a.BLEND_MODES.LIGHTEN,"lighten"),o(n,a.BLEND_MODES.SCREEN,"screen"),o(n,a.BLEND_MODES.COLOR_BURN,"color burn"),n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(31);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"serialize",value:function e(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this,n).then(function(e){e.meta={platform:"html5",version:r._editor.getSDK().version,createdAt:o.SDKUtils.ISODateString(new Date)};e.image=e.inputImage;delete e.inputImage;return e})}},{key:"_serializeSticker",value:function e(r,n){var o=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeSticker",this).call(this,r,n);o.options.alpha=n.getAlpha();if(o.options.tintColor){o.options.tintColor={rgba:o.options.tintColor}}return o}},{key:"_serializeText",value:function e(r,n){var o=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeText",this).call(this,r,n);o.options.color={rgba:o.options.color};o.options.backgroundColor={rgba:o.options.backgroundColor};o.options.flipHorizontally=false;o.options.flipVertically=false;delete o.options.fontWeight;return o}},{key:"_serializePath",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializePath",this).call(this,r);delete n.hardness;delete n.size;delete n.color;var o=r.getBrush();n.brush=o.serializeOptions(["identifier","size","color"],true);if(typeof n.brush.identifier==="undefined"){delete n.brush.identifier}n.brush.color={rgba:n.brush.color};var a=o.getOption("hardness");if(a!=="undefined"){n.brush.hardness=a}return n}},{key:"_serializeFrameOperation",value:function e(r,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeFrameOperation",this).call(this,r,n);var a=n.filter(function(e){return e.type==="sprite"});var s=void 0;if(a.length){s=a.pop();var l=s.options.sprites.filter(function(e){return e.type==="frame"})[0];var u=r.getTintColor();if(!u.equals(new o.Color(1,1,1,0))){l.options.tintColor={rgba:r.serializeOption("tintColor",true)}}var c=r.serializeOptions(["scale","alpha"],true);l.options=o.SDKUtils.extend(l.options,c);l.options.size=l.options.scale;delete l.options.scale}}},{key:"_serializeTransformOperation",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeTransformOperation",this).call(this,r);if(r._ratio){n.options.meta={identifier:r._ratio.identifier}}delete n.options.scale;return n}},{key:"_serializeAdjustmentsOperation",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeAdjustmentsOperation",this).call(this,r);var o=r.availableOptions;var a=o.gamma;var s=r.getGamma();var l=a.minValue,u=a.midValue,c=a.maxValue;n.options.gamma=s<=u?(s-l)/(u-l)-1:(s-u)/(c-u);return n}},{key:"_serializeOperation",value:function e(r,n){switch(r.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(r);case"linear-focus":return this._serializeLinearFocusOperation(r);case"blur":return this._serializeBlurOperation(r);default:return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_serializeOperation",this).call(this,r,n)}}},{key:"_serializeMirroredFocusOperation",value:function e(t){return{type:"focus",options:{type:"mirrored",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],true)}}}},{key:"_serializeLinearFocusOperation",value:function e(t){var r=t.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],true);r.start=r.controlPoint1;delete r.controlPoint1;r.end=r.controlPoint2;delete r.controlPoint2;return{type:"focus",options:{type:"linear",options:r}}}},{key:"_serializeBlurOperation",value:function e(t){return{type:"focus",options:{type:"gaussian",options:t.serializeOptions(["blurRadius"],true)}}}}]);return t}(s.default);t.default=p;p.version="3.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var a=r(0);var s=r(32);var l=m(s);var u=r(11);var c=m(u);var f=r(58);var p=m(f);var d=r(23);var h=m(d);var v=r(15);var _=m(v);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var k=void 0;if(typeof a.SDK.Operations.SpriteOperation!=="undefined"){k=a.SDK.Operations.SpriteOperation.BrushSprite.Brush}var w=function(e){b(t,e);function t(){y(this,t);return g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"_deserializeSticker",value:function e(t,r){var n=a.SDK.Operations.SpriteOperation;var i=r.options;var o=this._stickerManager.getStickerByIdentifier(i.identifier);if(!o){a.Log.warn("Deserializer","Unknown sticker `"+i.identifier+"`. Skipping sprite.");return Promise.resolve()}var s=c.default.getURLForSticker(o,"base");var l=this._editor.getUI().getAssetPath(s);var u=t.getInputDimensions(false);return h.default.load(l).then(function(e){var r=n.StickerSprite.prototype.availableOptions.adjustments.structure;var s=i.rotation,l=i.flipHorizontally,c=i.flipVertically;var f={identifier:i.identifier,image:e,position:a.Vector2.fromObject(i.position),dimensions:a.Vector2.fromObject(i.dimensions).multiply(u.min()),rotation:s||0,flipHorizontally:l,flipVertically:c,adjustments:{}};if(typeof i.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(function(e){if(typeof i.adjustments[e]!=="undefined"){f.adjustments[e]=i.adjustments[e]+r[e].default}})}if(typeof i.tintColor!=="undefined"&&typeof o.tintMode!=="undefined"){f.tintColor=a.Color.fromArray(i.tintColor.rgba);f.tintMode=o.tintMode}if(typeof i.alpha!=="undefined"){f.alpha=i.alpha}return t.createSticker(f)})}},{key:"_deserializeTransformOperation",value:function e(r){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeTransformOperation",this).call(this,r).then(function(e){if(!e)return;e._ratio=null;return e})}},{key:"_deserializeInputImage",value:function e(){var t=this;var r=this._data.image,n=r.data,i=r.type,o=r.uri;if(n&&i){o="data:"+i+";base64,"+n}if(o){return h.default.load(o).then(function(e){t._editor.setImage(e)})}else{return Promise.resolve()}}},{key:"_deserializeAdjustmentsOperation",value:function e(r){var n=a.SDK.Operations.AdjustmentsOperation;return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeAdjustmentsOperation",this).call(this,r).then(function(e){if(!e)return null;var t=r.options;if(typeof t.gamma!=="undefined"){var i=n.prototype.availableOptions.gamma,o=i.minValue,a=i.midValue,s=i.maxValue;e.setGamma(t.gamma<0?a+(a-o)*t.gamma:a+(s-a)*t.gamma)}return e})}},{key:"_deserializeFocusOperation",value:function e(r){var n=r.options.options;switch(r.options.type){case"radial":return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFocusOperation",this).call(this,r);case"linear":{var i=n.start,s=n.end,l=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:a.Vector2.fromObject(i),controlPoint2:a.Vector2.fromObject(s),blurRadius:l}))}case"mirrored":{var u=n.start,c=n.end,f=n.size,p=n.gradientSize,d=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:a.Vector2.fromObject(u),end:a.Vector2.fromObject(c),size:f,gradientSize:p,blurRadius:d}))}case"gaussian":{var h=n.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:h}))}}}},{key:"_deserializeText",value:function e(t,r){var n=r.options;var i=n.fontSize,o=n.lineHeight,s=n.fontIdentifier,l=n.alignment,u=n.rotation,c=n.maxWidth,f=n.color,p=n.backgroundColor;var d=this._ui.getFontLoader();var h=this._fontManager.getVariationByIdentifier(s);if(!h){h=this._fontManager.getDefaultVariation()}else{d.setFonts([h.getFont()])}return d.load().then(function(){var e=t.getInputDimensions(false);var r=c*e.min()/e.x;return t.createText({fontSize:i,lineHeight:o,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),textMetrics:h.getTextMetrics(),alignment:l,rotation:u,maxWidth:r,text:n.text,color:a.Color.fromArray(f.rgba),backgroundColor:a.Color.fromArray(p.rgba),position:a.Vector2.fromObject(n.position)})})}},{key:"_createBrushForPath",value:function e(t){var r=t.brush,n=r.identifier,i=r.color,o=r.size,s=r.hardness;var l=a.Color.fromArray(i.rgba);var u={color:l,size:o};if(typeof s!=="undefined"){u.hardness=s}var c=this._brushManager.getBrushByIdentifier(n);if(!c){c=this._brushManager.getFirstBrush()}if(c.prototype&&c.prototype instanceof k){var f=c;return new f(u)}else{var p=a.SDKUtils.extend({},c);delete p.image;var d=function(e){b(t,e);function t(){y(this,t);return g(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(k);d.identifier=c.identifier;return new d(a.SDKUtils.extend({},p,u))}}},{key:"_deserializeFrame",value:function e(r,n){var i=this;return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deserializeFrame",this).call(this,r,n).then(function(){var e=i._editor.operations.get("frame");var t=n.options,r=t.size,o=t.alpha,s=t.tintColor;var l={};if(typeof r!=="undefined"){l.scale=r}if(typeof o!=="undefined"){l.alpha=o}if(typeof s!=="undefined"){l.tintColor=a.Color.fromArray(s.rgba)}e.set(l)})}},{key:"_deserializeTextDesign",value:function e(t,r){var i=this;var o=r.options;var s=o.position,l=o.rotation,u=o.flipHorizontally,c=o.flipVertically,f=o.text,d=o.color,h=o.width,v=o.seed,m=o.inverted,y=o.identifier;var g=new p.default(this._ui,this._getOptions("textdesign"));var b=new _.default(this._ui,{fonts:a.Constants.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});var k=t.constructor.TextDesignSprite.AssetManager;var w=this._ui.getFontLoader();var O=g.getLayoutByIdentifier(y);var E=new O;w.setFonts(b.getFonts());k.setFonts(n({},k.getFonts(),b.getVariationsByIdentifier()));return w.load().then(function(){var e=E.getImagePaths().map(function(e){return{path:e,fullPath:i._ui.getAssetPath(e),image:null}});return k.loadImages(e).then(function(){E.onImagesLoaded();return t.createTextDesign({position:s,rotation:l,flipHorizontally:u,flipVertically:c,text:f,color:a.Color.fromArray(d.rgba),width:h,seed:v,inverted:m,layout:E})})})}}]);return t}(l.default);t.default=w;w.version="3.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};a(this,e);this._ui=t;this._options=r;this._defaultLayouts=i.SDK.Operations.SpriteOperation.TextDesignSprite.Layouts;this._layouts=[];this._init()}n(e,[{key:"_init",value:function e(){var t=this;var r=this._options.availableLayouts;this._layouts=Object.keys(this._defaultLayouts).map(function(e){return{identifier:t._defaultLayouts[e].identifier,layout:t._defaultLayouts[e]}});if(r){this._layouts=this._layouts.filter(function(e){return r.indexOf(e.identifier)>=0})}}},{key:"getLayoutByIdentifier",value:function e(t){var r=i.SDKUtils.Array.find(this._layouts,function(e){return e.identifier===t});return r&&r.layout}},{key:"getLayouts",value:function e(){return[].concat(o(this._layouts))}}]);return e}();t.default=s},function(e,t,r){"use strict";r(60);e.exports=r(61).default},function(e,t){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(86);var a=x(o);var s=r(2);var l=x(s);var u=r(3);var c=x(u);var f=r(1);var p=x(f);var d=r(22);var h=x(d);var v=r(195);var _=x(v);var m=r(196);var y=j(m);var g=r(4);var b=x(g);var k=r(44);var w=j(k);var O=r(13);var E=x(O);var S=r(6);var P=x(S);var C=r(30);var M=x(C);function j(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function x(e){return e&&e.__esModule?e:{default:e}}function R(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function B(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function T(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var D=function e(t){return i.SDKUtils.byteArrayToString(i.Base64.decode(t))};var F=function(e){T(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};R(this,t);var r=B(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r._mediator=new i.EventEmitter;r._fontLoader=new M.default(r);r._options=e;r._initOptions();r._initLanguage();r._initEvents();r._disposed=false;r._isReady=false;r._preloader=new _.default(r,r._options,r._mediator);i.Log.setLevel(r._options.logLevel);if(r._v()){r.run()}return r}n(t,[{key:"run",value:function e(){this._registerWebFonts();this._options.container.style.position="relative";this._render()}},{key:"_render",value:function e(){var t=this;var r=i.React.createElement(a.default,{ui:this,mediator:this._mediator,ref:function e(r){t._component=r},options:this._options});if(this._options.renderReturnsComponent){return r}else{i.ReactDOM.render(r,this._options.container)}}},{key:"export",value:function e(){var t;return(t=this._component).export.apply(t,arguments)}},{key:"serialize",value:function e(){var t;return(t=this._component).serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){return this._component.deserialize(t)}},{key:"getEditor",value:function e(){return this._component.getEditor()}},{key:"isReady",value:function e(){return this._isReady}},{key:"onReady",value:function e(t){if(!this._isReady){this._mediator.once(i.Constants.EVENTS.EDITOR_READY,t);this._isReady=true}else{t()}}},{key:"_initOptions",value:function e(){this._options=i.SDKUtils.defaults(this._options,{language:"en",title:"PhotoEditor SDK",logLevel:"warn",crossOrigin:"anonymous",preloader:true,editor:{},assets:{},photoRoll:{},enableUpload:true,enableWebcam:true,showCloseButton:false,showHeader:true,showTopBar:true,responsive:false});this._options.editor=i.SDKUtils.defaults(this._options.editor||{},{pixelRatio:typeof window!=="undefined"&&window.devicePixelRatio||1,preferredRenderer:"webgl",enableZoom:true,enableDrag:true,smoothDownscaling:false,smoothUpscaling:false,displayResizeMessage:true,maxMegaPixels:{},forceControls:[],forceCrop:false,watermarkImage:null,tools:["transform","filter","brightness","saturation","contrast","clarity","exposure","shadows","highlights","gamma","text","sticker","brush","radial-focus","mirrored-focus","frame"],controlsOrder:["transform",["filter","adjustments"],["text","sticker","brush"],["selectiveBlur","focus","frame"]],operationsOrder:["exif-orientation","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","selective-blur","sprite","frame","watermark"],controlsOptions:{}});this._options.editor.maxMegaPixels=i.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10});this._options.editor.export=i.SDKUtils.defaults(this._options.editor.export||{},{showButton:true,format:"image/png",type:i.RenderType.IMAGE,download:true,fileBasename:"photoeditorsdk-export",quality:.8});this._options.photoRoll=i.SDKUtils.defaults(this._options.photoRoll||{},{provider:null});this._options.extensions=i.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]});this._options.assets=i.SDKUtils.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null})}},{key:"_v",value:function e(){if(!this[D("X29wdGlvbnM=")][D("bGljZW5zZQ==")]){i.Log.error(D("TGljZW5zaW5n"),D("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4="));i.Log.error(D("TGljZW5zaW5n"),D("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg=="));return false}return true}},{key:"_registerWebFonts",value:function e(){var t=this.getAssetPath("fonts/montserrat-regular.woff",true,true);var r=this.getAssetPath("fonts/montserrat-light.woff",true,true);var n='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+t+"') format('woff');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: \"__pesdk_Montserrat\";\n        src: url('"+r+"') format('woff');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ";this._webFontsStyle=document.createElement("style");this._webFontsStyle.innerHTML=n;var i=document.getElementsByTagName("head")[0];i.appendChild(this._webFontsStyle)}},{key:"_initEvents",value:function e(){this._mediator.pipeEvents(this)}},{key:"_disposeEvents",value:function e(){this._mediator.unpipeEvents(this)}},{key:"_initLanguage",value:function e(){this._languages=i.SDKUtils.deepDefaults(this._options.extensions.languages,{de:r(201),en:r(202)});this._language=this._languages[this._options.language];if(!this._language){i.Log.error(this.constructor.name,"Language `"+this._options.language+"` not found!")}}},{key:"translate",value:function e(t,r){return i.Utils.translate(this._language,t,r)}},{key:"setImage",value:function e(t){if(!this._component)return;this._component.setImage(t)}},{key:"getAssetPath",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=this._options.assets,o=i.baseUrl,a=i.resolver;var s=o+"/"+t;if(t.match(/(ftp|http|https):\/\//)){s=t}if(r){if(!n){var l=typeof window!=="undefined"&&window.devicePixelRatio||1;if(l>1){var u=/\.[\w?=]+$/;t=t.replace(u,function(e){return"@2x"+e})}}s=o+"/ui/react/"+t}if(typeof a!=="undefined"&&a!==null){s=a(s)}return s}},{key:"getFontLoader",value:function e(){return this._fontLoader}},{key:"getPreloader",value:function e(){return this._preloader}},{key:"dispose",value:function e(){if(this._disposed){throw new Error("This instance of PhotoEditorSDK is already disposed.")}this._disposed=true;this._webFontsStyle.parentNode.removeChild(this._webFontsStyle);i.ReactDOM.unmountComponentAtNode(this._options.container);this._disposeEvents()}}]);return t}(i.EventEmitter);F.prototype.identifier="react";F.BaseComponent=i.BaseComponent;F.BaseControls=b.default;F.ControlsComponent=c.default;F.React=i.React;F.ReactBEM=i.ReactBEM;F.SharedState=i.SharedState;F.Constants=i.Constants;F.Utils=i.Utils;F.ScrollbarComponent=l.default;F.ModalManager=p.default;F.JSONLoader=h.default;F.PhotoRoll=y;F.Controls=w;F.SliderComponent=E.default;F.SliderOverlayComponent=P.default;var I=function(e){T(t,e);function t(){R(this,t);return B(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"componentDidMount",value:function e(){this._ui=new F(i.SDKUtils.extend({},this.props,{container:this.refs.container}));if(this.props.onEditorReady){this._ui.onReady(this.props.onEditorReady)}}},{key:"render",value:function e(){var t=i.SDKUtils.extend({},this.props.style||{});return i.React.createElement("div",{style:t,ref:"container"})}},{key:"ui",get:function e(){return this._ui}}]);return t}(i.React.Component);F.ReactComponent=I;i.SDK.UI=i.SDK.UI||{};i.SDK.UI.ReactUI=F;t.default=F},function(e,t){e.exports=r},function(e,t,r){"use strict";var n=r(17);var i=r(18);var o=r(34);var a=r(64);var s=r(19);var l=r(65);e.exports=function(e,t){var r=typeof Symbol==="function"&&Symbol.iterator;var u="@@iterator";function c(e){var t=e&&(r&&e[r]||e[u]);if(typeof t==="function"){return t}}var f="<<anonymous>>";var p={array:_("array"),bool:_("boolean"),func:_("function"),number:_("number"),object:_("object"),string:_("string"),symbol:_("symbol"),any:m(),arrayOf:y,element:g(),instanceOf:b,node:E(),objectOf:w,oneOf:k,oneOfType:O,shape:S,exact:P};function d(e,t){if(e===t){return e!==0||1/e===1/t}else{return e!==e&&t!==t}}function h(e){this.message=e;this.stack=""}h.prototype=Error.prototype;function v(e){if({ENV:'"production"'}.NODE_ENV!=="production"){var r={};var n=0}function a(a,l,u,c,p,d,v){c=c||f;d=d||u;if(v!==s){if(t){i(false,"Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use `PropTypes.checkPropTypes()` to call them. "+"Read more at http://fb.me/use-check-prop-types")}else if({ENV:'"production"'}.NODE_ENV!=="production"&&typeof console!=="undefined"){var _=c+":"+u;if(!r[_]&&n<3){o(false,"You are manually calling a React.PropTypes validation "+"function for the `%s` prop on `%s`. This is deprecated "+"and will throw in the standalone `prop-types` package. "+"You may be seeing this warning due to a third-party PropTypes "+"library. See https://fb.me/react-warning-dont-call-proptypes "+"for details.",d,c);r[_]=true;n++}}}if(l[u]==null){if(a){if(l[u]===null){return new h("The "+p+" `"+d+"` is marked as required "+("in `"+c+"`, but its value is `null`."))}return new h("The "+p+" `"+d+"` is marked as required in "+("`"+c+"`, but its value is `undefined`."))}return null}else{return e(l,u,c,p,d)}}var l=a.bind(null,false);l.isRequired=a.bind(null,true);return l}function _(e){function t(t,r,n,i,o,a){var s=t[r];var l=j(s);if(l!==e){var u=x(s);return new h("Invalid "+i+" `"+o+"` of type "+("`"+u+"` supplied to `"+n+"`, expected ")+("`"+e+"`."))}return null}return v(t)}function m(){return v(n.thatReturnsNull)}function y(e){function t(t,r,n,i,o){if(typeof e!=="function"){return new h("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside arrayOf.")}var a=t[r];if(!Array.isArray(a)){var l=j(a);return new h("Invalid "+i+" `"+o+"` of type "+("`"+l+"` supplied to `"+n+"`, expected an array."))}for(var u=0;u<a.length;u++){var c=e(a,u,n,i,o+"["+u+"]",s);if(c instanceof Error){return c}}return null}return v(t)}function g(){function t(t,r,n,i,o){var a=t[r];if(!e(a)){var s=j(a);return new h("Invalid "+i+" `"+o+"` of type "+("`"+s+"` supplied to `"+n+"`, expected a single ReactElement."))}return null}return v(t)}function b(e){function t(t,r,n,i,o){if(!(t[r]instanceof e)){var a=e.name||f;var s=B(t[r]);return new h("Invalid "+i+" `"+o+"` of type "+("`"+s+"` supplied to `"+n+"`, expected ")+("instance of `"+a+"`."))}return null}return v(t)}function k(e){if(!Array.isArray(e)){({ENV:'"production"'}).NODE_ENV!=="production"?o(false,"Invalid argument supplied to oneOf, expected an instance of array."):void 0;return n.thatReturnsNull}function t(t,r,n,i,o){var a=t[r];for(var s=0;s<e.length;s++){if(d(a,e[s])){return null}}var l=JSON.stringify(e);return new h("Invalid "+i+" `"+o+"` of value `"+a+"` "+("supplied to `"+n+"`, expected one of "+l+"."))}return v(t)}function w(e){function t(t,r,n,i,o){if(typeof e!=="function"){return new h("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside objectOf.")}var a=t[r];var l=j(a);if(l!=="object"){return new h("Invalid "+i+" `"+o+"` of type "+("`"+l+"` supplied to `"+n+"`, expected an object."))}for(var u in a){if(a.hasOwnProperty(u)){var c=e(a,u,n,i,o+"."+u,s);if(c instanceof Error){return c}}}return null}return v(t)}function O(e){if(!Array.isArray(e)){({ENV:'"production"'}).NODE_ENV!=="production"?o(false,"Invalid argument supplied to oneOfType, expected an instance of array."):void 0;return n.thatReturnsNull}for(var t=0;t<e.length;t++){var r=e[t];if(typeof r!=="function"){o(false,"Invalid argument supplied to oneOfType. Expected an array of check functions, but "+"received %s at index %s.",R(r),t);return n.thatReturnsNull}}function i(t,r,n,i,o){for(var a=0;a<e.length;a++){var l=e[a];if(l(t,r,n,i,o,s)==null){return null}}return new h("Invalid "+i+" `"+o+"` supplied to "+("`"+n+"`."))}return v(i)}function E(){function e(e,t,r,n,i){if(!C(e[t])){return new h("Invalid "+n+" `"+i+"` supplied to "+("`"+r+"`, expected a ReactNode."))}return null}return v(e)}function S(e){function t(t,r,n,i,o){var a=t[r];var l=j(a);if(l!=="object"){return new h("Invalid "+i+" `"+o+"` of type `"+l+"` "+("supplied to `"+n+"`, expected `object`."))}for(var u in e){var c=e[u];if(!c){continue}var f=c(a,u,n,i,o+"."+u,s);if(f){return f}}return null}return v(t)}function P(e){function t(t,r,n,i,o){var l=t[r];var u=j(l);if(u!=="object"){return new h("Invalid "+i+" `"+o+"` of type `"+u+"` "+("supplied to `"+n+"`, expected `object`."))}var c=a({},t[r],e);for(var f in c){var p=e[f];if(!p){return new h("Invalid "+i+" `"+o+"` key `"+f+"` supplied to `"+n+"`."+"\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "))}var d=p(l,f,n,i,o+"."+f,s);if(d){return d}}return null}return v(t)}function C(t){switch(typeof t){case"number":case"string":case"undefined":return true;case"boolean":return!t;case"object":if(Array.isArray(t)){return t.every(C)}if(t===null||e(t)){return true}var r=c(t);if(r){var n=r.call(t);var i;if(r!==t.entries){while(!(i=n.next()).done){if(!C(i.value)){return false}}}else{while(!(i=n.next()).done){var o=i.value;if(o){if(!C(o[1])){return false}}}}}else{return false}return true;default:return false}}function M(e,t){if(e==="symbol"){return true}if(t["@@toStringTag"]==="Symbol"){return true}if(typeof Symbol==="function"&&t instanceof Symbol){return true}return false}function j(e){var t=typeof e;if(Array.isArray(e)){return"array"}if(e instanceof RegExp){return"object"}if(M(t,e)){return"symbol"}return t}function x(e){if(typeof e==="undefined"||e===null){return""+e}var t=j(e);if(t==="object"){if(e instanceof Date){return"date"}else if(e instanceof RegExp){return"regexp"}}return t}function R(e){var t=x(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}function B(e){if(!e.constructor||!e.constructor.name){return f}return e.constructor.name}p.checkPropTypes=l;p.PropTypes=p;return p}},function(e,t,r){"use strict";var n=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty;var o=Object.prototype.propertyIsEnumerable;function a(e){if(e===null||e===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(e)}function s(){try{if(!Object.assign){return false}var e=new String("abc");e[5]="de";if(Object.getOwnPropertyNames(e)[0]==="5"){return false}var t={};for(var r=0;r<10;r++){t["_"+String.fromCharCode(r)]=r}var n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if(n.join("")!=="0123456789"){return false}var i={};"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e});if(Object.keys(Object.assign({},i)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(e){return false}}e.exports=s()?Object.assign:function(e,t){var r;var s=a(e);var l;for(var u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r){if(i.call(r,c)){s[c]=r[c]}}if(n){l=n(r);for(var f=0;f<l.length;f++){if(o.call(r,l[f])){s[l[f]]=r[l[f]]}}}}return s}},function(e,t,r){"use strict";if({ENV:'"production"'}.NODE_ENV!=="production"){var n=r(18);var i=r(34);var o=r(19);var a={}}function s(e,t,r,s,l){if({ENV:'"production"'}.NODE_ENV!=="production"){for(var u in e){if(e.hasOwnProperty(u)){var c;try{n(typeof e[u]==="function","%s: %s type `%s` is invalid; it must be a function, usually from "+"the `prop-types` package, but received `%s`.",s||"React class",r,u,typeof e[u]);c=e[u](t,u,s,r,null,o)}catch(e){c=e}i(!c||c instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker "+"function must return `null` or an `Error` but returned a %s. "+"You may have forgotten to pass an argument to the type checker "+"creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and "+"shape all require an argument).",s||"React class",r,u,typeof c);if(c instanceof Error&&!(c.message in a)){a[c.message]=true;var f=l?l():"";i(false,"Failed %s type: %s%s",r,c.message,f!=null?f:"")}}}}}e.exports=s},function(e,t,r){"use strict";var n=r(17);var i=r(18);var o=r(19);e.exports=function(){function e(e,t,r,n,a,s){if(s===o){return}i(false,"Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use PropTypes.checkPropTypes() to call them. "+"Read more at http://fb.me/use-check-prop-types")}e.isRequired=e;function t(){return e}var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};r.checkPropTypes=n;r.PropTypes=r;return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(16);var o=c(i);var a=r(33);var s=c(a);var l=r(37);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function d(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=function(e){d(t,e);function t(){var e;f(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._events={};o._needsStyleFixes=false;o._bindAll("_onSharedStateUpdate","fixStyles");return o}n(t,[{key:"fixStyles",value:function e(){}},{key:"componentDidMount",value:function e(){this._bindEvents();if(this.props.sharedState){this.props.sharedState.on("update",this._onSharedStateUpdate)}if(this._needsStyleFixes){this.fixStyles();if(this.context.options.responsive){window.addEventListener("resize",this.fixStyles)}}}},{key:"componentWillUnmount",value:function e(){this._unbindEvents();if(this.props.sharedState){this.props.sharedState.off("update",this._onSharedStateUpdate)}if(this.context.options.responsive&&this._needsStyleFixes){window.removeEventListener("resize",this.fixStyles)}}},{key:"componentWillReceiveProps",value:function e(t){if(t.sharedState){if(this.props.sharedState){this.props.sharedState.off("update",this._onSharedStateUpdate)}t.sharedState.on("update",this._onSharedStateUpdate)}}},{key:"_bindAll",value:function e(){var t=this;for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}n.forEach(function(e){if(typeof t[e]!=="function"){throw new Error("_bindAll: "+t.constructor.name+"."+e+" is not a function.")}t[e]=t[e].bind(t)})}},{key:"_t",value:function e(t,r){return this.context.ui.translate(t,r)}},{key:"_getAssetPath",value:function e(){var t;return(t=this.context.ui).getAssetPath.apply(t,arguments)}},{key:"_onSharedStateUpdate",value:function e(t,r){this.sharedStateDidChange(r);if(this.shouldSharedComponentUpdate(t,r)){this.forceUpdate()}}},{key:"shouldSharedComponentUpdate",value:function e(t,r){return true}},{key:"sharedStateDidChange",value:function e(t){}},{key:"setSharedState",value:function e(t,r){this.props.sharedState.set(t,r)}},{key:"getSharedState",value:function e(t){return this.props.sharedState.get(t)}},{key:"forceSharedUpdate",value:function e(){this.props.sharedState.broadcastUpdate()}},{key:"_bindEvents",value:function e(){for(var t in this._events){var r=this._events[t];this.context.mediator.on(t,r)}}},{key:"_unbindEvents",value:function e(){for(var t in this._events){var r=this._events[t];this.context.mediator.off(t,r)}}},{key:"_emitEvent",value:function e(t){var r;for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}(r=this.context.mediator).emit.apply(r,[t].concat(i))}},{key:"renderWithBEM",value:function e(){return u.default.createElement("div")}},{key:"render",value:function e(){return u.default.transform(this.renderWithBEM())}}]);return t}(o.default.Component);t.default=h;h.contextTypes={editor:s.default.object,ui:s.default.object,options:s.default.object,mediator:s.default.object,editorScreen:s.default.object};h.propTypes={sharedState:s.default.any}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(7);var i=f(n);var o=r(20);var a=f(o);var s=r(72);var l=f(s);var u=r(22);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}var p=i.default.Utils;var d=i.default.Math.Vector2;var h={getInnerDimensionsForElement:function e(t){var r=new d(t.offsetWidth,t.offsetHeight);var n=window.getComputedStyle(t,null);r.x-=parseInt(n.getPropertyValue("padding-left"),10);r.x-=parseInt(n.getPropertyValue("padding-right"),10);r.y-=parseInt(n.getPropertyValue("padding-top"),10);r.y-=parseInt(n.getPropertyValue("padding-bottom"),10);return r},getEventPosition:function e(t){var r=t.clientX;var n=t.clientY;if(t.type.indexOf("touch")!==-1){if(!t.touches.length)return;r=t.touches[0].clientX;n=t.touches[0].clientY}return new d(r,n)},createTransparentPatternCanvas:function e(){var t=document.createElement("canvas");var r=t.getContext("2d");t.width=10;t.height=10;r.fillStyle="white";r.fillRect(0,0,t.width,t.height);r.fillStyle="#cccccc";r.fillRect(0,0,t.width/2,t.height/2);r.fillRect(t.width/2,t.height/2,t.width,t.height);return t},supportsMSBlob:function e(){var t=document.createElement("canvas");return typeof t.msToBlob!=="undefined"},translate:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=this.fetch(t,r);if(!i){a.default.info("Utils#translate","Unable to translate `"+r+"`");return null}for(var o in n){i=i.replace("${"+o+"}",n[o])}return i},fetch:function e(t,r,n){r=r.replace(/\[(\w+)]/g,".$1");r=r.replace(/^\./,"");var i=r.split(".");for(var o=0;o<i.length;o++){var a=i[o];t=t[a];if(!t){break}}if(typeof t==="undefined"){return false}return t},isMobile:function e(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},isTouchDevice:function e(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},select:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!n)n=function e(t){return t};var i=[];r.forEach(function(e){t.forEach(function(t){var r=n(t);if(r===e){i.push(t)}})});return i},getJSONP:function e(t){var r=new c.default(t);return r.load()},cloneCategories:function e(t,r){return t.map(function(e){e=p.clone(e);e[r]=e[r].slice(0);return e})},mergeCategories:function e(t,r,n){t=this.cloneCategories(t,n);var i=null;r.forEach(function(e){t.forEach(function(t){if(e.identifier===t.identifier){i=t}});if(!i){t.push(e)}else{i[n]=i[n].concat(e[n])}});return t},getStyleObject:function e(t){var r=window.getComputedStyle(t);var n={};for(var i in r){var o=r.getPropertyValue(i);var a=i.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});if(o!==""){n[a]=o}}return n},debounce:function e(t,r,n){var i;return function(){var e=this;var o=arguments;var a=function r(){i=null;if(!n)t.apply(e,o)};var s=n&&!i;clearTimeout(i);i=setTimeout(a,r);if(s)t.apply(this,o)}},getScrollbarWidth:function e(){var t=document.createElement("div");t.style.visibility="hidden";t.style.width="100px";t.style.msOverflowStyle="scrollbar";document.body.appendChild(t);var r=t.offsetWidth;t.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%";t.appendChild(n);var i=n.offsetWidth;t.parentNode.removeChild(t);return r-i},capitalize:function e(t){return t.charAt(0).toUpperCase()+t.slice(1)},Browser:l.default};t.default=h},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var a=r(70);var s=c(a);var l=r(71);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=function(){function t(){p(this,t)}o(t,null,[{key:"isArray",value:function e(t){return Object.prototype.toString.call(t)==="[object Array]"}},{key:"isPlainObject",value:function e(t){if((typeof t==="undefined"?"undefined":i(t))!=="object"||!t){return false}if(typeof Object.getPrototypeOf==="function"){var r=Object.getPrototypeOf(t);return r===Object.prototype||r===null}return Object.prototype.toString.call(t)==="[object Object]"}},{key:"isMobile",value:function e(){if(typeof navigator==="undefined")return false;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}},{key:"isBrowser",value:function e(){return typeof window!=="undefined"}},{key:"isNode",value:function t(){return typeof window==="undefined"&&typeof e!=="undefined"}},{key:"values",value:function e(t){var e=[];for(var r in t){e.push(t[r])}return e}},{key:"isDOMElement",value:function e(t){return(typeof HTMLElement==="undefined"?"undefined":i(HTMLElement))==="object"?t instanceof HTMLElement:t&&(typeof t==="undefined"?"undefined":i(t))==="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName==="string"}},{key:"isTouchEvent",value:function e(t){return t.type.indexOf("touch")!==-1}},{key:"resizeVectorToFit",value:function e(t,r){var n=Math.min(r.x/t.x,r.y/t.y);var i=t.clone().multiply(n);return i}},{key:"resizeVectorToFill",value:function e(t,r){var n=t.x/t.y;var i=r.x/r.y;if(n>i){return r.clone().set(r.y*n,r.y)}else{return r.clone().set(r.x,r.x/n)}}},{key:"isExtendable",value:function e(t){return typeof t!=="undefined"&&t!==null&&((typeof t==="undefined"?"undefined":i(t))==="object"||typeof t==="function")}},{key:"defaults",value:function e(t){var r={};for(var n in t){r[n]=t[n]}for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++){o[a-1]=arguments[a]}for(var s=0;s<o.length;s++){var l=o[s];for(var u in l){if(typeof r[u]==="undefined"){r[u]=l[u]}}}return r}},{key:"deepMerge",value:function e(r){var i=function e(r,i){if(i===undefined){return e(null,r)}if(Array.isArray(i)){return[].concat(f(i))}if(!t.isPlainObject(i)){return i}if(!t.isPlainObject(r)){return n({},i)}var o=n({},r);Object.keys(i).forEach(function(t){var n=i[t];if(n===undefined){return}o[t]=e(r[t],n)});return o};for(var o=arguments.length,a=Array(o>1?o-1:0),s=1;s<o;s++){a[s-1]=arguments[s]}return a.reduce(i,r)}},{key:"deepDefaults",value:function e(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}var a=[].concat(i).reverse();return t.deepMerge.apply(t,f(a).concat([r]))}},{key:"deepClone",value:function e(r){var n={};for(var i in r){if(t.isExtendable(r[i])){n[i]=t.deepClone(r[i])}else{n[i]=r[i]}}return n}},{key:"getDeepProperty",value:function e(t,r){if(typeof r==="string"){return t[r]}if(!Array.isArray(r)){return undefined}var n=function e(t,r){var n=void 0;try{n=r(t)}catch(e){if(!(e instanceof TypeError)){throw e}}return n};return r.reduce(function(e,t){return e?typeof t==="function"?n(e,t):e[t]:null},t)}},{key:"extend",value:function e(t){var r={};for(var n in t){r[n]=t[n]}for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++){o[a-1]=arguments[a]}for(var s=0;s<o.length;s++){var l=o[s];for(var u in l){r[u]=l[u]}}return r}},{key:"clone",value:function e(t){return this.extend({},t)}},{key:"createBlobURIFromDataURI",value:function t(r){var n=typeof window==="undefined"?e:window;if(!n.Blob||!n.URL||!ArrayBuffer||!Uint8Array){return r}var i=s.default.decode(r.split(",")[1]);var o=r.split(",")[0].split(":")[1].split(";")[0];var a=new ArrayBuffer(i.length);var l=new Uint8Array(a);for(var u=0;u<i.length;u++){l[u]=i[u]}var c=new n.Blob([a],{type:o});return n.URL.createObjectURL(c)}},{key:"getUUID",value:function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0;var r=e==="x"?t:t&3|8;return r.toString(16)})}},{key:"createCanvas",value:function e(){return document.createElement("canvas")}},{key:"isPowerOfTwo",value:function e(t){return(t.x&t.x-1)===0&&(t.y&t.y-1)===0}},{key:"nextLowestPOT",value:function e(t){for(var r=1;r<32;r<<=1){t=t|t>>r}return t-(t>>1)}},{key:"nextHighestPOT",value:function e(t){t--;for(var r=1;r<32;r<<=1){t=t|t>>r}return t+1}},{key:"moveArrayItem",value:function e(t,r,n){if(n>=t.length){var i=n-t.length;while(i--+1){t.push(undefined)}}t.splice(n,0,t.splice(r,1)[0])}},{key:"ensureCanvasDimensions",value:function e(t,r){if(t.width!==r.x||t.height!==r.y){t.width=r.x;t.height=r.y}}},{key:"byteArrayToString",value:function e(t){return t.map(function(e){return String.fromCharCode(e)}).join("")}},{key:"clamp",value:function e(t,r,n){return Math.max(r,Math.min(t,n))}},{key:"wildCardMatch",value:function e(t,r){return new RegExp("^"+r.split("*").join(".*")+"$").test(t)}},{key:"flipObject",value:function e(t){var r={};for(var n in t){r[t[n]]=n}return r}},{key:"cloneOptions",value:function e(t){var r={};for(var n in t){var i=t[n];if(Array.isArray(i)){i=i.slice()}else if(i.clone){i=i.clone()}r[n]=i}return r}},{key:"ISODateString",value:function e(t){function r(e){return e<10?"0"+e:e}return t.getUTCFullYear()+"-"+r(t.getUTCMonth()+1)+"-"+r(t.getUTCDate())+"T"+r(t.getUTCHours())+":"+r(t.getUTCMinutes())+":"+r(t.getUTCSeconds())+"Z"}},{key:"getCrossOriginValue",value:function e(t){if(!t){return"anonymous"}if(t==="none"){return undefined}return t}},{key:"shallowEqual",value:function e(t,r){if(t===r){return true}if((typeof t==="undefined"?"undefined":i(t))!=="object"||t===null||(typeof r==="undefined"?"undefined":i(r))!=="object"||r===null){return false}var n=Object.keys(t);var o=Object.keys(r);if(n.length!==o.length){return false}var a=hasOwnProperty.bind(r);for(var s=0;s<n.length;s++){if(!a(n[s])||t[n[s]]!==r[n[s]]){return false}}return true}},{key:"enableIf",value:function e(t,r){return t?r:undefined}},{key:"invariant",value:function e(t,r){if(!t){var n=new Error(r);throw n}}},{key:"executePromises",value:function e(t){var r=t.length;var n=0;var i=[];var o=[];return new Promise(function(e,a){var s=function t(){n++;if(n>=r){if(o.length<=0){e(i)}else{a(o)}}};var l=function e(t){i.push(t);s()};var u=function e(t){o.push(t);s()};t.forEach(function(e){e.then(l).catch(u)})})}}]);return t}();d.Array=u.default;t.default=d}).call(t,r(8))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var i={encode:function e(t){var r="";var i=void 0,o=void 0,a=void 0;var s=void 0,l=void 0,u=void 0,c=void 0;var f=0;do{i=t[f++];o=t[f++];a=t[f++];s=i>>2;l=(i&3)<<4|o>>4;u=(o&15)<<2|a>>6;c=a&63;if(isNaN(o)){u=c=64}else if(isNaN(a)){c=64}r=r+n.charAt(s)+n.charAt(l)+n.charAt(u)+n.charAt(c);i=o=a="";s=l=u=c=""}while(f<t.length);return r},decode:function e(t){var r=void 0,i=void 0,o=void 0;var a=void 0,s=void 0,l=void 0,u=void 0;var c=0;var f=[];var p=/[^A-Za-z0-9+/=]/g;if(p.exec(t)){throw new Error("There were invalid base64 characters in the input text.\n"+"Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\n"+"Expect errors in decoding.")}t=t.replace(/[^A-Za-z0-9+/=]/g,"");do{a=n.indexOf(t.charAt(c++));s=n.indexOf(t.charAt(c++));l=n.indexOf(t.charAt(c++));u=n.indexOf(t.charAt(c++));r=a<<2|s>>4;i=(s&15)<<4|l>>2;o=(l&3)<<6|u;f.push(r);if(l!==64){f.push(i)}if(u!==64){f.push(o)}r=i=o="";a=s=l=u=""}while(c<t.length);return f}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(){i(this,e)}n(e,null,[{key:"head",value:function e(t){return t[0]}},{key:"tail",value:function e(t){return t.slice(1)}},{key:"last",value:function e(t){return t[t.length-1]}},{key:"init",value:function e(t){return t.slice(0,t.length-1)}},{key:"remove",value:function e(t,r){return t.filter(function(e,t,n){return!r(e,t,n)})}},{key:"findIndex",value:function e(t,r){for(var n=0;n<t.length;n++){if(r(t[n])){return n}}return-1}},{key:"find",value:function e(t,r){for(var n=0;n<t.length;n++){if(r(t[n])){return t[n]}}return undefined}},{key:"flatten",value:function t(r){return r.reduce(function(t,r){return t.concat(Array.isArray(r)?e.flatten(r):r)},[])}},{key:"range",value:function e(t,r){var n=[];if(r>t){for(var i=t;i<r;i++){n.push(i)}}return n}},{key:"repeat",value:function e(t,r){var n=[];for(var i=0;i<r;i++){n[i]=t}return n}},{key:"zip",value:function e(t,r){var n=Math.min(t.length,r.length);var i=[];for(var o=0;o<n;o++){i[o]=[t[o],r[o]]}return i}}]);return e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={getIEVersion:function e(){var t=navigator,r=t.userAgent,n=t.appVersion;if(n.indexOf("MSIE")!==-1){return n.match(/MSIE\s+?([0-9]+)/i)[1]}else if(r.indexOf("Trident")!==-1){return r.match(/rv:([0-9]+)/i)[1]}else{return false}},isIE10:function e(){var t=this.getIEVersion();return t!==false&&t===10},isIE11:function e(){var t=this.getIEVersion();return t!==false&&t===11},isIElte:function e(t){var r=this.getIEVersion();if(r===false)return false;return r<=t}}},function(e,t,r){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function t(){"use strict";var r,i,o,a=Object.prototype.toString,s=typeof e!="undefined"?function t(r){return e(r)}:setTimeout;try{Object.defineProperty({},"x",{});r=function e(t,r,n,i){return Object.defineProperty(t,r,{value:n,writable:true,configurable:i!==false})}}catch(e){r=function e(t,r,n){t[r]=n;return t}}o=function e(){var t,r,n;function o(e,t){this.fn=e;this.self=t;this.next=void 0}return{add:function e(i,a){n=new o(i,a);if(r){r.next=n}else{t=n}r=n;n=void 0},drain:function e(){var n=t;t=r=i=void 0;while(n){n.fn.call(n.self);n=n.next}}}}();function l(e,t){o.add(e,t);if(!i){i=s(o.drain)}}function u(e){var t,r=typeof e==="undefined"?"undefined":n(e);if(e!=null&&(r=="object"||r=="function")){t=e.then}return typeof t=="function"?t:false}function c(){for(var e=0;e<this.chain.length;e++){f(this,this.state===1?this.chain[e].success:this.chain[e].failure,this.chain[e])}this.chain.length=0}function f(e,t,r){var n,i;try{if(t===false){r.reject(e.msg)}else{if(t===true){n=e.msg}else{n=t.call(void 0,e.msg)}if(n===r.promise){r.reject(TypeError("Promise-chain cycle"))}else if(i=u(n)){i.call(n,r.resolve,r.reject)}else{r.resolve(n)}}}catch(e){r.reject(e)}}function p(e){var t,r=this;if(r.triggered){return}r.triggered=true;if(r.def){r=r.def}try{if(t=u(e)){l(function(){var n=new v(r);try{t.call(e,function e(){p.apply(n,arguments)},function e(){d.apply(n,arguments)})}catch(e){d.call(n,e)}})}else{r.msg=e;r.state=1;if(r.chain.length>0){l(c,r)}}}catch(e){d.call(new v(r),e)}}function d(e){var t=this;if(t.triggered){return}t.triggered=true;if(t.def){t=t.def}t.msg=e;t.state=2;if(t.chain.length>0){l(c,t)}}function h(e,t,r,n){for(var i=0;i<t.length;i++){(function i(o){e.resolve(t[o]).then(function e(t){r(o,t)},n)})(i)}}function v(e){this.def=e;this.triggered=false}function _(e){this.promise=e;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function m(e){if(typeof e!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var t=new _(this);this["then"]=function e(r,n){var i={success:typeof r=="function"?r:true,failure:typeof n=="function"?n:false};i.promise=new this.constructor(function e(t,r){if(typeof t!="function"||typeof r!="function"){throw TypeError("Not a function")}i.resolve=t;i.reject=r});t.chain.push(i);if(t.state!==0){l(c,t)}return i.promise};this["catch"]=function e(t){return this.then(void 0,t)};try{e.call(void 0,function e(r){p.call(t,r)},function e(r){d.call(t,r)})}catch(e){d.call(t,e)}}var y=r({},"constructor",m,false);m.prototype=y;r(y,"__NPO__",0,false);r(m,"resolve",function e(t){var r=this;if(t&&(typeof t==="undefined"?"undefined":n(t))=="object"&&t.__NPO__===1){return t}return new r(function e(r,n){if(typeof r!="function"||typeof n!="function"){throw TypeError("Not a function")}r(t)})});r(m,"reject",function e(t){return new this(function e(r,n){if(typeof r!="function"||typeof n!="function"){throw TypeError("Not a function")}n(t)})});r(m,"all",function e(t){var r=this;if(a.call(t)!="[object Array]"){return r.reject(TypeError("Not an array"))}if(t.length===0){return r.resolve([])}return new r(function e(n,i){if(typeof n!="function"||typeof i!="function"){throw TypeError("Not a function")}var o=t.length,a=Array(o),s=0;h(r,t,function e(t,r){a[t]=r;if(++s===o){n(a)}},i)})});r(m,"race",function e(t){var r=this;if(a.call(t)!="[object Array]"){return r.reject(TypeError("Not an array"))}return new r(function e(n,i){if(typeof n!="function"||typeof i!="function"){throw TypeError("Not a function")}h(r,t,function e(t,r){n(r)},i)})});return m};var o=typeof r==="undefined"?window:r;var a=typeof Promise!=="undefined"?Promise:i();o.Promise=o.Promise||a;t.default=a}).call(t,r(74).setImmediate,r(8))},function(e,t,r){var n=Function.prototype.apply;t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)};t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){if(e){e.close()}};function i(e,t){this._id=e;this._clearFn=t}i.prototype.unref=i.prototype.ref=function(){};i.prototype.close=function(){this._clearFn.call(window,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout(function t(){if(e._onTimeout)e._onTimeout()},t)}};r(75);t.setImmediate=setImmediate;t.clearImmediate=clearImmediate},function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate){return}var n=1;var i={};var o=false;var a=e.document;var s;function l(e){if(typeof e!=="function"){e=new Function(""+e)}var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++){t[r]=arguments[r+1]}var o={callback:e,args:t};i[n]=o;s(n);return n++}function u(e){delete i[e]}function c(e){var t=e.callback;var n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n);break}}function f(e){if(o){setTimeout(f,0,e)}else{var t=i[e];if(t){o=true;try{c(t)}finally{u(e);o=false}}}}function p(){s=function(e){t.nextTick(function(){f(e)})}}function d(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function h(){var t="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===e&&typeof r.data==="string"&&r.data.indexOf(t)===0){f(+r.data.slice(t.length))}};if(e.addEventListener){e.addEventListener("message",r,false)}else{e.attachEvent("onmessage",r)}s=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;f(t)};s=function(t){e.port2.postMessage(t)}}function _(){var e=a.documentElement;s=function(t){var r=a.createElement("script");r.onreadystatechange=function(){f(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function m(){s=function(e){setTimeout(f,0,e)}}var y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e;if({}.toString.call(e.process)==="[object process]"){p()}else if(d()){h()}else if(e.MessageChannel){v()}else if(a&&"onreadystatechange"in a.createElement("script")){_()}else{m()}y.setImmediate=l;y.clearImmediate=u})(typeof self==="undefined"?typeof e==="undefined"?this:e:self)}).call(t,r(8),r(21))},function(e,t,r){"use strict";var n=r(77);var i=r(79);t.parse=k;t.resolve=O;t.resolveObject=E;t.format=w;t.Url=o;function o(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],c=["{","}","|","\\","^","`"].concat(u),f=["'"].concat(c),p=["%","/","?",";","#"].concat(f),d=["/","?","#"],h=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:true,"javascript:":true},y={javascript:true,"javascript:":true},g={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},b=r(80);function k(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;n.parse(e,t,r);return n}o.prototype.parse=function(e,t,r){if(!i.isString(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var o=e.indexOf("?"),s=o!==-1&&o<e.indexOf("#")?"?":"#",u=e.split(s),c=/\\/g;u[0]=u[0].replace(c,"/");e=u.join(s);var k=e;k=k.trim();if(!r&&e.split("#").length===1){var w=l.exec(k);if(w){this.path=k;this.href=k;this.pathname=w[1];if(w[2]){this.search=w[2];if(t){this.query=b.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(t){this.search="";this.query={}}return this}}var O=a.exec(k);if(O){O=O[0];var E=O.toLowerCase();this.protocol=E;k=k.substr(O.length)}if(r||O||k.match(/^\/\/[^@\/]+@[^@\/]+/)){var S=k.substr(0,2)==="//";if(S&&!(O&&y[O])){k=k.substr(2);this.slashes=true}}if(!y[O]&&(S||O&&!g[O])){var P=-1;for(var C=0;C<d.length;C++){var M=k.indexOf(d[C]);if(M!==-1&&(P===-1||M<P))P=M}var j,x;if(P===-1){x=k.lastIndexOf("@")}else{x=k.lastIndexOf("@",P)}if(x!==-1){j=k.slice(0,x);k=k.slice(x+1);this.auth=decodeURIComponent(j)}P=-1;for(var C=0;C<p.length;C++){var M=k.indexOf(p[C]);if(M!==-1&&(P===-1||M<P))P=M}if(P===-1)P=k.length;this.host=k.slice(0,P);k=k.slice(P);this.parseHost();this.hostname=this.hostname||"";var R=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!R){var B=this.hostname.split(/\./);for(var C=0,T=B.length;C<T;C++){var D=B[C];if(!D)continue;if(!D.match(v)){var F="";for(var I=0,A=D.length;I<A;I++){if(D.charCodeAt(I)>127){F+="x"}else{F+=D[I]}}if(!F.match(v)){var z=B.slice(0,C);var N=B.slice(C+1);var L=D.match(_);if(L){z.push(L[1]);N.unshift(L[2])}if(N.length){k="/"+N.join(".")+k}this.hostname=z.join(".");break}}}}if(this.hostname.length>h){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!R){this.hostname=n.toASCII(this.hostname)}var V=this.port?":"+this.port:"";var U=this.hostname||"";this.host=U+V;this.href+=this.host;if(R){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(k[0]!=="/"){k="/"+k}}}if(!m[E]){for(var C=0,T=f.length;C<T;C++){var W=f[C];if(k.indexOf(W)===-1)continue;var K=encodeURIComponent(W);if(K===W){K=escape(W)}k=k.split(W).join(K)}}var H=k.indexOf("#");if(H!==-1){this.hash=k.substr(H);k=k.slice(0,H)}var $=k.indexOf("?");if($!==-1){this.search=k.substr($);this.query=k.substr($+1);if(t){this.query=b.parse(this.query)}k=k.slice(0,$)}else if(t){this.search="";this.query={}}if(k)this.pathname=k;if(g[E]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var V=this.pathname||"";var q=this.search||"";this.path=V+q}this.href=this.format();return this};function w(e){if(i.isString(e))e=k(e);if(!(e instanceof o))return o.prototype.format.call(e);return e.format()}o.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=false,a="";if(this.host){o=e+this.host}else if(this.hostname){o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){o+=":"+this.port}}if(this.query&&i.isObject(this.query)&&Object.keys(this.query).length){a=b.stringify(this.query)}var s=this.search||a&&"?"+a||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||g[t])&&o!==false){o="//"+(o||"");if(r&&r.charAt(0)!=="/")r="/"+r}else if(!o){o=""}if(n&&n.charAt(0)!=="#")n="#"+n;if(s&&s.charAt(0)!=="?")s="?"+s;r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)});s=s.replace("#","%23");return t+o+r+s+n};function O(e,t){return k(e,false,true).resolve(t)}o.prototype.resolve=function(e){return this.resolveObject(k(e,false,true)).format()};function E(e,t){if(!e)return t;return k(e,false,true).resolveObject(t)}o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,false,true);e=t}var r=new o;var n=Object.keys(this);for(var a=0;a<n.length;a++){var s=n[a];r[s]=this[s]}r.hash=e.hash;if(e.href===""){r.href=r.format();return r}if(e.slashes&&!e.protocol){var l=Object.keys(e);for(var u=0;u<l.length;u++){var c=l[u];if(c!=="protocol")r[c]=e[c]}if(g[r.protocol]&&r.hostname&&!r.pathname){r.path=r.pathname="/"}r.href=r.format();return r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){var f=Object.keys(e);for(var p=0;p<f.length;p++){var d=f[p];r[d]=e[d]}r.href=r.format();return r}r.protocol=e.protocol;if(!e.host&&!y[e.protocol]){var h=(e.pathname||"").split("/");while(h.length&&!(e.host=h.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(h[0]!=="")h.unshift("");if(h.length<2)h.unshift("");r.pathname=h.join("/")}else{r.pathname=e.pathname}r.search=e.search;r.query=e.query;r.host=e.host||"";r.auth=e.auth;r.hostname=e.hostname||e.host;r.port=e.port;if(r.pathname||r.search){var v=r.pathname||"";var _=r.search||"";r.path=v+_}r.slashes=r.slashes||e.slashes;r.href=r.format();return r}var m=r.pathname&&r.pathname.charAt(0)==="/",b=e.host||e.pathname&&e.pathname.charAt(0)==="/",k=b||m||r.host&&e.pathname,w=k,O=r.pathname&&r.pathname.split("/")||[],h=e.pathname&&e.pathname.split("/")||[],E=r.protocol&&!g[r.protocol];if(E){r.hostname="";r.port=null;if(r.host){if(O[0]==="")O[0]=r.host;else O.unshift(r.host)}r.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){if(h[0]==="")h[0]=e.host;else h.unshift(e.host)}e.host=null}k=k&&(h[0]===""||O[0]==="")}if(b){r.host=e.host||e.host===""?e.host:r.host;r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname;r.search=e.search;r.query=e.query;O=h}else if(h.length){if(!O)O=[];O.pop();O=O.concat(h);r.search=e.search;r.query=e.query}else if(!i.isNullOrUndefined(e.search)){if(E){r.hostname=r.host=O.shift();var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(S){r.auth=S.shift();r.host=r.hostname=S.shift()}}r.search=e.search;r.query=e.query;if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.href=r.format();return r}if(!O.length){r.pathname=null;if(r.search){r.path="/"+r.search}else{r.path=null}r.href=r.format();return r}var P=O.slice(-1)[0];var C=(r.host||e.host||O.length>1)&&(P==="."||P==="..")||P==="";var M=0;for(var j=O.length;j>=0;j--){P=O[j];if(P==="."){O.splice(j,1)}else if(P===".."){O.splice(j,1);M++}else if(M){O.splice(j,1);M--}}if(!k&&!w){for(;M--;M){O.unshift("..")}}if(k&&O[0]!==""&&(!O[0]||O[0].charAt(0)!=="/")){O.unshift("")}if(C&&O.join("/").substr(-1)!=="/"){O.push("")}var x=O[0]===""||O[0]&&O[0].charAt(0)==="/";if(E){r.hostname=r.host=x?"":O.length?O.shift():"";var S=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(S){r.auth=S.shift();r.host=r.hostname=S.shift()}}k=k||r.host&&O.length;if(k&&!x){O.unshift("")}if(!O.length){r.pathname=null;r.path=null}else{r.pathname=O.join("/")}if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.auth=e.auth||r.auth;r.slashes=r.slashes||e.slashes;r.href=r.format();return r};o.prototype.parseHost=function(){var e=this.host;var t=s.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e}},function(e,t,r){(function(e,n){var i;(function(o){var a=typeof t=="object"&&t&&!t.nodeType&&t;var s=typeof e=="object"&&e&&!e.nodeType&&e;var l=typeof n=="object"&&n;if(l.global===l||l.window===l||l.self===l){o=l}var u,c=2147483647,f=36,p=1,d=26,h=38,v=700,_=72,m=128,y="-",g=/^xn--/,b=/[^\x20-\x7E]/,k=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=f-p,E=Math.floor,S=String.fromCharCode,P;function C(e){throw new RangeError(w[e])}function M(e,t){var r=e.length;var n=[];while(r--){n[r]=t(e[r])}return n}function j(e,t){var r=e.split("@");var n="";if(r.length>1){n=r[0]+"@";e=r[1]}e=e.replace(k,".");var i=e.split(".");var o=M(i,t).join(".");return n+o}function x(e){var t=[],r=0,n=e.length,i,o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function R(e){return M(e,function(e){var t="";if(e>65535){e-=65536;t+=S(e>>>10&1023|55296);e=56320|e&1023}t+=S(e);return t}).join("")}function B(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return f}function T(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function D(e,t,r){var n=0;e=r?E(e/v):e>>1;e+=E(e/t);for(;e>O*d>>1;n+=f){e=E(e/O)}return E(n+(O+1)*e/(e+h))}function F(e){var t=[],r=e.length,n,i=0,o=m,a=_,s,l,u,h,v,g,b,k,w;s=e.lastIndexOf(y);if(s<0){s=0}for(l=0;l<s;++l){if(e.charCodeAt(l)>=128){C("not-basic")}t.push(e.charCodeAt(l))}for(u=s>0?s+1:0;u<r;){for(h=i,v=1,g=f;;g+=f){if(u>=r){C("invalid-input")}b=B(e.charCodeAt(u++));if(b>=f||b>E((c-i)/v)){C("overflow")}i+=b*v;k=g<=a?p:g>=a+d?d:g-a;if(b<k){break}w=f-k;if(v>E(c/w)){C("overflow")}v*=w}n=t.length+1;a=D(i-h,n,h==0);if(E(i/n)>c-o){C("overflow")}o+=E(i/n);i%=n;t.splice(i++,0,o)}return R(t)}function I(e){var t,r,n,i,o,a,s,l,u,h,v,g=[],b,k,w,O;e=x(e);b=e.length;t=m;r=0;o=_;for(a=0;a<b;++a){v=e[a];if(v<128){g.push(S(v))}}n=i=g.length;if(i){g.push(y)}while(n<b){for(s=c,a=0;a<b;++a){v=e[a];if(v>=t&&v<s){s=v}}k=n+1;if(s-t>E((c-r)/k)){C("overflow")}r+=(s-t)*k;t=s;for(a=0;a<b;++a){v=e[a];if(v<t&&++r>c){C("overflow")}if(v==t){for(l=r,u=f;;u+=f){h=u<=o?p:u>=o+d?d:u-o;if(l<h){break}O=l-h;w=f-h;g.push(S(T(h+O%w,0)));l=E(O/w)}g.push(S(T(l,0)));o=D(r,k,n==i);r=0;++n}}++r;++t}return g.join("")}function A(e){return j(e,function(e){return g.test(e)?F(e.slice(4).toLowerCase()):e})}function z(e){return j(e,function(e){return b.test(e)?"xn--"+I(e):e})}u={version:"1.4.1",ucs2:{decode:x,encode:R},decode:F,encode:I,toASCII:z,toUnicode:A};if(true){!(i=function(){return u}.call(t,r,t,e),i!==undefined&&(e.exports=i))}else if(a&&s){if(e.exports==a){s.exports=u}else{for(P in u){u.hasOwnProperty(P)&&(a[P]=u[P])}}}else{o.punycode=u}})(this)}).call(t,r(78)(e),r(8))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t,r){"use strict";e.exports={isString:function(e){return typeof e==="string"},isObject:function(e){return typeof e==="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}},function(e,t,r){"use strict";t.decode=t.parse=r(81);t.encode=t.stringify=r(82)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&";r=r||"=";var a={};if(typeof e!=="string"||e.length===0){return a}var s=/\+/g;e=e.split(t);var l=1e3;if(o&&typeof o.maxKeys==="number"){l=o.maxKeys}var u=e.length;if(l>0&&u>l){u=l}for(var c=0;c<u;++c){var f=e[c].replace(s,"%20"),p=f.indexOf(r),d,h,v,_;if(p>=0){d=f.substr(0,p);h=f.substr(p+1)}else{d=f;h=""}v=decodeURIComponent(d);_=decodeURIComponent(h);if(!n(a,v)){a[v]=_}else if(i(a[v])){a[v].push(_)}else{a[v]=[a[v],_]}}return a};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){t=t||"&";r=r||"=";if(e===null){e=undefined}if(typeof e==="object"){return o(a(e),function(a){var s=encodeURIComponent(n(a))+r;if(i(e[a])){return o(e[a],function(e){return s+encodeURIComponent(n(e))}).join(t)}else{return s+encodeURIComponent(n(e[a]))}}).join(t)}if(!s)return"";return encodeURIComponent(n(s))+r+encodeURIComponent(n(e))};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function o(e,t){if(e.map)return e.map(t);var r=[];for(var n=0;n<e.length;n++){r.push(t(e[n],n))}return r}var a=Object.keys||function(e){var t=[];for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t.push(r)}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(7);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}t.default={EVENTS:{RENDER:"render",EXPORT:"export",EDITOR_READY:"editor:ready",CLOSE:"close",ZOOM_DONE:"zoom:done",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",COLORPICKER_OPEN:"colorpicker:open",HISTORY_UPDATED:"history:update",HISTORY_BEFORE_UNDO:"history:before_undo",HISTORY_UNDO:"history:undo",WINDOW_RESIZE:"window:resize",CONTROLS_SWITCHED:"controls:switched",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},DEFAULTS:{TRANSFORM_RATIOS:[[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:true},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:1.33},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:1.77}],[{identifier:"imgly_transform_facebook_profile",defaultName:"FB Profile",ratio:1/1},{identifier:"imgly_transform_facebook_ad",defaultName:"FB Ad",dimensions:new i.default.Math.Vector2(1200,627)},{identifier:"imgly_transform_facebook_post",defaultName:"FB Post",dimensions:new i.default.Math.Vector2(940,788)},{identifier:"imgly_transform_facebook_cover",defaultName:"FB Cover",dimensions:new i.default.Math.Vector2(851,315)}]],BRUSHES:[i.default.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush],FONTS:[{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff"}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff"}]},{fontFamily:"Bernier",variations:[{identifier:"imgly_font_bernier_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_bernier_regular.woff"}]},{fontFamily:"Cheque",variations:[{identifier:"imgly_font_cheque_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_cheque_regular.woff"}]},{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:true}]},{fontFamily:"Gagalin",variations:[{identifier:"imgly_font_gagalin_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_gagalin_regular.woff"}]},{fontFamily:"Hagin",variations:[{identifier:"imgly_font_hagin_caps_thin",fontWeight:200,provider:"file",filePath:"fonts/imgly_font_hagin_caps_thin.woff"}]},{fontFamily:"Intro",variations:[{identifier:"imgly_font_intro_inline",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_intro_inline.woff"}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff"}]},{fontFamily:"Nexa",variations:[{identifier:"imgly_font_nexa_script",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_nexa_script.woff"}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff"},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff"}]},{fontFamily:"Panton",variations:[{identifier:"imgly_font_panton_blackitalic_caps",fontWeight:800,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_blackitalic_caps.woff"},{identifier:"imgly_font_panton_lightitalic_caps",fontWeight:200,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_lightitalic_caps.woff"}]},{fontFamily:"Perfograma",variations:[{identifier:"imgly_font_perfograma",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_perfograma.woff"}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff"}]}]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(7);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=a.default.EventEmitter,p=a.default.Utils,d=a.default.Log;var h=function(e){c(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};l(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r._state=e;return r}i(t,[{key:"set",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if((typeof t==="undefined"?"undefined":n(t))!=="object"){d.warn("SharedState#set expects an object as first parameter")}var i=p.extend({},this._state);this._state=p.extend(this._state,t);if(r){this.broadcastUpdate(i,this._state)}}},{key:"get",value:function e(t){return this._state[t]}},{key:"broadcastUpdate",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.emit("update",t,r)}},{key:"clear",value:function e(){this._state={}}}]);return t}(f);t.default=h},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var r=typeof window==="undefined"?e:window;var n=r.requestAnimationFrame;var i=r.cancelAnimationFrame;var o=0;var a=["ms","moz","webkit","o"];for(var s=0;s<a.length&&!n;++s){t.requestAnimationFrame=n=r[a[s]+"RequestAnimationFrame"];t.cancelAnimationFrame=i=r[a[s]+"CancelAnimationFrame"]||r[a[s]+"CancelRequestAnimationFrame"]}if(n){t.requestAnimationFrame=n=n.bind(r)}if(i){t.cancelAnimationFrame=i=i.bind(r)}if(!n){t.requestAnimationFrame=n=function e(t,r){var n=(new Date).getTime();var i=Math.max(0,16-(n-o));var a=setTimeout(function(){t(n+i)},i);o=n+i;return a}}if(!i){t.cancelAnimationFrame=i=function e(t){clearTimeout(t)}}t.requestAnimationFrame=n;t.cancelAnimationFrame=i}).call(t,r(8))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(87);var a=k(o);var s=r(89);var l=k(s);var u=r(96);var c=k(u);var f=r(106);var p=k(f);var d=r(109);var h=k(d);var v=r(9);var _=k(v);var m=r(190);var y=k(m);var g=r(1);var b=k(g);function k(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function E(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function S(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=function(e){S(t,e);function t(){var e;O(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._screens={loading:a.default,splash:l.default,photoRoll:c.default,webcam:p.default,editor:h.default,empty:_.default};var s=void 0;if(o.props.options.preloader){s="loading"}o._screenAfterLoading="splash";if(o.props.options.editor.image){o._screenAfterLoading="editor"}if(!s){s=o._screenAfterLoading}o._previousScreensStack=[];o.state={activeScreen:o._screens[s],activeScreenName:s,screens:w({},s,o._screens[s])};return o}n(t,[{key:"hasPreviousScreen",value:function e(){return!!this._previousScreensStack.length}},{key:"getPreviousScreen",value:function e(){var t=this._previousScreensStack;return t[t.length-1]}},{key:"switchToScreen",value:function e(t){var r=this;var n=null;if(t==="back"){n=this._previousScreensStack.pop();if(!n){throw new Error("Unable to switch to previous screen - no previous screen found.")}}else{if(t==="post-loading")t=this._screenAfterLoading;n=this._screens[t];if(!n){throw new Error("Unknown screen `"+t+"`")}this._previousScreensStack.push(this.state.activeScreen)}if(!this.state.screens[t]){this.state.screens[t]=n}if(this.state.activeScreenName!=="editor"){delete this.state.screens[this.state.activeScreenName]}return new i.Promise(function(e){r.setState({activeScreen:n,activeScreenName:t},function(){e()})})}},{key:"setImage",value:function e(t,r){var n=this;var i=this.props.options;i.editor.image=t;var o=!this.refs.editorScreen;this.switchToScreen("editor").then(function(){if(!o){n.refs.editorScreen.setImage(t,r)}})}},{key:"export",value:function e(){if(this.state.activeScreen!==this._screens.editor){return i.Promise.reject(new Error("Unable to export: Active screen is not the editor screen."))}if(this.state.screens.editor){var t;return(t=this.refs.editorScreen).export.apply(t,arguments)}}},{key:"getEditor",value:function e(){if(this.state.activeScreen!==this._screens.editor){return i.Promise.reject(new Error("Unable to get editor: Active screen is not the editor screen."))}if(this.state.screens.editor){return this.refs.editorScreen.getEditor()}}},{key:"serialize",value:function e(){var t;if(!this.state.screens.editor){return i.Promise.reject(new Error("Editor screen unavailable"))}return(t=this.refs.editorScreen).serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){if(!this.state.screens.editor){return i.Promise.reject(new Error("Editor screen unavailable"))}return this.refs.editorScreen.deserialize(t)}},{key:"getChildContext",value:function e(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator}}},{key:"_renderScreens",value:function e(){var t=[];for(var r in this.state.screens){var n=this.state.screens[r];var o=this.state.activeScreen===n;t.push(i.ReactBEM.createElement(n,{ref:r+"Screen",app:this,visible:o}))}return t}},{key:"render",value:function e(){return i.ReactBEM.transform(i.ReactBEM.createElement("div",{bem:"b:editor"},i.ReactBEM.createElement(y.default,{modalManager:b.default.instance}),this._renderScreens()))}}]);return t}(i.React.Component);t.default=P;P.childContextTypes={ui:i.PropTypes.object.isRequired,mediator:i.PropTypes.object.isRequired,options:i.PropTypes.object.isRequired};P.propTypes={ui:i.PropTypes.object.isRequired,mediator:i.PropTypes.object.isRequired,options:i.PropTypes.object.isRequired}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(9);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o.state={progress:0};o._preloader=o.context.ui.getPreloader();o._preloader.on("progress",function(e){o.state.progress=e});o._preloader.on("done",function(){o.props.app.switchToScreen("post-loading")});return o}n(t,[{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=window,a=n.devicePixelRatio;this._canvas=this.refs.canvas;this._canvas.width=this._canvas.offsetWidth*a;this._canvas.height=this._canvas.offsetHeight*a;this._context=this._canvas.getContext("2d");this._preloaderImage=new window.Image;this._preloaderImage.addEventListener("load",function(){r._preloader.load();(0,o.requestAnimationFrame)(r._tick)});this._preloaderImage.crossOrigin="Anonymous";this._preloaderImage.src=this.context.ui.getAssetPath("preloader.png",true);this._running=true;this._tick=this._tick.bind(this)}},{key:"componentWillUnmount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this);this._running=false}},{key:"_tick",value:function e(){this._renderLoadingIndicator();if(this._running){(0,o.requestAnimationFrame)(this._tick)}}},{key:"_renderLoadingIndicator",value:function e(){var t=this._canvas,r=t.width,n=t.height;var i=this._context;i.clearRect(0,0,r,n);i.save();i.beginPath();i.moveTo(r/2,n/2);i.arc(r/2,n/2,r/2,-Math.PI*.5,Math.PI*2*this.state.progress-Math.PI*.5,false);i.lineTo(r/2,n/2);i.clip();i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,r,n);i.restore();i.save();i.globalAlpha=.05;i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,r,n);i.restore()}},{key:"_renderScreen",value:function e(){return o.ReactBEM.createElement("div",{bem:"$b:loadingScreen"},o.ReactBEM.createElement("div",{bem:"e:container"},o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"})))}}]);return t}(s.default);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onCloseClick");return s}n(t,[{key:"_onCloseClick",value:function e(){this.context.mediator.emit(i.Constants.EVENTS.CLOSE)}},{key:"renderWithBEM",value:function e(){var t=void 0;if(this.context.options.showCloseButton){t=i.ReactBEM.createElement("div",{bem:"$e:close",onClick:this._onCloseClick},i.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("close.png",true)}))}return i.ReactBEM.createElement("div",{bem:"$b:header"},i.ReactBEM.createElement("div",{bem:"e:label"},this.context.options.title),t)}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(9);var a=d(o);var s=r(90);var l=d(s);var u=r(94);var c=d(u);var f=r(95);var p=d(f);function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){_(t,e);function t(){h(this,t);var e=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._bindAll("_onWebcamClick","_onPhotoRollClick","_onImage");return e}n(t,[{key:"_onPhotoRollClick",value:function e(){this.props.app.switchToScreen("photoRoll")}},{key:"_onWebcamClick",value:function e(){this.props.app.switchToScreen("webcam")}},{key:"_onImage",value:function e(t){this.props.app.setImage(t)}},{key:"_isWebcamAvailable",value:function e(){return!i.Utils.isMobile()&&this.context.options.enableWebcam!==false}},{key:"_isPhotoRollAvailable",value:function e(){return!!this.context.options.photoRoll.provider}},{key:"_renderScreen",value:function e(){var t=[];var r=0;var n=this.context.options.enableUpload;if(n)r++;var o=this._isWebcamAvailable();if(o)r++;var a=this._isPhotoRollAvailable();if(a)r++;if(n){t.push(i.ReactBEM.createElement(l.default,{onImage:this._onImage,totalRows:r}))}if(o){t.push(i.ReactBEM.createElement(c.default,{onClick:this._onWebcamClick,totalRows:r}))}if(a){t.push(i.ReactBEM.createElement(p.default,{onClick:this._onPhotoRollClick,totalRows:r}))}return i.ReactBEM.createElement("div",{bem:"$b:splashScreen"},i.ReactBEM.createElement("div",{bem:"e:container"},t))}}]);return t}(a.default);t.default=m;m.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);var a=r(1);var s=h(a);var l=r(24);var u=h(l);var c=r(91);var f=h(c);var p=r(25);var d=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function m(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var y=function(e){m(t,e);function t(){v(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._modifier="upload";e._bindAll("_onImage","_onDragEnter","_onDragOver","_onDragLeave","_onDrop");e._dragCounter=0;e.state={dragAreaHovered:false};return e}i(t,[{key:"_onDragEnter",value:function e(t){t.preventDefault();this._dragCounter++;this.setState({dragAreaHovered:true})}},{key:"_onDragOver",value:function e(t){t.preventDefault()}},{key:"_onDragLeave",value:function e(t){t.preventDefault();this._dragCounter--;if(this._dragCounter===0){this.setState({dragAreaHovered:false})}}},{key:"_onDrop",value:function e(t){var r=this;t.stopPropagation();t.preventDefault();t=t.nativeEvent;t.returnValue=false;this.setState({dragAreaHovered:false},function(){if(!t.dataTransfer)return;if(!t.dataTransfer.files[0].type.match(/^image\//i)){return s.default.instance.displayError(r._t("errors.title"),r._t("errors.invalidFileType.text",{fileType:t.dataTransfer.files[0].type}))}r._handleFile(t.dataTransfer.files[0])})}},{key:"_onClick",value:function e(t){this.refs.upload.open()}},{key:"_handleFile",value:function e(t){var r=this;var n=new window.FileReader;n.onload=function(){return function(e){var t=e.target.result;var n=new window.Image;n.addEventListener("load",function(){r._onImage(n)});n.src=t}}(t);n.readAsDataURL(t)}},{key:"_onImage",value:function e(t){this.props.onImage&&this.props.onImage(t)}},{key:"_renderContent",value:function e(){var t={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};if(this.state.dragAreaHovered){t.className="is-hovered"}var r="e:contentCell";if(this.context.options.enableWebcam!==false||this.context.options.photoRoll.provider!==null){r+=" m:withBorder"}return o.ReactBEM.createElement("div",{bem:"e:contentWrapper"},o.ReactBEM.createElement("div",{bem:"e:contentRow"},o.ReactBEM.createElement("div",n({bem:r,onClick:this._onClick},t),o.ReactBEM.createElement(d.default,{ref:"upload",onNewFile:this._onImage}),o.ReactBEM.createElement(f.default,{bem:"e:button",uppercase:true},this._t("splash.upload.button")),o.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.upload.description")))))}}]);return t}(u.default);t.default=y;y.propTypes={onImage:o.PropTypes.func.isRequired};y.contextTypes=u.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t="b:button";if(this.props.uppercase){t+=" m:uppercase"}return i.ReactBEM.createElement("button",{bem:t,className:this.props.className,onClick:this.props.onClick},this.props.children)}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={onClick:i.PropTypes.func,children:i.PropTypes.any.isRequired,className:i.PropTypes.string};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(93);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(e){l(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r._input=e;r._onFileChange=r._onFileChange.bind(r);r._input.addEventListener("change",r._onFileChange);return r}n(t,[{key:"open",value:function e(){this._input.value=null;this._input.click()}},{key:"_handleFile",value:function e(t){var r=this;var n=new window.FileReader;n.onload=function(){return function(e){var t=e.target.result;var n=new window.Image;n.addEventListener("load",function(){r.emit("file",n)});n.addEventListener("error",function(e){return a.default.instance.displayError(r._t("errors.title"),r._t("errors.imageLoadingError.text"))});n.src=t}}(t);n.readAsDataURL(t)}},{key:"_onFileChange",value:function e(){var t=this._input.files;if(!t.length)return;this._handleFile(t[0])}},{key:"dispose",value:function e(){this._input.removeEventListener("change",this._onFileChange)}}]);return t}(i.EventEmitter);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(e,r,n){var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var l=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;o(this,t);var u=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));u.id=i.SDKUtils.getUUID();u.type=e;u.title=r;u.text=n;u.overlay=s;u.closeOnOverlayClick=l;u.visible=true;u.data=null;return u}n(t,[{key:"setData",value:function e(t){this.data=t;this.emit("update")}},{key:"close",value:function e(){this.visible=false;this.emit("close")}},{key:"remove",value:function e(){this.emit("remove")}}]);return t}(i.EventEmitter);var u=function(e){s(t,e);function t(){o(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._modals=[];return e}n(t,[{key:"displayLoading",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=new l("loading",t,null,r);this.addModal(n);return n}},{key:"displayProgress",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=new l("progress",null,t);n.setData({progress:r});this.addModal(n);return n}},{key:"displayInput",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=new l("input",t,null,n,true);i.setData({text:r});this.addModal(i);return i}},{key:"displayWarning",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:["OK"];var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var o=new l("warning",t,r,i);o.setData({buttons:n});this.addModal(o);return o}},{key:"displayError",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=new l("error",t,r,n);this.addModal(i);return i}},{key:"addModal",value:function e(t){var r=this;this._modals.push(t);t.on("close",function(){r.emit("update")});t.on("remove",function(){r.removeModal(t)});t.on("update",function(){r.emit("update")});this.emit("update")}},{key:"removeModal",value:function e(t){var r=this._modals.indexOf(t);this._modals.splice(r,1);this.emit("update")}},{key:"getModals",value:function e(){return this._modals}}],[{key:"instance",get:function e(){if(!this._instance){this._instance=new t}return this._instance}}]);return t}(i.EventEmitter);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(24);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._needsStyleFixes=true;o._modifier="webcam";return o}n(t,[{key:"fixStyles",value:function e(){if(i.Utils.Browser.isIElte(11)){var t=this.refs,r=t.cell,n=t.overlay;var o=r.offsetHeight;n.style.height=o+"px"}}},{key:"_renderContent",value:function e(){var t={backgroundImage:"url("+this._getAssetPath("splash/webcam.png",true,true)+")"};return i.ReactBEM.createElement("div",{bem:"e:contentWrapper"},i.ReactBEM.createElement("div",{bem:"e:contentRow"},i.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:t,ref:"cell"},i.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),i.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.webcam.headline")),i.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.webcam.description")))))}}]);return t}(a.default);t.default=f;f.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(24);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._needsStyleFixes=true;o._modifier="photoRoll";return o}n(t,[{key:"fixStyles",value:function e(){if(i.Utils.Browser.isIElte(11)){var t=this.refs,r=t.cell,n=t.overlay;var o=r.offsetHeight;n.style.height=o+"px"}}},{key:"_renderContent",value:function e(){var t={backgroundImage:"url("+this._getAssetPath("splash/photo-roll.png",true,true)+")"};return i.ReactBEM.createElement("div",{bem:"e:contentWrapper"},i.ReactBEM.createElement("div",{bem:"e:contentRow"},i.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:t,ref:"cell"},i.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),i.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.photoRoll.headline")),i.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.photoRoll.description")))))}}]);return t}(a.default);t.default=f;f.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(9);var a=m(o);var s=r(97);var l=m(s);var u=r(101);var c=m(u);var f=r(41);var p=m(f);var d=r(104);var h=m(d);var v=r(1);var _=m(v);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var k=function(e){b(t,e);function t(){var e;y(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o.state={section:"overview",sectionsHistory:[]};o._bindAll("_onLibraryClicked","_onSearchSuggestionClicked","_onPhotoClicked","_onFileUpload","_onWebcamClick","_onBackClicked","_onSearch");return o}n(t,[{key:"hasPreviousSection",value:function e(){return!!this.state.sectionsHistory.length}},{key:"switchToSection",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(t==="back"){if(!this.hasPreviousSection()){if(r){return this.props.app.switchToScreen("back")}else{return this.switchToSection("overview")}}t=this.state.sectionsHistory.pop()}else if(this.state.section!==t&&n){this.state.sectionsHistory.push(this.state.section)}this.setState({section:t})}},{key:"_onLibraryClicked",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.state.library=t;this.switchToSection("library",true,!r)}},{key:"_onSearchSuggestionClicked",value:function e(t){this.state.searchQuery=t.query;this.switchToSection("search")}},{key:"_onPhotoClicked",value:function e(t){var r=this;var n=_.default.instance.displayLoading(this._t("loading.loading"));var o=new window.Image;o.addEventListener("load",function(){n.close();r.props.app.setImage(o,true)});o.addEventListener("error",function(){n.close();_.default.instance.displayError(r._t("errors.imageLoadFail.title"),r._t("errors.imageLoadFail.text",{path:o.src}))});o.crossOrigin=i.SDKUtils.getCrossOriginValue(this.context.options.crossOrigin);o.src=t.urls.raw}},{key:"_onBackClicked",value:function e(){this.switchToSection("back")}},{key:"_onSearch",value:function e(t){if(!t.trim().length){this.state.searchQuery=null;return this.switchToSection("back",false)}this.state.searchQuery=t;this.switchToSection("search")}},{key:"_onWebcamClick",value:function e(){this.props.app.switchToScreen("webcam")}},{key:"_onFileUpload",value:function e(t){this.props.app.setImage(t)}},{key:"_isBackButtonVisible",value:function e(){return this.state.sectionsHistory.length!==0||this.props.app.hasPreviousScreen()}},{key:"_renderContent",value:function e(){switch(this.state.section){case"search":return i.ReactBEM.createElement(h.default,{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case"library":return i.ReactBEM.createElement(p.default,{crossOrigin:i.SDKUtils.getCrossOriginValue(this.context.options.crossOrigin),library:this.state.library,onPhotoClicked:this._onPhotoClicked});case"overview":return i.ReactBEM.createElement(c.default,{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked})}}},{key:"_renderScreen",value:function e(){var t=this._renderContent();return i.ReactBEM.createElement("div",{bem:"$b:photoRollScreen"},i.ReactBEM.createElement(l.default,{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t("generic.back"),ref:"topBarControls"}),t)}}]);return t}(a.default);t.default=k;k.childContextTypes={ui:i.PropTypes.object.isRequired,editor:i.PropTypes.object.isRequired,mediator:i.PropTypes.object.isRequired,options:i.PropTypes.object.isRequired,editorScreen:i.PropTypes.object.isRequired};k.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(12);var a=v(o);var s=r(98);var l=v(s);var u=r(25);var c=v(u);var f=r(99);var p=v(f);var d=r(100);var h=v(d);function v(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var g=function(e){y(t,e);function t(){var e;_(this,t);for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}var a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onUploadButtonClicked","_onWebcamButtonClicked","_onBackClicked","_onSearchValueChange","_onNewFile");a._onSearchValueChange=i.Utils.debounce(a._onSearchValueChange,250);return a}n(t,[{key:"_onBackClicked",value:function e(){this.props.onBackClicked&&this.props.onBackClicked()}},{key:"_onSearchValueChange",value:function e(t){this.props.onSearch&&this.props.onSearch(t)}},{key:"_onUploadButtonClicked",value:function e(){this.refs.upload.open()}},{key:"_onWebcamButtonClicked",value:function e(){this.props.onWebcamClick&&this.props.onWebcamClick()}},{key:"_onNewFile",value:function e(t){this.props.onFileUpload&&this.props.onFileUpload(t)}},{key:"_isWebcamAvailable",value:function e(){return!i.Utils.isMobile()&&this.context.options.enableWebcam!==false}},{key:"_renderRightButtons",value:function e(){var t=this.context.options;var r=[];if(t.enableUpload){r.push(i.ReactBEM.createElement(l.default,{icon:this._getAssetPath("photo-roll/upload.png",true),onClick:this._onUploadButtonClicked}))}if(this._isWebcamAvailable()){r.push(i.ReactBEM.createElement(l.default,{icon:this._getAssetPath("photo-roll/webcam.png",true),onClick:this._onWebcamButtonClicked}))}return r}},{key:"renderWithBEM",value:function e(){var t=void 0;if(this.props.backButton){t=i.ReactBEM.createElement(h.default,{label:this.props.backButtonLabel,onClick:this._onBackClicked})}return i.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},i.ReactBEM.createElement("div",{bem:"e:cell"},i.ReactBEM.createElement("div",{bem:"e:table"},i.ReactBEM.createElement("div",{bem:"e:cell m:left"},t),i.ReactBEM.createElement("div",{bem:"e:cell m:fullWidth"},i.ReactBEM.createElement(p.default,{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),i.ReactBEM.createElement(c.default,{onNewFile:this._onNewFile,ref:"upload"})),i.ReactBEM.createElement("div",{bem:"e:cell m:right"},this._renderRightButtons()))))}}]);return t}(a.default);t.default=g;g.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this.props.onClick},i.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.icon})))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){var e;a(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onFocus","_onBlur","_onChange","_onBarClick");o.state={active:false,placeholder:o._t("photoRoll.search.placeholder"),value:o.props.searchQuery||""};return o}n(t,[{key:"componentWillReceiveProps",value:function e(t){if(t.searchQuery||this.state.value){this.state.active=true}else{this.state.active=false}this.setState({value:t.searchQuery||""})}},{key:"componentDidUpdate",value:function e(){this.refs.input.value=this.state.value}},{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._hiddenInputDummy=document.createElement("div");var n=o.Utils.getStyleObject(this.refs.input);var a=["font","lineHeight","textAlign","textIndent","textTransform","textDecoration","textRendering","textShadow","textOverflow","wordSpacing","letterSpacing","whiteSpace"];a.forEach(function(e){r._hiddenInputDummy.style[e]=n[e]});this._hiddenInputDummy.style.position="absolute";this._hiddenInputDummy.style.top="-9999px";this._hiddenInputDummy.style.left="-9999px";this.refs.root.appendChild(this._hiddenInputDummy);this._updateInputWidth()}},{key:"_updateInputWidth",value:function e(){var t=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder;setTimeout(function(){t.setState({inputWidth:t._hiddenInputDummy.offsetWidth+5})},0)}},{key:"_onBarClick",value:function e(){this.refs.input.focus()}},{key:"_onFocus",value:function e(){this.setState({active:true})}},{key:"_onBlur",value:function e(){if(this.state.value===""&&!this.props.searchQuery){this.setState({active:false})}}},{key:"_onChange",value:function e(t){this.state.value=t.target.value;this.forceUpdate();this.props.onChange&&this.props.onChange(this.state.value)}},{key:"renderWithBEM",value:function e(){var t="$e:searchBar";var r="photo-roll/search-light.png";if(this.state.active){t+=" m:active";r="photo-roll/search-dark.png"}r=this._getAssetPath(r,true);var n={width:this.state.inputWidth+"px"};return o.ReactBEM.createElement("bem",{specifier:"$b:photoRollScreen"},o.ReactBEM.createElement("div",{bem:t,ref:"root",onClick:this._onBarClick},o.ReactBEM.createElement("div",{bem:"e:content"},o.ReactBEM.createElement("div",{bem:"$e:icon"},o.ReactBEM.createElement("img",{src:r,bem:"e:image"})),o.ReactBEM.createElement("div",{bem:"e:inputContainer"},o.ReactBEM.createElement("input",{bem:"e:input",ref:"input",placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:n})))))}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:"$e:backButton",onClick:this.props.onClick},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("top-bar/back.png",true)}),i.ReactBEM.createElement("div",{bem:"e:label"},this.props.label)))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){var r=[];var n=true;var i=false;var o=undefined;try{for(var a=e[Symbol.iterator](),s;!(n=(s=a.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){i=true;o=e}finally{try{if(!n&&a["return"])a["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var a=r(0);var s=r(1);var l=d(s);var u=r(102);var c=d(u);var f=r(40);var p=d(f);function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){_(t,e);function t(){var e;h(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._needsStyleFixes=true;o.state={loading:true,libraries:[],searchSuggestions:[]};o._bindAll("_onLibraryClick","_onSearchSuggestionClick");var a=o.context.options.photoRoll.provider;o._provider=new a;return o}i(t,[{key:"fixStyles",value:function e(){if(a.Utils.Browser.isIElte(11)){var t=this.refs,r=t.cell,n=t.container;if(!(r&&n)){return}var i=r.offsetHeight;n.style.height=i+"px"}}},{key:"componentDidMount",value:function e(){var r=this;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var i=l.default.instance.displayLoading(this._t("loading.loading"));this._load().then(function(e){var t=n(e,2),o=t[0],a=t[1];i.close();if(o.length===1){r._onLibraryClick(o[0],true)}else{r.setState({loading:false,libraries:o,searchSuggestions:a})}})}},{key:"_onLibraryClick",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.props.onLibraryClicked&&this.props.onLibraryClicked(t,r)}},{key:"_onSearchSuggestionClick",value:function e(t){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(t)}},{key:"_load",value:function e(){var t=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return a.Promise.all(t)}},{key:"_renderLibraries",value:function e(){var t=this;var r=this.state.libraries.map(function(e){return a.ReactBEM.createElement(c.default,{onClick:t._onLibraryClick,library:e})});return a.ReactBEM.createElement("li",{bem:"e:item"},a.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},a.ReactBEM.createElement("div",{bem:"e:headline"},"Browse libraries"),a.ReactBEM.createElement("ul",{bem:"$e:libraryList"},r)))}},{key:"_renderSearchSuggestions",value:function e(){var t=this;if(!this.state.searchSuggestions.length)return null;var r=this.state.searchSuggestions.map(function(e){return a.ReactBEM.createElement(p.default,{onClick:t._onSearchSuggestionClick,searchSuggestion:e})});return a.ReactBEM.createElement("li",{bem:"e:item"},a.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},a.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),a.ReactBEM.createElement("ul",{bem:"$e:libraryList"},r)))}},{key:"_renderContent",value:function e(){return a.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},a.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},a.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},a.ReactBEM.createElement("div",{bem:"e:innerContainer"},a.ReactBEM.createElement("ul",{bem:"$e:groupList"},this._renderLibraries(),this._renderSearchSuggestions())))))}},{key:"renderWithBEM",value:function e(){if(!this.state.loading){return this._renderContent()}else{return a.ReactBEM.createElement("div",null)}}}]);return t}(a.BaseComponent);t.default=m;m.contextTypes=a.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onClick");return s}n(t,[{key:"_onClick",value:function e(){this.props.onClick&&this.props.onClick(this.props.library)}},{key:"renderWithBEM",value:function e(){var t=this.props.library;var r={backgroundImage:"url("+t.coverImage+")"};return i.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},i.ReactBEM.createElement("li",{bem:"e:item",style:r,onClick:this._onClick},i.ReactBEM.createElement("div",{bem:"e:overlay"}),i.ReactBEM.createElement("div",{bem:"e:name"},t.name)))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t=this.props.photo;return i.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:photoList"},i.ReactBEM.createElement("li",{bem:"$e:item",onClick:this.props.onClick},i.ReactBEM.createElement("div",{bem:"e:overlay"}),i.ReactBEM.createElement("div",{bem:"e:title"},t.title),i.ReactBEM.createElement("img",{bem:"e:image",src:t.urls.thumb})))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(41);var a=f(o);var s=r(105);var l=f(s);var u=r(1);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"componentWillReceiveProps",value:function e(t){if(t.query!==this.props.query){this._loadPhotos(t.query)}}},{key:"_getHeadline",value:function e(){return this._t("photoRoll.search.results.headline",{query:this.props.query})}},{key:"_loadPhotos",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props.query;this._totalPhotosHeight=0;var n=c.default.instance.displayProgress(this._t("loading.loading"));var i=this.context.options.photoRoll.provider;var o=new i;o.searchPhotos(r).then(function(e){return t._preloadPhotos(e,n)}).then(function(e){t.setState({photos:e,loading:false});n.close()})}},{key:"_renderNotFound",value:function e(){return i.ReactBEM.createElement(l.default,{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked})}},{key:"renderWithBEM",value:function e(){if(!this.state.loading){if(this.state.photos.length===0){return this._renderNotFound()}else{return this._renderPhotos()}}else{return i.ReactBEM.createElement("div",null)}}}]);return t}(a.default);t.default=v;v.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(40);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onSearchSuggestionClick");var a=o.context.options.photoRoll.provider;o._provider=new a;o.state={searchSuggestions:[]};return o}n(t,[{key:"_onSearchSuggestionClick",value:function e(t){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(t)}},{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._provider.getSearchSuggestions().then(function(e){r.setState({searchSuggestions:e})})}},{key:"_renderMessage",value:function e(){return{__html:this._t("photoRoll.search.noSearchResults",{query:this.props.query})}}},{key:"_renderSearchSuggestions",value:function e(){var t=this;if(!this.state.searchSuggestions.length)return null;var r=this.state.searchSuggestions.map(function(e){return o.ReactBEM.createElement(s.default,{onClick:t._onSearchSuggestionClick,searchSuggestion:e})});return o.ReactBEM.createElement("div",null,o.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),o.ReactBEM.createElement("ul",{bem:"$e:libraryList"},r))}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},o.ReactBEM.createElement("div",{bem:"e:cell"},o.ReactBEM.createElement("div",{bem:"e:container"},o.ReactBEM.createElement("div",{bem:"e:innerContainer"},o.ReactBEM.createElement("div",{bem:"e:noSearchResults",dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))))}}]);return t}(o.BaseComponent);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(9);var a=f(o);var s=r(12);var l=f(s);var u=r(107);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);var e=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._bindAll("_onCancel","_onWebcamReady","_onShutterClicked");e.state={webcamReady:false};return e}n(t,[{key:"_onWebcamReady",value:function e(){this.setState({webcamReady:true})}},{key:"_onCancel",value:function e(){this.props.app.switchToScreen("back")}},{key:"_onShutterClicked",value:function e(){var t=this;var r=this.refs.webcam;r.makePhoto().then(function(e){t.props.app.setImage(e)}).catch(function(e){i.Log.error(e)})}},{key:"_renderScreen",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:webcamScreen"},i.ReactBEM.createElement(l.default,{label:this._t("webcam.headline")},i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:"e:cancelButton",onClick:this._onCancel},this._t("generic.cancel")),i.ReactBEM.createElement("div",{bem:"e:label"},this._t("webcam.headline")))),i.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},i.ReactBEM.createElement("div",{bem:"e:container e:cell"},i.ReactBEM.createElement(c.default,{ref:"webcam",onReady:this._onWebcamReady,onBack:this._onCancel}))),i.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},i.ReactBEM.createElement("div",{bem:"e:cell"},i.ReactBEM.createElement("bem",{specifier:"b:webcamScreen"},i.ReactBEM.createElement("div",{bem:"$e:shutterButton",onClick:this._onShutterClicked,className:this.state.webcamReady?"is-active":false},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/webcam/shutter.png",true)}))))))}}]);return t}(a.default);t.default=v;v.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(1);var a=u(o);var s=r(108);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){c(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._bindAll("_onWebcamReady","_onWebcamError");e.state={webcamReady:false};return e}n(t,[{key:"shouldComponentUpdate",value:function e(t,r){return false}},{key:"_onWebcamReady",value:function e(){this.props.onReady&&this.props.onReady();this.setState({webcamReady:true})}},{key:"_onWebcamError",value:function e(t){var r=this;var n=a.default.instance.displayError(this._t("errors.title"),this._t("errors.webcamUnavailable.text",{error:t}));n.on("close",function(){return r.props.onBack()})}},{key:"makePhoto",value:function e(){if(!this.state.webcamReady){return}return this._webcam.capture()}},{key:"renderWithBEM",value:function e(){var t=this;return i.ReactBEM.createElement("div",{bem:"$b:webcam",ref:"container"},i.ReactBEM.createElement(l.default,{flashURL:this._getAssetPath("fallback/webcam.swf"),ref:function e(r){t._webcam=r},onWebcamError:this._onWebcamError,onWebcamAvailable:this._onWebcamReady}))}}]);return t}(i.BaseComponent);t.default=d;d.propTypes={onReady:i.PropTypes.func};d.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r._bindAll("_onLoadedMetadata");r.state={webcamAvailable:false,useFlashFallback:false,containerWidth:null,containerHeight:null};r._getUserMedia=null;r._webcamStream=null;return r}n(t,[{key:"componentDidMount",value:function e(){var t=this;this._initGetUserMedia();this._calculateFlashDimensions();if(this._getUserMedia){this._getUserMedia({video:{optional:[{minWidth:320},{minWidth:640},{minWidth:1024},{minWidth:1280},{minWidth:1920},{minWidth:2560}]},audio:false}).then(function(e){t._webcamStream=e;var r=t._videoElement;if("srcObject"in r){r.srcObject=e}else{r.src=window.URL.createObjectURL(e)}}).catch(function(e){if(t.props.onWebcamError){t.props.onWebcamError(e)}})}else{var r=false;if(!window.Webcam){window.Webcam={};r=true}window.Webcam.flashNotify=function(e,n){switch(e){case"cameraLive":t.setState({webcamAvailable:true},function(){t.props.onWebcamAvailable&&t.props.onWebcamAvailable()});delete window.Webcam.flashNotify;if(r){delete window.Webcam}break;case"error":t.props.onWebcamError&&t.props.onWebcamError(n);delete window.Webcam.flashNotify;if(r){delete window.Webcam}break}}}}},{key:"componentWillUnmount",value:function e(){this._disposeWebcam()}},{key:"_initGetUserMedia",value:function e(){if(navigator.mediaDevices){if(navigator.mediaDevices.getUserMedia){this._getUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices)}}if(!this._getUserMedia){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(t){this._getUserMedia=function(e){return new Promise(function(r,n){return t.call(navigator,e,r,n)})}}}if(!this._getUserMedia){this.setState({useFlashFallback:true})}}},{key:"_disposeWebcam",value:function e(){if(this._webcamStream){var t=this._webcamStream;var r=t.getTracks()[0];if(r){r.stop()}else if(t.stop){t.stop()}}else if(this._flashWebcam){this._flashWebcam._releaseCamera()}}},{key:"capture",value:function e(){var t=this;if(!this.state.webcamAvailable){return Promise.reject(new Error("Webcam video not available"))}if(this._videoElement&&!this._flashWebcam){return new Promise(function(e,r){var n=t._videoElement;if(n.readyState===0){r(new Error("Webcam video not available"))}else{var i=document.createElement("canvas");i.width=n.videoWidth;i.height=n.videoHeight;var o=i.getContext("2d");o.drawImage(n,0,0);var a=new window.Image;a.addEventListener("load",function(){e(a)});a.src=i.toDataURL("image/jpeg")}})}else if(this._flashWebcam){return new Promise(function(e,r){var n=t._flashWebcam._snap();var i=new Image;i.onload=function(){e(i)};i.src="data:image/jpeg;base64,"+n})}return Promise.reject(new Error("Webcam video not available"))}},{key:"_getIEHeight",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var r=this._container;for(var n=0;n<1e3;n++){if(r.clientHeight>t){break}if(r.parentNode){r=r.parentNode}else{break}}return r.clientHeight>t?r.clientHeight:null}},{key:"_calculateFlashDimensions",value:function e(){var t=.9*(this._getIEHeight()||window.innerHeight);var r=4/3*t||640;var n=t||480;this.setState({containerWidth:r,containerHeight:n})}},{key:"_getFlashFallbackComponent",value:function e(){var t=this;var r=this.state.containerWidth||640;var n=this.state.containerHeight||480;var i="width="+r+"&height="+n+"&dest_width=1024&dest_height=768&jpeg_quality=100&fps=24";return React.createElement("object",{classID:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",type:"application/x-shockwave-flash",width:r,height:n,ref:function e(r){t._flashWebcam=r},align:"middle"},React.createElement("param",{name:"wmode",value:"transparent"}),React.createElement("param",{name:"allowScriptAccess",value:"always"}),React.createElement("param",{name:"allowFullScreen",value:"false"}),React.createElement("param",{name:"movie",value:this.props.flashURL}),React.createElement("param",{name:"loop",value:"false"}),React.createElement("param",{name:"menu",value:"false"}),React.createElement("param",{name:"quality",value:"best"}),React.createElement("param",{name:"bgcolor",value:"#ffffff"}),React.createElement("param",{name:"flashvars",value:i}))}},{key:"_onLoadedMetadata",value:function e(){var t=this;this.setState({webcamAvailable:true},function(){t.props.onWebcamAvailable&&t.props.onWebcamAvailable()})}},{key:"render",value:function e(){var t=this;var r=this.state.useFlashFallback?this._getFlashFallbackComponent():React.createElement("video",{style:{width:"100%"},autoPlay:true,ref:function e(r){t._videoElement=r},onLoadedMetadata:this._onLoadedMetadata});return React.createElement("div",{style:{width:this.state.useFlashFallback?this.state.containerWidth:"100%",height:this.state.useFlashFallback?this.state.containerHeight:"100%",display:"block",margin:"auto",overflow:"hidden"},ref:function e(r){t._container=r}},r)}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={flashURL:i.PropTypes.string,onWebcamAvailable:i.PropTypes.func,onWebcamError:i.PropTypes.func}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(42);var s=y(a);var l=r(9);var u=y(l);var c=r(112);var f=y(c);var p=r(1);var d=y(p);var h=r(113);var v=y(h);var _=r(43);var m=y(_);function y(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function b(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function k(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var w=500;var O=function(e){k(t,e);function t(){var e;g(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._overviewControls=s.default;a._bindAll("switchToControls","_startEditor","_onWindowResize","_onWindowResizeDone","_onImageResize","_onNewImage","_onRenderError");a._previousControlsStack=[];a.state={zoom:null,controls:v.default,dragEnabled:true,sharedState:new o.SharedState};a._editor=new m.default(a.context.ui,a.context.options,a.context.mediator);a._editor.on("new-image",a._onNewImage);a._editor.on("ready",a._startEditor);a._editor.on("resize",a._onImageResize);a._editor.on("render-error",a._onRenderError);a._hasUsedForceCrop=false;a._isReady=false;a._forceControls=a.context.options.editor.forceControls;a._forceControlIndex=0;return a}n(t,[{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.options;var o=this.context.options.editor,a=o.image,s=o.forceCrop;this.setImage(a);this._editor.render();this._editor.on("ready",function(){if(s){r._switchToFroceCropControl()}else{r._switchToNextForceControl()}});if(n.responsive){window.addEventListener("resize",this._onWindowResize)}}},{key:"componentWillUnmount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this);this._editor.dispose();var r=this.context.options;if(r.responsive){window.removeEventListener("resize",this._onWindowResize)}}},{key:"_startEditor",value:function e(){this._editor.start()}},{key:"_switchToFroceCropControl",value:function e(){var t=this._editor.controls.getAvailable();var r=t["transform"];if(!r){return}this.switchToControls(r,{},null,{forceCrop:true,firstCrop:true});this._hasUsedForceCrop=true}},{key:"_switchToNextForceControl",value:function e(){if(this._forceControlIndex<this._forceControls.length){var t=this._forceControls[this._forceControlIndex],r=t.control,n=t.options;var i=this._editor.controls.getAvailable();var a=i[r];var s=o.SDKUtils.defaults({forcedControl:true},n);if(!a){throw new Error("Force controls: Could not find control with identifier `"+r+"`")}this.switchToControls(a,{},null,s);this._forceControlIndex++}}},{key:"_onRenderError",value:function e(t){d.default.instance.displayError(this._t("errors.renderingError.title"),this._t("errors.renderingError.text"),true);o.Log.error(this.constructor.name,"An error occurred while rendering: "+t.message)}},{key:"_onNewImage",value:function e(){this.switchToControls(v.default)}},{key:"_onImageResize",value:function e(){var t=this;var r=d.default.instance.displayLoading(this._t("loading.resizing"));this._editor.once("resized",function(e){var n=e.dimensions,i=e.reason;r.close();if(t.context.options.editor.displayResizeMessage){d.default.instance.displayWarning(t._t("warnings.imageResized_"+i+".title"),t._t("warnings.imageResized_"+i+".text",{maxMegaPixels:t._editor.getMaxMegapixels(),width:n.x,height:n.y}))}})}},{key:"_onWindowResize",value:function e(){if(this._resizeTimeout){window.clearTimeout(this._resizeTimeout);this._resizeTimeout=null}this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,w)}},{key:"_onWindowResizeDone",value:function e(){this._emitEvent(o.Constants.EVENTS.WINDOW_RESIZE)}},{key:"switchToControls",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=null;if(t==="back"){s=this._previousControlsStack.pop()}else if(t==="home"||t===v.default){if(this.context.options.editor.forceCrop&&!this._hasUsedForceCrop){return this._switchToFroceCropControl()}if(this._forceControlIndex<this._forceControls.length){return this._switchToNextForceControl()}s=v.default;this._previousControlsStack=[]}else{s=t;this._previousControlsStack.push(this.state.controls)}var l=this.state.controls!==s;if(this.state.controls.onExit){this.state.controls.onExit.call(this.refs.controls)}this.state.sharedState.clear();this.state.sharedState.set(r,false);var u=o.SDKUtils.defaults(o.SDKUtils.defaults(a,this.context.options.editor.controlsOptions[s.identifier]),s.defaultOptions);if(s.onEnter){s.onEnter.call(this.refs.controls,this.state.sharedState,u)}var c=function e(){if(!n._isReady){n._isReady=true;n.context.mediator.emit(o.Constants.EVENTS.EDITOR_READY)}};if(l){this.setState({controls:s,controlsOptions:u},function(){c();i&&i()})}else{c();return i&&i()}}},{key:"getZoom",value:function e(){return this.state.zoom}},{key:"export",value:function e(){var t=this;for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}return new Promise(function(e,r){t.switchToControls("home",{},function(){var i;(i=t._editor).export.apply(i,n).then(e).catch(r)})})}},{key:"getEditor",value:function e(){return this._editor}},{key:"serialize",value:function e(){var t;return(t=this._editor).serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){return this._editor.deserialize(t)}},{key:"_showUndoButton",value:function e(){return this._editor.history.isAvailable()}},{key:"getChildContext",value:function e(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator}}},{key:"setImage",value:function e(t,r){this._forceControlIndex=0;this._editor.setImage(t,r)}},{key:"_renderScreen",value:function e(){var t=this.state.controls.controlsComponent;var r=this.state.controls.canvasControlsComponent;if(!r){r=v.default.canvasControlsComponent}var n=this.state.controls.topBarControlsComponent;if(!n){n=v.default.topBarControlsComponent}var i=void 0,a=void 0,s=void 0;if(n&&this.context.options.showTopBar){s=o.ReactBEM.createElement(n,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:"topBarControls"})}if(t){i=o.ReactBEM.createElement(t,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-controls",ref:"controls"})}if(r){a=o.ReactBEM.createElement(r,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-canvasControls",ref:"canvasControls"})}var l="$b:editorScreen";if(!this.context.options.showHeader){l+=" m:noHeader"}return o.ReactBEM.createElement("div",{bem:l},s,o.ReactBEM.createElement(f.default,{ref:"canvas",largeControls:this.state.controls.largeCanvasControls},a),o.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},o.ReactBEM.createElement("div",{bem:"e:cell"},i)))}}]);return t}(u.default);t.default=O;O.childContextTypes={ui:o.PropTypes.object.isRequired,editor:o.PropTypes.object.isRequired,mediator:o.PropTypes.object.isRequired,options:o.PropTypes.object.isRequired,editorScreen:o.PropTypes.object.isRequired};O.contextTypes=u.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},i.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/back.png",true)}))))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},i.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/tick.png",true)}))))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function u(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c=function(e){u(t,e);function t(){var e,r;s(this,t);for(var n=arguments.length,i=Array(n),u=0;u<n;u++){i[u]=arguments[u]}var c=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));c._bindAll("_onDragStart","_onDragMove","_onDragEnd","_onWindowResize","_onFeaturesUpdated","_onZoomChange");c._events=(r={},a(r,o.Constants.EVENTS.WINDOW_RESIZE,c._onWindowResize),a(r,o.Constants.EVENTS.FEATURES_UPDATED,c._onFeaturesUpdated),r);c._initialRenderDone=false;c.state={canvasPosition:new o.Vector2,canvasOffset:new o.Vector2};return c}n(t,[{key:"_onWindowResize",value:function e(){var t=this.context.editor;var r=t.getSDK();r.resizeTo(this._getContainerDimensions());t.zoom.set("auto")}},{key:"_onFeaturesUpdated",value:function e(t){if(t.indexOf("drag")!==-1){this.forceUpdate()}}},{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var r=this.context.editor;var n=r.getRenderer();var a=this.refs,s=a.canvasCell,l=a.canvas;var u=s.offsetWidth;var c=s.offsetHeight;n.setCanvas(l);n.resizeTo(new o.Vector2(u,c),true);r.zoom.on("set",this._onZoomChange)}},{key:"componentWillUnmount",value:function e(){var t=this.context.editor;t.zoom.off("set",this._onZoomChange)}},{key:"_onZoomChange",value:function e(){this.forceUpdate()}},{key:"_onDragStart",value:function e(t){var r=this.context.editor;if(!r.features.isEnabled("drag"))return;t.preventDefault();this._dragStartPosition=o.Utils.getEventPosition(t.nativeEvent);this._dragInitialOffset=r.getOffset().clone();document.addEventListener("mousemove",this._onDragMove);document.addEventListener("touchmove",this._onDragMove);document.addEventListener("mouseup",this._onDragEnd);document.addEventListener("touchend",this._onDragEnd)}},{key:"_onDragMove",value:function e(t){var r=o.Utils.getEventPosition(t);var n=r.clone().subtract(this._dragStartPosition);var i=this._dragInitialOffset.clone().add(n);var a=this.context.editor;var s=a.getOffset().clone();a.setOffset(i);if(!a.getOffset().equals(s)){a.render()}}},{key:"_onDragEnd",value:function e(t){document.removeEventListener("mousemove",this._onDragMove);document.removeEventListener("touchmove",this._onDragMove);document.removeEventListener("mouseup",this._onDragEnd);document.removeEventListener("touchend",this._onDragEnd)}},{key:"_getContainerDimensions",value:function e(){var t=this.refs.canvasCell;return new o.Vector2(t.offsetWidth,t.offsetHeight)}},{key:"_getDraggableStyle",value:function e(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x}}},{key:"renderWithBEM",value:function e(){var t=null;var r=null;if(this.props.largeControls){r=this.props.children}else{t=this.props.children}var n=this.context.editor;var i=n.isReady()&&n.zoom.get()>n.zoom.getDefault();var a=n.features.isEnabled("drag")&&i;return o.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},o.ReactBEM.createElement("div",{bem:"e:container e:cell",ref:"canvasCell"},o.ReactBEM.createElement("div",{bem:"e:innerContainer",className:a?"is-draggable":null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),t),r))}}]);return t}(o.BaseComponent);t.default=c;c.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(4);var i=f(n);var o=r(114);var a=f(o);var s=r(42);var l=f(s);var u=r(119);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(i.default);v.topBarControlsComponent=a.default;v.controlsComponent=l.default;v.canvasControlsComponent=c.default;t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(12);var a=v(o);var s=r(115);var l=v(s);var u=r(116);var c=v(u);var f=r(117);var p=v(f);var d=r(118);var h=v(d);function v(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var g=function(e){y(t,e);function t(){_(this,t);return m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderContent",value:function e(){var t=null;if(this.context.options.enableUpload){t=i.ReactBEM.createElement(l.default,{app:this.props.app})}var r=null;if(this.context.options.editor.enableZoom){r=i.ReactBEM.createElement(h.default,null)}return i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:"e:left"},t),i.ReactBEM.createElement("div",{bem:"e:right"},i.ReactBEM.createElement(p.default,null),i.ReactBEM.createElement(c.default,null)),r)}}]);return t}(a.default);t.default=g;g.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(26);var a=u(o);var s=r(25);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onNewFile","_onButtonClick");return o}n(t,[{key:"_onNewFile",value:function e(t){var r=this.context.editor;r.reset();r.setImage(t);r.zoom.set("auto")}},{key:"_onButtonClick",value:function e(){var t=this.context.options;var r=t.enableWebcam===false||i.Utils.isMobile();var n=!!t.photoRoll.provider;if(r&&!n){this.refs.upload.open()}else if(n){this.props.app.switchToScreen("photoRoll")}else{this.props.app.switchToScreen("splash")}}},{key:"renderWithBEM",value:function e(){var t=this.context.options;var r=null;if(t.photoRoll.provider){r=this._t("editor.backgroundImage")}else{r=this._t("editor.new")}return i.ReactBEM.createElement("div",null,i.ReactBEM.createElement(l.default,{onNewFile:this._onNewFile,ref:"upload"}),i.ReactBEM.createElement(a.default,{label:r,icon:"editor/new.png",onClick:this._onButtonClick}))}}]);return t}(i.BaseComponent);t.default=d;d.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(1);var a=u(o);var s=r(26);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onButtonClick");return o}n(t,[{key:"_onButtonClick",value:function e(){var t=this;var r=this.context,n=r.options,i=r.editor,o=r.editorScreen;var s=n.editor.export;o.switchToControls("home",null,function(){var e=a.default.instance.displayLoading(t._t("loading.exporting"));setTimeout(function(){i.export(s.download).then(function(){e.close()}).catch(function(r){a.default.instance.displayError(t._t("errors.title"),r.message);e.close()})},100)})}},{key:"renderWithBEM",value:function e(){var t=this.context.options;if(!t.editor.export.showButton)return null;return i.ReactBEM.createElement(l.default,{style:"blue",label:this._t("editor.export"),icon:"editor/export.png",onClick:this._onButtonClick})}}]);return t}(i.BaseComponent);t.default=d;d.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(26);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e,r;u(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++){o[a]=arguments[a]}var s=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));s._bindAll("_onButtonClick","_onHistoryUpdated","_onFeaturesUpdated");s._events=(r={},l(r,i.Constants.EVENTS.HISTORY_UPDATED,s._onHistoryUpdated),l(r,i.Constants.EVENTS.FEATURES_UPDATED,s._onFeaturesUpdated),r);return s}n(t,[{key:"_onFeaturesUpdated",value:function e(){this.forceUpdate()}},{key:"_onHistoryUpdated",value:function e(){this.forceUpdate()}},{key:"_onButtonClick",value:function e(){var t=this.context.editor;t.history.undo()}},{key:"renderWithBEM",value:function e(){var t=this.context.editor;if(!t.history.isAvailable())return null;return i.ReactBEM.createElement(a.default,{label:this._t("editor.undo"),icon:"editor/undo.png",onClick:this._onButtonClick})}}]);return t}(i.BaseComponent);t.default=p;p.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){var e,r;a(this,t);for(var n=arguments.length,l=Array(n),u=0;u<n;u++){l[u]=arguments[u]}var c=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l)));c._bindAll("_onZoomOutClick","_onZoomInClick","_onZoomDone","_onFeaturesUpdated");c._events=(r={},o(r,i.Constants.EVENTS.ZOOM_DONE,c._onZoomDone),o(r,i.Constants.EVENTS.FEATURES_UPDATED,c._onFeaturesUpdated),r);return c}n(t,[{key:"_onFeaturesUpdated",value:function e(){this.forceUpdate()}},{key:"_onZoomDone",value:function e(){this.forceUpdate()}},{key:"_onZoomOutClick",value:function e(t){var r=this.context.editor;if(!r.features.isEnabled("zoom"))return;r.zoom.out()}},{key:"_onZoomInClick",value:function e(t){var r=this.context.editor;if(!r.features.isEnabled("zoom"))return;r.zoom.in()}},{key:"renderWithBEM",value:function e(){var t=this.context.editor;var r=t.zoom.get();var n=t.features.isEnabled("zoom");return i.ReactBEM.createElement("bem",{specifier:"b:editorScreen"},i.ReactBEM.createElement("div",{bem:"$e:zoom"},i.ReactBEM.createElement("div",{bem:"$e:button m:zoomOut",onClick:this._onZoomOutClick,className:n?null:"is-disabled"},i.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/minus.png",true)})),i.ReactBEM.createElement("div",{bem:"e:label"},this._t("editor.zoom"),i.ReactBEM.createElement("br",null),Math.round(r*100),"%"),i.ReactBEM.createElement("div",{bem:"$e:button m:zoomIn",onClick:this._onZoomInClick,className:n?null:"is-disabled"},i.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/plus.png",true)}))))}}]);return t}(i.BaseComponent);t.default=u;u.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(10);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onClick");return o}n(t,[{key:"_onClick",value:function e(t){this._performHitTest(i.Utils.getEventPosition(t))}},{key:"_getContainerStyle",value:function e(){if(!this.context.editor.isReady()){return{left:0,top:0,width:1,height:1}}var t=this.context.editor.getSDK().getSprite().getBounds(),r=t.x,n=t.y,i=t.width,o=t.height;return{left:r,top:n,width:i,height:o}}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:canvasControls e:container m:full",ref:"container"},i.ReactBEM.createElement("div",{bem:"$b:canvasControls e:innerContainer",ref:"innerContainer",style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}))}}]);return t}(a.default);t.default=f;f.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(121);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(t,r,n){l(this,e);this._sdk=t;this._options=r;this._download=n}n(e,[{key:"export",value:function e(){var t=this;var r=this._getRenderType();return this._sdk.export(r,this._options.format,this._options.quality).then(function(e){if(t._download){t._downloadData(r,e)}return e})}},{key:"_downloadData",value:function e(t,r){switch(t){case i.RenderType.DATAURL:a.default.downloadDataURL(r,this._options.fileBasename);break;case i.RenderType.MSBLOB:a.default.downloadMSBlob(r,this._options.fileBasename);break}}},{key:"_getRenderType",value:function e(){var t=this._options;if(t.type!==i.RenderType.IMAGE||!this._download){return t.type}else{if(i.Utils.supportsMSBlob()){return i.RenderType.MSBLOB}else{return i.RenderType.DATAURL}}}}]);return e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(){o(this,e)}n(e,null,[{key:"downloadDataURL",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"photoeditorsdk-export";var n=this.createBlobURLFromDataURL(t);var i=this.getExtensionFromDataURL(t);var o=document.createElement("a");o.download=r+"."+i;o.href=n;document.body.appendChild(o);o.click();document.body.removeChild(o)}},{key:"downloadMSBlob",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"photoeditorsdk-export";navigator.msSaveBlob(t,r+".png")}},{key:"getExtensionFromDataURL",value:function e(t){var r=t.split(",")[0].split(":")[1].split(";")[0];return r.split("/").pop()}},{key:"createBlobURLFromDataURL",value:function e(t){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array){return t}var r=i.Base64.decode(t.split(",")[1]);var n=t.split(",")[0].split(":")[1].split(";")[0];var o=new ArrayBuffer(r.length);var a=new Uint8Array(o);for(var s=0;s<r.length;s++){a[s]=r[s]}var l=new window.Blob([o],{type:n});return window.URL.createObjectURL(l)}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r,n){o(this,e);this._image=t;this._maxPixels=r;this._maxDimensions=n}n(e,[{key:"needsResize",value:function e(){var t=new i.Vector2(this._image.width,this._image.height);var r=t.x*t.y;var n=r>this._maxPixels;var o=this._maxDimensions!==null&&(t.x>this._maxDimensions||t.y>this._maxDimensions);return n||o}},{key:"resize",value:function e(){var t=this;var r=null;var n=null;var o=this._maxDimensions;return new i.Promise(function(e,a){window.setTimeout(function(){var a=new i.Vector2(t._image.width,t._image.height);var s=a.clone();if(s.x*s.y>t._maxPixels){s.copy(t._getDimensionsByMaxPixels());r="maxMegaPixels"}if(o!==null&&(s.x>o||s.y>o)){var l=Math.min(o/s.x,o/s.y);s.multiply(l);r="maxDimensions"}s.floor();n=t._createResizedImageCanvas(s);e({canvas:n,dimensions:s,reason:r})},1e3)})}},{key:"_createResizedImageCanvas",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t;var n=this._image;var i=document.createElement("canvas");i.width=t.x;i.height=t.y;var o=t.clone().subtract(r).divide(2);var a=i.getContext("2d");a.drawImage(n,0,0,n.width,n.height,o.x,o.y,r.x,r.y);return i}},{key:"_getDimensionsByMaxPixels",value:function e(){var t=this._image;var r=this._maxPixels;var n=t.width/t.height;var o=t.height/t.width;return new i.Vector2(Math.sqrt(r*n),Math.sqrt(r*o)).floor()}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(7);var o=s(i);var a=r(0);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(t,r,n){l(this,e);this._editor=t;this._sdk=r;this._mediator=n;this._map={};this._stack=this._sdk&&this._sdk.getOperationsStack();this._preferredOrder=this._editor.getOptions().editor.operationsOrder;this._available={};var i=o.default.Operations;for(var a in i){var s=i[a];this._available[s.identifier]=s}var u=t.getOptions();var c=u.extensions.operations;for(var f in c){var p=c[f];this._available[p.identifier]=p}if(this._stack){this._fixStack()}}n(e,[{key:"exists",value:function e(t){return!!this._map[t]}},{key:"add",value:function e(t){var r=this;var n=t.constructor.identifier;t.on("update",function(){r._mediator.emit(a.Constants.EVENTS.OPERATION_UPDATED,t)});var i=this._preferredOrder.indexOf(n);if(i===-1){throw new Error("EditorOperations#add: `"+n+"` does not appear in `operationsOrder`")}this._stack.set(i,t);this._map[n]=t;this._mediator.emit(a.Constants.EVENTS.OPERATION_CREATED,t)}},{key:"remove",value:function e(t){var r=t.constructor.identifier;var n=this._stack.getStack();delete this._map[r];var i=n.map(function(e){return e.constructor.identifier}).indexOf(t.constructor.identifier);if(i!==-1){this._stack.removeAt(i);for(var o=i+1;o<n.length;o++){var s=n[o];if(!s)continue;s.setDirty(true)}this._mediator.emit(a.Constants.EVENTS.OPERATION_REMOVED,t)}}},{key:"get",value:function e(t){return this._map[t]}},{key:"getOrCreate",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(this._map[t]){var n=this._map[t];n.set(r,false);return n}else{var i=this._available[t];var o=new i(this._sdk,r);this.add(o);return o}}},{key:"getStack",value:function e(){return this._stack}},{key:"isAvailable",value:function e(t){return!!this._available[t]}},{key:"getAvailable",value:function e(){return this._available}},{key:"reset",value:function e(){this._map={}}},{key:"_fixStack",value:function e(){var t=this;var r=this._stack.getStack().slice();this._stack.clear();r.forEach(function(e){t.add(e)})}}]);return e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(44);var o=s(i);var a=r(0);function s(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function e(t,r,n){l(this,e);this._editor=t;this._sdk=r;this._mediator=n;this._invalidOperationsSeen=[];this._options=this._editor.getOptions();this._available=a.SDKUtils.extend({},o,this._options.extensions.controls)}n(e,[{key:"isEnabled",value:function e(t){var r=this;var n=this.get(t);if(!n){a.Log.info("EditorControls#isEnabled: Unknown control: "+t);return false}var i=n.requiredOperations||[];var o=[];i.forEach(function(e){if(!r._editor.operations.isAvailable(e)){o.push(e)}});if(o.length){if(this._invalidOperationsSeen.indexOf(t)===-1){this._invalidOperationsSeen.push(t);a.Log.error("Control `"+t+"` can not be used because "+(o.length===1?"operation is":"operations are")+" missing: "+o.map(function(e){return"`"+e+"`"}).join(", "))}return false}return n.isAvailable&&n.isAvailable(this._editor)}},{key:"get",value:function e(t){return this._available[t]}},{key:"getAvailable",value:function e(){return this._available}}]);return e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=l(i);var a=r(126);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=["brightness","clarity","contrast","exposure","highlights","saturation","shadows","gamma"];var d=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.exists("adjustments");var i=r.operations.getOrCreate("adjustments");var o=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:o})}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("adjustment")&&p.filter(function(e){return t.isToolEnabled(e)}).length>0}},{key:"getPreloadAssets",value:function e(t){return p.filter(function(e){return t.isToolEnabled(e)}).map(function(e){return"controls/adjustments/"+e+".png"})}}]);return t}(o.default);d.controlsComponent=s.default;d.identifier="adjustments";d.iconPath="controls/overview/adjustments.png";d.languageKey="controls.overview.adjustments";d.defaultOptions={};d.requiredOperations=["adjustments"];t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(3);var s=h(a);var l=r(2);var u=h(l);var c=r(6);var f=h(c);var p=r(127);var d=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function m(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var y=o.SDK.Operations.AdjustmentsOperation;var g=["brightness","saturation","contrast","gamma","clarity","exposure","shadows","highlights"];var b=function(e){m(t,e);function t(){var e;v(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onSliderValueChange");var a=o.context.editor;o._operation=a.operations.getOrCreate("adjustments");o.state={selectedControls:null};return o}n(t,[{key:"_onBackClick",value:function e(r){var n=this.context.editor;var o=this.getSharedState("operationExistedBefore");var a=this.getSharedState("initialOptions");if(!this._operation.optionsEqual(a)){n.history.add(this._operation,a,o)}var s=this._operation.getDefaultOptions();if(this._operation.optionsEqual(s)){n.operations.remove(this._operation)}i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onBackClick",this).call(this,r)}},{key:"_onSliderValueChange",value:function e(t){var r=this.state.selectedControls;var n=y.prototype.availableOptions[r];var i=n.minValue,o=n.midValue,a=n.maxValue;t=t<0?o+(o-i)*t/100:o+(a-o)*t/100;this._operation.setOption(r,t);var s=this.context.editor;s.render()}},{key:"_onButtonClick",value:function e(t,r){this.setState({selectedControls:t})}},{key:"_buildSliderProps",value:function e(t){var r=y.prototype.availableOptions[t];var n=r.minValue,i=r.midValue,o=r.maxValue;var a=this._operation?this._operation.getOption(t):i;var s=(a<=i?(a-n)/(i-n)-1:(a-i)/(o-i))*100;return{minValue:-100,maxValue:100,value:s,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.adjustments."+t),middleDot:true,onChange:this._onSliderValueChange}}},{key:"renderOverlayControls",value:function e(){var t=this.state.selectedControls;if(!t)return;var r=this._buildSliderProps(t);return o.ReactBEM.createElement(f.default,r)}},{key:"_renderListItems",value:function e(){var t=this;return g.filter(function(e){return t.context.editor.isToolEnabled(e)}).map(function(e){var r=t.state.selectedControls===e;var n=r?"is-active":null;var i=void 0;if(!r&&false){var a=t._buildSliderProps(e);i=o.ReactBEM.createElement("bem",{specifier:"b:adjustmentsControls"},o.ReactBEM.createElement("div",{bem:"e:miniSlider"},o.ReactBEM.createElement(d.default,a)))}return o.ReactBEM.createElement("li",{bem:"e:item",key:e,"data-identifier":e},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:t._onButtonClick.bind(t,e),className:n},o.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/adjustments/"+e+".png",true)}),o.ReactBEM.createElement("div",{bem:"e:label"},t._t("controls.adjustments."+e)),i)))})}},{key:"renderControls",value:function e(){var t=this._renderListItems();return o.ReactBEM.createElement("div",{bem:"e:cell m:list"},o.ReactBEM.createElement(u.default,null,o.ReactBEM.createElement("ul",{bem:"$e:list"},t)))}}]);return t}(s.default);t.default=b;b.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){var e;a(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o.state={value:o.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0};return o}i(t,[{key:"componentDidMount",value:function e(){this._setValue(this.state.value,false)}},{key:"componentWillReceiveProps",value:function e(t){if(t.value!==this.state.value){this._setValue(t.value,false)}}},{key:"_getKnobStyle",value:function e(){return{left:this.state.sliderPosition}}},{key:"_getForegroundStyle",value:function e(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}}},{key:"_displayMiddleDot",value:function e(){return this.props.middleDot!==false}},{key:"_setValue",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;t=Math.round(t);var n=this.props,i=n.minValue,o=n.maxValue;var a=(t-i)/(o-i);var s=this.refs.bar;var l=s.offsetWidth;var u=l*a;var c=a*l;var f=0;if(this._displayMiddleDot()){c=Math.abs(a-.5)*l;f=a<.5?l*.5-c:"50%"}this.setState({value:t,sliderPosition:u,foregroundWidth:c,foregroundLeft:f})}},{key:"renderWithBEM",value:function e(){var t={style:this._getForegroundStyle()};return o.ReactBEM.createElement("div",{bem:"$b:miniSlider"},o.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},o.ReactBEM.createElement("div",{bem:"$e:background"}),o.ReactBEM.createElement("div",n({bem:"$e:foreground"},t)),o.ReactBEM.createElement("div",{bem:"e:knob",style:this._getKnobStyle()})))}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(4);var a=d(o);var s=r(129);var l=d(s);var u=r(130);var c=d(u);var f=r(131);var p=d(f);function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){_(t,e);function t(){h(this,t);return v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.exists("transform");var o=r.operations.getOrCreate("transform");o.setEnabled(false,false);var a=r.operations.exists("orientation");var s=r.operations.getOrCreate("orientation");var l={end:new i.Vector2(1,1),rotation:0,start:new i.Vector2(0,0),textureScale:1};var u=o.getInputDimensions(false);var c=o.getNewDimensions(u);var f=l;if(n){f=o.serializeOptions();delete f.enabled;var p=f,d=p.start,h=p.end,v=p.rotation;var _=o.calculateScale(v);var m=o.getInputDimensions(false);var y=Math.cos(v);var g=Math.sin(v);var b=h.clone().subtract(d).divide(2);var k=d.clone().add(b).multiply(m);var w=k.subtract(m.clone().multiply(.5));var O=new i.Vector2(w.x*y-w.y*g,w.x*g+w.y*y).multiply(_);var E=m.clone().multiply(.5).add(O);var S=E.clone().divide(m);var P=S.clone().subtract(b.clone().multiply(_));var C=S.clone().add(b.clone().multiply(_));f.start=P;f.end=C}r.broadcastTransform(o,l);var M=s.serializeOptions();var j=[10,0,58+10,0];r.setSpriteScale(o.calculateScale());r.setRotation(f.rotation);r.setPadding(j);o.set(l,n);r.zoom.set("auto",function(){r.features.disable("zoom","drag")},false);this.setSharedState({initialTransformOptions:f,initialOrientationOptions:M,operation:o,orientationOperation:s,activePadding:j,orientationOperationExistedBefore:a,transformOperationExistedBefore:n,start:i.Vector2.fromObject(f.start),end:i.Vector2.fromObject(f.end),rotation:f.rotation,orientationRotation:s.getRotation(),flipVertically:s.getFlipVertically(),flipHorizontally:s.getFlipHorizontally(),initialDimensions:c,inputDimensions:u})}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("transform")&&t.isToolEnabled("transform")}},{key:"getPreloadAssets",value:function e(t){var r=t.getOptions();var n=i.SDKUtils.defaults(r.editor.controlsOptions.transform,this.defaultOptions);var o=["controls/transform/rotate-ccw.png","controls/transform/rotate-cw.png","controls/transform/flip-h.png","controls/transform/flip-v.png"];var a=l.default.getRatios(n);a.forEach(function(e){if(Array.isArray(e)){e.forEach(function(e){var t=e.identifier;o.push("controls/transform/"+t+".png")})}else{o.push("controls/transform/"+e.identifier+".png")}});return o}}]);return t}(a.default);m.topBarControlsComponent=p.default;m.controlsComponent=l.default;m.canvasControlsComponent=c.default;m.identifier="transform";m.iconPath="controls/overview/transform.png";m.languageKey="controls.overview.transform";m.defaultOptions={};m.requiredOperations=["transform"];t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(3);var s=p(a);var l=r(2);var u=p(l);var c=r(6);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){_(t,e);function t(){var e;h(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_selectRatio","_onRotationChange","_reapplyRatio");a.state={ratio:null};a._ratios=a.constructor.getRatios(a.props.options);a._events=d({},o.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO,a._reapplyRatio);a._selectInitialRatio(!a.getSharedState("transformOperationExistedBefore"));return a}n(t,[{key:"shouldSharedComponentUpdate",value:function e(t,r){return t.ratio!==r.ratio}},{key:"_onRotationChange",value:function e(t){var r=this.getSharedState("operation");var n=this.context.editor;t=t*Math.PI/180;n.setRotation(t);n.setSpriteScale(r.calculateScale(t));n.render();this.setSharedState({rotation:t})}},{key:"_getRotatedSpriteDimensions",value:function e(){var t=this.context.editor;var r=t.getRotation();var n=t.getOutputDimensions(false);return new o.Vector2(Math.abs(n.x*Math.cos(r))+Math.abs(n.y*Math.sin(r)),Math.abs(n.x*Math.sin(r))+Math.abs(n.y*Math.cos(r)))}},{key:"_calculateTextureScale",value:function e(){var t=this.getSharedState("operation");var r=this.getSharedState("ratio");if(!r||!r.dimensions){return 1}var n=this.getSharedState("start");var i=this.getSharedState("end");var o=i.clone().subtract(n);var a=t.getInputDimensions(false).multiply(o);return r.dimensions.x/a.x}},{key:"_getHistoryItems",value:function e(){var t=[];var r=this._getTransformHistoryItem();if(r){t.push(r)}var n=this._getOrientationHistoryItem();if(n){t.push(n)}return t}},{key:"_getTransformHistoryItem",value:function e(){var t=this.context.editor;var r=this.getSharedState("operation");var n=this.getSharedState("initialTransformOptions");var i=this.getSharedState("transformOperationExistedBefore");if(!r.optionsEqual(n)){return{operation:r,options:n,existent:i,undo:function e(r,n){t.broadcastTransform(r,n)}}}}},{key:"_getOrientationHistoryItem",value:function e(){var t=this.context.editor;var r=this.getSharedState("orientationOperation");var n=this.getSharedState("initialOrientationOptions");var i=this.getSharedState("orientationOperationExistedBefore");if(!r.optionsEqual(n)){return{operation:r,options:n,existent:i,undo:function e(r,n){if(r.getRotation()!==n.rotation){t.broadcastRotate(n.rotation-r.getRotation())}var i=n.rotation;var o=i===90||i===270;if(r.getFlipVertically()!==n.flipVertically){t.broadcastFlip(o?"horizontal":"vertical")}else if(r.getFlipHorizontally()!==n.flipHorizontally){t.broadcastFlip(o?"vertical":"horizontal")}}}}}},{key:"_reapplyRatio",value:function e(){var t=this.getSharedState("ratio");this._selectRatio(t)}},{key:"_onBackClick",value:function e(r){var n=this.context.editor;var a=this.getSharedState("ratio");var s=this.getSharedState("operation");var l=this.getSharedState("orientationOperation");var u=n.getRotation();var c=this.getSharedState("start").clone();var f=this.getSharedState("end").clone();if((a===null||c.equals(0,0)&&f.equals(1,1))&&u===0){n.operations.remove(s)}else{var p=this._calculateTextureScale();var d={rotation:u,start:c,end:f,textureScale:p,enabled:true};var h=s.calculateScale(u);var v=s.getInputDimensions(false);var _=Math.cos(-u);var m=Math.sin(-u);var y=f.clone().subtract(c).divide(2);var g=c.clone().add(y).multiply(v);var b=g.subtract(v.clone().multiply(.5));var k=new o.Vector2(b.x*_-b.y*m,b.x*m+b.y*_).divide(h);var w=v.clone().multiply(.5).add(k);var O=w.clone().divide(v);d.start=O.clone().subtract(y.clone().divide(h));d.end=O.clone().add(y.clone().divide(h));n.broadcastTransform(s,d);s.set(d)}if(l.getRotation()===0&&!l.getFlipVertically()&&!l.getFlipHorizontally()){n.operations.remove(l)}n.setPadding(false);n.setRotation(0);n.setSpriteScale(1);var E=this._getHistoryItems();if(E.length){var S=this.props.options,P=S.forceCrop,C=S.firstCrop;if(!P&&!C){n.history.add(E)}}n.features.enable("zoom","drag");n.zoom.set("auto");i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onBackClick",this).call(this,r)}},{key:"_selectInitialRatio",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var r=this.getSharedState("operation");var n=null;var i=o.SDKUtils.Array.flatten(this._ratios);var a=r._ratio;if(a){var s=i.filter(function(e){return e===a});n=s[0]}if(!n){var l=i.filter(function(e){return e.selected});n=l.pop()}if(!n){n=i[0]}return this._selectRatio(n,t,false)}},{key:"_selectRatio",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var i=this.getSharedState("operation");if(r&&t){this._setDefaultOptionsForRatio(t,n)}i._ratio=t;var a={ratio:t};var s=this.context.editor;if(!t){s.setPadding(false);s.setRotation(0);s.setSpriteScale(1);a.rotation=0;a.start=new o.Vector2(0,0);a.end=new o.Vector2(1,1)}else{s.setPadding(this.getSharedState("activePadding"))}s.render();this.setSharedState(a,n)}},{key:"_setDefaultOptionsForRatio",value:function e(t){var r=t.ratio,n=t.name,i=t.dimensions;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var s=this.context.editor;var l=new o.Vector2;var u=new o.Vector2;if(i&&!r){r=i.x/i.y}if(r==="*"){l=new o.Vector2(0,0);u=new o.Vector2(1,1)}else{var c=s.getOutputDimensions();var f=c.x/c.y;if(f<=r){var p=1/c.y*(c.x/r);l.set(0,(1-p)/2);u.set(1,1-l.y)}else{var d=1/c.x*(r*c.y);l.set((1-d)/2,0);u.set(1-l.x,1)}}this.setSharedState({start:l,end:u},a)}},{key:"renderOverlayControls",value:function e(){var t=this.getSharedState("rotation")*180/Math.PI;if(!this.getSharedState("ratio"))return null;return o.ReactBEM.createElement(f.default,{value:t,minValue:-45,middleDot:true,maxValue:45,valueUnit:"°",label:this._t("controls.transform.rotation"),onChange:this._onRotationChange})}},{key:"_renderListItems",value:function e(){var t=this;var r=[];var n=function e(r){return o.ReactBEM.createElement("li",{bem:"e:item",key:r.identifier,"data-identifier":r.identifier},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t.getSharedState("ratio")===r?"is-active":null,onClick:t._selectRatio.bind(t,r)},o.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/transform/"+r.identifier+".png",true)}),o.ReactBEM.createElement("div",{bem:"e:label"},t._t("controls.transform.ratios."+r.identifier)||r.defaultName))))};this._ratios.forEach(function(e){if(Array.isArray(e)){var t=e;var i=[];t.forEach(function(e){i.push(n(e))});if(i.length){r.push(i)}}else{var o=e;r.push(n(o))}});var i=[];r.forEach(function(e){i=i.concat(e);if(Array.isArray(e)&&e!==r[r.length-1]){i.push(o.ReactBEM.createElement("li",{bem:"e:separator"}))}});var a=o.ReactBEM.createElement("li",{bem:"e:item","data-identifier":"none",key:"noTransform"},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:!this.getSharedState("ratio")?"is-active":null,onClick:this._selectRatio.bind(this,null)},o.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/no-transform.png",true)}),o.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.transform.none")))));var s=this.context.options;return s.editor.forceCrop?i:[a,o.ReactBEM.createElement("li",{bem:"e:separator"})].concat(i)}},{key:"renderControls",value:function e(){var t=this._renderListItems();return o.ReactBEM.createElement("div",{bem:"e:cell m:list"},o.ReactBEM.createElement(u.default,null,o.ReactBEM.createElement("ul",{bem:"$e:list"},t)))}}],[{key:"getRatios",value:function e(t){var r=t.ratios,n=t.replaceRatios,i=t.availableRatios;r=r||[];var a=void 0;a=o.Constants.DEFAULTS.TRANSFORM_RATIOS;if(n){a=r}else{a=a.concat(r)}if(i&&i.length){var s=function e(t){if(Array.isArray(t)){return t.map(e).filter(function(e){return e})}else{if(i.indexOf(t.identifier)===-1){return null}else{return t}}};a=a.map(s).filter(function(e){return e})}return a}}]);return t}(s.default);t.default=m;m.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(5);var a=u(o);var s=r(10);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=new i.Vector2(50,50);var h=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._needsStyleFixes=true;o._bindAll("_onCenterDragStart","_onCenterDrag");o.state={dimensions:o.getSharedState("initialDimensions")};return o}n(t,[{key:"fixStyles",value:function e(){if(i.Utils.Browser.isIElte(11)){var t=this.context.editor;var r=this.refs.container;var n=t.getCanvasDimensions(false);var o=n.y;r.style.height=o+"px"}}},{key:"sharedStateDidChange",value:function e(t){if(t!==this.getSharedState("ratio")){this._updateDimensions()}}},{key:"_updateDimensions",value:function e(){var t=this.getSharedState("operation");var r=this.getSharedState("ratio")||{ratio:"*"};var n=void 0;if(r.dimensions){n=r.dimensions.clone()}else{var i=t.getInputDimensions(false);var o=this.getSharedState("start");var a=this.getSharedState("end");var s=a.clone().subtract(o);n=s.multiply(i).floor()}this.setState({dimensions:n})}},{key:"_onCenterDragStart",value:function e(){var t=this.getSharedState("start");var r=this.getSharedState("end");this._initialValues={start:t.clone(),end:r.clone(),size:r.clone().subtract(t)}}},{key:"_onCenterDrag",value:function e(t){var r=this.context.editor;var n=this._initialValues,o=n.start,a=n.size;var s=r.getOutputDimensions();var l=t.clone().divide(s);var u=new i.Vector2(0,0);var c=new i.Vector2(1,1).subtract(a);var f=o.clone().add(l).clamp(u,c);var p=f.clone().add(a);this.setSharedState({start:f,end:p})}},{key:"_onKnobDragStart",value:function e(t){this._currentDragOption=t;this._initialValues={start:this.getSharedState("start").clone(),end:this.getSharedState("end").clone()}}},{key:"_onKnobDrag",value:function e(t,r){var n=this.context.editor;var o=n.getOutputDimensions();var a=this.getSharedState("ratio")||{ratio:"*"},s=a.ratio,l=a.dimensions;if(l&&!s){s=l.x/l.y}var u=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(o);var c=void 0;if(t==="start"){u.subtract(r);c=this._initialValues.end.clone().multiply(o)}else if(t==="end"){u.add(r);c=new i.Vector2(1,1).subtract(this._initialValues.start).multiply(o)}var f=o;if(typeof s!=="undefined"&&s!=="*"){if(s>o.x/o.y){f=new i.Vector2(o.x,o.x/s)}else{f=new i.Vector2(o.y*s,o.y)}}u.x=Math.min(Math.max(Math.min(d.x,f.x),u.x),c.x);if(s!=="*"){u.y=u.x/s}u.y=Math.min(Math.max(Math.min(d.y,f.y),u.y),c.y);if(s!=="*"){u.x=u.y*s}if(t==="start"){var p=this._initialValues.end.clone().subtract(u.clone().divide(o));this.setSharedState({start:p},false);this._updateDimensions()}else if(t==="end"){var h=this._initialValues.start.clone().add(u.clone().divide(o));this.setSharedState({end:h},false);this._updateDimensions()}}},{key:"_calculateDimensions",value:function e(){var t=this.context.editor;var r=this.getSharedState("start");var n=this.getSharedState("end");return n.clone().subtract(r).multiply(t.getInputDimensions(false)).round()}},{key:"_getAreaStyles",value:function e(){var t=this.context.editor;var r=t.getOutputDimensions();var n=t.getCanvasDimensions();var i=this.getSharedState("start").clone().multiply(r).floor();var o=this.getSharedState("end").clone().multiply(r).ceil();var a=o.clone().subtract(i);var s=n.clone().subtract(r).divide(2).floor();var l=t.getPadding();i.add(s).add(0,l[0]);return{topLeft:this._getDimensionsStyles(i.x,i.y),topCenter:this._getDimensionsStyles(a.x,i.y),centerLeft:this._getDimensionsStyles(i.x,a.y),center:this._getDimensionsStyles(a.x,a.y)}}},{key:"_getDimensionsStyles",value:function e(t,r){return{width:Math.max(1,t),height:Math.max(1,r)}}},{key:"renderWithBEM",value:function e(){var t=this.getSharedState("ratio");var r=this.state.dimensions;var n=void 0;if(t){var o=this._getAreaStyles();n=i.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},i.ReactBEM.createElement("div",{bem:"e:row"},i.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:o.topLeft}," "),i.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:o.topCenter}," "),i.ReactBEM.createElement("div",{bem:"e:cell m:dark"})),i.ReactBEM.createElement("div",{bem:"e:row"},i.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:o.centerLeft}," "),i.ReactBEM.createElement(a.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},i.ReactBEM.createElement("div",{bem:"e:cell m:bordered",style:o.center},i.ReactBEM.createElement(a.default,{onStart:this._onKnobDragStart.bind(this,"start"),onDrag:this._onKnobDrag.bind(this,"start")},i.ReactBEM.createElement("div",{bem:"e:knob m:topLeft $b:knob"},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",true)}))),i.ReactBEM.createElement("div",{bem:"e:dimensions"},r.x+"x"+r.y),i.ReactBEM.createElement(a.default,{onStart:this._onKnobDragStart.bind(this,"end"),onDrag:this._onKnobDrag.bind(this,"end")},i.ReactBEM.createElement("div",{bem:"e:knob m:bottomRight $b:knob"},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",true)}))))),i.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," ")),i.ReactBEM.createElement("div",{bem:"e:row"},i.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," "),i.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," "),i.ReactBEM.createElement("div",{bem:"e:cell m:dark"}," ")))}else{n=i.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},i.ReactBEM.createElement("div",{bem:"e:dimensions"},r.x+"x"+r.y))}return i.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container"},n)}}]);return t}(l.default);t.default=h;h.contextTypes=l.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(12);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_onRotateClick",value:function e(t){var r=void 0;if(t==="cw"){r=90}else if(t==="ccw"){r=-90}var n=this.context.editor;var o=this.getSharedState("orientationOperation");var a=(o.getRotation()+r)%360;o.set({rotation:a});var s={orientationRotation:a};var l=this.getSharedState("ratio");if(l&&!l.dimensions){var u=this.getSharedState("start");var c=this.getSharedState("end");var f=u.clone();if(t==="cw"){u.set(1-c.y,f.x);c.set(1-f.y,c.x)}else if(t==="ccw"){u.set(f.y,1-c.x);c.set(c.y,1-f.x)}s.start=u;s.end=c}if(l&&l.dimensions){this._emitEvent(i.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO)}this.setSharedState(s);n.broadcastRotate(r);n.zoom.set("auto")}},{key:"_onFlipClick",value:function e(t){var r;var n=this.context.editor;var i=this.getSharedState("orientationOperation");var o=!this.getSharedState("flip"+t);var a=this.getSharedState("rotation")*-1;this.setSharedState((r={},l(r,"flip"+t,o),l(r,"rotation",a),r));n.setRotation(a);i.flip(t);var s=this.getSharedState("start");var u=this.getSharedState("end");var c=s.clone();if(t==="horizontal"){s.set(1-u.x,s.y);u.set(1-c.x,u.y)}else if(t==="vertical"){s.set(s.x,1-u.y);u.set(u.x,1-c.y)}this.setSharedState({start:s,end:u});n.broadcastFlip(t);n.render()}},{key:"shouldSharedComponentUpdate",value:function e(t,r){return false}},{key:"renderContent",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"$b:topBar"},i.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"vertical")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-v.png",true)})),i.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"horizontal")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-h.png",true)})),i.ReactBEM.createElement("div",{bem:"e:space"}),i.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"ccw")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-ccw.png",true)})),i.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"cw")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-cw.png",true)})))}}]);return t}(a.default);t.default=p;p.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(4);var a=f(o);var s=r(133);var l=f(s);var u=r(27);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.exists("filter");var i=r.operations.getOrCreate("filter");var o=i.serializeOptions(["identifier","filter","intensity"]);this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:o})}},{key:"onExit",value:function e(){var t=this.getSharedState("initialOptions");var r=this._operation.getFilter().constructor;var n=t.filter.constructor;var i=void 0;if(n.identifier==="3d-lut"){i=t.filter.getImage()}var o=this._operation.getIntensity();if(this._operation.getIdentifier()!==t.identifier||o!==t.intensity){var a=this.context.editor;a.history.add(this._operation,{identifier:t.identifier,intensity:o},this.getSharedState("operationExistedBefore"),function(){var e=a.operations.getOrCreate("filter");if(n.identifier==="3d-lut"){e.setFilter(new n({image:i}))}else{e.setFilter(new n)}})}if(r.isIdentity){var s=this.context.editor;s.operations.remove(this._operation)}}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("filter")&&t.isToolEnabled(this.identifier)}},{key:"getPreloadAssets",value:function e(t){var r=t.getOptions();var n=i.SDKUtils.defaults(r.editor.controlsOptions.filter,this.defaultOptions);var o=new c.default(t.getUI(),n);var a=[];var s=o.getCategories();s.forEach(function(e){a.push("controls/filters/categories/"+e.identifier+".png");var t=o.getFiltersForCategory(e.identifier);t.forEach(function(e){a.push("controls/filters/"+e.identifier+".png");if(e.lutImage){a.push([e.lutImage,false,false])}})});return a}}]);return t}(a.default);v.controlsComponent=l.default;v.identifier="filter";v.iconPath="controls/overview/filters.png";v.languageKey="controls.overview.filters";v.defaultOptions={categories:[],replaceCategories:false,availableFilters:null,hideCategories:false};v.requiredOperations=["filter"];t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(3);var a=v(o);var s=r(2);var l=v(s);var u=r(45);var c=v(u);var f=r(6);var p=v(f);var d=r(27);var h=v(d);function v(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function y(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function g(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var b=i.SDK.Operations.FilterOperation.Filters;var k=function(e){g(t,e);function t(){var e;m(this,t);for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}var a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onItemClick","_onOperationUpdated","_onSliderValueChange","_onCategoryChange");a._operation=a.getSharedState("operation");a._events=_({},i.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated);a._initFilterManager();a.state={category:a._filterManager.getCategoryByIdentifier("all")};return a}n(t,[{key:"_initFilterManager",value:function e(){this._filterManager=new h.default(this.context.ui,this.props.options)}},{key:"_onSliderValueChange",value:function e(t){this._operation.setIntensity(t/100);var r=this.context.editor;r.render()}},{key:"_onCategoryChange",value:function e(t){var r=this;this.setState({category:t},function(){r.refs.scrollbar.update()})}},{key:"_onOperationUpdated",value:function e(t){if(t===this._operation){this.forceUpdate()}}},{key:"_onItemClick",value:function e(t,r){var n=this;this._filterManager.instantiateFilterWithIdentifier(t).then(function(e){n._operation.set({filter:e,identifier:t,intensity:1});var r=n.context.editor;r.render();n.forceUpdate()})}},{key:"renderOverlayControls",value:function e(){var t=this._operation.getFilter();if(t.isIdentity)return null;var r=this._operation.getIntensity();return i.ReactBEM.createElement(p.default,{minValue:0,maxValue:100,value:r*100,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.filter.intensity"),onChange:this._onSliderValueChange})}},{key:"_renderListItems",value:function e(){var t=this;var r=this._operation.getIdentifier();var n=this._filterManager.getFiltersForCategory(this.state.category.identifier);return[b.IdentityFilter].concat(n).map(function(e){var n=e.identifier;return i.ReactBEM.createElement("li",{bem:"e:item",key:n,onClick:t._onItemClick.bind(t,n)},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},i.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/filters/"+n+".png",true)}),i.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:n===r?"is-active":null},i.ReactBEM.createElement("div",{bem:"e:label"},t._t("controls.filter.filters."+e.identifier)||e.defaultName)))))})}},{key:"_renderCategoryDropdown",value:function e(){var t=this;var r=this._filterManager.getCategories();var n=!this.props.options.hideCategories&&r.length>1;if(!n){return null}var o=r.map(function(e){return{identifier:e.identifier,item:e,label:t._t("controls.filter.categories."+e.identifier)||e.defaultName,icon:t._getAssetPath("controls/filters/categories/"+e.identifier+".png",true)}});var a={identifier:this.state.category.identifier,item:this.state.category,label:this._t("controls.filter.categories."+this.state.category.identifier)||this.state.category.defaultName,icon:this._getAssetPath("controls/filters/categories/"+this.state.category.identifier+".png",true)};return i.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},i.ReactBEM.createElement(c.default,{items:o,selectedItem:a,onChange:this._onCategoryChange}))}},{key:"renderControls",value:function e(){var t=this._renderListItems();var r=this._renderCategoryDropdown();return[r,i.ReactBEM.createElement("div",{bem:"e:cell m:list"},i.ReactBEM.createElement(l.default,{ref:"scrollbar"},i.ReactBEM.createElement("ul",{bem:"$e:list"},t)))]}}]);return t}(a.default);t.default=k;k.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_onItemClick",value:function e(t){this.props.onChange&&this.props.onChange(t.item)}},{key:"_renderListItems",value:function e(){var t=this;return this.props.items.map(function(e){var r=e.identifier===t.props.selectedItem.identifier;return i.ReactBEM.createElement("li",{bem:"$e:item",className:r?" is-active":"",onClick:t._onItemClick.bind(t,e)},i.ReactBEM.createElement("img",{bem:"e:icon",src:e.icon}),i.ReactBEM.createElement("div",{bem:"e:label"},e.label))})}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:categoryDropdown $e:overlay"},i.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderListItems()))}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=c(i);var a=r(136);var s=c(a);var l=r(137);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function d(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=function(e){d(t,e);function t(){f(this,t);return p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"isAvailable",value:function e(t){return t.isToolAllowed("focus")&&(t.isToolEnabled("radial-focus")||t.isToolEnabled("mirrored-focus"))}},{key:"onExit",value:function e(){var t=this.context.editor;t.features.enable("zoom","drag");var r=this.getSharedState("initialOptions");var n=this.getSharedState("initialOperation");var i=this.getSharedState("operation");if(!i&&n||i&&n&&i.constructor===n.constructor){t.history.add(n,r,true)}if(i&&!n){t.history.add(i,{},false)}if(i&&n&&i.constructor!==n.constructor){t.history.add([{operation:n,options:r,existent:true},{operation:i,options:{},existent:false}])}}},{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.get("mirrored-focus")||r.operations.get("radial-focus");var i={};if(n){i=n.serializeOptions();delete i.enabled}this.setSharedState({operation:n,initialOperation:n,operationExistedBefore:!!n,initialOptions:i,inputDimensions:r.getOutputDimensions()})}},{key:"getPreloadAssets",value:function e(t){var r=[];if(t.isToolEnabled("radial-focus")){r.push("controls/focus/radial.png")}if(t.isToolEnabled("mirrored-focus")){r.push("controls/focus/mirrored.png")}return r}}]);return t}(o.default);h.controlsComponent=s.default;h.canvasControlsComponent=u.default;h.identifier="focus";h.iconPath="controls/overview/focus.png";h.languageKey="controls.overview.focus";h.defaultOptions={};h.requiredOperations=["radial-focus","mirrored-focus","linear-focus","blur"];t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(3);var a=f(o);var s=r(2);var l=f(s);var u=r(6);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=[{toolName:"radial-focus",iconName:"radial",languageKey:"controls.focus.radial"},{toolName:"mirrored-focus",iconName:"mirrored",languageKey:"controls.focus.mirrored"}];var m=function(e){v(t,e);function t(){var e;d(this,t);for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}var a=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onBlurRadiusChange","_onOperationRemoved");a._removedOperation=null;a._events=p({},i.Constants.EVENTS.OPERATION_REMOVED,a._onOperationRemoved);return a}n(t,[{key:"_onBlurRadiusChange",value:function e(t){var r=this.getSharedState("operation");var n=this.getSharedState("inputDimensions");r.setBlurRadius(t/n.min());var i=this.context.editor;i.render()}},{key:"_onButtonClick",value:function e(t,r){var n=this.context.editor;var i=this.getSharedState("operation");if(i){this._removedOperation=i;n.operations.remove(i)}var o=null;if(t){o=n.operations.getOrCreate(t)}this.setSharedState({operation:o});n.render()}},{key:"_onOperationRemoved",value:function e(t){var r=this.getSharedState("operation");if(!r||t!==r||t===this._removedOperation)return;if(this._backButtonClicked)return;var n=this.context.editor;var i=r.constructor.identifier;var o=n.operations.getOrCreate(i);this.setSharedState({operation:o,operationExistedBefore:false,initialOptions:{}})}},{key:"renderOverlayControls",value:function e(){var t=this.getSharedState("operation");if(!t)return null;var r=this.getSharedState("inputDimensions");var n=r.min();var o=t.getBlurRadius()*n;return i.ReactBEM.createElement(c.default,{minValue:0,maxValue:Math.min(180,Math.round(n*.1)),valueUnit:"px",middleDot:false,label:this._t("controls.focus.blurRadius"),onChange:this._onBlurRadiusChange,value:o})}},{key:"_renderListItems",value:function e(){var t=this;var r=this.getSharedState("operation");var n=this.context.editor;var o=i.ReactBEM.createElement("li",{bem:"e:item",key:"none"},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:!r?"is-active":null,onClick:this._onButtonClick.bind(this,null)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/focus/none.png",true)}),i.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.focus.none")))));return[o].concat(_.filter(function(e){var t=e.toolName;return n.isToolEnabled(t)}).map(function(e){var n=e.toolName,o=e.iconName,a=e.languageKey;var s=r&&r.constructor.identifier===n;return i.ReactBEM.createElement("li",{bem:"e:item","data-identifier":n,key:n},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:s?"is-active":null,onClick:t._onButtonClick.bind(t,n)},i.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/focus/"+o+".png",true)}),i.ReactBEM.createElement("div",{bem:"e:label"},t._t(a)))))}))}},{key:"renderControls",value:function e(){var t=this._renderListItems();return i.ReactBEM.createElement("div",{bem:"e:cell m:list"},i.ReactBEM.createElement(l.default,null,i.ReactBEM.createElement("ul",{bem:"$e:list"},t)))}}]);return t}(a.default);t.default=m;m.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(10);var a=f(o);var s=r(138);var l=f(s);var u=r(139);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_getControlsForOperation",value:function e(t){if(!t)return null;switch(t.constructor.identifier){case"mirrored-focus":return l.default;case"radial-focus":return c.default}}},{key:"renderWithBEM",value:function e(){var t=this.getSharedState("operation");var r=this._getControlsForOperation(t);if(!r)return i.ReactBEM.createElement("div",null);return i.ReactBEM.createElement(r,this.props)}}]);return t}(a.default);t.default=v;v.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=c(a);var l=r(10);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){var e;p(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated");a.state={areaPosition:new o.Vector2,areaDimensions:new o.Vector2,knobPosition:new o.Vector2};a._operation=a.getSharedState("operation");a._events=f({},o.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated);return a}n(t,[{key:"_onCanvasZoomDone",value:function e(){this._setStylesFromOptions()}},{key:"_onOperationUpdated",value:function e(t){if(t!==this.getSharedState("operation"))return;this._setStylesFromOptions()}},{key:"sharedStateDidChange",value:function e(t){if(t.operation){this._operation=t.operation;if(this._operation.constructor.identifier==="mirrored-focus")this._setStylesFromOptions()}}},{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag");r._setStylesFromOptions()})}},{key:"_onCenterDragStart",value:function e(){this._initialStart=this._operation.getStart();this._initialEnd=this._operation.getEnd();this._initialDist=this._initialEnd.clone().subtract(this._initialStart)}},{key:"_onCenterDrag",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=t.clone().divide(n);var a=this._initialStart.clone().add(i).clamp(new o.Vector2(0,0),new o.Vector2(1,1).subtract(this._initialDist));var s=a.clone().add(this._initialDist);this._operation.set({start:a,end:s});r.render();this._setStylesFromOptions();this.forceUpdate()}},{key:"_onKnobDragStart",value:function e(t){this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onKnobDrag",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=this._initialKnobPosition.clone().add(t).clamp(new o.Vector2(0,0),n);var a=i.clone().subtract(this.state.areaPosition);var s=this.state.areaPosition.clone().add(-a.y,a.x).divide(n);var l=this.state.areaPosition.clone().add(a.y,-a.x).divide(n);var u=a.len()*2;this._operation.set({start:s,end:l,size:u/n.min(),gradientSize:u/n.min()});this.setState({knobPosition:i,areaDimensions:new o.Vector2(this.state.areaDimensions.x,u)});r.render()}},{key:"_getAreaStyle",value:function e(){var t=this.state.knobPosition.clone().subtract(this.state.areaPosition);var r=Math.atan2(t.x,t.y)*(180/Math.PI);var n="rotate("+(-r).toFixed(2)+"deg)";return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:this.state.areaDimensions.x*-.5,marginTop:this.state.areaDimensions.y*-.5,transform:n,MozTransform:n,msTransform:n,WebkitTransform:n}}},{key:"_getKnobStyle",value:function e(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}}},{key:"_setStylesFromOptions",value:function e(){var t=this.context.editor;var r=t.getOutputDimensions();var n=this._operation.getStart().clone().multiply(r);var i=this._operation.getEnd().clone().multiply(r);var a=this._operation.getSize()*r.min();var s=i.clone().subtract(n);var l=n.clone().add(s.clone().divide(2));var u=new o.Vector2(r.len()*2,a);var c=s.len();var f=s.clone().divide(c).divide(2);this.setState({areaDimensions:u,areaPosition:l.clone(),knobPosition:l.clone().add(-a*f.y,a*f.x)})}},{key:"_getContainerStyle",value:function e(){var t=this.context.editor.getSDK().getSprite().getBounds(),r=t.x,n=t.y,i=t.width,o=t.height;return{left:r,top:n,width:i,height:o}}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},o.ReactBEM.createElement("div",{bem:"$b:linearFocusCanvasControls"},o.ReactBEM.createElement(s.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},o.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},o.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))}}]);return t}(u.default);t.default=v;v.contextTypes=u.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=c(a);var l=r(10);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){var e;p(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated");a.state={areaPosition:new o.Vector2,areaDimensions:new o.Vector2,knobPosition:new o.Vector2};a._knobChangedManually=false;a._operation=a.getSharedState("operation");a._events=f({},o.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated);return a}n(t,[{key:"_onCanvasZoomDone",value:function e(){this._setStylesFromOptions()}},{key:"_onOperationUpdated",value:function e(t){if(t!==this.getSharedState("operation"))return;this._knobChangedManually=false;this._setStylesFromOptions()}},{key:"sharedStateDidChange",value:function e(t){if(t.operation){this._operation=t.operation;if(this._operation.constructor.identifier==="radial-focus")this._setStylesFromOptions()}}},{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag");r._setStylesFromOptions()})}},{key:"_onCenterDragStart",value:function e(){this._initialPosition=this._operation.getPosition();this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onCenterDrag",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=t.clone().divide(n);var o=this._initialPosition.clone().add(i);var a=this._initialKnobPosition.clone().add(t);this._operation.set({position:o});this.state.knobPosition=a;r.render();this._setStylesFromOptions()}},{key:"_onKnobDragStart",value:function e(t){this._knobChangedManually=true;this._initialKnobPosition=this.state.knobPosition.clone()}},{key:"_onKnobDrag",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=this._initialKnobPosition.clone().add(t).clamp(new o.Vector2(0,0),n);var a=this._operation.getPosition().clone().multiply(n);var s=i.clone().subtract(a).abs().len();var l=s/2;this.setState({knobPosition:i,areaDimensions:new o.Vector2(s*2,s*2)});this._operation.set({radius:s/n.min(),gradientRadius:l/n.min()});r.render()}},{key:"_getAreaStyle",value:function e(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:this.state.areaDimensions.x*-.5,marginTop:this.state.areaDimensions.y*-.5}}},{key:"_getKnobStyle",value:function e(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}}},{key:"_setStylesFromOptions",value:function e(){var t=this.context.editor;var r=t.getOutputDimensions();var n=this._operation.getPosition().clone().multiply(r);var i=this._operation.getRadius()*r.min();var a=i*2;var s=new o.Vector2(a,a);var l={areaDimensions:s,areaPosition:n};if(!this._knobChangedManually){l.knobPosition=n.clone().add(i,0)}this.setState(l)}},{key:"_getContainerStyle",value:function e(){var t=this.context.editor;var r=t.getSDK().getSprite().getBounds(),n=r.x,i=r.y,o=r.width,a=r.height;return{left:n,top:i,width:o,height:a}}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},o.ReactBEM.createElement("div",{bem:"$b:radialFocusCanvasControls"},o.ReactBEM.createElement(s.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},o.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},o.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))}}]);return t}(u.default);t.default=v;v.contextTypes=u.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(4);var a=f(o);var s=r(141);var l=f(s);var u=r(143);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=i.SDK.Operations.SpriteOperation,_=v.StickerSprite,m=v.BrushSprite;var y=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onExit",value:function e(){var t=this.context.editor;var r=this.getSharedState("operation");if(!this.getSharedState("skipHistory")){t.history.add(r,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore"))}t.zoom.restore();t.features.enable("zoom","drag");t.render()}},{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.exists("sprite");var i=r.operations.getOrCreate("sprite");var o=i.getSprites();var a=i.getSpritesOfType(_);var s=i.serializeOptions();r.zoom.save();r.zoom.set("auto");r.features.disable("zoom","drag");this.setSharedState({operationExistedBefore:n,operation:i,sprites:o,stickers:a,initialOptions:s})}},{key:"clickAtPosition",value:function e(t,r){if(!r.operations.exists("sprite"))return false;var n=r.operations.getOrCreate("sprite");var i=n.getSpritesAtPosition(t,r.getOutputTextureDimensions()).filter(function(e){return!(e instanceof m)});if(i.length&&i[0]instanceof _){return{selectedSprite:i[0]}}else{return false}}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("sticker")&&t.isToolEnabled("sticker")}}]);return t}(a.default);y.controlsComponent=l.default;y.canvasControlsComponent=c.default;y.identifier="sticker";y.iconPath="controls/overview/sticker.png";y.languageKey="controls.overview.sticker";y.defaultOptions={categories:null,replaceCategories:false,availableStickers:null,tooltips:false,hideCategories:false,fixedRatio:true,snapRotation:90,snapRotationTolerance:5,smoothDownscaling:false};y.requiredOperations=["sprite"];y.getPreloadAssets=a.default.getPreloadAssets;t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var a=r(0);var s=r(3);var l=g(s);var u=r(2);var c=g(u);var f=r(45);var p=g(f);var d=r(1);var h=g(d);var v=r(11);var _=g(v);var m=r(142);var y=g(m);function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function k(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function O(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var E=function(e){O(t,e);function t(){var e;k(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onStickerMouseLeave","_renderTooltipCanvas","_onCategoryChange","_onBeforeHistoryUndo");o._events=b({},a.Constants.EVENTS.HISTORY_BEFORE_UNDO,o._onBeforeHistoryUndo);o._operation=o.getSharedState("operation");o._sprites=o.getSharedState("sprites");o._stickers=o.getSharedState("stickers");o._initStickerManager();o.state={category:o._stickerManager.getCategory("all")};return o}i(t,[{key:"_onBeforeHistoryUndo",value:function e(t){var r=t.operation,n=t.options;if(r!==this.getSharedState("operation"))return;var i=n.sprites;if(i.indexOf(this.getSharedState("selectedSprite"))===-1){this.setSharedState({skipHistory:true},false);this.props.onSwitchControls("home")}}},{key:"_onCategoryChange",value:function e(t){var r=this;this.setState({category:t},function(){r.refs.scrollbar.update()})}},{key:"componentDidMount",value:function e(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);if(this.props.options.stickersJSONPath){this._loadExternalStickers()}var r=this.context.editor;r.zoom.set("auto",function(){r.features.disable("zoom","drag")})}},{key:"_loadExternalStickers",value:function e(){var t=this;var r=null;var n=setTimeout(function(){r=h.default.instance.displayLoading(t._t("loading.loading"))},100);var i=function e(){if(n){clearTimeout(n);n=null}if(r)r.close();t._jsonLoaded=true};this._stickerManager.loadExternal(this.props.options.stickersJSONPath).then(function(e){i();t.forceUpdate(function(){t.refs.scrollbar.update()})}).catch(function(e){i();var r=h.default.instance.displayError(t._t("errors.loadingStickersFailed.title"),e.message);r.on("close",function(){t.props.onBack()})})}},{key:"_renderTooltipCanvas",value:function e(){var t=this;var r=this.state.hoveredSticker;var n=new window.Image;var i=r.images.mediaBase;n.addEventListener("load",function(){if(!t.state.tooltipVisible||t.state.hoveredSticker!==r){return}if(typeof i.width!=="undefined"&&typeof i.height!=="undefined"){n.width=i.width;n.height=i.height}var e=t.refs.tooltipCanvas;e.width=e.offsetWidth;e.height=e.offsetHeight;var o=e.getContext("2d");var s=Math.min(e.width/n.width,e.height/n.height);var l=new a.Vector2(n.width,n.height).multiply(s);var u=new a.Vector2(e.width,e.height).divide(2).subtract(l.clone().divide(2));o.drawImage(n,0,0,n.width,n.height,u.x,u.y,l.x,l.y)});var o=this._getAssetPath(_.default.getURLForSticker(r,"base"));n.crossOrigin=this.context.editor.getCrossOrigin();n.src=o}},{key:"_initStickerManager",value:function e(){this._stickerManager=new _.default(this.context.ui,this.props.options)}},{key:"_onBackClick",value:function e(t){this._backButtonClicked=true;this.props.onSwitchControls("home")}},{key:"_onStickerClick",value:function e(t){var r=this;var n=t.images.mediaBase;var i=_.default.getURLForSticker(t,"base");var o=this._getAssetPath(i);var s=new window.Image;var l=void 0;var u=setTimeout(function(){l=h.default.instance.displayLoading(r._t("loading.loading"))},100);s.addEventListener("load",function(){if(l)l.close();if(u){clearTimeout(u);u=null}if(typeof n.width!=="undefined"&&typeof n.height!=="undefined"){s.width=n.width;s.height=n.height}var e=r.context.editor;var i=r._calculateInitialStickerScale(t,s);var o=r._operation.createSticker({identifier:t.identifier,image:s,position:new a.Vector2(.5,.5),dimensions:new a.Vector2(s.width,s.height).multiply(i),rotation:0,smoothDownscaling:r.props.options.smoothDownscaling});r._operation.addSprite(o);r._stickers.push(o);e.render(function(){r.setSharedState({selectedSprite:o,sprites:r._sprites,stickers:r._stickers})})});s.addEventListener("error",function(){if(l)l.close();if(u){clearTimeout(u);u=null}h.default.instance.displayError(r._t("errors.imageLoadFail.title"),r._t("errors.imageLoadFail.text",{path:s.src}))});s.crossOrigin=this.context.editor.getCrossOrigin();s.src=o}},{key:"_calculateInitialStickerScale",value:function e(t,r){var n=this.getSharedState("operation");var i=n.getInputDimensions(false);var o=new a.Vector2(r.width,r.height);var s=a.SDKUtils.resizeVectorToFit(o,i.clone().multiply(.5));return s.x/o.x}},{key:"_onStickerMouseEnter",value:function e(t,r){var n=this;this.setState({tooltipVisible:true,hoveredSticker:t,hoveredStickerElement:r.currentTarget},function(){n._renderTooltipCanvas();n._updateTooltipPosition()})}},{key:"_updateTooltipPosition",value:function e(){var t=this.state.hoveredStickerElement;var r=this.refs.root;var n=t.getBoundingClientRect();var i=r.getBoundingClientRect();this.setState({tooltipPosition:n.left-i.left})}},{key:"_onStickerMouseLeave",value:function e(){this.setState({tooltipVisible:false,hoveredSticker:null})}},{key:"_renderListItems",value:function e(){var t=this;var r=this.props.options,i=r.stickersJSONPath,o=r.replaceCategories;if(i&&o&&!this._jsonLoaded){return}var s=this._stickerManager.getStickersForCategory(this.state.category.identifier);return s.map(function(e,r){var i=t.props.options;var o=i.tooltips?{onMouseEnter:t._onStickerMouseEnter.bind(t,e),onMouseLeave:t._onStickerMouseLeave}:null;return a.ReactBEM.createElement(y.default,n({sticker:e,onClick:t._onStickerClick.bind(t,e)},o))})}},{key:"_renderTooltip",value:function e(){var t=this.props.options.tooltips&&this.state.tooltipVisible;var r={left:this.state.tooltipPosition};return t?a.ReactBEM.createElement("div",{bem:"e:cell m:empty"},a.ReactBEM.createElement("div",{bem:"$b:stickersControls $e:tooltip",style:r},a.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"tooltipCanvas"}))):null}},{key:"_renderCategoryDropdown",value:function e(){var t=this;var r=this.props.options,n=r.stickersJSONPath,i=r.replaceCategories;if(n&&i&&!this._jsonLoaded){return}var o=this._stickerManager.getCategories(true);var s=!this.props.options.hideCategories&&o.length>1;if(!s){return null}var l=o.map(function(e){return{identifier:e.identifier,item:e,label:t._t("controls.sticker.categories."+e.identifier)||e.defaultName,icon:t._getAssetPath("controls/stickers/categories/"+e.identifier+".png",true)}});var u=this.state.category;var c={identifier:u.identifier,item:u,label:this._t("controls.sticker.categories."+u.identifier)||u.defaultName,icon:this._getAssetPath("controls/stickers/categories/"+u.identifier+".png",true)};return a.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},a.ReactBEM.createElement(p.default,{items:l,selectedItem:c,onChange:this._onCategoryChange}))}},{key:"renderControls",value:function e(){var t=this._renderListItems();var r=this._renderTooltip();var n=this._renderCategoryDropdown();return[r,n,a.ReactBEM.createElement("div",{bem:"e:cell m:list"},a.ReactBEM.createElement(c.default,{ref:"scrollbar"},a.ReactBEM.createElement("ul",{bem:"$e:list"},t)))]}}]);return t}(l.default);t.default=E;E.contextTypes=l.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(11);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){var e;l(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o.state={sticker:o.props.sticker};return o}n(t,[{key:"componentDidMount",value:function e(){this._renderSticker()}},{key:"componentWillReceiveProps",value:function e(t){var r=this;if(this.props.sticker!==t.sticker){this.setState({sticker:t.sticker},function(){r._renderSticker()})}}},{key:"_renderSticker",value:function e(){var t=this.context.editor;var r=t.getSDK();var n=this.props.sticker;var o=n.images.mediaThumb;var s=a.default.getURLForSticker(n,"thumb");var l=this._getAssetPath(s);var u=this.refs["canvas-"+n.name];var c=r.getPixelRatio();u.width=u.offsetWidth*c;u.height=u.offsetHeight*c;u.style.width=u.offsetWidth+"px";u.style.height=u.offsetHeight+"px";var f=u.getContext("2d");var p=new window.Image;p.addEventListener("load",function(){if(typeof o.width!=="undefined"&&typeof o.height!=="undefined"&&!i.Utils.Browser.getIEVersion()){p.width=o.width;p.height=o.height}var e=Math.min(u.width/p.width,u.height/p.height);var t=new i.Vector2(p.width,p.height).multiply(e);var r=new i.Vector2(u.width,u.height).divide(2).subtract(t.clone().divide(2));f.drawImage(p,0,0,p.width,p.height,r.x,r.y,t.x,t.y)});p.crossOrigin=this.context.editor.getCrossOrigin();p.src=l}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("li",{bem:"$b:stickersControls $e:item",key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},i.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas-"+this.props.sticker.name}))}}]);return t}(i.BaseComponent);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(14);var a=u(o);var s=r(147);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_renderOverlayControls",value:function e(){if(!this.getSharedState("selectedSprite"))return;return i.ReactBEM.createElement(l.default,{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove})}}]);return t}(a.default);t.default=d;d.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=c(a);var l=r(28);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function d(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=function(e){d(t,e);function t(){var e;f(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onTextChange","_onItemDoubleClick","_onItemTouchStart","_onItemTouchEnd","_onResizeKnobDragStart","_onResizeKnobDrag","_onResizeKnobDragStop","_onRotationKnobDragStart","_onRotationKnobDrag","_onRotationKnobDragStop","_onBlur");o.state={editMode:false,text:o.props.sprite.getText()};return o}n(t,[{key:"componentWillReceiveProps",value:function e(r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillReceiveProps",this).call(this,r);if(r.sprite!==this.props.sprite){this.refs.textarea.blur();this.setState({text:r.sprite.getText(),editMode:false})}}},{key:"_onTextChange",value:function e(t){var r=this.props.sprite;r.setText(t.target.value);this.setState({text:t.target.value})}},{key:"_onItemDoubleClick",value:function e(){this.enterEditMode()}},{key:"enterEditMode",value:function e(){var t=this;var r=this.props.sprite;r.setVisible(false);if(!r._edited){r.setText("");this.refs.textarea.value="";r._edited=true;this.setState({text:""})}this.setState({editMode:true},function(){t.refs.textarea.focus();t.refs.textarea.select()})}},{key:"leaveEditMode",value:function e(){var t=this.props.sprite;t.setVisible(true)}},{key:"_onItemTouchStart",value:function e(t){this._initialTouchPosition=o.Utils.getEventPosition(t);this._tapStartAt=(0,o.now)()}},{key:"_onItemTouchEnd",value:function e(){if((0,o.now)()-this._tapStartAt<=100){if(typeof this._lastTapAt!=="undefined"&&(0,o.now)()-this._lastTapAt<=300){this._onItemDoubleClick()}this._lastTapAt=(0,o.now)()}}},{key:"_onRotationKnobDragStart",value:function e(t,r){this._dragging=true;this._initialPosition=this._getRotationKnobPosition();this.props.onDragStart&&this.props.onDragStart()}},{key:"_onRotationKnobDrag",value:function e(t,r){var n=this.props.sprite;var i=this.context.editor;var o=this._getAbsoluteSpritePosition();var a=this._initialPosition.clone().add(t);var s=a.clone().subtract(o);var l=n.getDimensions(i.getSDK(),i.getOutputDimensions());var u=Math.atan2(s.y/2,s.x/2)-Math.atan2(l.y/2,l.x/2);n.setRotation(u);i.render();this.forceUpdate()}},{key:"_onRotationKnobDragStop",value:function e(t){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onResizeKnobDragStart",value:function e(t,r){this._initialPosition=this._getResizeKnobPosition();this.props.onDragStart&&this.props.onDragStart()}},{key:"_onResizeKnobDrag",value:function e(t,r){var n=this.props.sprite;var i=n.getRotation();var o=this.context.editor;var a=o.getOutputDimensions();var s=Math.cos(i);var l=Math.sin(i);var u=this._initialPosition.clone().add(t);var c=this._getAbsoluteSpritePosition();var f=u.clone().subtract(c);var p=Math.max((f.x*s+f.y*l)/a.x*2,.1);n.setMaxWidth(p);o.render()}},{key:"_onResizeKnobDragStop",value:function e(t){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onBlur",value:function e(){this.leaveEditMode()}},{key:"_getRotationKnobStyle",value:function e(){var t=this._getRotationKnobPosition();return{left:t.x,top:t.y}}},{key:"_getResizeKnobStyle",value:function e(){var t=this._getResizeKnobPosition();return{left:t.x,top:t.y}}},{key:"_getTextStyle",value:function e(){var t=this.context.editor;var r=this.props.sprite;var n=t.getSDK();var i=t.getOutputDimensions();var o=r.getDOMStyle(n,i);var a=this._getAbsoluteSpritePosition();var s=r.getDimensions(n,i);o.height=Math.min(s.y,i.y-a.y);if(!this.state.editMode){o.display="none"}return o}},{key:"_getItemContainerStyle",value:function e(){var t=this.context.editor;var r=this.props.sprite;var n=t.getOutputDimensions();var i=r.getDimensions(t.getSDK(),n);var o=r.getPosition().clone().multiply(n);var a=r.getRotation()*180/Math.PI;var s="rotateZ("+a.toFixed(2)+"deg)";var l="50% 50%";var u=i.x;var c=i.y;return{width:u,height:c,left:o.x-u*.5,top:o.y-c*.5,marginLeft:0,marginTop:0,transform:s,MozTransform:s,msTransform:s,WebkitTransform:s,transformOrigin:l,MozTransformOrigin:l,msTransformOrigin:l,WebkitTransformOrigin:l}}},{key:"_getRotationKnobPosition",value:function e(){var t=this.props.sprite;var r=this.context.editor;var n=Math.sin(t.getRotation());var i=Math.cos(t.getRotation());var o=r.getOutputDimensions();var a=t.getDimensions(r.getSDK(),o);var s=a.clone().divide(2);var l=t.getPosition().clone().multiply(o).add(s.x*i-s.y*n,s.x*n+s.y*i);return l}},{key:"_getResizeKnobPosition",value:function e(){var t=this.props.sprite;var r=this.context.editor;var n=Math.sin(t.getRotation());var i=Math.cos(t.getRotation());var o=r.getOutputDimensions();var a=t.getDimensions(r.getSDK(),o);var s=a.clone().divide(2);var l=t.getPosition().clone().multiply(o).add(s.x*i+s.y*n,s.x*n-s.y*i);return l}},{key:"_renderKnobs",value:function e(){var t=[];if(this.props.selected&&!this.state.editMode){t=[o.ReactBEM.createElement(s.default,{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},o.ReactBEM.createElement("div",{bem:"e:knob m:rotate $b:knob",style:this._getRotationKnobStyle()},o.ReactBEM.createElement("img",{bem:"e:icon m:larger",src:this._getAssetPath("controls/knobs/rotate.png",true)}))),o.ReactBEM.createElement(s.default,{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},o.ReactBEM.createElement("div",{bem:"e:knob m:resize $b:knob",style:this._getResizeKnobStyle()},o.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-up.png",true)})))]}return t}},{key:"_renderItem",value:function e(){var t=this._getItemContainerStyle();var r=o.ReactBEM.createElement("textarea",{bem:"e:content",ref:"textarea",style:this._getTextStyle(),value:this.state.text,disabled:!this.state.editMode,onBlur:this._onBlur,onChange:this._onTextChange});return o.ReactBEM.createElement("bem",{specifier:"e:text"},o.ReactBEM.createElement("div",{bem:"e:container",style:t},r))}},{key:"_renderSelectedOverlay",value:function e(){var t=[];if(this.props.selected){t.push("is-selected")}if(this.state.editMode){t.push("is-disabled")}t=t.join(" ");var r=this._getItemContainerStyle();return o.ReactBEM.createElement("bem",{specifier:"e:text"},o.ReactBEM.createElement(s.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},o.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:r,className:t})))}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},o.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))}}]);return t}(u.default);t.default=h;h.contextTypes=u.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(5);var a=u(o);var s=r(28);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}var a=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onRotateKnobDragStart","_onRotateKnobDrag","_onRotateKnobDragStop");a._id=i.SDKUtils.getUUID();return a}n(t,[{key:"_onKnobDragStart",value:function e(t,r,n){var i=this.props.sprite;switch(t){case"bottom":this._initialPosition=this._getBottomDragKnobPosition();break;case"top":this._initialPosition=this._getTopDragKnobPosition();break}this._initialDimensions=i.getDimensions().clone();this.props.onDragStart&&this.props.onDragStart()}},{key:"_onKnobDrag",value:function e(t,r,n){var o=this.props.sprite;var a=this.context.editor;var s=this._getAbsoluteSpritePosition();var l=this._initialPosition.clone().add(r);var u=l.clone().subtract(s);var c=this._initialPosition.clone().subtract(s);if(this.props.options.fixedRatio){var f=this._getStickerDimensions().divide(2).abs();var p=this._initialPosition.clone().subtract(s);var d=void 0;switch(t){case"bottom":d=Math.atan2(u.y,u.x)-Math.atan2(f.y,f.x);break;case"top":d=Math.atan2(u.y,u.x)-Math.atan2(-f.y,-f.x);break}var h=this._initialDimensions.clone().multiply(u.len()/p.len());var v=this.props.options,_=v.snapRotation,m=v.snapRotationTolerance;var y=Math.round(d*180/Math.PI);var g=Math.round(y/_)*_;var b=y-g;if(Math.abs(b)<m){d=g*Math.PI/180}o.set({dimensions:h,rotation:d})}else{var k=this.context.editor.zoom.get();var w=o.getRotation();var O=Math.cos(w*-1);var E=Math.sin(w*-1);var S=new i.Vector2(u.x*O-u.y*E,u.x*E+u.y*O);var P=new i.Vector2(c.x*O-c.y*E,c.x*E+c.y*O);var C=void 0;switch(t){case"bottom":C=S.clone().subtract(P);break;case"top":C=P.clone().subtract(S);break}var M=this._initialDimensions.clone().add(C.clone().divide(k).multiply(2));o.set({dimensions:M})}a.render()}},{key:"_onKnobDragStop",value:function e(){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onRotateKnobDragStart",value:function e(t,r){this._initialPosition=this._getRotateKnobPosition();this.props.onDragStart&&this.props.onDragStart()}},{key:"_onRotateKnobDragStop",value:function e(){this.props.onDragStop&&this.props.onDragStop()}},{key:"_onRotateKnobDrag",value:function e(t,r){var n=this.props.sprite;var i=this.context.editor;var o=this._getAbsoluteSpritePosition();var a=this._initialPosition.clone().add(t);var s=this._getStickerDimensions().divide(2);var l=a.clone().subtract(o);var u=void 0;u=Math.atan2(l.y,l.x)-Math.atan2(-s.y,s.x);n.set({rotation:u});i.render()}},{key:"_getBottomDragKnobStyle",value:function e(){var t=this._getBottomDragKnobPosition();return{left:t.x,top:t.y}}},{key:"_getTopDragKnobStyle",value:function e(){var t=this._getTopDragKnobPosition();return{left:t.x,top:t.y}}},{key:"_getRotateKnobStyle",value:function e(){var t=this._getRotateKnobPosition();return{left:t.x,top:t.y}}},{key:"_getStickerStyle",value:function e(){var t=this.props.sprite;var r=this._getStickerDimensions().abs();var n=this._getAbsoluteSpritePosition().subtract(r.clone().divide(2));var i=t.getRotation()*180/Math.PI;var o="rotate("+i.toFixed(2)+"deg)";var a=t.getDimensions();var s=t.getFlipVertically();if(a.y<0)s=!s;if(s){o+=" scaleY(-1)"}var l=t.getFlipHorizontally();if(a.x<0)l=!l;if(l){o+=" scaleX(-1)"}return{top:n.y,left:n.x,width:r.x,height:r.y,WebkitTransform:o,msTransform:o,MozTransform:o,OTransform:o}}},{key:"_getStickerDimensions",value:function e(){var t=this.props.sprite;var r=this.context.editor;return t.getDimensions().clone().multiply(r.zoom.get())}},{key:"_getRotateKnobPosition",value:function e(){var t=this.props.sprite;var r=this._getAbsoluteSpritePosition();var n=t.getRotation();var i=Math.sin(n||0);var o=Math.cos(n||0);var a=this._getStickerDimensions().divide(2);return r.clone().add(a.x*o+a.y*i,a.x*i-a.y*o)}},{key:"_getBottomDragKnobPosition",value:function e(){var t=this.props.sprite;var r=this._getAbsoluteSpritePosition();var n=t.getRotation();var i=Math.sin(n||0);var o=Math.cos(n||0);var a=this._getStickerDimensions().divide(2);return r.clone().add(a.x*o-a.y*i,a.x*i+a.y*o)}},{key:"_getTopDragKnobPosition",value:function e(){var t=this.props.sprite;var r=this._getAbsoluteSpritePosition();var n=t.getRotation();var i=Math.sin(n||0);var o=Math.cos(n||0);var a=this._getStickerDimensions(t).divide(2);return r.clone().subtract(a.x*o-a.y*i,a.x*i+a.y*o)}},{key:"_renderKnobs",value:function e(){var t=[];if(this.props.selected){t=[i.ReactBEM.createElement(a.default,{onStart:this._onKnobDragStart.bind(this,"bottom"),onStop:this._onKnobDragStop.bind(this,"bottom"),onDrag:this._onKnobDrag.bind(this,"bottom")},i.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getBottomDragKnobStyle()},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",true)}))),i.ReactBEM.createElement(a.default,{onStart:this._onKnobDragStart.bind(this,"top"),onStop:this._onKnobDragStop.bind(this,"top"),onDrag:this._onKnobDrag.bind(this,"top")},i.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getTopDragKnobStyle()},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",true)})))];if(!this.props.options.fixedRatio){t.push(i.ReactBEM.createElement(a.default,{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},i.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getRotateKnobStyle()},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/rotate.png",true)}))))}}return t}},{key:"_renderSVGFilter",value:function e(){if(this.props.hideContent)return null;var t=this.props.sprite;var r=t.getAdjustments();var n=r.getBrightness();var o=r.getSaturation();var a=r.getContrast();var s="<filter id='pesdk-sticker-"+this._id+"-filter'>\n        <feComponentTransfer>\n          <feFuncR type='linear' intercept='"+n+"' />\n          <feFuncG type='linear' intercept='"+n+"' />\n          <feFuncB type='linear' intercept='"+n+"' />\n        </feComponentTransfer>\n        <feColorMatrix type='saturate' values='"+o+"' />\n        <feComponentTransfer>\n          <feFuncR type='linear' slope='"+a+"' intercept='"+(-(.5*a)+.5)+"' />\n          <feFuncG type='linear' slope='"+a+"' intercept='"+(-(.5*a)+.5)+"' />\n          <feFuncB type='linear' slope='"+a+"' intercept='"+(-(.5*a)+.5)+"' />\n        </feComponentTransfer>\n      </filter>";return i.ReactBEM.createElement("svg",{width:"0",height:"0","color-interpolation-filters":"sRGB",is:"svg"},i.ReactBEM.createElement("defs",{key:Math.random(),dangerouslySetInnerHTML:{__html:s}}))}},{key:"_renderSelectedOverlay",value:function e(){var t=[];if(this.props.selected){t.push("is-selected")}t=t.join(" ");var r=this._getStickerStyle();return i.ReactBEM.createElement("bem",{specifier:"e:text"},i.ReactBEM.createElement(a.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},i.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:r,className:t})))}},{key:"_renderItem",value:function e(){if(this.props.hideContent)return null;var t=this.props.sprite;var r=this._getStickerStyle();var n=window.location.href.replace(window.location.hash,"");var o={filter:'url("'+n+"#pesdk-sticker-"+this._id+'-filter")'};var a={width:r.width,height:r.height};return i.ReactBEM.createElement("bem",{specifier:"e:sticker"},i.ReactBEM.createElement("div",{bem:"e:container",style:r},i.ReactBEM.createElement("svg",{width:parseInt(r.width),height:parseInt(r.height),"color-interpolation-filters":"sRGB",is:"svg",style:a,preserveAspectRatio:"none"},i.ReactBEM.createElement("image",{xlinkHref:t.getImage().src,width:r.width,height:r.height,style:o,preserveAspectRatio:"none"}))))}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},i.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderSVGFilter(),this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))}}]);return t}(l.default);t.default=d;d.contextTypes=l.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(28);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);if(this.props.hideContent)return;var r=this.props.sprite.getCanvas();this._appendCanvas(r)}},{key:"componentWillReceiveProps",value:function e(t){if(this.props.hideContent)return;if(t.sprite!==this.props.sprite){var r=this.props.sprite.getCanvas();r.parentNode.removeChild(r);var n=t.sprite.getCanvas();this._appendCanvas(n)}}},{key:"_isSelected",value:function e(){return this.getSharedState("brush")===this.props.sprite}},{key:"_appendCanvas",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();t.style.width=n.x+"px";t.style.height=n.y+"px";this.refs.brush.appendChild(t)}},{key:"renderWithBEM",value:function e(){if(this.props.hideContent)return null;var t=this._isSelected()?"is-selected":null;return o.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},o.ReactBEM.createElement("div",{bem:"$e:item e:container m:full",ref:"container"},o.ReactBEM.createElement("div",{bem:"$e:brush",className:t,ref:"brush"})))}}]);return t}(s.default);t.default=p;p.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_onFlipClick",value:function e(t,r){r.preventDefault();r.stopPropagation();this.props.onFlip&&this.props.onFlip(t)}},{key:"_onTakeToFrontClick",value:function e(t){t.preventDefault();t.stopPropagation();this.props.onTakeToFront&&this.props.onTakeToFront()}},{key:"_onRemoveClick",value:function e(t){t.preventDefault();t.stopPropagation();this.props.onRemove&&this.props.onRemove()}},{key:"_renderItems",value:function e(){return[i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"h")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-h.png",true)})),i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"v")},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-v.png",true)})),i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",true)})),i.ReactBEM.createElement("div",{bem:"$e:separator"}),i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",true)}))]}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(4);var a=d(o);var s=r(149);var l=d(s);var u=r(151);var c=d(u);var f=r(15);var p=d(f);function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=i.SDK.Operations.SpriteOperation,y=m.TextSprite,g=m.BrushSprite;var b=function(e){_(t,e);function t(){h(this,t);return v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onExit",value:function e(){var t=this.context.editor;var r=this.getSharedState("operation");if(!this.getSharedState("skipHistory")){t.history.add(r,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore"))}t.zoom.restore();t.features.enable("zoom","drag");t.render()}},{key:"onEnter",value:function e(t,r){var n=this.context,i=n.editor,o=n.ui;var a=i.operations.exists("sprite");var s=i.operations.getOrCreate("sprite");var l=s.getSprites();var u=s.serializeOptions();var c=new p.default(o,r);var f=c.getDefaultVariation();this.setSharedState({operationExistedBefore:a,operation:s,sprites:l,initialOptions:u,fontManager:c,defaultFontVariation:f,fonts:c.getFonts()});i.zoom.save();i.render()}},{key:"clickAtPosition",value:function e(t,r){if(!r.operations.exists("sprite"))return false;var n=r.operations.getOrCreate("sprite");var i=n.getSpritesAtPosition(t,r.getOutputTextureDimensions()).filter(function(e){return!(e instanceof g)});if(i.length&&i[0]instanceof y){return{selectedSprite:i[0]}}else{return false}}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("text")&&t.isToolEnabled("text")}},{key:"getPreloadAssets",value:function e(t){return["controls/text/align_left.png","controls/text/align_right.png","controls/text/align_center.png","controls/text/minus.png","controls/text/plus.png"]}}]);return t}(a.default);b.controlsComponent=c.default;b.canvasControlsComponent=l.default;b.identifier="text";b.iconPath="controls/overview/text.png";b.languageKey="controls.overview.text";b.defaultOptions={fonts:[],replaceFonts:false,availableVariations:null};b.requiredOperations=["sprite"];t.default=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(14);var s=c(a);var l=r(150);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function d(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=function(e){d(t,e);function t(){var e;f(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onTextEdit");return o}n(t,[{key:"_onItemBlur",value:function e(){var t=this.getSharedState("selectedSprite");if(t&&t.getText()===""){t.setText(this._t("controls.text.defaultText"));t._edited=false}}},{key:"_onSpriteRemove",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onSpriteRemove",this).call(this);this.props.onSwitchControls("home")}},{key:"_onTextEdit",value:function e(){var t=this.getSharedState("selectedSprite");this.refs["sprite-"+t.getId()].enterEditMode()}},{key:"_renderOverlayControls",value:function e(){if(!this.getSharedState("selectedSprite"))return;return o.ReactBEM.createElement(u.default,{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit})}}]);return t}(s.default);t.default=h;h.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_onEditClick",value:function e(t){t.preventDefault();t.stopPropagation();this.props.onEdit&&this.props.onEdit()}},{key:"_onTakeToFrontClick",value:function e(t){t.preventDefault();t.stopPropagation();this.props.onTakeToFront&&this.props.onTakeToFront()}},{key:"_onRemoveClick",value:function e(t){t.preventDefault();t.stopPropagation();this.props.onRemove&&this.props.onRemove()}},{key:"_renderItems",value:function e(){var t=[i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",true)}))];if(i.Utils.isTouchDevice()){t=t.concat([i.ReactBEM.createElement("div",{bem:"$e:separator"}),i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onEditClick.bind(this)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/edit.png",true)}))])}t=t.concat([i.ReactBEM.createElement("div",{bem:"$e:separator"}),i.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",true)}))]);return t}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())}}]);return t}(i.BaseComponent);t.default=l;l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(3);var s=b(a);var l=r(2);var u=b(l);var c=r(29);var f=b(c);var p=r(6);var d=b(p);var h=r(46);var v=b(h);var _=r(156);var m=b(_);var y=r(1);var g=b(y);function b(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function w(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function O(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function E(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var S=["left","center","right"];var P=function(e){E(t,e);function t(){var e;w(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=O(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onFontSizeChange","_onFontChange","_onAlignmentClick","_onTakeToFrontClick","_onForegroundColorChange","_onBackgroundColorChange","_onBeforeHistoryUndo");a._events=k({},o.Constants.EVENTS.HISTORY_BEFORE_UNDO,a._onBeforeHistoryUndo);a._operation=a.getSharedState("operation");a._fontLoader=a.context.ui.getFontLoader();a._fontLoader.setFonts(a.getSharedState("fonts"));a.state={mode:null,loading:true};var s=a.context.editor;s.render();a._fonts=a.getSharedState("fonts");return a}n(t,[{key:"componentDidMount",value:function e(){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var n=this.context.editor;n.zoom.set("auto",function(){n.features.disable("zoom","drag")});var o=function e(){r._createText();r.setState({loading:false})};if(this._fontLoader.needsToLoad()){this._loadFonts().then(o.bind(this))}else{o()}}},{key:"_loadFonts",value:function e(){var t=this;var r=g.default.instance.displayLoading(this._t("loading.loading"));return this._fontLoader.load().then(function(){r.close()}).catch(function(e){r.close();g.default.instance.displayWarning(t._t("errors.loadingFontsFailed.title"),t._t("errors.loadingFontsFailed.text"))})}},{key:"_createText",value:function e(){var t=this.context.editor;var r=this.getSharedState("selectedSprite");var n=this.getSharedState("operation");var i=this.getSharedState("defaultFontVariation");var a=t.getOutputDimensions();if(!r){var s=t.getSDK();var l=s.getRenderer();var u=l.getMaxTextureSize();var c=n.createText({fontIdentifier:i.getIdentifier(),text:this._t("controls.text.defaultText"),position:new o.Vector2(.5,.5),pivot:new o.Vector2(.5,.5),maxWidth:.5,maxHeight:u?u/a.y:3,fontSize:.08,fontFamily:i.getFont().getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle(),alignment:"center"});n.addSprite(c);this.setSharedState({selectedSprite:c});t.render()}}},{key:"_onBeforeHistoryUndo",value:function e(t){var r=t.operation,n=t.options;if(r!==this.getSharedState("operation"))return;var i=n.sprites;if(i.indexOf(this.getSharedState("selectedSprite"))===-1){this.setSharedState({skipHistory:true},false);this.props.onSwitchControls("home")}}},{key:"_onBackClick",value:function e(t){var r=this.context.editor;r.render();this._backButtonClicked=true;this.props.onSwitchControls("home")}},{key:"sharedStateDidChange",value:function e(t){if("selectedSprite"in t){this.forceUpdate()}}},{key:"_onFontSizeChange",value:function e(t){var r=this.context.editor;var n=this.context.editor.getOutputDimensions();var i=this.getSharedState("selectedSprite");i.setFontSize(t/n.y);this.forceUpdate();r.render()}},{key:"_onFontChange",value:function e(t){var r=this.context.editor;var n=this.getSharedState("selectedSprite");n.setFontFamily(t.getFont().getFontFamily());n.setFontWeight(t.getFontWeight());n.setFontStyle(t.getFontStyle());n.setFontIdentifier(t.getIdentifier());this.forceUpdate();r.render()}},{key:"_onAlignmentClick",value:function e(t){var r=this.context.editor;var n=this.getSharedState("selectedSprite");var i=n.getAlignment();var o=S.indexOf(i);var a=(o+1)%S.length;var s=S[a];n.setAlignment(s);this.forceSharedUpdate();r.render()}},{key:"_onTakeToFrontClick",value:function e(t){var r=this.context.editor;var n=this.getSharedState("operation");n.takeSpriteToFront(this.getSharedState("selectedSprite"));this.forceSharedUpdate();r.render()}},{key:"_onForegroundColorChange",value:function e(t){var r=this.context.editor;var n=this.getSharedState("selectedSprite");n.setColor(t);r.render()}},{key:"_onBackgroundColorChange",value:function e(t){var r=this.context.editor;var n=this.getSharedState("selectedSprite");n.setBackgroundColor(t);r.render()}},{key:"_switchToMode",value:function e(t){if(t===this.state.mode)t=null;this.setState({mode:t})}},{key:"renderOverlayControls",value:function e(){switch(this.state.mode){case"size":return this._renderFontSizeOverlayControl();case"font":return this._renderFontFamilyOverlayControl();default:return null}}},{key:"_renderFontSizeOverlayControl",value:function e(){var t=this.getSharedState("selectedSprite");if(!t)return;var r=this.context.editor;var n=r.getOutputDimensions();var i=Math.round(n.y);var a=Math.round(t.getFontSize()*n.y);return o.ReactBEM.createElement(d.default,{value:a,minValue:n.y*.05,maxValue:i,label:this._t("controls.text.size"),onChange:this._onFontSizeChange})}},{key:"_renderSizeItem",value:function e(){var t=this.getSharedState("selectedSprite");if(!t)return;var r=this.context.editor.getOutputDimensions();var n=t.getFontSize();var i=this.state.mode==="size"?"is-active":null;return o.ReactBEM.createElement("li",{bem:"e:item",key:"size"},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:i,"data-identifier":"fontSize",onClick:this._switchToMode.bind(this,"size")},o.ReactBEM.createElement("div",{bem:"b:fontSize e:text"},Math.round(n*r.y)),o.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.size")))))}},{key:"_renderFontFamilyOverlayControl",value:function e(){var t=this.getSharedState("selectedSprite");if(!t)return;return o.ReactBEM.createElement(m.default,{fontFamily:t.getFontFamily(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange})}},{key:"_renderFontItem",value:function e(){var t=this.getSharedState("selectedSprite");if(!t)return;var r=this.state.mode==="font"?"is-active":null;return o.ReactBEM.createElement("li",{bem:"e:item",key:"font"},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:r,"data-identifier":"font",onClick:this._switchToMode.bind(this,"font")},o.ReactBEM.createElement(v.default,{fontFamily:t.getFontFamily(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle()}),o.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.font")))))}},{key:"_renderAlignmentItem",value:function e(){var t=this.getSharedState("selectedSprite");if(!t)return;var r=t.getAlignment();return o.ReactBEM.createElement("li",{bem:"e:item",key:"alignment"},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onAlignmentClick,"data-identifier":"alignment"},o.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/text/align_"+r+".png",true)}),o.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.alignment")))))}},{key:"_renderTakeToFrontItem",value:function e(){return o.ReactBEM.createElement("li",{bem:"e:item",key:"takeToFront"},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onTakeToFrontClick},o.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take_to_front.png",true)}),o.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.takeToFront")))))}},{key:"renderControls",value:function e(){if(this.state.loading)return o.ReactBEM.createElement("div",null);var t=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()];var r=this.getSharedState("selectedSprite");var n=r.getColor().clone();var i=r.getBackgroundColor().clone();return[o.ReactBEM.createElement("div",{bem:"e:cell m:list"},o.ReactBEM.createElement(u.default,{ref:"scrollbar"},o.ReactBEM.createElement("ul",{bem:"$e:list"},t))),o.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},o.ReactBEM.createElement(f.default,{initialValue:n,label:this._t("controls.text.foreground"),onChange:this._onForegroundColorChange})),o.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},o.ReactBEM.createElement(f.default,{initialValue:i,label:this._t("controls.text.background"),onChange:this._onBackgroundColorChange}))]}}]);return t}(s.default);t.default=P;P.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(153);var s=p(a);var l=r(154);var u=p(l);var c=r(155);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=function(e){v(t,e);function t(){var e;d(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._value=o.props.initialValue.clone();var a=o._value.toHSV();var s=a[0];var l=a[1];var u=a[2];o._hsv={h:s,s:l,v:u};o._bindAll("_onElementClick","_onColorChange","_onDocumentClick");return o}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);document.addEventListener("click",this._onDocumentClick)}},{key:"componentWillUnmount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this);document.removeEventListener("click",this._onDocumentClick)}},{key:"_onDocumentClick",value:function e(t){for(var r=t.target;r;r=r.parentNode){if(r===this.refs.root){return}}this.props.onClose&&this.props.onClose()}},{key:"_onElementClick",value:function e(t){t.stopPropagation()}},{key:"_onColorChange",value:function e(t){this._value=t;this.props.onChange&&this.props.onChange(t)}},{key:"renderWithBEM",value:function e(){var t=void 0;if(this.props.alpha!==false){t=o.ReactBEM.createElement(s.default,{initialValue:this._value,onChange:this._onColorChange})}return o.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:overlay",onClick:this._onElementClick,ref:"root"},t,o.ReactBEM.createElement("div",{bem:"e:bottom"},o.ReactBEM.createElement(u.default,{initialValue:this._value,onChange:this._onColorChange}),o.ReactBEM.createElement(f.default,{initialValue:this._value,onChange:this._onColorChange})))}}]);return t}(o.BaseComponent);t.default=_;_.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._bindAll("_onKnobDrag","_onKnobDragStart");a._value=a.props.initialValue.clone();a._transparentPatternCanvas=o.Utils.createTransparentPatternCanvas();return a}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderCanvas()}},{key:"shouldComponentUpdate",value:function e(t){var r=t.initialValue;if(r!==this._value){this._value=r.clone();this._renderCanvas();return true}return false}},{key:"_onKnobDragStart",value:function e(t,r){if(r.target===this.refs.knob){this._initialAlpha=this._value.a}else{this._setAlphaFromPosition(t)}}},{key:"_onKnobDrag",value:function e(t,r){var n=this.refs.canvas;var i=n.offsetWidth;var o=t.x/i;this._setAlpha(this._initialAlpha+o)}},{key:"_getKnobStyle",value:function e(){return{left:(this._value.a*100).toFixed(2)+"%",top:"50%"}}},{key:"_setAlpha",value:function e(t){this._value.a=t;this._value.a=Math.min(1,Math.max(0,this._value.a));this.forceUpdate();this.props.onChange&&this.props.onChange(this._value)}},{key:"_setAlphaFromPosition",value:function e(t){var r=this.refs.canvas;this._initialAlpha=t.x/r.offsetWidth;this._setAlpha(this._initialAlpha)}},{key:"_renderCanvas",value:function e(){var t=this.refs.canvas;var r=t.getContext("2d");t.width=t.offsetWidth;t.height=t.offsetHeight;var n=r.createPattern(this._transparentPatternCanvas,"repeat");r.fillStyle=n;r.fillRect(0,0,t.width,t.height);var i=r.createLinearGradient(0,0,t.width,t.height);var o=this._value.clone();o.a=0;i.addColorStop(0,o.toRGBA());i.addColorStop(1,this._value.toHex());r.fillStyle=i;r.fillRect(0,0,t.width,t.height)}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:alpha"},o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},o.ReactBEM.createElement("div",null,o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),o.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]);return t}(o.BaseComponent);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onKnobDrag","_onKnobDragStart");o._value=o.props.initialValue.clone();var a=o._value.toHSV();var s=a[0];var l=a[1];var f=a[2];o._hsvColor={h:s,s:l,v:f};return o}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderCanvas()}},{key:"shouldComponentUpdate",value:function e(t){var r=t.initialValue;if(r!==this._value){this._value=r.clone();var n=this._value.toHSV();var i=n[0];var o=n[1];var a=n[2];this._hsvColor={h:i,s:o,v:a};this._renderCanvas();return true}return false}},{key:"_onKnobDragStart",value:function e(t,r){if(r.target===this.refs.knob){this._initialValue=this._hsvColor.v;this._initialSaturation=this._hsvColor.s}else{this._setValuesFromPosition(t)}}},{key:"_onKnobDrag",value:function e(t,r){var n=this.refs.canvas;var i=n.offsetWidth;var o=n.offsetHeight;var a=t.x/i;var s=t.y/o*-1;var l=this._hsvColor.h;this._setHSV(l,this._initialSaturation+a,this._initialValue+s)}},{key:"_getKnobStyle",value:function e(){var t=this._hsvColor,r=t.s,n=t.v;return{left:(r*100).toFixed(2)+"%",top:((1-n)*100).toFixed(2)+"%"}}},{key:"_setHSV",value:function e(t,r,n){r=Math.max(.01,Math.min(r,.99));n=Math.max(.01,Math.min(n,.99));this._value=o.Color.fromHSV(t,r,n,this._value.a);this._hsvColor={h:t,s:r,v:n};this.forceUpdate();this.props.onChange&&this.props.onChange(this._value)}},{key:"_setValuesFromPosition",value:function e(t){var r=this.refs.canvas;this._initialSaturation=t.x/r.offsetWidth;this._initialValue=1-t.y/r.offsetHeight;var n=this._hsvColor.h;this._setHSV(n,this._initialSaturation,this._initialValue)}},{key:"_renderCanvas",value:function e(){var t=this.refs.canvas;var r=t.getContext("2d");t.width=t.offsetWidth;t.height=t.offsetHeight;var n=r.getImageData(0,0,t.width,t.height);for(var i=0;i<t.height;i++){var a=(t.height-i)/t.height;for(var s=0;s<t.width;s++){var l=s/t.width;var u=o.Color.fromHSV(this._hsvColor.h,l,a);var c=u.r,f=u.g,p=u.b,d=u.a;var h=(i*t.width+s)*4;n.data[h]=c*255;n.data[h+1]=f*255;n.data[h+2]=p*255;n.data[h+3]=d*255}}r.putImageData(n,0,0)}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:saturation"},o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},o.ReactBEM.createElement("div",null,o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),o.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]);return t}(o.BaseComponent);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(5);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;u(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._bindAll("_onKnobDrag","_onKnobDragStart");o._value=o.props.initialValue.clone();var a=o._value.toHSV();var s=a[0];var l=a[1];var f=a[2];o._hsvColor={h:s,s:l,v:f};o.state={value:o.props.initialValue};return o}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderCanvas()}},{key:"shouldComponentUpdate",value:function e(t){var r=t.initialValue;if(r!==this._value){this._value=r.clone();var n=this._value.toHSV();var i=n[0];var o=n[1];var a=n[2];this._hsvColor={h:i,s:o,v:a};this._renderCanvas();return true}return false}},{key:"_onKnobDragStart",value:function e(t,r){if(r.target===this.refs.knob){this._initialHue=this._hsvColor.h}else{this._setValueFromPosition(t)}}},{key:"_onKnobDrag",value:function e(t,r){var n=this.refs.canvas;var i=n.offsetHeight;var o=t.y/i;this._setHue(this._initialHue+o)}},{key:"_getKnobStyle",value:function e(){return{left:"50%",top:(this._hsvColor.h*100).toFixed(2)+"%"}}},{key:"_setHue",value:function e(t){var r=this._hsvColor,n=r.s,i=r.v;t=Math.min(1,Math.max(0,t));n=Math.max(.01,Math.min(n,.99));i=Math.max(.01,Math.min(i,.99));this._value=o.Color.fromHSV(t,n,i,this._value.a);this._hsvColor={h:t,s:n,v:i};this.forceUpdate();this.props.onChange&&this.props.onChange(this._value)}},{key:"_setValueFromPosition",value:function e(t){var r=this.refs.canvas;this._initialHue=t.y/r.offsetHeight;this._setHue(this._initialHue)}},{key:"_renderCanvas",value:function e(){var t=this.refs.canvas;var r=t.getContext("2d");t.width=t.offsetWidth;t.height=t.offsetHeight;for(var n=0;n<t.height;n++){var i=n/t.height;var a=o.Color.fromHSV(i,1,1);r.strokeStyle=a.toRGBA();r.beginPath();r.moveTo(0,n);r.lineTo(t.width,n);r.stroke()}}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:hue"},o.ReactBEM.createElement(s.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},o.ReactBEM.createElement("div",null,o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),o.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))}}]);return t}(o.BaseComponent);t.default=p;p.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(2);var a=u(o);var s=r(46);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_onListItemClick",value:function e(t,r){this.props.onChange&&this.props.onChange(t)}},{key:"_renderListItems",value:function e(){var t=this;var r=this.props.fonts;return r.map(function(e){var r=t.props.selectedIdentifier;return e.getVariations().map(function(n){var o=r===n.getIdentifier();var a=o?"is-active":null;return i.ReactBEM.createElement("li",{bem:"e:item",key:n.getIdentifier(),className:a,onClick:t._onListItemClick.bind(t,n)},i.ReactBEM.createElement(l.default,{fontFamily:n.getFontFamily(),fontWeight:n.getFontWeight(),fontStyle:n.getFontStyle()}),i.ReactBEM.createElement("div",{bem:"e:label"},e.getFontFamily()))})})}},{key:"renderWithBEM",value:function e(){var t=this._renderListItems();return i.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:dark m:large"},i.ReactBEM.createElement(a.default,null,i.ReactBEM.createElement("ul",{bem:"$b:fontFamily e:list"},t)))}}]);return t}(i.BaseComponent);t.default=d;d.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(7);function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function a(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var s=function(e){a(t,e);function t(){i(this,t);return o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(n.Configurable);t.default=s;s.prototype.availableOptions={fontFamily:{type:n.OptionType.STRING,required:true},variations:{type:n.OptionType.ARRAY,required:true}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(4);var a=f(o);var s=r(159);var l=f(s);var u=r(161);var c=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){h(t,e);function t(){p(this,t);return d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onExit",value:function e(){var t=this.context.editor;t.zoom.restore();t.features.enable("zoom","drag");t.render()}},{key:"onEnter",value:function e(t,r){var n=this.context.editor;n.zoom.save();n.zoom.set("auto",function(){n.render()});var o=n.getOutputDimensions();var a=n.operations.exists("sprite");var s=n.operations.getOrCreate("sprite");var l=s.createBrush();var u=s.serializeOptions(undefined,true);s.addSprite(l);var c=Math.max(o.min()*.05,1);if(r.sizePresets&&r.sizePresets.length>0){c=r.sizePresets[0]}var f=new i.Color(1,0,0,1);var p=1;this.setSharedState({operationExistedBefore:a,operation:s,brush:l,initialOptions:u,size:c,color:f,hardness:p})}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("brush")&&t.isToolEnabled("brush")}},{key:"getPreloadAssets",value:function e(){return[]}}]);return t}(a.default);v.controlsComponent=l.default;v.canvasControlsComponent=c.default;v.identifier="brush";v.iconPath="controls/overview/brush.png";v.languageKey="controls.overview.brush";v.defaultOptions={sizePresets:[]};v.requiredOperations=["sprite"];t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(3);var s=_(a);var l=r(13);var u=_(l);var c=r(2);var f=_(c);var p=r(29);var d=_(p);var h=r(160);var v=_(h);function _(e){return e&&e.__esModule?e:{default:e}}function m(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var k=function(e){b(t,e);function t(){var e,r;y(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++){i[a]=arguments[a]}var s=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._hasDoneButton=false;s._brushOptions={size:s.getSharedState("size"),color:s.getSharedState("color").clone()};s._hasPresets=s.props.options.sizePresets&&s.props.options.sizePresets.length>0;s._hasSlider=!s._hasPresets;s._bindAll("_onSizeUpdated","_onColorUpdated","_onOperationUpdated","_onOperationRemoved");s.state={sizeControlsEnabled:false};s._events=(r={},m(r,o.Constants.EVENTS.OPERATION_UPDATED,s._onOperationUpdated),m(r,o.Constants.EVENTS.OPERATION_REMOVED,s._onOperationRemoved),r);return s}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var r=this.context.editor;r.zoom.set("auto");r.features.disable("zoom","drag")}},{key:"_onSizeClick",value:function e(t){this._onSizeUpdated(t);this.forceUpdate()}},{key:"_onOperationRemoved",value:function e(t){if(t!==this.getSharedState("operation"))return;if(this._backButtonClicked)return;var r=this.context.editor;var n=r.operations.getOrCreate("sprite");var i=n.createBrush();n.addSprite(i);this.setSharedState({operation:n,brush:i,operationExistedBefore:false,initialOptions:{}});r.render()}},{key:"_onOperationUpdated",value:function e(t){if(t===this.getSharedState("operation")){var r=this.getSharedState("brush");if(r){var n=t.getSprites().filter(function(e){return e.getId()===r.getId()})[0];this.setSharedState({brush:n})}this.context.editor.render()}}},{key:"_onSizeUpdated",value:function e(t){this.setSharedState({size:t});this._brushOptions.size=t}},{key:"_onColorUpdated",value:function e(t){this.setSharedState({color:t});this._brushOptions.color=t.clone()}},{key:"_renderSizeItems",value:function e(){var t=this;var r=this.props.options.sizePresets;var n=Math.max.apply(null,r);return r.map(function(e){var r=t.getSharedState("size")===e;return o.ReactBEM.createElement(v.default,{size:e,maxSize:n,active:r,key:e,onClick:t._onSizeClick.bind(t,e)})})}},{key:"renderControls",value:function e(){var t=this.context.editor;var r=t.zoom.get();var n=[];if(this._hasSlider){var i=t.getFinalDimensions();var a=1;var s=Math.round(i.clone().multiply(r).min()/2);var l=this._brushOptions.size;n.push(o.ReactBEM.createElement("div",{bem:"e:cell m:slider"},o.ReactBEM.createElement(u.default,{style:"large",minValue:a,maxValue:s,valueUnit:"px",middleDot:false,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:l})))}else if(this._hasPresets){n.push(o.ReactBEM.createElement("div",{bem:"e:cell m:list"},o.ReactBEM.createElement(f.default,null,o.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderSizeItems()))))}n.push(o.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},o.ReactBEM.createElement(d.default,{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated})));return n}}]);return t}(s.default);t.default=k;k.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){a(this,t);return s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._renderCanvas()}},{key:"componentDidUpdate",value:function e(){this._renderCanvas()}},{key:"_renderCanvas",value:function e(){var t=this.refs.canvas;var r=t.getContext("2d");t.width=t.offsetWidth;t.height=t.offsetHeight;var n=this.props,i=n.maxSize,o=n.size;var a=t.width*(o/i);var s=a/2;r.fillStyle="white";r.beginPath();r.arc(t.width/2,t.height/2,s,0,2*Math.PI);r.fill()}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("bem",{specifier:"$b:controls $e:list"},o.ReactBEM.createElement("li",{bem:"e:item",onClick:this.props.onClick},o.ReactBEM.createElement("bem",{specifier:"$b:controls"},o.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.props.active?"is-active":null},o.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),o.ReactBEM.createElement("div",{bem:"e:label"},this.props.size)))))}}]);return t}(o.BaseComponent);t.default=u;u.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(14);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=o.SDK.Operations.SpriteOperation.BrushSprite;var h=o.SDK.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush;var v=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._windowResized=false;a._drawing=false;a._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize");a._lastDrawPosition=null;a._events=o.SDKUtils.extend(a._events,u({},o.Constants.EVENTS.WINDOW_RESIZE,a._onWindowResize));a.state={cursorVisible:false,cursorPosition:new o.Vector2};return a}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._updateContainerRect()}},{key:"componentDidUpdate",value:function e(){if(this._windowResized){this._updateContainerRect();this._windowResized=false}}},{key:"_onWindowResize",value:function e(){this._windowResized=true}},{key:"_onOperationRemoved",value:function e(t){void 0}},{key:"_onOperationUpdated",value:function e(t){if(t===this.getSharedState("operation")){this.forceUpdate()}}},{key:"_onMouseDown",value:function e(t){t.preventDefault();this._optionsBeforeDraw=this.getSharedState("operation").serializeOptions();this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore");this.setSharedState({operationExistedBefore:true},false);var r=this.context.editor.getOutputDimensions();var n=this._getCursorPosition(t);var i=this.getSharedState("brush");var o=this.getSharedState("size")/r.min();var a=this.getSharedState("color");var s=this.getSharedState("hardness");this._drawing=true;var l=new h({size:o,hardness:s,color:a});this._currentPath=i.createPath(l);this._currentPath.addControlPoint(n.clone().divide(r));document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);document.addEventListener("mouseup",this._onMouseUp);document.addEventListener("touchend",this._onMouseUp)}},{key:"_onMouseUp",value:function e(){this._currentPath.setClosed(true);var t=this.context.editor;var r=t.getOutputTextureDimensions();this.getSharedState("brush").render(r);this._currentPath=null;this._drawing=false;t.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw);document.removeEventListener("mousemove",this._onMouseMove);document.removeEventListener("touchmove",this._onMouseMove);document.removeEventListener("mouseup",this._onMouseUp);document.removeEventListener("touchend",this._onMouseUp)}},{key:"_onMouseEnter",value:function e(t){var r=this._getCursorPosition(t);this.setState({cursorVisible:true,cursorPosition:r});this._onMouseMove(t)}},{key:"_onMouseLeave",value:function e(){this.setState({cursorVisible:false})}},{key:"_onMouseMove",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=r.getOutputTextureDimensions();var o=r.zoom.get();var a=this._getCursorPosition(t);this.setState({cursorPosition:a});var s=void 0;if(!this._lastDrawPosition){s=true}else{var l=this.getSharedState("size");var u=this._lastDrawPosition.clone().subtract(a).abs().len()/o;s=u>=l/10}if(this._drawing&&s){this._currentPath.addControlPoint(a.clone().divide(n));this.getSharedState("brush").render(i);this._lastDrawPosition=a.clone()}}},{key:"_onMouseMoveOnCanvas",value:function e(t){var r=this._getCursorPosition(t);this.setState({cursorPosition:r})}},{key:"_getPropsForSprite",value:function e(r){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getPropsForSprite",this).call(this,r);if(r instanceof d){n.hideContent=false}return n}},{key:"_getCursorStyle",value:function e(){var t=this.getSharedState("size");var r=this.getSharedState("color");var n=this.state.cursorPosition;return{left:n.x,top:n.y,width:t,height:t,background:r.toRGBA(),marginLeft:t*-.5,marginTop:t*-.5}}},{key:"_updateContainerRect",value:function e(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()}},{key:"_getCursorPosition",value:function e(t){var r=o.Utils.getEventPosition(t);var n=this._containerBoundingRect;return r.subtract(n.left,n.top)}},{key:"_getContainerProps",value:function e(){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getContainerProps",this).call(this);r.onMouseDown=r.onTouchStart=this._onMouseDown;return r}},{key:"_getInnerContainerProps",value:function e(){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getInnerContainerProps",this).call(this);delete r.onClick;r.onMouseEnter=this._onMouseEnter;r.onMouseLeave=this._onMouseLeave;r.onMouseMove=this._onMouseMoveOnCanvas;return r}},{key:"_renderOverlayControls",value:function e(){var t=this.state.cursorVisible?"is-visible":null;return o.ReactBEM.createElement("div",{bem:"$b:brushCanvasControls"},o.ReactBEM.createElement("div",{bem:"e:cursor",className:t,style:this._getCursorStyle()}))}}]);return t}(s.default);t.default=v;v.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=c(i);var a=r(163);var s=c(a);var l=r(164);var u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function d(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=function(e){d(t,e);function t(){f(this,t);return p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onExit",value:function e(){var t=this.context.editor;var r=this.getSharedState("operation");if(r.getPaths().length===0){t.operations.remove(r)}t.zoom.restore();t.features.enable("zoom","drag");t.render()}},{key:"onEnter",value:function e(t,r){var n=this.context.editor;n.zoom.save();n.zoom.set("auto",function(){n.render()});var i=n.getOutputDimensions();var o=n.operations.exists("selective-blur");var a=n.operations.getOrCreate("selective-blur");var s=a.serializeOptions();var l=a.getBrush();var u=i.min()*.1;var c=1;var f=a.getInputDimensions();this.setSharedState({operationExistedBefore:o,operation:a,brush:l,initialOptions:s,size:u,hardness:c,inputDimensions:f})}},{key:"isAvailable",value:function e(t){return t.isToolEnabled("selective-blur")}}]);return t}(o.default);h.controlsComponent=s.default;h.canvasControlsComponent=u.default;h.identifier="selective-blur";h.iconPath="controls/overview/selective-blur.png";h.languageKey="controls.overview.selective-blur";h.defaultOptions={};h.requiredOperations=["selective-blur"];t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(3);var s=p(a);var l=r(13);var u=p(l);var c=r(6);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=function(e){_(t,e);function t(){var e,r;h(this,t);for(var n=arguments.length,i=Array(n),a=0;a<n;a++){i[a]=arguments[a]}var s=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));s._hasDoneButton=false;s._brushSize=s.getSharedState("size");s._bindAll("_onOperationUpdated","_onOperationRemoved","_onSizeUpdated","_onBlurRadiusChange");s.state={sizeControlsEnabled:false};s._events=(r={},d(r,o.Constants.EVENTS.OPERATION_UPDATED,s._onOperationUpdated),d(r,o.Constants.EVENTS.OPERATION_REMOVED,s._onOperationRemoved),r);return s}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);var r=this.context.editor;r.zoom.set("auto");r.features.disable("zoom","drag")}},{key:"_onOperationRemoved",value:function e(t){if(t!==this.getSharedState("operation"))return;if(this._backButtonClicked)return;var r=this.context.editor;var n=r.operations.getOrCreate("selective-blur");var i=n.getBrush();this.setSharedState({operation:n,brush:i,operationExistedBefore:false,initialOptions:{}});r.render()}},{key:"_onOperationUpdated",value:function e(t){if(t===this.getSharedState("operation")){var r=this.context.editor;r.render();this.forceUpdate()}}},{key:"_onSizeUpdated",value:function e(t){this.setSharedState({size:t});this._brushSize=t}},{key:"_onBlurRadiusChange",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=this.getSharedState("inputDimensions");this.getSharedState("operation").setBlurRadius(t/i.min());var o=this.context.editor;o.render();if(n){o.history.add(this.getSharedState("operation"),{blurRadius:r/i.min()},true)}}},{key:"renderOverlayControls",value:function e(){var t=this.getSharedState("inputDimensions");var r=t.min();var n=this.getSharedState("operation").getBlurRadius()*r;return o.ReactBEM.createElement(f.default,{minValue:0,maxValue:Math.min(180,Math.round(r*.1)),value:n,valueUnit:"px",label:this._t("controls.selectiveBlur.blurRadius"),onChange:this._onBlurRadiusChange})}},{key:"renderControls",value:function e(){var t=this.context.editor;var r=t.zoom.get();var n=[];var i=t.getFinalDimensions();var a=1;var s=Math.round(i.clone().multiply(r).min()/2);var l=this._brushSize;n.push(o.ReactBEM.createElement("div",{bem:"e:cell m:slider"},o.ReactBEM.createElement(u.default,{style:"large",minValue:a,maxValue:s,valueUnit:"px",middleDot:false,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:l})));return n}}]);return t}(s.default);t.default=m;m.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(14);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=function(e){p(t,e);function t(){var e;c(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var a=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));a._windowResized=false;a._drawing=false;a._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize");a._lastDrawPosition=null;a._events=o.SDKUtils.extend(a._events,u({},o.Constants.EVENTS.WINDOW_RESIZE,a._onWindowResize));a.state={cursorVisible:false,cursorPosition:new o.Vector2};return a}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._updateContainerRect()}},{key:"componentDidUpdate",value:function e(){if(this._windowResized){this._updateContainerRect();this._windowResized=false}}},{key:"_onWindowResize",value:function e(){this._windowResized=true}},{key:"_onOperationRemoved",value:function e(t){}},{key:"_onOperationUpdated",value:function e(t){if(t===this.getSharedState("operation")){this.forceUpdate()}}},{key:"_onMouseDown",value:function e(t){t.preventDefault();var r=this.getSharedState("operation");this._optionsBeforeDraw=r.serializeOptions();this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore");this.setSharedState({operationExistedBefore:true},false);var n=this.context.editor.getOutputDimensions();var i=this._getCursorPosition(t);var o=this.getSharedState("size")/n.min();var a=this.getSharedState("hardness");this._drawing=true;this._currentPath=r.createPath(o,a);this._currentPath.addControlPoint(i.clone().divide(n));document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);document.addEventListener("mouseup",this._onMouseUp);document.addEventListener("touchend",this._onMouseUp)}},{key:"_onMouseUp",value:function e(){this._currentPath.setClosed(true);var t=this.context.editor;t.render();this._currentPath=null;this._drawing=false;t.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw);document.removeEventListener("mousemove",this._onMouseMove);document.removeEventListener("touchmove",this._onMouseMove);document.removeEventListener("mouseup",this._onMouseUp);document.removeEventListener("touchend",this._onMouseUp)}},{key:"_onMouseEnter",value:function e(t){var r=this._getCursorPosition(t);this.setState({cursorVisible:true,cursorPosition:r});this._onMouseMove(t)}},{key:"_onMouseLeave",value:function e(){this.setState({cursorVisible:false})}},{key:"_onMouseMove",value:function e(t){var r=this.context.editor;var n=r.getOutputDimensions();var i=r.zoom.get();var o=this._getCursorPosition(t);this.setState({cursorPosition:o});var a=void 0;if(!this._lastDrawPosition){a=true}else{var s=this.getSharedState("size");var l=this._lastDrawPosition.clone().subtract(o).abs().len()/i;a=l>=s/10}if(this._drawing&&a){this._currentPath.addControlPoint(o.clone().divide(n));this._lastDrawPosition=o.clone();r.render()}}},{key:"_onMouseMoveOnCanvas",value:function e(t){var r=this._getCursorPosition(t);this.setState({cursorPosition:r})}},{key:"_getCursorStyle",value:function e(){var t=this.getSharedState("size");var r=this.state.cursorPosition;return{left:r.x,top:r.y,width:t,height:t,marginLeft:t*-.5,marginTop:t*-.5}}},{key:"_updateContainerRect",value:function e(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()}},{key:"_getCursorPosition",value:function e(t){var r=o.Utils.getEventPosition(t);var n=this._containerBoundingRect;return r.subtract(n.left,n.top)}},{key:"_getContainerProps",value:function e(){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getContainerProps",this).call(this);r.onMouseDown=r.onTouchStart=this._onMouseDown;return r}},{key:"_getInnerContainerProps",value:function e(){var r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getInnerContainerProps",this).call(this);delete r.onClick;r.onMouseEnter=this._onMouseEnter;r.onMouseLeave=this._onMouseLeave;r.onMouseMove=this._onMouseMoveOnCanvas;return r}},{key:"_renderSpriteItems",value:function e(){return null}},{key:"_renderOverlayControls",value:function e(){var t=this.state.cursorVisible?"is-visible":null;return o.ReactBEM.createElement("div",{bem:"$b:selectiveBlurCanvasControls"},o.ReactBEM.createElement("div",{bem:"e:cursor",className:t,style:this._getCursorStyle()}))}}]);return t}(s.default);t.default=d;d.contextTypes=s.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=l(i);var a=r(166);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){u(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,null,[{key:"onExit",value:function e(){var t=this.context.editor;var r=this.getSharedState("operation");var n=this.getSharedState("initialOptions");var i=r.getFrame();var o=r.getScale();if((i&&i.identifier)!==(n.frame&&n.frame.identifier)||o!==n.scale){t.history.add(r,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore"))}if(!r.getFrame()){t.operations.remove(r)}t.render()}},{key:"onEnter",value:function e(t){var r=this.context.editor;var n=r.operations.exists("frame");var i=r.operations.getOrCreate("frame");var o=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:n,initialOptions:o,inputDimensions:i.getInputDimensions(),frame:i.getFrame()})}},{key:"isAvailable",value:function e(t){return t.isToolAllowed("frame")&&t.isToolEnabled("frame")}}]);return t}(o.default);p.controlsComponent=s.default;p.identifier="frame";p.iconPath="controls/overview/frame.png";p.languageKey="controls.overview.frame";p.defaultOptions={frames:[]};p.requiredOperations=["sprite"];p.getPreloadAssets=o.default.getPreloadAssets;t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(3);var a=k(o);var s=r(2);var l=k(s);var u=r(1);var c=k(u);var f=r(48);var p=k(f);var d=r(167);var h=k(d);var v=r(29);var _=k(v);var m=r(6);var y=k(m);var g=r(49);var b=k(g);function k(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function E(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function S(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=function(e){S(t,e);function t(){var e,r;O(this,t);for(var n=arguments.length,o=Array(n),a=0;a<n;a++){o[a]=arguments[a]}var s=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));s._operation=s.getSharedState("operation");s._bindAll("_onScaleChange","_onColorChange","_onOperationUpdated","_onOperationRemoved");s._events=(r={},w(r,i.Constants.EVENTS.OPERATION_UPDATED,s._onOperationUpdated),w(r,i.Constants.EVENTS.OPERATION_REMOVED,s._onOperationRemoved),r);s._initFrameManager();return s}n(t,[{key:"_initFrameManager",value:function e(){this._frameManager=new p.default(this.context.ui,this.props.options)}},{key:"_onOperationUpdated",value:function e(t){if(t===this.getSharedState("operation")){this.forceSharedUpdate()}}},{key:"_onOperationRemoved",value:function e(t){if(t!==this.getSharedState("operation"))return;if(this._backButtonClicked)return;var r=this.context.editor;var n=r.operations.getOrCreate("frame");this.setSharedState({operation:n,frame:null,operationExistedBefore:false,initialOptions:{}});r.render()}},{key:"_onScaleChange",value:function e(t){var r=this.context.editor;var n=this.getSharedState("inputDimensions");this._operation.setScale(t/n.min());r.render()}},{key:"_onColorChange",value:function e(t){var r=this.getSharedState("operation");r.setTintColor(t.clone());var n=this.context.editor;n.render()}},{key:"_onBackClick",value:function e(t){this._backButtonClicked=true;this.props.onSwitchControls("home")}},{key:"_onFrameClick",value:function e(t){var r=this;var n=this.context.editor;var i=this.getSharedState("operation");if(t===null){i.setFrame(null);n.render();return this.setSharedState({frame:null})}var o=void 0;var a=setTimeout(function(){o=c.default.instance.displayLoading(r._t("loading.loading"))},100);var s=new b.default(this.context.ui,t);s.load().then(function(){if(o)o.close();if(a){clearTimeout(a);a=null}var e=s.getFrame();i.setFrame(e);var t=r.context.editor;t.render();r.setSharedState({frame:s})})}},{key:"renderOverlayControls",value:function e(){var t=this.getSharedState("frame");if(!t)return null;var r=this.getSharedState("inputDimensions");var n=5;var o=Math.round(.3*r.min());var a=this._operation.getScale()*r.min();return i.ReactBEM.createElement(y.default,{minValue:n,maxValue:o,value:a,valueUnit:"px",middleDot:false,label:this._t("controls.frame.scale"),onChange:this._onScaleChange})}},{key:"_renderListItems",value:function e(){var t=this;var r=this._frameManager.getFramesForCategory("all");var n=this.getSharedState("operation").getFrame();var o=i.ReactBEM.createElement("li",{bem:"e:item",key:"no-frame",onClick:this._onFrameClick.bind(this,null)},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:!n?"is-active":null},i.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/frame/no-frame.png",true)}),i.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.noFrame")))));return[o].concat(r.map(function(e,r){return i.ReactBEM.createElement(h.default,{frame:e,active:n&&n.identifier===e.identifier,onClick:t._onFrameClick.bind(t,e)})}))}},{key:"renderControls",value:function e(){var t=this.getSharedState("operation").getFrame();var r=this._renderListItems();var n=[i.ReactBEM.createElement("div",{bem:"e:cell m:list"},i.ReactBEM.createElement(l.default,{ref:"scrollbar"},i.ReactBEM.createElement("ul",{bem:"$e:list"},r)))];if(t&&t.tintable){var o=this.getSharedState("operation");n.push(i.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},i.ReactBEM.createElement(_.default,{initialValue:o.getTintColor().clone(),onChange:this._onColorChange})))}return n}}]);return t}(a.default);t.default=P;P.contextTypes=a.default.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s.state={frame:s.props.frame};return s}n(t,[{key:"componentDidMount",value:function e(){this._renderFrame()}},{key:"componentWillReceiveProps",value:function e(t){var r=this;if(this.props.frame!==t.frame){this.setState({frame:t.frame},function(){r._renderFrame()})}}},{key:"_renderFrame",value:function e(){var t=this.context.editor;var r=t.getSDK();var n=this.props.frame;var o=this._getAssetPath(n.thumbnail);var a=this.refs["canvas-"+n.identifier];var s=r.getPixelRatio();a.width=a.offsetWidth*s;a.height=a.offsetHeight*s;a.style.width=a.offsetWidth+"px";a.style.height=a.offsetHeight+"px";var l=a.getContext("2d");var u=new window.Image;u.addEventListener("load",function(){var e=Math.min(a.width/u.width,a.height/u.height);var t=new i.Vector2(u.width,u.height).multiply(e);var r=new i.Vector2(a.width,a.height).divide(2).subtract(t.clone().divide(2));l.drawImage(u,0,0,u.width,u.height,r.x,r.y,t.x,t.y)});u.crossOrigin=this.context.editor.getCrossOrigin();u.src=o}},{key:"renderWithBEM",value:function e(){return i.ReactBEM.createElement("bem",{specifier:"b:controls e:list"},i.ReactBEM.createElement("li",{bem:"e:item",key:this.props.frame.identifier,onClick:this.props.onClick},i.ReactBEM.createElement("bem",{specifier:"$b:controls"},i.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},i.ReactBEM.createElement("canvas",{bem:"e:canvas m:large",ref:"canvas-"+this.props.frame.identifier}),i.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:this.props.active?"is-active":null},i.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.frames."+this.props.frame.identifier)||this.props.frame.defaultName))))))}}]);return t}(i.BaseComponent);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r,n){o(this,e);this._editor=t;this._sdk=r;this._mediator=n;this._options=this._editor.getOptions();this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom}}n(e,[{key:"isEnabled",value:function e(t){var r=t.charAt(0).toUpperCase()+t.slice(1);var n=this._options.editor["enable"+r];return this._features[t]&&n}},{key:"enable",value:function e(){var t=this;for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}n.forEach(function(e){t._features[e]=true});this._mediator.emit(i.Constants.EVENTS.FEATURES_ENABLED,n);this._mediator.emit(i.Constants.EVENTS.FEATURES_UPDATED,n)}},{key:"disable",value:function e(){var t=this;for(var r=arguments.length,n=Array(r),o=0;o<r;o++){n[o]=arguments[o]}n.forEach(function(e){t._features[e]=false});this._mediator.emit(i.Constants.EVENTS.FEATURES_DISABLED,n);this._mediator.emit(i.Constants.EVENTS.FEATURES_UPDATED,n)}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=300;var u=function(e){s(t,e);function t(e,r,n){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i._editor=e;i._sdk=r;i._mediator=n;i._isDefaultZoom=false;i._zoom=i._sdk.getZoom();i._options=i._editor.getOptions();i._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(e){return e/100});return i}n(t,[{key:"in",value:function e(){var t=this._getClosestZoomLevel(this._zoom+.001,+1);if(!t)return this._zoomLevels[this._zoomLevels.length-1];this.set(t)}},{key:"out",value:function e(){var t=this._getClosestZoomLevel(this._zoom-.001,-1);if(!t)return this._zoomLevels[0];this.set(t)}},{key:"_getClosestZoomLevel",value:function e(t,r){if(r===-1){return this._zoomLevels.filter(function(e){return e<t}).pop()}else if(r===1){return this._zoomLevels.filter(function(e){return e>t})[0]}}},{key:"restore",value:function e(){if(!this._previousZoom)return;this.set(this._previousZoom);this._previousZoom=null}},{key:"save",value:function e(){this._previousZoom=this._zoom}},{key:"set",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(!this._editor.isReady()){return}var i=t;var o=this.getDefault();if(t==="auto"||i===o){i=o;t="auto";this._isDefaultZoom=true}else{this._isDefaultZoom=false}var a=Math.max(1,o*2);var s=n?this.getMinimum():0;i=Math.max(s,Math.min(a,i));this._zoom=i;this._sdk.setZoom(this._zoom);this._sdk.setTextureQuality(Math.min(this._zoom,1));this.emit("set",this._zoom,r)}},{key:"getDefault",value:function e(){var t=this._editor.getFinalDimensions(false);var r=this._editor.getCanvasDimensions();var n=i.SDKUtils.resizeVectorToFit(t,r);return n.divide(t).x}},{key:"getMinimum",value:function e(){var t=this._editor.getFinalDimensions();var r=i.SDKUtils.resizeVectorToFit(t,new i.Vector2(l,l));return r.divide(t).x}},{key:"isDefault",value:function e(){return this._isDefaultZoom}},{key:"get",value:function e(){return this._zoom}}]);return t}(i.EventEmitter);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(e,r,n){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i._editor=e;i._sdk=r;i._mediator=n;i._history=[];return i}n(t,[{key:"isAvailable",value:function e(){return this._history.length!==0}},{key:"add",value:function e(t,r,n){var o=this;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var s=void 0;if(t instanceof Array){var l=t;this._history.push(l);l.forEach(function(e){o._mediator.emit(i.Constants.EVENTS.HISTORY_UPDATED,e.operation)});s=l}else{s={operation:t,options:r,existent:n,undo:a};this._history.push(s);this._mediator.emit(i.Constants.EVENTS.HISTORY_UPDATED,t)}return s}},{key:"undo",value:function e(){var t=this;var r=this._editor.operations;var n=this._history.pop();if(n){var o=[].concat(n);o.forEach(function(e){var n=e.operation,o=e.existent,a=e.options,s=e.undo;t._mediator.emit(i.Constants.EVENTS.HISTORY_BEFORE_UNDO,e);if(!o){r.remove(n)}else{n=r.getOrCreate(n.constructor.identifier);n.set(a);t._mediator.emit(i.Constants.EVENTS.OPERATION_UPDATED,n)}if(typeof s==="function"){s(n,a)}t._mediator.emit(i.Constants.EVENTS.HISTORY_UPDATED,n);t._mediator.emit(i.Constants.EVENTS.HISTORY_UNDO,n)});this.emit("undo")}}},{key:"reset",value:function e(){this._history=[]}}]);return t}(i.EventEmitter);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(50);var o=l(i);var a=r(51);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="1.0.0"},function(e,t,r){e.exports=r(173)},function(e,t,r){var n=function(){return this}()||Function("return this")();var i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0;var o=i&&n.regeneratorRuntime;n.regeneratorRuntime=undefined;e.exports=r(174);if(i){n.regeneratorRuntime=o}else{try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=undefined}}},function(e,t){!function(t){"use strict";var r=Object.prototype;var n=r.hasOwnProperty;var i;var o=typeof Symbol==="function"?Symbol:{};var a=o.iterator||"@@iterator";var s=o.asyncIterator||"@@asyncIterator";var l=o.toStringTag||"@@toStringTag";var u=typeof e==="object";var c=t.regeneratorRuntime;if(c){if(u){e.exports=c}return}c=t.regeneratorRuntime=u?e.exports:{};function f(e,t,r,n){var i=t&&t.prototype instanceof y?t:y;var o=Object.create(i.prototype);var a=new R(n||[]);o._invoke=C(e,r,a);return o}c.wrap=f;function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var d="suspendedStart";var h="suspendedYield";var v="executing";var _="completed";var m={};function y(){}function g(){}function b(){}var k={};k[a]=function(){return this};var w=Object.getPrototypeOf;var O=w&&w(w(B([])));if(O&&O!==r&&n.call(O,a)){k=O}var E=b.prototype=y.prototype=Object.create(k);g.prototype=E.constructor=b;b.constructor=g;b[l]=g.displayName="GeneratorFunction";function S(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}c.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===g||(t.displayName||t.name)==="GeneratorFunction":false};c.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,b)}else{e.__proto__=b;if(!(l in e)){e[l]="GeneratorFunction"}}e.prototype=Object.create(E);return e};c.awrap=function(e){return{__await:e}};function P(e){function t(r,i,o,a){var s=p(e[r],e,i);if(s.type==="throw"){a(s.arg)}else{var l=s.arg;var u=l.value;if(u&&typeof u==="object"&&n.call(u,"__await")){return Promise.resolve(u.__await).then(function(e){t("next",e,o,a)},function(e){t("throw",e,o,a)})}return Promise.resolve(u).then(function(e){l.value=e;o(l)},a)}}var r;function i(e,n){function i(){return new Promise(function(r,i){t(e,n,r,i)})}return r=r?r.then(i,i):i()}this._invoke=i}S(P.prototype);P.prototype[s]=function(){return this};c.AsyncIterator=P;c.async=function(e,t,r,n){var i=new P(f(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function C(e,t,r){var n=d;return function i(o,a){if(n===v){throw new Error("Generator is already running")}if(n===_){if(o==="throw"){throw a}return T()}r.method=o;r.arg=a;while(true){var s=r.delegate;if(s){var l=M(s,r);if(l){if(l===m)continue;return l}}if(r.method==="next"){r.sent=r._sent=r.arg}else if(r.method==="throw"){if(n===d){n=_;throw r.arg}r.dispatchException(r.arg)}else if(r.method==="return"){r.abrupt("return",r.arg)}n=v;var u=p(e,t,r);if(u.type==="normal"){n=r.done?_:h;if(u.arg===m){continue}return{value:u.arg,done:r.done}}else if(u.type==="throw"){n=_;r.method="throw";r.arg=u.arg}}}}function M(e,t){var r=e.iterator[t.method];if(r===i){t.delegate=null;if(t.method==="throw"){if(e.iterator.return){t.method="return";t.arg=i;M(e,t);if(t.method==="throw"){return m}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=p(r,e.iterator,t.arg);if(n.type==="throw"){t.method="throw";t.arg=n.arg;t.delegate=null;return m}var o=n.arg;if(!o){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return m}if(o.done){t[e.resultName]=o.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=i}}else{return o}t.delegate=null;return m}S(E);E[l]="Generator";E[a]=function(){return this};E.toString=function(){return"[object Generator]"};function j(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(j,this);this.reset(true)}c.keys=function(e){var t=[];for(var r in e){t.push(r)}t.reverse();return function r(){while(t.length){var n=t.pop();if(n in e){r.value=n;r.done=false;return r}}r.done=true;return r}};function B(e){if(e){var t=e[a];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var r=-1,o=function t(){while(++r<e.length){if(n.call(e,r)){t.value=e[r];t.done=false;return t}}t.value=i;t.done=true;return t};return o.next=o}}return{next:T}}c.values=B;function T(){return{value:i,done:true}}R.prototype={constructor:R,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=i;this.done=false;this.delegate=null;this.method="next";this.arg=i;this.tryEntries.forEach(x);if(!e){for(var t in this){if(t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))){this[t]=i}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(e){if(this.done){throw e}var t=this;function r(r,n){s.type="throw";s.arg=e;t.next=r;if(n){t.method="next";t.arg=i}return!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];var s=a.completion;if(a.tryLoc==="root"){return r("end")}if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc");var u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc){return r(a.catchLoc,true)}else if(this.prev<a.finallyLoc){return r(a.finallyLoc)}}else if(l){if(this.prev<a.catchLoc){return r(a.catchLoc,true)}}else if(u){if(this.prev<a.finallyLoc){return r(a.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}if(o&&(e==="break"||e==="continue")&&o.tryLoc<=t&&t<=o.finallyLoc){o=null}var a=o?o.completion:{};a.type=e;a.arg=t;if(o){this.method="next";this.next=o.finallyLoc;return m}return this.complete(a)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);x(r);return m}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:B(e),resultName:t,nextLoc:r};if(this.method==="next"){this.arg=i}return m}}}(function(){return this}()||Function("return this")())},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r){o(this,e);this._ui=t;this._options=r;this._brushes=[];this._brushesById={};this._addBrushes(i.Constants.DEFAULTS.BRUSHES);var n=this._options,a=n.brushes,s=n.replaceBrushes,l=n.availableBrushes;if(this._options.brushes){this._addBrushes(a,s)}if(l){this._brushes=this._brushes.filter(function(e){return l.indexOf(e.identifier)!==-1})}}n(e,[{key:"_addBrushes",value:function e(t,r){var n=this;if(r){this._brushes=[];this._brushesById={}}t.forEach(function(e){n._brushes.push(e);n._brushesById[e.identifier]=e})}},{key:"getBrushByIdentifier",value:function e(t){return this._brushesById[t]}},{key:"getBrushes",value:function e(){return this._brushes}},{key:"getFirstBrush",value:function e(){return this._brushes[0]}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(52);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f={italic:"i"};var p=function(e){c(t,e);function t(){l(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"load",value:function e(){if(this._fonts.length){this._addStylesheetTag()}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this)}},{key:"_addStylesheetTag",value:function e(){var t=this._getFamiliesString();var r=document.createElement("link");r.rel="stylesheet";r.href="https://fonts.googleapis.com/css?family="+t;var n=document.getElementsByTagName("head")[0];n.appendChild(r)}},{key:"_getFamiliesString",value:function e(){var t={};this._fonts.forEach(function(e){var r=e.getFontFamily();var n=e.getFontStyle();var i=e.getFontWeight();t[r]=t[r]||[];if(typeof i!=="undefined"){t[r].push(""+i+(f[n]||""))}else{t[r].push(400)}});var r=[];for(var n in t){var i=t[n];var o=i.length?":"+i.join(","):"";var a=n.replace(" ","+")+o;r.push(a)}return r.join("|")}}]);return t}(a.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(178);var o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):r(39);var u=50;var c=5e3;var f=function(){function e(t){s(this,e);this._fontVariation=t;this._defaultFontRuler=new o.default;this._customFontRuler=new o.default(this._fontVariation)}n(e,[{key:"observe",value:function e(){var t=this;var r=l();return new Promise(function(e,n){var i=window.setInterval(function(){var o=t._defaultFontRuler.getWidth()!==t._customFontRuler.getWidth();if(o){window.clearInterval(i);return e()}else{if(l()-r>=c){var a=new Error("Failed to load font "+t._fontVariation.getFontFamily()+".");a.font=t._fontVariation;return n(a)}}},u)})}},{key:"dispose",value:function e(){this._defaultFontRuler.dispose();this._customFontRuler.dispose()}}]);return e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(47);var o=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=30;var u="abcdefghijklmnopqrstuvwxzy";var c=function(){function e(t){s(this,e);this._fontVariation=t||new o.default({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"});this._createRuler()}n(e,[{key:"_createRuler",value:function e(){this._ruler=document.createElement("div");this._ruler.innerText=u;document.body.appendChild(this._ruler);this._setRulerStyle()}},{key:"_setRulerStyle",value:function e(){this._ruler.style.cssText="\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: "+this._fontVariation.getFontStyle()+" "+this._fontVariation.getFontWeight()+" "+l+"px "+this._fontVariation.getFontFamily()+";\n    "}},{key:"setFontVariation",value:function e(t){this._fontVariation=t;this._setRulerStyle()}},{key:"getWidth",value:function e(){return this._ruler.offsetWidth}},{key:"dispose",value:function e(){if(this._ruler){this._ruler.parentNode.removeChild(this._ruler);this._ruler=null}}}]);return e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(52);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){l(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"load",value:function e(){var r=this;var n=[];this._fonts.forEach(function(e){var t=r._ui.getAssetPath(e.getFilePath(),false,true);n.push('@font-face {\n        font-family: "'+e.getFontFamily()+"\";\n        src: url('"+t+"') format('woff');\n        font-weight: "+e.getFontWeight()+";\n        font-style: "+e.getFontStyle()+";\n      }")});var o=n.join("\n");var a=document.createElement("style");a.innerHTML=o;var s=document.getElementsByTagName("head")[0];s.appendChild(a);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this)}}]);return t}(a.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(53);var o=l(i);var a=r(54);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="1.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(31);var o=l(i);var a=r(32);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="2.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(t,r){var n=this;o(this,e);this._ui=t;this._options=r;this._overlays=i.SharedConstants.DEFAULTS.OVERLAYS.slice(0);this._overlaysByIdentifier={};if(r.overlays){if(r.replaceOverlays){this._overlays=r.overlays}else{this._overlays=this._overlays.concat(r.overlays)}}if(r.availableOverlays){this._overlays=this._overlays.filter(function(e){return r.availableOverlays.indexOf(e.identifier)!==-1})}this._overlays.forEach(function(e){n._overlaysByIdentifier[e.identifier]=e})}n(e,[{key:"getOverlays",value:function e(){return this._overlays}},{key:"getOverlayByIdentifier",value:function e(t){return this._overlaysByIdentifier[t]}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(184);var o=l(i);var a=r(185);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="2.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(31);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){a(this,t);return s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(i.default);t.default=u;u.version="2.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(32);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var u=function(e){l(t,e);function t(){a(this,t);return s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(i.default);t.default=u;u.version="2.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(56);var o=l(i);var a=r(57);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="3.0.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(188);var o=l(i);var a=r(189);var s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){u(this,e);this._editor=t}n(e,[{key:"serialize",value:function e(){var t=new o.default(this._editor);return t.serialize.apply(t,arguments)}},{key:"deserialize",value:function e(t){var r=new s.default(this._editor,t);return r.deserialize()}}]);return e}();t.default=c;c.version="3.1.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(56);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=function(e){c(t,e);function t(){l(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_serializeTextDesign",value:function e(t,r){var n=r.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],true);n.color={rgba:n.color};var i=r.getLayout();if(i){n.identifier=i.constructor.identifier}return{type:"textdesign",options:n}}}]);return t}(a.default);t.default=f;f.version="3.1.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(0);var a=r(57);var s=p(a);var l=r(58);var u=p(l);var c=r(15);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=function(e){v(t,e);function t(){d(this,t);return h(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"_deserializeTextDesign",value:function e(t,r){var i=this;var a=r.options;var s=a.position,l=a.rotation,c=a.flipHorizontally,p=a.flipVertically,d=a.text,h=a.color,v=a.width,_=a.seed,m=a.inverted,y=a.identifier;var g=new u.default(this._ui,this._getOptions("textdesign"));var b=new f.default(this._ui,{fonts:o.Constants.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});var k=t.constructor.TextDesignSprite.AssetManager;var w=this._ui.getFontLoader();var O=g.getLayoutByIdentifier(y);var E=new O;w.setFonts(b.getFonts());k.setFonts(n({},k.getFonts(),b.getVariationsByIdentifier()));return w.load().then(function(){var e=E.getImagePaths().map(function(e){return{path:e,fullPath:i._ui.getAssetPath(e),image:null}});return k.loadImages(e).then(function(){E.onImagesLoaded();return t.createTextDesign({position:s,rotation:l,flipHorizontally:c,flipVertically:p,text:d,color:o.Color.fromArray(h.rgba),width:v,seed:_,inverted:m,layout:E})})})}}]);return t}(s.default);t.default=_;_.version="3.1.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var o=r(0);var a=r(191);var s=h(a);var l=r(192);var u=h(l);var c=r(193);var f=h(c);var p=r(194);var d=h(p);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function m(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var y=function(e){m(t,e);function t(){var e;v(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var o=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));o._modalManager=o.props.modalManager;o._bindAll("_onModalManagerUpdate");return o}n(t,[{key:"componentDidMount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this);this._modalManager.on("update",this._onModalManagerUpdate)}},{key:"componentWillUnmount",value:function e(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this);this._modalManager.off("update",this._onModalManagerUpdate)}},{key:"_onModalManagerUpdate",value:function e(){this.forceUpdate()}},{key:"_onModalClosed",value:function e(t){this._modalManager.removeModal(t)}},{key:"_renderModals",value:function e(){var t=this;var r=this._modalManager.getModals();return r.map(function(e){var r=void 0;switch(e.type){case"loading":r=s.default;break;case"warning":r=u.default;break;case"error":r=f.default;break;case"progress":r=d.default;break}return o.ReactBEM.createElement(r,{modal:e,onClose:t._onModalClosed.bind(t,e)})})}},{key:"renderWithBEM",value:function e(){return o.ReactBEM.createElement("div",null,this._renderModals())}}]);return t}(o.BaseComponent);t.default=y;y.contextTypes=o.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t=this.props.modal;return i.ReactBEM.createElement("bem",{specifier:"$b:modals"},i.ReactBEM.createElement("div",{bem:"e:overlay"},i.ReactBEM.createElement("div",{bem:"e:modal m:loading"},i.ReactBEM.createElement("div",{bem:"e:text"},t.text))))}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={modal:i.PropTypes.object};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t=this.props.modal;return i.ReactBEM.createElement("bem",{specifier:"$b:modals"},i.ReactBEM.createElement("div",{bem:"e:modal m:warning"},i.ReactBEM.createElement("div",{bem:"e:title"},t.title),i.ReactBEM.createElement("div",{bem:"e:text"},t.text),i.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this.props.onClose},"OK")))}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={modal:i.PropTypes.object};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){var e;o(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++){n[i]=arguments[i]}var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n)));s._bindAll("_onClose");return s}n(t,[{key:"_onClose",value:function e(){this.props.modal.close()}},{key:"renderWithBEM",value:function e(){var t=this.props.modal;var r=i.ReactBEM.createElement("div",{bem:"e:modal m:error"},i.ReactBEM.createElement("div",{bem:"e:title"},t.title),i.ReactBEM.createElement("div",{bem:"e:text"},t.text),i.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this._onClose},"OK"));var n=t.overlay?i.ReactBEM.createElement("div",{bem:"e:overlay"},r):r;return i.ReactBEM.createElement("bem",{specifier:"$b:modals"},n)}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={modal:i.PropTypes.object};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=function(e){s(t,e);function t(){o(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"renderWithBEM",value:function e(){var t=this.props.modal;var r=t.data.progress;var n={width:((r||0)*100).toFixed(2)+"%"};return i.ReactBEM.createElement("bem",{specifier:"$b:modals"},i.ReactBEM.createElement("div",{bem:"e:overlay"},i.ReactBEM.createElement("div",{bem:"e:modal m:loading"},i.ReactBEM.createElement("div",{bem:"e:text"},t.text),i.ReactBEM.createElement("bem",{specifier:"b:loadingModal"},i.ReactBEM.createElement("div",{bem:"$e:progressBar"},i.ReactBEM.createElement("div",{bem:"e:progress",style:n}))))))}}]);return t}(i.BaseComponent);t.default=l;l.propTypes={modal:i.PropTypes.object};l.contextTypes=i.BaseComponent.contextTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var o=r(43);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=5e3;var p=function(e){c(t,e);function t(e,r,n){l(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i._ui=e;i._options=r;i._mediator=n;i._assets={};i._editor=new a.default(e,r,n,true);i._assets=["controls/back.png","controls/minus.png","controls/plus.png","controls/tick.png","controls/webcam/shutter.png","controls/knobs/remove.png","controls/knobs/resize-diagonal-down.png","controls/knobs/resize-diagonal-up.png","controls/knobs/rotate.png","editor/export.png","editor/new.png","editor/undo.png",["splash/photo-roll.png",false,true],["splash/webcam.png",false,true],"top-bar/back.png","close.png"];i._appendControlsAssets();return i}n(t,[{key:"_appendControlsAssets",value:function e(){var t=this._editor.controls.getAvailable();for(var r in t){var n=t[r];if(this._editor.controls.isEnabled(r)){this._assets=this._assets.concat(n.getPreloadAssets(this._editor));this._assets.push(n.iconPath)}}}},{key:"load",value:function e(){var t=this;var r=this._assets.slice();var n=r.length;var o=0;var a=function e(){o++;t.emit("progress",o/n);if(o===n){t.emit("done")}};var s=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"timed out";i.Log.warn("Preloader",t+" "+r+".");a()};var l=function e(t){return window.setTimeout(function(){s(t)},f)};r.forEach(function(e){var r=true;var n=true;if(i.SDKUtils.isArray(e)){n=e[2];r=e[1];e=e[0]}var o=t._ui.getAssetPath(e,n,!r);var u=new window.Image;var c=l(o);u.addEventListener("load",function(){t._assets[o]=u;window.clearTimeout(c);a()});u.addEventListener("error",function(){window.clearTimeout(c);s(o,"was not found")});u.crossOrigin=i.SDKUtils.getCrossOriginValue(t._options.crossOrigin);u.src=o})}},{key:"getAsset",value:function e(t){return this._assets[t]}}]);return t}(i.EventEmitter);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(197);Object.defineProperty(t,"Provider",{enumerable:true,get:function e(){return s(n).default}});var i=r(198);Object.defineProperty(t,"Library",{enumerable:true,get:function e(){return s(i).default}});var o=r(199);Object.defineProperty(t,"SearchSuggestion",{enumerable:true,get:function e(){return s(o).default}});var a=r(200);Object.defineProperty(t,"Photo",{enumerable:true,get:function e(){return s(a).default}});function s(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(){o(this,e)}n(e,[{key:"getLibraries",value:function e(){i.Log.warn(this.constructor.name,"`getLibraries` is abstract and not implemented.");return i.Promise.resolve([])}},{key:"getSearchSuggestions",value:function e(){i.Log.warn(this.constructor.name,"`getSearchSuggestions` is abstract and not implemented.");return i.Promise.resolve([])}},{key:"getPhotosForLibrary",value:function e(t){i.Log.warn(this.constructor.name,"`getPhotosForLibrary` is abstract and not implemented.");return i.Promise.resolve([])}},{key:"searchPhotos",value:function e(t){i.Log.warn(this.constructor.name,"`searchPhotos` is abstract and not implemented.");return i.Promise.resolve([])}}]);return e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(t){n(this,e);this.name=t.name;this.coverImage=t.coverImage};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(t){n(this,e);this.query=t.query;this.name=this.query;this.coverImage=t.coverImage};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(t,r){n(this,e);this.library=t;this.title=r.title;this.urls=r.urls};t.default=i},function(e,t){e.exports={controls:{overview:{filters:"Filter",adjustments:"Korrekturen",transform:"Zuschneiden",blur:"Weichzeichnen",frame:"Rahmen",sticker:"Sticker",text:"Text",brush:"Malen",focus:"Focus","selective-blur":"Sel. Unschärfe"},text:{foreground:"Vordergrund",background:"Hintergrund",size:"Größe",font:"Schriftart",alignment:"Ausrichtung",takeToFront:"Nach oben",defaultText:"Doppelklick zum Bearbeiten!"},adjustments:{brightness:"Helligkeit",contrast:"Kontrast",saturation:"Sättigung",gamma:"Gamma",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",clarity:"Klarheit"},transform:{none:"Original",rotation:"Drehung"},focus:{none:"Original",radial:"Kreisförmig",mirrored:"Gespiegelt",blurRadius:"Radius"},selectiveBlur:{blurRadius:"Radius",size:"Dicke"},filters:{intensity:"Intensität",filters:{identity:"Original"}},sticker:{flip:"Spiegeln","flip-v":"Spiegeln (V)","flip-h":"Spiegeln (H)",takeToFront:"Nach oben",categories:{all:"Alle"}},brush:{size:"Dicke",color:"Farbe"},frame:{noFrame:"Kein Rahmen",scale:"Größe"}},webcam:{headline:"Mache ein Foto!"},editor:{headline:"Foto editieren",new:"Neu",backgroundImage:"Hintergrundbild",undo:"Rückgängig",export:"Speichern",zoom:"Zoom"},splash:{upload:{button:"Lade ein Foto hoch",description:"Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch"},webcam:{headline:"Webcam",description:"Klicke hier, um ein Foto mit deiner Webcam zu machen"},photoRoll:{headline:"Kostenloses Bildmaterial",description:"Suche dir eines von tausenden Stock Photos aus."}},photoRoll:{search:{placeholder:"Nach Fotos suchen",noSearchResults:'Entschuldigung, aber wir konnten für <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse für "${query}"'}}},generic:{back:"Zurück",cancel:"Abbrechen",color:"Farbe"},loading:{resizing:"Bild wird bearbeitet...",exporting:"Exportiere...",loading:"Lade..."},warnings:{imageResized_maxMegaPixels:{title:"Bild verkleinert",text:"Da dein Bild die maximale Größe von ${maxMegaPixels} Megapixeln überschreitet, wurde es auf ${width}x${height} Pixel verkleinert."},imageResized_maxDimensions:{title:"Bild verkleinert",text:"Aufgrund von Hardware-Beschränkungen wurde das Bild auf ${width}x${height} Pixel verkleinert."}},errors:{imageLoadFail:{title:"Bild konnte nicht geladen werden",text:"Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten."},webcamUnavailable:{title:"Webcam nicht verfügbar",text:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})"},webcamNotSupported:{title:"Webcam nicht unterstützt",text:"Dein Browser unterstützt das Webcam-Feature leider noch nicht."},renderingError:{title:"Rendering-Fehler",text:"Beim Rendern des Bildes ist ein Fehler aufgetreten."},context_lost:{title:"Es ist ein Fehler aufgetreten",text:"Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal."},context_lost_limit:{title:"Es ist ein Fehler aufgetreten",text:"Bild-Generierung ist mehrmals fehlgeschlagen."},loadingStickersFailed:{title:"Laden der Sticker fehlgeschlagen"},loadingFontsFailed:{title:"Laden der Schriftarten fehlgeschlagen",text:"Einige Schriftarten sind möglicherweise nicht verfügbar."},photoRollLoadFail:{title:"Laden der Photo Roll fehlgeschlagen",text:"Die Photo Roll konnte nicht geladen werden: ${error}"},invalidFileType:{text:"Der Dateityp ${fileType} wird nicht unterstützt."},title:"Es ist ein Fehler aufgetreten"}}},function(e,t){e.exports={controls:{overview:{filters:"Filters",adjustments:"Adjust",transform:"Transform",focus:"Focus",frame:"Frame",sticker:"Sticker",text:"Text",brush:"Brush","selective-blur":"Selective Blur"},text:{foreground:"Foreground",background:"Background",size:"Size",font:"Font",alignment:"Alignment",takeToFront:"To Front",defaultText:"Double-click to edit"},adjustments:{brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",exposure:"Exposure",gamma:"Gamma",shadows:"Shadows",highlights:"Highlights",clarity:"Clarity"},transform:{none:"Original",rotation:"Rotation"},focus:{none:"None",radial:"Radial",mirrored:"Mirrored",blurRadius:"Blur radius"},selectiveBlur:{blurRadius:"Blur radius",size:"Size"},filter:{intensity:"Intensity",filters:{identity:"None"}},sticker:{flip:"Flip","flip-v":"Flip (V)","flip-h":"Flip (H)",takeToFront:"To Front",categories:{all:"All"}},brush:{size:"Size",color:"Color"},frame:{noFrame:"No Frame",scale:"Scale"}},webcam:{headline:"Take a photo!"},editor:{headline:"Edit Photo",new:"New",backgroundImage:"Background Image",undo:"Undo",export:"Export",zoom:"Zoom"},splash:{upload:{button:"Upload your image",description:"Upload a picture from your library or just drag and drop"},webcam:{headline:"Webcam",description:"Take a picture with your webcam or phone"},photoRoll:{headline:"Free stock footage",description:"Select from thousands of Free Stock Photos"}},photoRoll:{search:{placeholder:"Search for photos",noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:"Back",cancel:"Cancel",color:"Color"},loading:{resizing:"Resizing...",exporting:"Exporting...",loading:"Loading..."},warnings:{imageResized_maxMegaPixels:{title:"Image resized",text:"Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels."},imageResized_maxDimensions:{title:"Image resized",text:"Due to hardware limitations your image has been resized to ${width}x${height} pixels."}},errors:{imageLoadFail:{title:"Failed to load image",text:"Failed to load the image at ${path}"},webcamUnavailable:{title:"Webcam unavailable",text:"Unable to display webcam image (Error: ${error})"},webcamNotSupported:{title:"Webcam not supported",text:"The webcam feature is not supported by your browser."},renderingError:{title:"Error while rendering",text:"An error has occurred while rendering the image."},context_lost:{title:"An error has occurred",text:"Your browser took too long to render the image. Please try applying less operations."},context_lost_limit:{title:"An error has occurred",text:"Your browser failed multiple times while rendering the image."},loadingStickersFailed:{title:"Failed to load stickers"},loadingFontsFailed:{title:"Failed to load fonts",text:"Some fonts might not be available."},photoRollLoadFail:{title:"Failed to load Photo Roll",text:"Failed to load photos for the photo roll: ${error}"},invalidFileType:{text:"The file type ${fileType} is not supported."},title:"An error has occurred"}}}])});
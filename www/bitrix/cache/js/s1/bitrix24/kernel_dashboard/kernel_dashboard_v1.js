; /* /bitrix/js/report/js/dashboard/board.min.js?15441274417849*/
; /* /bitrix/js/report/js/dashboard/row.min.js?154412744111129*/
; /* /bitrix/js/report/js/dashboard/rowlayouts.min.js?15441274417458*/
; /* /bitrix/js/report/js/dashboard/cell.min.js?15441274417082*/
; /* /bitrix/js/report/js/dashboard/widget.min.js?154412744113285*/
; /* /bitrix/js/report/js/dashboard/content.min.js?15441274413262*/
; /* /bitrix/js/report/js/dashboard/utils.min.js?1544127441841*/

; /* Start:"a:4:{s:4:"full";s:58:"/bitrix/js/report/js/dashboard/board.min.js?15441274417849";s:6:"source";s:39:"/bitrix/js/report/js/dashboard/board.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Report.Dashboard");BX.Report.Dashboard.Board=function(e){if(!BX.type.isPlainObject(e)){throw new Error("BX.Report.Dashboard.Board: 'options' is not an object.")}if(!BX.type.isDomNode(e.renderTo)){throw new Error("BX.Report.Dashboard.Board: 'renderTo' is not a DOMNode.")}window.addEventListener("scroll",BX.throttle(this.lazyLoad,100,this));this.renderTo=e.renderTo;this.id=e.id||null;this.rendered=false;this.designerMode=e.designerMode;this.defaultWidgetClass=e.defaultWidgetClass||"BX.Report.Dashboard.Widget";this.rowsOrder=[];this.layout={outerContainer:null,innerContainer:null,boardContainer:null,emptyBoardContainer:null};this.rowWithPseudoRows=null;this.addRows(e.rows);this.init()};BX.Report.Dashboard.Board.prototype={isEmpty:function(){return this.empty},setEmpty:function(e){this.empty=e;if(this.empty){BX.cleanNode(this.getBoardContainer());this.getBoardContainer().appendChild(this.getEmptyBoardContent())}else{BX.cleanNode(this.getBoardContainer())}},init:function(){BX.Report.Dashboard.BoardRepository.addBoard(this)},getId:function(){return this.id},toggleDesignerMode:function(){if(this.isDesignerMode()){this.setDesignerMode(false)}else{this.setDesignerMode(true)}},setDesignerMode:function(e){this.designerMode=e;if(this.designerMode){this.getInnerContainer().classList.add("report-visualconstructor-dashboard-designer-mode")}else{this.getInnerContainer().classList.remove("report-visualconstructor-dashboard-designer-mode")}},isDesignerMode:function(){return this.designerMode},getRenderToContainer:function(){return this.renderTo},getOuterContainer:function(){if(this.layout.outerContainer){return this.layout.outerContainer}this.layout.outerContainer=BX.create("div",{props:{className:"report-visualconstructor"}});return this.layout.outerContainer},getInnerContainer:function(){if(this.layout.innerContainer){return this.layout.innerContainer}this.layout.innerContainer=BX.create("div",{props:{className:"report-visualconstructor-inner"}});return this.layout.innerContainer},getBoardContainer:function(){if(this.layout.boardContainer){return this.layout.boardContainer}this.layout.boardContainer=BX.create("div",{props:{className:"report-visualconstructor-dashboard-container"}});return this.layout.boardContainer},lazyLoad:function(){var e=this.getRows();var t=document.documentElement.clientHeight;e.forEach(function(e){var r=e.getRowWrapper().getBoundingClientRect();if(r.top>=0&&r.top<=t||r.bottom>=0&&r.bottom<=t){e.lazyLoadWidgets()}})},addRow:function(e,t,r){if(this.isEmpty()){this.setEmpty(false)}var o=this.getRowObject(e);o.setBoard(this);if(r===true){this.addRowBefore(o,t)}else{this.addRowAfter(o,t)}jsDD.refreshDestArea();return o},getRowObject:function(e){var t;if(BX.type.isPlainObject(e)&&!(e instanceof BX.Report.Dashboard.Row)){t=new BX.Report.Dashboard.Row(e)}else if(e instanceof BX.Report.Dashboard.Row){t=e}else{throw new Error("Unable to create or get row object")}return t},addRowToStart:function(e){e.setBoard(this);this.rowsOrder.splice(0,0,e);if(this.isRendered()){BX.prepend(e.render(),this.getBoardContainer())}return e},addRowBefore:function(e,t){t=this.getRow(t);var r=BX.util.array_search(t,this.rowsOrder);if(r>=0){this.rowsOrder.splice(r,0,e);if(this.isRendered()){this.getBoardContainer().insertBefore(e.render(),t.getRowContainer())}}},addRowAfter:function(e,t){t=this.getRow(t);var r=BX.util.array_search(t,this.rowsOrder);var o=this.getNextRowSibling(t);if(r>=0&&o){this.rowsOrder.splice(r+1,0,e);if(this.isRendered()){this.getBoardContainer().insertBefore(e.render(),o.getRowContainer())}}else{this.rowsOrder.push(e);if(this.isRendered()){this.getBoardContainer().appendChild(e.render())}}},addRows:function(e){e.forEach(function(e){this.addRow(e)}.bind(this))},adjustRowsWeight:function(){var e=this.getRows();for(var t=0;t<e.length;t++){e[t].setWeight(t+1)}BX.onCustomEvent(this,"BX.Report.Dashboard.Board:afterRowsAdjust",[e])},getRows:function(){return this.rowsOrder},getRow:function(e){var t=e instanceof BX.Report.Dashboard.Row?e.getId():e;for(var r=0;r<this.rowsOrder.length;r++){if(this.rowsOrder[r]instanceof BX.Report.Dashboard.Row&&this.rowsOrder[r].getId()===t){return this.rowsOrder[r]}}return null},removeRow:function(e){var t=BX.util.array_search(e,this.rowsOrder);e.remove();this.rowsOrder.splice(t,1);BX.onCustomEvent(this,"BX.Report.Dashboard.Board:afterRowRemove",[{row:e}])},moveRow:function(e,t){e=this.getRow(e);t=this.getRow(t);if(!e||e===t){return false}var r=BX.util.array_search(e,this.rowsOrder);this.rowsOrder.splice(r,1);var o=BX.util.array_search(t,this.rowsOrder);if(o>=0){this.rowsOrder.splice(o,0,e);if(this.isRendered()){this.getBoardContainer().insertBefore(e.getRowContainer(),t.getRowContainer())}}else{this.rowsOrder.push(e);if(this.isRendered()){this.getBoardContainer().appendChild(e.getRowContainer())}}this.adjustRowsWeight();return true},getNextRowSibling:function(e){var t=this.getRowIndex(e);var r=this.getRows();return t!==-1&&r[t+1]?r[t+1]:null},getPreviousRowSibling:function(e){var t=this.getRowIndex(e);var r=this.getRows();return t>0&&r[t-1]?r[t-1]:null},getRowIndex:function(e){e=this.getRow(e);return BX.util.array_search(e,this.getRows())},render:function(){this.setDesignerMode(this.isDesignerMode());var e=document.createDocumentFragment();var t=this.getRows();BX.Report.Dashboard.Utils.forEach(t,function(r){e.appendChild(t[r].render())}.bind(this));BX.cleanNode(this.getBoardContainer());this.getBoardContainer().appendChild(e);if(!this.isRendered()){this.renderLayout();this.setRenderStatus(true);BX.onCustomEvent(this,"Dashboard.Board:onFirstRender",[this])}BX.onCustomEvent(this,"Dashboard.Board:onRender",[this])},renderLayout:function(){if(this.getOuterContainer().parentNode){return}var e=this.getInnerContainer();e.appendChild(this.getBoardContainer());this.getRenderToContainer().appendChild(e);this.lazyLoad()},getEmptyBoardContent:function(){if(this.layout.emptyBoardContainer){return this.layout.emptyBoardContainer}this.layout.emptyBoardContainer=BX.create("div",{attrs:{className:"report-visualconstructor-empty-board"},text:BX.message("DASHBOARD_EMPTY_BOARD_CONTENT")});return this.layout.emptyBoardContainer},setRenderStatus:function(e){if(BX.type.isBoolean(e)){this.rendered=e}else{throw Error("Render status might be boolean")}},isRendered:function(){return this.rendered},clearRows:function(){this.rowsOrder=[]},destroy:function(){this.rendered=false;BX.remove(this.getBoardContainer());var e=this.getRows();for(var t in e){if(e.hasOwnProperty(t)){e[t].destroy()}}},getWidget:function(e){var t=e instanceof BX.Report.Dashboard.Widget?e.getId():e;var r=this.getRows();for(var o=0;o<r.length;o++){if(r[o].getWidget(t)){return r[o].getWidget(t)}}return null},showPriorityPseudoRowsByYPos:function(e,t){var r=this.getRows();for(var o in r){if(!r.hasOwnProperty(o)){continue}var i=r[o];if(i.isPseudo()){continue}var s=i.getRectArea();var n=s.bottom;var a=s.top;if(a<=t&&n>=t){if(!i.hasShownPriorityPseudoRows){for(var d=0;d<e.length;d++){i.pseudoRowsList.push(e[d]);this.addRow(e[d],i,true)}i.hasShownPriorityPseudoRows=true}}else{var h=0;if(i.hasShownPriorityPseudoRows){for(var u=0;u<i.pseudoRowsList.length;u++){var f=i.pseudoRowsList[u];if(f.isRendered()){var l=f.getRectArea();if(!h){h=l.top}else if(h>l.top){h=l.top}}}if(t>n||t<h){this.removePseudoRows()}}}}},removePseudoRows:function(){var e=this.getRows();var t=[];for(var r=0;r<e.length;r++){if(e[r].isPseudo()){t.push(e[r])}else{e[r].hasShownPriorityPseudoRows=false}}for(var o=0;o<t.length;o++){this.removeRow(t[o])}jsDD.refreshDestArea()}};BX.Report.Dashboard.BoardRepository={dashboards:[],addBoard:function(e){this.dashboards.push(e)},getBoard:function(e){var t=this.getBoards();for(var r=0;r<t.length;r++){if(t[r].getId()===e){return t[r]}}return false},getBoards:function(){return this.dashboards}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/report/js/dashboard/row.min.js?154412744111129";s:6:"source";s:37:"/bitrix/js/report/js/dashboard/row.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Report.Dashboard");BX.Report.Dashboard.Row=function(t){this.id=t.id;this.weight=t.weight||0;this.layoutMap=t.layoutMap||"";this.widgetsOrder=[];this.pseudo=t.pseudo||false;if(BX.type.isArray(t.widgets)){this.addWidgets(t.widgets)}this.draggable=t.draggable||true;this.loaded=t.loaded||false;this.timer=null;this.isScrollingUp=false;this.isScrollingDown=false;this.timer=null;this.rectArea=null;this.board={};this.rowLayout=new BX.Report.Dashboard.Row.LayoutFabric({row:this,map:this.layoutMap});this.layout={rowContainer:null,rowMoveControlButton:null,rowWrapper:null,rowAddButton:null,rowRemoveButton:null,controlsContainer:null,contentContainer:null,actionMenuOpenButton:null};this.pseudoRowsList=[]};BX.Report.Dashboard.Row.prototype={isPseudo:function(){return this.pseudo},removePseudo:function(){this.pseudo=false;if(this.isRendered()){this.getRowContainer().classList.remove("report-visualconstructor-dashboard-pseudo-row")}},getWidgetClass:function(t){var e=BX.Report.Dashboard.Utils.getClass(t);if(BX.type.isFunction(e)){return e}return BX.Report.Dashboard.Widget},getRowContainer:function(){if(this.layout.rowContainer){return this.layout.rowContainer}this.layout.rowContainer=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-row-container","data-id":this.getId(),"data-weight":this.getWeight(),"data-type":"row-container"}});if(this.isPseudo()){this.layout.rowContainer.classList.add("report-visualconstructor-dashboard-pseudo-row")}else{jsDD.registerDest(this.layout.rowContainer,31)}this.makeDraggable();return this.layout.rowContainer},getRowWrapper:function(){if(this.layout.rowWrapper){return this.layout.rowWrapper}this.layout.rowWrapper=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-row-wrapper","data-id":this.getId(),"data-type":"row-wrapper"}});return this.layout.rowWrapper},getRowMoveControlButton:function(){if(this.layout.rowMoveControlButton){return this.layout.rowMoveControlButton}this.layout.rowMoveControlButton=BX.create("div",{text:"^",props:{className:"report-visualconstructor-dashboard-row-move-control"}});return this.layout.rowMoveControlButton},getRowAddButton:function(){if(this.layout.rowAddButton){return this.layout.rowAddButton}this.layout.rowAddButton=BX.create("div",{text:"+",props:{className:"report-visualconstructor-dashboard-row-add-control"},events:{click:this.rowAddButtonClickHandler.bind(this)}});return this.layout.rowAddButton},getRowLayoutChooseContent:function(){var t=new BX.Report.Dashboard.Row.HorizontalLinear({row:this,cellCount:1});var e=new BX.Report.Dashboard.Row.HorizontalLinear({row:this,cellCount:2});var o=new BX.Report.Dashboard.Row.HorizontalLinear({row:this,cellCount:3});var r=new BX.Report.Dashboard.Row.HorizontalLinear({row:this,cellCount:4});return BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-row-miniature-popup-content"},children:[t.getMiniatureContainer(),e.getMiniatureContainer(),o.getMiniatureContainer(),r.getMiniatureContainer()]})},rowAddButtonClickHandler:function(){this.openRowLayoutChoosePopup()},openRowLayoutChoosePopup:function(){this.addRowPopup=new BX.PopupWindow("report-visualconstructor-dashboard-add-row-popup-"+this.getId(),this.getRowAddButton(),{title:"Select Row Layout",closeIcon:{right:"20px",top:"10px"},angle:true,autoHide:true,content:this.getRowLayoutChooseContent(),events:{onPopupClose:this.unpinRowAddButton.bind(this)}});this.addRowPopup.show();this.pinRowAddButton()},pinRowAddButton:function(){this.getRowAddButton().classList.add("report-visualconstructor-dashboard-add-row-popup-opened")},unpinRowAddButton:function(){this.getRowAddButton().classList.remove("report-visualconstructor-dashboard-add-row-popup-opened")},render:function(){var t=this.getRowContainer();var e=this.getRowWrapper();e.appendChild(this.getRowLayout().render());t.appendChild(e);t.appendChild(this.getRowMoveControlButton());t.appendChild(this.getRowAddButton());this.setRenderStatus(true);return t},getId:function(){return this.id},setId:function(t){if(this.isRendered()){this.getRowContainer().setAttribute("data-id",t);this.getRowWrapper().setAttribute("data-id",t)}this.id=t},getWeight:function(){return this.weight},setWeight:function(t){this.weight=t;if(this.isRendered()){this.getRowContainer().setAttribute("data-weight",t)}},getBoard:function(){return this.board},setBoard:function(t){this.board=t},getWidget:function(t){var e=t instanceof BX.Report.Dashboard.Widget?t.getId():t;for(var o=0;o<this.widgetsOrder.length;o++){if(this.widgetsOrder[o]instanceof BX.Report.Dashboard.Widget&&this.widgetsOrder[o].getId()===e){return this.widgetsOrder[o]}}return null},getWidgets:function(){return this.widgetsOrder},addWidget:function(t){var e;if(BX.type.isPlainObject(t)&&!(t instanceof BX.Report.Dashboard.Widget)){var o=this.getWidgetClass(t.className);e=new o(t)}else if(t instanceof BX.Report.Dashboard.Widget){e=t}else{throw new Error("Unable to create or get widget object")}e.setRowId(this.getId());e.setRow(this);this.widgetsOrder.push(e);if(this.isRendered()){if(!e.getCell()){var r=this.getRowLayout().getFirstEmptyCell();e.setCell(r)}e.getCell().setWidget(e)}return e},addWidgets:function(t){t.forEach(function(t){this.addWidget(t)}.bind(this))},moveWidget:function(t,e){if(e.getHeight()>t.getCell().getHeight()||t.getHeight()>e.getCell().getHeight()){return}if(!e.isDraggable()){return}var o=t.getCell();var r=e.getCell();var i=this.getRowLayout();var s=i.getCells();var a=null;if(t.getRow()===this){a=o}else{a=this.getRowLayout().getFirstEmptyCell()}if(a){var n=BX.util.array_search(a,s);var d=BX.util.array_search(r,s);r.getContainer().classList.add("report-visualconstructor-dashboard-empty-cell-droppable");r.getContainer().classList.add("report-visualconstructor-dashboard-empty-cell-droppable-active");var l=true;if(n>d){for(var h=n;h>d;h--){if(s[h-1].getWidget()&&s[h-1].getWidget().getHeight()<=s[h].getHeight()){s[h].setWidget(s[h-1].getWidget())}else{l=false;break}}if(l){r.clear();t.setCell(r)}}else{for(var u=n;u<d;u++){if(s[u+1].getWidget()&&s[u+1].getWidget().getHeight()<=s[u].getHeight()){s[u].setWidget(s[u+1].getWidget())}else{l=false;break}}if(l){r.clear();t.setCell(r)}}if(l){r.setHeight(t.getHeight());var g=BX.util.array_search(t,this.widgetsOrder);this.widgetsOrder.splice(g,1);var c=BX.util.array_search(e,this.widgetsOrder);if(c>=0){this.widgetsOrder.splice(c,0,t)}else{this.widgetsOrder.push(t)}}}},removeWidget:function(t){var e=BX.util.array_search(t,this.widgetsOrder);this.widgetsOrder.splice(e,1);if(this.getWidgets().length===0){this.getBoard().removeRow(this)}},remove:function(){this.destroy()},destroy:function(){jsDD.unregisterDest(this.layout.rowContainer);this.setRenderStatus(false);BX.remove(this.getRowContainer());this.getRowLayout().destroy()},getRowLayout:function(){return this.rowLayout},setRenderStatus:function(t){if(BX.type.isBoolean(t)){this.rendered=t}else{throw Error("Render status might be boolean")}},isRendered:function(){return this.rendered},isDraggable:function(){return this.draggable},makeDraggable:function(){if(!this.isDraggable()){return}this.getRowMoveControlButton().onbxdragstart=BX.delegate(this.onDragStart,this);this.getRowMoveControlButton().onbxdrag=BX.delegate(this.onDrag,this);this.getRowMoveControlButton().onbxdragstop=BX.delegate(this.onDragStop,this);jsDD.registerObject(this.getRowMoveControlButton())},onDragStart:function(){this.getRowContainer().classList.add("report-visualconstructor-dashboard-row-drag");this.dragRowOffset=jsDD.start_y;this.dragRowId=BX.util.array_search(this,this.getBoard().getRows());this.dragTargetRow=this.dragTargetRow||this},onDrag:function(t,e){this.verticalAutoScroll(e);this.moveVisuallyRows(e)},onDragStop:function(){var t=this.getBoard().moveRow(this,this.dragTargetRow);if(t){BX.onCustomEvent(this.getBoard(),"BX.Report.Dashboard.Board:afterRowMoved",[this.getBoard().getRows()])}this.getRowContainer().classList.remove("report-visualconstructor-dashboard-row-drag");var e=this.getBoard().getRows();for(var o in e){if(!e.hasOwnProperty(o)){continue}var r=e[o];var i=r.getRowContainer();r.resetRectArea();i.style.removeProperty("transition");i.style.removeProperty("transform")}this.stopScroll()},getRectArea:function(){this.rectArea=BX.pos(this.getRowContainer());this.rectArea.middle=this.rectArea.top+this.rectArea.height/2;return this.rectArea},moveVisuallyRows:function(t){this.getRowContainer().style.transform="translateY("+(t-this.dragRowOffset)+"px)";var e=this.getBoard().getRows();var o=this.getRectArea().height;var r;for(var i in e){if(!e.hasOwnProperty(i)){continue}var s=e[i];if(s===this){continue}var a=s.getRowContainer();var n=s.getRectArea();var d=n.middle;if(t>d&&i>this.dragRowId&&a.style.transform!=="translateY("+-o+"px)"){r=this.getWeight();this.setWeight(s.getWeight());s.setWeight(r);a.style.transition="300ms";a.style.transform="translateY("+-o+"px)";this.dragTargetRow=this.getBoard().getNextRowSibling(s);s.resetRectArea()}if(t<d&&i<this.dragRowId&&a.style.transform!=="translateY("+o+"px)"){r=this.getWeight();this.setWeight(s.getWeight());s.setWeight(r);a.style.transition="300ms";a.style.transform="translateY("+o+"px)";this.dragTargetRow=s;s.resetRectArea()}var l=t<d&&i>this.dragRowId&&a.style.transform!==""&&a.style.transform!=="translateY(0px)";var h=t>d&&i<this.dragRowId&&a.style.transform!==""&&a.style.transform!=="translateY(0px)";if(l||h){a.style.transition="300ms";a.style.transform="translateY(0px)";this.dragTargetRow=l?s:this.getBoard().getNextRowSibling(s);s.resetRectArea()}}},resetRectArea:function(){this.rectArea=null},lazyLoadWidgets:function(){if(!this.loaded){var t=this.getWidgets();t.forEach(function(t){t.lazyLoad()});this.loaded=true}},verticalAutoScroll:function(t){var e=window.pageYOffset||document.documentElement.scrollTop;var o=document.documentElement.clientHeight;var r=t-e;if(r>=o-50){this.scrollDown(t)}else if(r<=50){this.scrollUp(t)}else{this.stopScroll()}},scrollUp:function(t){if(this.isScrollingUp){return}this.isScrollingUp=true;this.timer=setInterval(BX.delegate(function(){var e=window.pageYOffset||document.documentElement.scrollTop;window.scrollTo(0,e-10);t-=10;this.moveVisuallyRows(t)},this),20)},scrollDown:function(t){if(this.isScrollingDown){return}this.isScrollingDown=true;this.timer=setInterval(BX.delegate(function(){var e=window.pageYOffset||document.documentElement.scrollTop;window.scrollTo(0,e+10);t+=10;this.moveVisuallyRows(t)},this),20)},stopScroll:function(){this.isScrollingUp=false;this.isScrollingDown=false;clearInterval(this.timer)},removeTopPseudoRows:function(){for(var t=0;t<this.pseudoRowsList.top.length;t++){if(this.pseudoRowsList.top[t]instanceof BX.Report.Dashboard.Row&&this.pseudoRowsList.top[t].isPseudo()){this.getBoard().removeRow(this.pseudoRowsList.top[t])}}this.pseudoRowsList.top=[]},removeBottomPseudoRows:function(){for(var t=0;t<this.pseudoRowsList.bottom.length;t++){if(this.pseudoRowsList.bottom[t]instanceof BX.Report.Dashboard.Row&&this.pseudoRowsList.bottom[t].isPseudo()){this.getBoard().removeRow(this.pseudoRowsList.bottom[t])}}this.pseudoRowsList.bottom=[]}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/report/js/dashboard/rowlayouts.min.js?15441274417458";s:6:"source";s:44:"/bitrix/js/report/js/dashboard/rowlayouts.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Report.Dashboard.Row");BX.Report.Dashboard.Row.BaseLayout=function(e){this.cellCount=e.cellCount;this.row=e.row;this.cells=[]};BX.Report.Dashboard.Row.BaseLayout.prototype={getClassName:function(){return"BX.Report.Dashboard.Row.BaseLayout"},getRow:function(){return this.row},getWidgets:function(){return this.getRow().getWidgets()},getCells:function(){return this.cells},getFirstEmptyCell:function(){var e=this.getCells();for(var t=1;t<=e.length;t++){if(e[t]instanceof BX.Report.Dashboard.Cell&&e[t].isEmpty()){return e[t]}}return null},getMiniatureContainer:function(){var e=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-miniature-container"},events:{click:this.handlerRowAddByMiniature.bind(this)}});for(var t=1;t<=this.cellCount;t++){var l=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-miniature-cell"}});e.appendChild(l)}return e},getPseudoRowId:function(){return"pseudo_"+Math.floor(Math.random()*(99999-15e3))+15e3+""},getPseudoCellId:function(){return"js_"+BX.util.getRandomString()},handlerRowAddByMiniature:function(){this.getRow().getBoard().addRow(new BX.Report.Dashboard.Row({id:this.getPseudoRowId(),pseudo:true,maxWidgetCount:""+this.cellCount,layoutMap:this.getLayoutMap()}),this.getRow(),false);this.getRow().addRowPopup.close()},getLayoutMap:function(){var e=[];for(var t=1;t<=this.cellCount;t++){var l={type:"cell",id:this.getPseudoCellId(),removable:0};e.push(l)}return{type:"cell-container",orientation:"horizontal",elements:e}}};BX.Report.Dashboard.Row.HorizontalLinear=function(e){BX.Report.Dashboard.Row.BaseLayout.apply(this,arguments)};BX.Report.Dashboard.Row.HorizontalLinear.prototype={__proto__:BX.Report.Dashboard.Row.BaseLayout.prototype,constructor:BX.Report.Dashboard.Row.HorizontalLinear,getClassName:function(){return"BX.Report.Dashboard.Row.HorizontalLinear"}};BX.Report.Dashboard.Row.LayoutFabric=function(e){this.row=e.row;this.map=e.map;this.layout=null;this.cells=[]};BX.Report.Dashboard.Row.LayoutFabric.prototype={render:function(){var e=this.getLayout();this.fillCellsWithWidgets();return e},getRow:function(){return this.row},getCells:function(){return this.cells},getWidgets:function(){return this.getRow().getWidgets()},getMapWithoutDomElements:function(e,t){if(!t){e=this.getMap()}var l={};if(e["type"]==="cell-container"){l["type"]=e["type"];l["orientation"]=e["orientation"];l["elements"]=[];for(var r in e["elements"]){l["elements"].push(this.getMapWithoutDomElements(e["elements"][r],true))}}else if(e["type"]==="cell"){l["type"]=e["type"];l["id"]=e["id"];l["flexValue"]=e["flexValue"];l["height"]=e["height"]}return l},getMap:function(){return this.map},getFirstEmptyCell:function(){var e=this.getCells();for(var t=0;t<=e.length;t++){if(e[t]instanceof BX.Report.Dashboard.Cell&&e[t].isEmpty()){return e[t]}}return null},getLayout:function(){if(this.layout){return this.layout}this.layout=this.buildNestedCellNodeTree(this.getMap(),false);return this.layout},destroy:function(){BX.remove(this.getLayout());var e=this.getCells();for(var t=0;t<e.length;t++){e[t].destroy()}},fillCellsWithWidgets:function(){var e=this.getWidgets();var t=this.getCells();BX.Report.Dashboard.Utils.forEach(e,BX.delegate(function(l){for(var r=0;r<t.length;r++){var n=e[l].getWeight();if(n===t[r].getId()&&t[r].isEmpty()){t[r].setWidget(e[l])}}},this))},buildNestedCellNodeTree:function(e,t){if(e["type"]==="cell"){var l=new BX.Report.Dashboard.Cell({id:e["id"],height:e["height"]||380,flexValue:e["flexValue"]||1,row:this.getRow()});this.cells.push(l);var r=l.render();e["domElement"]=r;return r}if(e["type"]==="cell-container"){var n;if(e["orientation"]==="horizontal"){n=this.getCellRowContainer()}else if(e["orientation"]==="vertical"){n=this.getCellColumnContainer()}if(e["elements"]){for(var i=0;i<e["elements"].length;i++){n.appendChild(this.buildNestedCellNodeTree(e["elements"][i],true))}}if(t){var o=this.getCellContainer();o.style.flex=e["flexValue"]||1;o.appendChild(n);e["domElement"]=o;return o}else{e["domElement"]=n;return n}}},getCellContainer:function(){return BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-cell report-visualconstructor-dashboard-cell-container","data-type":"cell-container"}})},getCellRowContainer:function(){return BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-row report-visualconstructor-dashboard-row-direction-row"}})},getCellColumnContainer:function(){return BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-row report-visualconstructor-dashboard-row-direction-column"}})},transformCellToContainer:function(e,t){var l=this.findContainerContainsCell(e,this.getMap());var r=this.findCellIndexInContainerElements(e,l["elements"]);var n=l["elements"][r]["domElement"];var i=Object.assign({},l["elements"][r]);var o=this.getPseudoCellId();i.flexValue=1;i.height=380;var a=[i];for(var s=1;s<t.cellCount;s++){a.push({type:"cell",id:o,height:180,flexValue:1,removable:1})}l["elements"][r]={type:"cell-container",flexValue:l["elements"][r]["flexValue"]||1,orientation:t["orientation"],elements:a};var u=BX.util.array_search(e,this.getCells());this.cells.splice(u,1);var d=this.buildNestedCellNodeTree(l["elements"][r],true);l["domElement"].replaceChild(d,n);this.fillCellsWithWidgets()},findContainerContainsCell:function(e,t){var l=t;if(l["type"]==="cell-container"){for(var r=0;r<l["elements"].length;r++){if(l["elements"][r]["type"]==="cell-container"){var n=this.findContainerContainsCell(e,l["elements"][r]);if(n){return n}}if(l["elements"][r]["type"]==="cell"){if(e.getId()===l["elements"][r]["id"]){return t}}}}return null},findCellIndexInContainerElements:function(e,t){for(var l=0;l<t.length;l++){if(t[l]["id"]===e.getId()){return l}}return null},getCellById:function(e){var t=this.getCells();for(var l=0;l<t.length;l++){if(t[l].getId()===e){return t[l]}}return false},adjustNoEmptyCellsInCellLevel:function(e){var t=this.findContainerContainsCell(e,this.getMap());var l=this.findCellIndexInContainerElements(e,t["elements"]);var r=t["elements"][l];for(var n=0;n<t["elements"].length;n++){if(t["elements"][n]["type"]==="cell"){var i=this.getCellById(t["elements"][n]["id"]);if(i.getId()!==r["id"]&&!i.isEmpty()){var o=i.getContainer().clientHeight;var a=i.getWidget().getHeight();var s=Math.round(o/a);if(s>1){this.transformCellToContainer(i,{orientation:"vertical",cellCount:2})}}}}},adjustCellToMaxSize:function(e){var t=this.findContainerContainsCell(e,this.getMap());if(t["orientation"]==="vertical"){if(!this.isCellsContainerHasFilledCell(t)){this.clearCellsFromCollectionByContainer(t);var l=t.domElement;t.type="cell";t.flexValue=1;t.id=this.getPseudoCellId();delete t.orientation;delete t.elements;var r=this.buildNestedCellNodeTree(t,false);this.getLayout().replaceChild(r,l);t.domElement=r}}},clearCellsFromCollectionByContainer:function(e){if(e["type"]==="cell-container"){for(var t=0;t<e["elements"].length;t++){if(e["elements"][t]["type"]==="cell"){var l=this.getCellById(e["elements"][t]["id"]);var r=BX.util.array_search(l,this.getCells());this.cells.splice(r,1)}else{this.clearCellsFromCollectionByContainer(e["elements"][t])}}}},isCellsContainerHasFilledCell:function(e){for(var t=0;t<e["elements"].length;t++){if(e["elements"][t]["type"]==="cell"){var l=this.getCellById(e["elements"][t]["id"]);if(!l.isEmpty()){return true}}}return false},getPseudoCellId:function(){return"js_"+BX.util.getRandomString()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/report/js/dashboard/cell.min.js?15441274417082";s:6:"source";s:38:"/bitrix/js/report/js/dashboard/cell.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){BX.namespace("BX.Report.Dashboard");BX.Report.Dashboard.Cell=function(t){this.height=t.height||400;this.widget=t.widget;this.flexValue=t.flexValue||1;this.row=t.row;this.empty=true;this.rendered=false;this.id=t.id;this.layout={cellContainer:null,tempContainer:null}};BX.Report.Dashboard.Cell.prototype={getId:function(){return this.id},getWidget:function(){return this.widget},getRow:function(){return this.row},getHeight:function(){return this.height},setHeight:function(t){this.height=t;if(this.isRendered()){this.getContainer().style.minHeight=t+"px"}},getContainer:function(){if(this.layout.cellContainer){return this.layout.cellContainer}this.layout.cellContainer=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-cell report-visualconstructor-dashboard-empty-cell","data-id":this.id,"data-type":"cell"},style:{flex:this.flexValue||1,minHeight:"0"}});this.layout.cellContainer.onbxdestdragstart=BX.delegate(this.onWidgetDragStart,this);this.layout.cellContainer.onbxdestdraghover=BX.delegate(this.onWidgetDragEnter,this);this.layout.cellContainer.onbxdestdraghout=BX.delegate(this.onWidgetDragLeave,this);this.layout.cellContainer.onbxdestdragfinish=BX.delegate(this.onWidgetDragDrop,this);this.layout.cellContainer.onbxdestdragstop=BX.delegate(this.onWidgetDragEnd,this);jsDD.registerDest(this.layout.cellContainer,30);return this.layout.cellContainer},getCellTempContainer:function(){if(this.layout.tempContainer){return this.layout.tempContainer}this.layout.tempContainer=BX.create("div",{text:"Drop here widget or ",attrs:{className:"report-visualconstructor-dashboard-cell-temp-content"}});var t=BX.create("ins",{html:"create",events:{}});this.layout.tempContainer.appendChild(t);return this.layout.tempContainer},onWidgetDragStart:function(t){if(t.dataset.type!=="widget"){return}var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e.getCell().getRow().getBoard()!==this.getRow().getBoard()){return}if(e.getHeight()>this.getHeight()){return}if(!e.isResizeable()&&e.getCell().getContainer().clientWidth>this.getContainer().clientWidth+4){return}if(this.isEmpty()){this.getContainer().classList.add("report-visualconstructor-dashboard-empty-cell-droppable")}jsDD.refreshDestArea()},onWidgetDragEnter:function(t){if(t.dataset.type!=="widget"){return}var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e.getCell().getRow().getBoard()!==this.getRow().getBoard()){return}if(e.getHeight()>this.getHeight()){return}if(!e.isResizeable()&&e.getCell().getContainer().clientWidth>this.getContainer().clientWidth+4){return}if(this.isEmpty()){this.getContainer().classList.add("report-visualconstructor-dashboard-empty-cell-droppable-active");this.expendTimer=setTimeout(function(){this.getContainer().style.transition="min-height 700ms";this.getContainer().style.minHeight=e.getHeight()+"px";this.getContainer().addEventListener("transitionend",function(){jsDD.refreshDestArea()},false)}.bind(this),300)}else{this.moveTimer=setTimeout(BX.delegate(function(){var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e!==this.getWidget()){this.getRow().moveWidget(e,this.getWidget())}},this),500)}},onWidgetDragLeave:function(t){if(t.dataset.type!=="widget"){return}var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e.getCell().getRow().getBoard()!==this.getRow().getBoard()){return}if(!e.isResizeable()&&e.getCell().getContainer().clientWidth>this.getContainer().clientWidth+4){return}this.getContainer().classList.remove("report-visualconstructor-dashboard-empty-cell-droppable-active");clearTimeout(this.moveTimer);clearTimeout(this.expendTimer);setTimeout(function(){this.getContainer().style.minHeight="50px"}.bind(this),300)},onWidgetDragDrop:function(t){clearTimeout(this.moveTimer);if(t.dataset.type!=="widget"){return}var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e.getCell().getRow().getBoard()!==this.getRow().getBoard()){return}if(!e.isResizeable()&&e.getCell().getContainer().clientWidth>this.getContainer().clientWidth+4){return}if(e.getHeight()>this.getHeight()){return}if(this.isEmpty()){e.dropped=true;var i=e.getCell();var r=e.getRow();if(r!==this.getRow()){r.removeWidget(e);this.getRow().addWidget(e)}this.setWidget(e);e.setCell(this);var s=this.getContainer().clientHeight;var o=e.getHeight();var n=Math.round(s/o);if(n>1){this.getRow().getRowLayout().transformCellToContainer(this,{orientation:"vertical",cellCount:n})}this.getRow().getRowLayout().adjustNoEmptyCellsInCellLevel(this);if(r.getWidgets().length!==0&&i.getId()!==this.getId()){i.clear()}this.getRow().getBoard().lazyLoad();BX.onCustomEvent(this.getRow().getBoard(),"BX.Report.Dashboard.Widget:afterMove",[this.getRow().getWidgets(),this.getRow()]);if(r.getWidgets().length!==0){i.adjustToMaxSize();BX.onCustomEvent(this.getRow().getBoard(),"BX.Report.Dashboard.Widget:afterMove",[i.getRow().getWidgets(),i.getRow()])}this.getRow().removePseudo()}this.getRow().getBoard().removePseudoRows()},onWidgetDragEnd:function(t){if(t.dataset.type==="widget"){var e=this.getRow().getBoard().getWidget(t.dataset.id);if(e&&!e.dropped){e.getCell().setWidget(e)}this.getContainer().classList.remove("report-visualconstructor-dashboard-empty-cell-droppable");this.getContainer().classList.remove("report-visualconstructor-dashboard-empty-cell-droppable-active");if(!this.isEmpty()){this.getContainer().style.transition="min-height 300ms";this.getContainer().style.minHeight=this.getWidget().getHeight()+"px"}}},clear:function(){BX.cleanNode(this.getContainer());this.getCellTempContainer().classList.remove("report-visualconstructor-dashboard-hidden-temp-content");this.getContainer().appendChild(this.getCellTempContainer());this.getContainer().classList.add("report-visualconstructor-dashboard-empty-cell");this.getContainer().style.minHeight="";this.empty=true;this.widget=null;this.getRow().getRowLayout().getCellById(this.getId()).empty=true;this.getRow().getRowLayout().getCellById(this.getId()).widget=null;BX.onCustomEvent(this,"BX.Report.Dashboard.Cell:clean",[this])},isEmpty:function(){return this.empty},render:function(){var t=this.getContainer();t.appendChild(this.getCellTempContainer());if(this.getWidget()instanceof BX.Report.Dashboard.Widget){t.classList.remove("report-visualconstructor-dashboard-empty-cell");t.classList.remove("report-visualconstructor-dashboard-empty-cell-droppable");t.appendChild(this.getWidget().render());t.style.minHeight=this.getWidget().getHeight()+"px";this.getWidget().setCell(this);this.getCellTempContainer().classList.add("report-visualconstructor-dashboard-hidden-temp-content");this.empty=false}else{this.clear()}this.rendered=true;return t},isRendered:function(){return this.rendered},setWidget:function(t){this.widget=t;this.setHeight(t.getHeight());if(this.isRendered()){this.render();if(this.widget.loaded){BX.onCustomEvent(this.getWidget(),"Dashboard.Board.Widget:onAfterRender")}}},adjustToMaxSize:function(){this.getRow().getRowLayout().adjustCellToMaxSize(this)},destroy:function(){jsDD.unregisterDest(this.getContainer());jsDD.current_dest_index=false;BX.remove(this.getContainer())}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/report/js/dashboard/widget.min.js?154412744113285";s:6:"source";s:40:"/bitrix/js/report/js/dashboard/widget.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){BX.namespace("BX.Report.Dashboard");BX.Report.Dashboard.Widget=function(t){this.id=t.id;this.rowId=t.rowId;this.title=t.title||"No title";this.weight=t.weight||0;this.data=t.data||{};this.setContent(t.content||null);this.width=t.width||"100%";this.height=t.height||"100%";this.draggable=t.draggable||false;this.droppable=t.droppable||false;this.loaded=t.loaded||false;this.cell=t.cell||null;this.config=t.config||null;this.resizable=t.resizable;this.dropped=false;this.layout={lazyLoadPresetContainer:null,widgetContainer:null,widgetWrapper:null,headContainer:null,headWrapper:null,titleContainer:null,controlsContainer:null,contentContainer:null,contentWrapper:null,menuOpenButton:null};this.actionItems=t.actionItems||[];this.events=t.events||{};this.actionItems.push(BX.create("div",{text:BX.message("DASHBOARD_WIDGET_REMOVE_TITLE"),events:{click:this.openDeleteConfirmPopup.bind(this)}}));this.board=null};BX.Report.Dashboard.Widget.prototype={isResizeable:function(){return this.resizable},isDarkMode:function(){var t=this.getColor().substring(1,7);return BX.Report.Dashboard.Utils.isDarkColor(t)},getColor:function(){return this.config.color?this.config.color:"#ffffff"},setColor:function(t){this.config.color=t},applyColor:function(){if(this.loaded){this.getWidgetWrapper().style.backgroundColor=this.getColor();if(this.isDarkMode()){this.getWidgetWrapper().classList.add("report-visualconstructor-dashboard-widget-dark");this.getWidgetWrapper().classList.remove("report-visualconstructor-dashboard-widget-light")}else{this.getWidgetWrapper().classList.add("report-visualconstructor-dashboard-widget-light");this.getWidgetWrapper().classList.remove("report-visualconstructor-dashboard-widget-dark")}}},getLazyLoadPresetContainer:function(){if(this.layout.lazyLoadPresetContainer){return this.layout.lazyLoadPresetContainer}var t=new BX.Loader({size:60});this.layout.lazyLoadPresetContainer=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-lazy-load-preset"}});t.show(this.layout.lazyLoadPresetContainer);return this.layout.lazyLoadPresetContainer},getWidgetContainer:function(){if(this.layout.widgetContainer){return this.layout.widgetContainer}this.layout.widgetContainer=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-container","data-id":this.getId(),"data-weight":this.getWeight(),"data-type":"widget"}});this.makeDraggable(this.layout.widgetContainer);return this.layout.widgetContainer},getWidgetWrapper:function(){var t=null;if(this.layout.widgetWrapper){return this.layout.widgetWrapper}else{t=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-wrapper"}})}this.layout.widgetWrapper=t;return this.layout.widgetWrapper},makeDraggable:function(t){if(!this.isDraggable()){return}this.getWidgetContainer().classList.add("report-visualconstructor-dashboard-draggable-widget-container");t.onbxdragstart=BX.delegate(this.onDragStart,this);t.onbxdrag=BX.delegate(this.onDrag,this);t.onbxdragstop=BX.delegate(this.onDragStop,this);t.onbxdragfinish=BX.delegate(this.onDragFinish,this);t.onbxdragrelease=BX.delegate(this.onDragEnd,this);jsDD.registerObject(t)},isDraggable:function(){return this.draggable},onDragStart:function(){if(!this.dragElement){this.dropped=false;var t=this.getWidgetContainer();this.dragElement=t.cloneNode(true);this.dragElement.rotated=false;this.dragWidgetOffsetX=jsDD.start_x-this.getRectArea().left;this.dragWidgetOffsetY=jsDD.start_y-this.getRectArea().top;this.dragElement.style.position="absolute";this.dragElement.style.height=this.getRectArea().height+"px";this.dragElement.style.width=this.getRectArea().width+"px";this.dragElement.style.flex="none";this.dragElement.classList.add("report-visualconstructor-dashboard-widget-drag");document.body.appendChild(this.dragElement);this.getCell().clear();this.getCell().getContainer().style.height=this.getRectArea().height+"px"}},onDrag:function(t,e){if(this.dragElement){this.autoResize();this.rotateDragWidget(t,e);this.autoScroll(t,e);this.moveDragWidget(t,e);this.getRow().getBoard().showPriorityPseudoRowsByYPos(this.buildPriorityRows(),e)}},buildPriorityRows:function(){var t=[];t[0]=this.getSingleCellRow();if(this.isResizeable()){t[1]=this.getDoubledPriorityRow()}return t},getSingleCellRow:function(){return new BX.Report.Dashboard.Row({id:"js_"+BX.util.getRandomString(),pseudo:true,layoutMap:{type:"cell-container",orientation:"horizontal",elements:[{type:"cell",flexValue:1,id:"js_"+BX.util.getRandomString()}]}})},getDoubledPriorityRow:function(){return new BX.Report.Dashboard.Row({id:"js_"+BX.util.getRandomString(),pseudo:true,layoutMap:{type:"cell-container",orientation:"horizontal",elements:[{type:"cell",flexValue:1,id:"js_"+BX.util.getRandomString()},{type:"cell",flexValue:1,id:"js_"+BX.util.getRandomString()}]}})},autoResize:function(){if(!this.dragElement.scaled){this.dragElement.style.transform="scale(0.5)";this.dragElement.style.transition="100ms";this.dragElement.style.zIndex="9999";this.dragElement.scaled=true;this.dragElement.style.transformOrigin=this.dragWidgetOffsetX+"px "+this.dragWidgetOffsetY+"px";this.dragElement.style.mstransformOrigin=this.dragWidgetOffsetX+"px "+this.dragWidgetOffsetY+"px";this.dragElement.style.webkittransformOrigin=this.dragWidgetOffsetX+"px "+this.dragWidgetOffsetY+"px"}},rotateDragWidget:function(t){if(!this.dragElement.rotated){if(jsDD.start_x>t){this.dragElement.classList.add("report-visualconstructor-dashboard-widget-rotated-right")}else{this.dragElement.classList.add("report-visualconstructor-dashboard-widget-rotated-left")}this.dragElement.rotated=true}},moveDragWidget:function(t,e){if(t<0||e<0){return}if(this.dragElement){this.dragElement.style.left=t-this.dragWidgetOffsetX+"px";this.dragElement.style.top=e-this.dragWidgetOffsetY+"px"}},onDragStop:function(){this.stopScroll();BX.remove(this.dragElement);this.dragElement=null;this.getCell().getContainer().style.height="";this.resetRectArea()},onDragFinish:function(t){if(t.dataset.type!=="cell"){this.getCell().setWidget(this)}},onDragEnd:function(){if(!this.dropped){this.getCell().setWidget(this);this.getCell().getRow().getBoard().removePseudoRows()}},getHeadContainer:function(){if(this.layout.headContainer){this.layout.headContainer.style.backgroundColor="";return this.layout.headContainer}this.layout.headContainer=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-head-container","data-id":this.getId(),"data-weight":this.getWeight(),"data-type":"widget"}});return this.layout.headContainer},getHeadWrapper:function(){if(this.layout.headWrapper){return this.layout.headWrapper}this.layout.headWrapper=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-head-wrapper"}});return this.layout.headWrapper},getTitleContainer:function(){if(this.layout.titleContainer){return this.layout.titleContainer}this.layout.titleContainer=BX.create("div",{props:{className:"report-visualconstructor-dashboard-widget-title-container"}});return this.layout.titleContainer},getControlsContainer:function(){if(this.layout.controlsContainer){return this.layout.controlsContainer}this.layout.controlsContainer=BX.create("div",{props:{className:"report-visualconstructor-dashboard-widget-controls-container"}});return this.layout.controlsContainer},getContentContainer:function(){if(this.layout.contentContainer){return this.layout.contentContainer}this.layout.contentContainer=BX.create("div",{props:{className:"report-visualconstructor-dashboard-widget-content-container"}});return this.layout.contentContainer},getContentWrapper:function(){if(this.layout.contentWrapper){return this.layout.contentWrapper}this.layout.contentWrapper=BX.create("div",{props:{className:"report-visualconstructor-dashboard-widget-content-wrapper"}});return this.layout.contentWrapper},setRowId:function(t){this.rowId=t},setRow:function(t){this.row=t;this.rowId=this.row.getId()},getRow:function(){return this.row},getCell:function(){return this.cell},setCell:function(t){this.cell=t;this.weight=this.cell.getId()},getId:function(){return this.id},getWeight:function(){return this.weight},getContent:function(){return this.runtimeContent},setContent:function(t){if(BX.type.isPlainObject(t)&&!(t instanceof BX.Report.Dashboard.Content)){var e=this.getContentClass(t.className);t.params.widget=this;this.runtimeContent=new e(t.params)}else if(t instanceof BX.Report.Dashboard.Content){this.runtimeContent.setWidget(this)}if(this.runtimeContent.errors.length!==0){var i={errors:this.runtimeContent.errors};this.runtimeContent=new BX.Report.Dashboard.Content.Error(i)}},getHeight:function(){if(this.getContent().getHeight()!=="auto"){return this.getContent().getHeight()+55}else{return 323}},getContentClass:function(t){var e=BX.Report.Dashboard.Utils.getClass(t);if(BX.type.isFunction(e)){return e}return BX.Report.Dashboard.Content.Empty},getBoard:function(){return this.board},setBoard:function(t){this.board=t},lazyLoad:function(){this.loaded=true;this.render();BX.onCustomEvent(this,"Dashboard.Board.Widget:onAfterRender")},render:function(){var t=this.getWidgetContainer();var e=this.getContent();if(this.loaded){var i=this.getHeadContainer();var r=this.getHeadWrapper();var o=this.getControlsContainer();var n=this.getContentContainer();var s=this.getContentWrapper();if(this.checkIsRendered()){BX.cleanNode(t);BX.cleanNode(n);BX.cleanNode(s)}s=this.getContentWrapper();n.appendChild(s);var a=this.getTitleContainer();a.innerHTML=this.config.title;r.appendChild(a);var l=this.getWidgetWrapper();this.applyColor();s.appendChild(e.render());o.appendChild(this.getPropertiesOpenButton());r.appendChild(o);i.appendChild(r);l.appendChild(i);l.appendChild(n);this.getLazyLoadPresetContainer().classList.add("report-visualconstructor-dashboard-widget-lazy-load-preset-disable");t.appendChild(l)}else{var d=this.getLazyLoadPresetContainer();t.appendChild(d)}this.setRenderStatus(true);return t},remove:function(){this.getCell().clear();this.getDeleteConfirmPopup().close();this.getRow().removeWidget(this)},destroy:function(){this.setRenderStatus(false);jsDD.unregisterObject(this.getWidgetContainer());BX.remove(this.getWidgetContainer());delete this.propertiesPopup},getPropertiesOpenButton:function(){if(this.layout.menuOpenButton){return this.layout.menuOpenButton}this.layout.menuOpenButton=BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-properties-button"},events:{click:this.propertiesOpenButtonClickHandler.bind(this)}});return this.layout.menuOpenButton},propertiesOpenButtonClickHandler:function(t){var e=t.target||t.srcElement;this.openPopupMenu(e)},getPropertiesPopup:function(t){if(!this.propertiesPopup){var e="report-visualconstructor-drashboard-widget-popup"+this.getId();this.propertiesPopup=new BX.PopupWindow(e,t,{noAllPaddings:true,closeByEsc:true,autoHide:true,content:this.getActionsMenuItemsLayout()})}return this.propertiesPopup},openPopupMenu:function(t){this.getPropertiesPopup(t).show()},getActionsMenuItemsLayout:function(){for(var t in this.actionItems){this.actionItems[t].classList.add("report-visualconstructor-dashboard-widget-properties-popup-item")}return BX.create("div",{attrs:{className:"report-visualconstructor-dashboard-widget-properties-popup-wrapper"},children:this.actionItems})},openDeleteConfirmPopup:function(){this.getPropertiesPopup().close();this.removePopup=new BX.PopupWindow("report-visualconstructor-dashboard-widget-remove-popup-"+this.getId(),null,{closeIcon:{right:"20px",top:"10px"},titleBar:this.config.title,zIndex:0,offsetLeft:0,offsetTop:0,draggable:{restrict:false},overlay:{backgroundColor:"black",opacity:"80"},buttons:[new BX.PopupWindowButton({text:BX.message("DASHBOARD_WIDGET_REMOVE_ACCEPT_TITLE"),className:"popup-window-button-accept",events:{click:this.remove.bind(this)}}),new BX.PopupWindowButton({text:BX.message("DASHBOARD_WIDGET_REMOVE_CANCEL_TITLE"),className:"webform-button-link-cancel",events:{click:function(){this.popupWindow.close()}}})],content:BX.message("DASHBOARD_WIDGET_REMOVE_CONTENT")});this.removePopup.show()},getDeleteConfirmPopup:function(){return this.removePopup},checkIsRendered:function(){return this.isRendered},setRenderStatus:function(t){this.isRendered=t},getRectArea:function(){if(!this.rectArea){this.rectArea=BX.pos(this.getWidgetContainer());this.rectArea.middle=this.rectArea.left+this.rectArea.width/2}return this.rectArea},resetRectArea:function(){this.rectArea=null},autoScroll:function(t,e){var i=window.pageYOffset||document.documentElement.scrollTop;var r=document.documentElement.clientHeight;var o=e-i;if(o>=r-50){this.scrollDown(t,e)}else if(o<=50){this.scrollUp(t,e)}else{this.stopScroll()}},scrollUp:function(t,e){if(this.isScrollingUp){return}this.isScrollingUp=true;this.timer=setInterval(BX.delegate(function(){var i=window.pageYOffset||document.documentElement.scrollTop;window.scrollTo(0,i-10);e-=10;this.moveDragWidget(t,e)},this),20)},scrollDown:function(t,e){if(this.isScrollingDown){return}this.isScrollingDown=true;this.timer=setInterval(BX.delegate(function(){var i=window.pageYOffset||document.documentElement.scrollTop;window.scrollTo(0,i+10);e+=10;this.moveDragWidget(t,e)},this),20)},stopScroll:function(){this.isScrollingUp=false;this.isScrollingDown=false;clearInterval(this.timer)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/report/js/dashboard/content.min.js?15441274413262";s:6:"source";s:41:"/bitrix/js/report/js/dashboard/content.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Report.Dashboard");BX.Report.Dashboard.Content=function(t){this.height=t.height||"auto";this.color=t.color||"inherit";this.errors=t.errors||[];this.data=t.data||{};this.rendered=false;this.widget=t.widget||null;this.layout={container:null}};BX.Report.Dashboard.Content.prototype={isRendered:function(){return this.rendered},setRenderStatus:function(t){this.rendered=t},getColor:function(){return this.color},getHeight:function(){if(this.height!=="auto"){return this.height-55}else{return"auto"}},setWidget:function(t){this.widget=t;return this},getWidget:function(){return this.widget},render:function(){return BX.create("div",{html:"parent render"})}};BX.Report.Dashboard.Content.Html=function(t){this.html=t.html||[];this.js=t.js||[];this.css=t.css||"";this.config=t.config||"";this.htmlContentWrapper=BX.create("div");BX.Report.Dashboard.Content.apply(this,arguments)};BX.Report.Dashboard.Content.Html.counter=0;BX.Report.Dashboard.Content.Html.callbacks={};BX.Report.Dashboard.Content.Html.ready=function(t){this.callbacks[this.counter]=t};BX.Report.Dashboard.Content.Html.callCallbackInContext=function(t,e){if(this.callbacks[t]){this.callbacks[t](e)}};BX.Report.Dashboard.Content.Html.prototype={__proto__:BX.Report.Dashboard.Content.prototype,constructor:BX.Report.Dashboard.Content.Html,loadAssets:function(){if(this.css.length){BX.load(this.css,BX.delegate(function(){if(this.js.length){BX.load(this.js,BX.delegate(function(){this.fillHtmlContentWrapper()},this))}else{this.fillHtmlContentWrapper()}},this))}else if(this.js.length){BX.load(this.js,BX.delegate(function(){this.fillHtmlContentWrapper()},this))}else{this.fillHtmlContentWrapper()}},fillHtmlContentWrapper:function(){BX.Report.Dashboard.Content.Html.counter++;BX.html(this.htmlContentWrapper,this.html,{callback:function(){BX.Report.Dashboard.Content.Html.callCallbackInContext(BX.Report.Dashboard.Content.Html.counter,this.htmlContentWrapper)}.bind(this)});this.htmlContentWrapper.style.minHeight=this.getHeight()+"px";this.htmlContentWrapper.style.overflow="hidden"},render:function(){if(this.isRendered()){return this.htmlContentWrapper}else{BX.addCustomEvent(this.widget,"Dashboard.Board.Widget:onAfterRender",BX.delegate(function(){if(this.htmlContentWrapper.parentNode){this.loadAssets()}},this));this.setRenderStatus(true);return this.htmlContentWrapper}},setHeight:function(t){this.height=t;this.htmlContentWrapper.style.minHeight=this.height+"px"}};BX.Report.Dashboard.Content.Empty=function(t){BX.Report.Dashboard.Content.apply(this,arguments)};BX.Report.Dashboard.Content.Empty.prototype={__proto__:BX.Report.Dashboard.Content.prototype,constructor:BX.Report.Dashboard.Content.Empty,render:function(){return BX.create("div",{styles:{height:this.getHeight()+"px"},html:"empty content"})}};BX.Report.Dashboard.Content.Error=function(t){BX.Report.Dashboard.Content.apply(this,arguments)};BX.Report.Dashboard.Content.Error.prototype={__proto__:BX.Report.Dashboard.Content.prototype,constructor:BX.Report.Dashboard.Content.Error,render:function(){var t=[];for(var e=0;e<this.errors.length;e++){t.push(BX.create("div",{html:this.errors[e],style:{color:"red"}}))}return BX.create("div",{styles:{height:this.getHeight()+"px"},children:t})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/report/js/dashboard/utils.min.js?1544127441841";s:6:"source";s:39:"/bitrix/js/report/js/dashboard/utils.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){BX.Report.Dashboard.Utils={forEach:function(r,t){Object.keys(r).map(t)},getClass:function(r){if(!BX.type.isNotEmptyString(r)){return null}var t=null;var e=window;var a=r.split(".");for(var n=0;n<a.length;n++){var f=a[n];if(!e[f]){return null}e=e[f];t=e}return t},isDarkColor:function(r){if(!this.isValidColor(r)){return false}if(r.length===3){r=r.replace(/([a-f0-9])/gi,"$1$1")}r=r.toLowerCase();var t=this.getDefaultColors();if(BX.util.in_array(r,t)){return true}var e=parseInt(r,16);var a=e>>16&255;var n=e>>8&255;var f=e&255;var i=(a*299+n*587+f*114)/1e3;return i<128},getDefaultColors:function(){return["eec200","00c4fb","47d1e2","75d900","ffab00","ff5752","468ee5","1eae43","f7d622","4fc3f7","9dcf00","f6ce00"]},isValidColor:function(r){return BX.type.isNotEmptyString(r)&&r.match(/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}}})();
/* End */
;
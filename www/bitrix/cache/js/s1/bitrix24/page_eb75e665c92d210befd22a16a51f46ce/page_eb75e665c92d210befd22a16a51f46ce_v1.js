
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15441274532527";s:6:"source";s:78:"/bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
var waitDiv = null;
var waitPopup = null;
var waitTimeout = null;
var waitTime = 500;

function __SASSetAdmin()
{
	__SASShowWait();
	BX.ajax({
		url: '/bitrix/components/bitrix/socialnetwork.admin.set/ajax.php',
		method: 'POST',
		dataType: 'json',
		data: {'ACTION': 'SET', 'sessid': BX.bitrix_sessid(), 'site': BX.util.urlencode(BX.message('SASSiteId'))},
		onsuccess: function(data) { __SASProcessAJAXResponse(data); }
	});
}

function __SASProcessAJAXResponse(data)
{
	if (data["SUCCESS"] != "undefined" && data["SUCCESS"] == "Y")
	{
		BX.reload();
		return false;
	}
	else if (data["ERROR"] != "undefined" && data["ERROR"].length > 0)
	{
		if (data["ERROR"].indexOf("SESSION_ERROR", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorSessionWrong'));
			BX.reload();
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_ADMIN", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorNotAdmin'));
			return false;
		}
		else if (data["ERROR"].indexOf("CURRENT_USER_NOT_AUTH", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorCurrentUserNotAuthorized'));
			return false;
		}
		else if (data["ERROR"].indexOf("SONET_MODULE_NOT_INSTALLED", 0) === 0)
		{
			__SASShowError(BX.message('SASErrorModuleNotInstalled'));
			return false;
		}
		else
		{
			__SASShowError(data["ERROR"]);
			return false;		
		}
	}
}
				
function __SASShowError(errorText) 
{
	__SASCloseWait();

	var errorPopup = new BX.PopupWindow('sas-error' + Math.random(), window, {
		autoHide: true,
		lightShadow: false,
		zIndex: 2,
		content: BX.create('DIV', {props: {'className': 'sonet-adminset-error-text-block'}, html: errorText}),
		closeByEsc: true,
		closeIcon: true
	});
	errorPopup.show();

}

function __SASShowWait(timeout)
{
	if (timeout !== 0)
	{
		return (waitTimeout = setTimeout(function(){
			__SASShowWait(0)
		}, 50));
	}

	if (!waitPopup)
	{
		waitPopup = new BX.PopupWindow('sas_wait', window, {
			autoHide: true,
			lightShadow: true,
			zIndex: 2,
			content: BX.create('DIV', {
				props: {
					className: 'sonet-adminset-wait-cont'
				},
				children: [
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-icon'
						}
					}),
					BX.create('DIV', {
						props: {
							className: 'sonet-adminset-wait-text'
						},
						html: BX.message('SASWaitTitle')
					})
				]
			})
		});
	}
	else
		waitPopup.setBindElement(window);

	waitPopup.show();
}

function __SASCloseWait()
{
	if (waitTimeout)
	{
		clearTimeout(waitTimeout);
		waitTimeout = null;
	}

	if (waitPopup)
		waitPopup.close();
}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:95:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/script.min.js?154412746160";s:6:"source";s:78:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/script.js";s:3:"min";s:82:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/script.min.js";s:3:"map";s:82:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/script.map.js";}"*/
BX.namespace("BX.Tasks");
/* End */
;
; /* Start:"a:4:{s:4:"full";s:97:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.min.js?154412738440309";s:6:"source";s:77:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
BX.namespace("BX.Main");if(typeof BX.Main.interfaceButtons==="undefined"){BX.Main.interfaceButtons=function(t,e){this.classItem="main-buttons-item";this.classItemSublink="main-buttons-item-sublink";this.classItemText="main-buttons-item-text";this.classItemCounter="main-buttons-item-counter";this.classItemIcon="main-buttons-item-icon";this.classItemMore="main-buttons-item-more";this.classOnDrag="main-buttons-drag";this.classDropzone="main-buttons-submenu-dropzone";this.classSeporator="main-buttons-submenu-separator";this.classHiddenLabel="main-buttons-hidden-label";this.classSubmenuItem="main-buttons-submenu-item";this.classItemDisabled="main-buttons-disabled";this.classItemOver="over";this.classItemActive="main-buttons-item-active";this.classSubmenu="main-buttons-submenu";this.classSecret="secret";this.classItemLocked="locked";this.submenuIdPrefix="main_buttons_popup_";this.childMenuIdPrefix="main_buttons_popup_child_";this.submenuWindowIdPrefix="menu-popup-";this.classSettingMenuItem="main-buttons-submenu-setting";this.classEditState="main-buttons-edit";this.classEditItemButton="main-buttons-item-edit-button";this.classDragItemButton="main-buttons-item-drag-button";this.classSettingsApplyButton="main-buttons-submenu-settings-apply";this.classSettingsResetButton="main-buttons-submenu-settings-reset";this.classSetHome="main-buttons-set-home";this.classSetHide="main-buttons-set-hide";this.classManage="main-buttons-manage";this.classContainer="main-buttons";this.classSubmenuNoHiddenItem="main-buttons-submenu-item-no-hidden";this.classDefaultSubmenuItem="menu-popup-item";this.classInner="main-buttons-inner-container";this.listContainer=null;this.pinContainer=null;this.dragItem=null;this.overItem=null;this.moreButton=null;this.messages=null;this.licenseParams=null;this.isSubmenuShown=false;this.isSubmenuShownOnDragStart=false;this.isSettingsEnabled=true;this.containerId=e.containerId;this.tmp={};this.init(t,e);return{getItemById:BX.delegate(this.getItemById,this),getAllItems:BX.delegate(this.getAllItems,this),getHiddenItems:BX.delegate(this.getHiddenItems,this),getVisibleItems:BX.delegate(this.getVisibleItems,this),getDisabledItems:BX.delegate(this.getDisabledItems,this),getMoreButton:BX.delegate(this.getMoreButton,this),adjustMoreButtonPosition:BX.delegate(this.adjustMoreButtonPosition,this),showSubmenu:BX.delegate(this.showSubmenu,this),closeSubmenu:BX.delegate(this.closeSubmenu,this),refreshSubmenu:BX.delegate(this.refreshSubmenu,this),getCurrentSettings:BX.delegate(this.getCurrentSettings,this),saveSettings:BX.delegate(this.saveSettings,this),setCounterValueByItemId:BX.delegate(this.setCounterValueByItemId,this),getCounterValueByItemId:BX.delegate(this.getCounterValueByItemId,this),updateCounter:BX.delegate(this.updateCounter,this),getActive:BX.delegate(this.getActive,this),isEditEnabled:BX.delegate(this.isEditEnabled,this),isActiveInMoreMenu:BX.delegate(this.isActiveInMoreMenu,this),isSettingsEnabled:this.isSettingsEnabled,classes:{item:this.classItem,itemText:this.classItemText,itemCounter:this.classItemCounter,itemIcon:this.classItemIcon,itemDisabled:this.classItemDisabled,itemOver:this.classItemOver,itemActive:this.classItemActive,itemLocked:this.classItemLocked,submenu:this.classSubmenu,submenuItem:this.classSubmenuItem,containerOnDrag:this.classOnDrag,classSettingMenuItem:this.classSettingMenuItem},itemsContainer:this.listContainer,itemsContainerId:this.listContainer.id}};BX.Main.interfaceButtons.prototype={init:function(t,e){this.listContainer=BX(this.getId());if(!BX.type.isPlainObject(e)){throw"BX.MainButtons: params is not Object"}if(!("containerId"in e)||!BX.type.isNotEmptyString(e.containerId)){throw"BX.MainButtons: containerId not set in params"}if(!BX.type.isDomNode(this.listContainer)){throw"BX.MainButtons: #"+e.containerId+" is not dom node"}if("classes"in e&&BX.type.isPlainObject(e.classes)){this.setCustomClasses(e.classes)}if("messages"in e&&BX.type.isPlainObject(e.messages)){this.setMessages(e.messages)}if("licenseWindow"in e&&BX.type.isPlainObject(e.licenseWindow)){this.setLicenseWindowParams(e.licenseWindow)}if("disableSettings"in e&&e.disableSettings==="true"){this.isSettingsEnabled=false;this.visibleControlMoreButton()}this.moreButton=this.getMoreButton();this.listChildItems={};if(this.isSettingsEnabled){this.dragAndDropInit()}this.adjustMoreButtonPosition();this.bindOnClickOnMoreButton();this.bindOnScrollWindow();this.setContainerHeight();BX.bind(this.getContainer(),"click",BX.delegate(this._onDocumentClick,this));BX.addCustomEvent("onPullEvent-main",BX.delegate(this._onPush,this));this.updateMoreButtonCounter();if(this.isActiveInMoreMenu()){this.activateItem(this.moreButton)}var i=this.getVisibleItems();var s=BX.type.isArray(i)&&i.length>0?i[0]:null;var n=BX.Buttons.Utils.getByTag(s,"a");if(!BX.type.isDomNode(n)){return}var a=n.getAttribute("href");if(a.charAt(0)==="?"){a=n.pathname+n.search}if(!this.lastHomeLink){this.lastHomeLink=a}this.bindOnResizeFrame()},_onDocumentClick:function(t){var e=this.getItem(t);var i,s,n,a,o,u;if(this.isDragButton(t.target)){t.preventDefault();t.stopPropagation()}if(BX.type.isDomNode(e)){if(this.isSettings(e)){this.enableEdit();BX.hide(this.getSettingsButton());BX.show(this.getSettingsApplyButton());return false}if(this.isApplySettingsButton(e)){t.preventDefault();t.stopPropagation();this.disableEdit();BX.show(this.getSettingsButton());BX.hide(this.getSettingsApplyButton());return false}if(this.isResetSettingsButton(e)){this.resetSettings();return false}if(this.isLocked(e)){t.preventDefault();this.showLicenseWindow();return false}if(this.isEditButton(t.target)){var r,h;t.preventDefault();t.stopPropagation();if(this.isSubmenuItem(e)){e=this.getItemAlias(e)}try{r=JSON.parse(BX.data(e,"item"))}catch(t){}h=this.getItemEditMenu();if(h&&h.popupWindow.isShown()&&this.lastEditNode===e){h.popupWindow.close()}else{this.showItemEditMenu(r,t.target)}this.lastEditNode=e;return false}if(this.isSetHide(e)){o=this.getVisibleItems();u=BX.type.isArray(o)?o.length:null;a=this.editItemData.ID.replace(this.listContainer.id+"_","");s=this.getItemById(a);n=this.getItemAlias(s);s=this.isVisibleItem(s)?s:n;if(this.isDisabled(n)){this.enableItem(n)}else if(!this.isDisabled(n)&&u>2){this.disableItem(n)}if(u===2){BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onHideLastVisibleItem",[s,this])}this.refreshSubmenu();this.saveSettings();this.adjustMoreButtonPosition();if(this.isEditEnabled()){this.enableEdit();BX.hide(this.getSettingsButton());BX.show(this.getSettingsApplyButton())}this.editMenu.popupWindow.close();return false}if(this.isSetHome(e)){a=this.editItemData.ID.replace(this.listContainer.id+"_","");s=this.getItemById(a);n=this.getItemAlias(s);if(this.isDisabled(n)){this.enableItem(n)}this.listContainer.insertBefore(s,BX.firstChild(this.listContainer));this.adjustMoreButtonPosition();this.refreshSubmenu();this.saveSettings();if(this.isEditEnabled()){this.enableEdit();BX.hide(this.getSettingsButton());BX.show(this.getSettingsApplyButton())}this.editMenu.popupWindow.close();return false}if(!this.isSublink(t.target)){i=this.dataValue(e,"onclick");if(BX.type.isNotEmptyString(i)){t.preventDefault();this.execScript(i)}}}if(this.isEditEnabled()){this.getSubmenu().popupWindow.setAutoHide(false)}},isActiveInMoreMenu:function(){var t=this.getHiddenItems();var e=this.getDisabledItems();var i=t.concat(e);return i.some(function(t){var e;try{e=JSON.parse(BX.data(t,"item"))}catch(t){}return BX.type.isPlainObject(e)&&("IS_ACTIVE"in e&&e.IS_ACTIVE===true||e.IS_ACTIVE==="true"||e.IS_ACTIVE==="Y")},this)},_onPush:function(t,e){if(t==="user_counter"&&e&&BX.message("SITE_ID")in e){var i=e[BX.message("SITE_ID")];for(var s in i){if(i.hasOwnProperty(s)){this.updateCounter(s,i[s])}}}},bindOnScrollWindow:function(){BX.bind(window,"scroll",BX.delegate(this._onScroll,this))},getActive:function(){var t=this.getAllItems();var e,i;var s=null;if(BX.type.isArray(t)){t.forEach(function(t){try{e=JSON.parse(BX.data(t,"item"))}catch(t){e=null}if(BX.type.isPlainObject(e)&&"IS_ACTIVE"in e&&(e.IS_ACTIVE===true||e.IS_ACTIVE==="true"||e.IS_ACTIVE==="Y")){s=e}},this)}if(BX.type.isPlainObject(s)){i=BX(s.ID);if(BX.type.isDomNode(i)){s.NODE=i}else{s.NODE=null}}return s},isSetHome:function(t){return BX.hasClass(t,this.classSetHome)},isSetHide:function(t){return BX.hasClass(t,this.classSetHide)},getSettingsButton:function(){return BX.Buttons.Utils.getByClass(this.getSubmenuContainer(),this.classSettingMenuItem)},getSettingsApplyButton:function(){return BX.Buttons.Utils.getByClass(this.getSubmenuContainer(),this.classSettingsApplyButton)},isApplySettingsButton:function(t){return BX.hasClass(t,this.classSettingsApplyButton)},enableEdit:function(){var t=this.getSubmenu();if(t&&"popupWindow"in t){t.popupWindow.setAutoHide(false)}BX.addClass(this.listContainer,this.classEditState);BX.addClass(this.getSubmenuContainer(),this.classEditState);this.isEditEnabledState=true},disableEdit:function(){var t=this.getSubmenu();if(t&&"popupWindow"in t){t.popupWindow.setAutoHide(true)}BX.removeClass(this.listContainer,this.classEditState);BX.removeClass(this.getSubmenuContainer(),this.classEditState);this.isEditEnabledState=false},isEditEnabled:function(){return this.isEditEnabledState},showItemEditMenu:function(t,e){if(BX.type.isPlainObject(t)&&"ID"in t){var i=[this.listContainer.id,"_edit_item"].join("");var s=BX.PopupMenu.getMenuById(i);if(s){BX.PopupMenu.destroy(i)}s=this.createItemEditMenu(t,i,e);s.popupWindow.show()}},getContainer:function(){if(!BX.type.isDomNode(this.container)){this.container=BX(this.containerId).parentNode}return this.container},getItemEditMenu:function(){return BX.PopupMenu.getMenuById([this.listContainer.id,"_edit_item"].join(""))},createItemEditMenu:function(t,e,i){var s;var n=[{text:this.message("MIB_SET_HOME"),className:"main-buttons-set-home menu-popup-no-icon"}];var a=t.ID.replace(this.listContainer.id+"_","");var o=this.getItemById(a);if(this.isDisabled(o)){n.push({text:this.message("MIB_SET_SHOW"),className:"main-buttons-set-hide menu-popup-no-icon"})}else{n.push({text:this.message("MIB_SET_HIDE"),className:"main-buttons-set-hide menu-popup-no-icon"})}var u=BX.pos(i);var r={menuId:e,anchor:i,menuItems:n,settings:{autoHide:true,offsetTop:0,offsetLeft:u.width/2,zIndex:20,angle:{position:"top",offset:u.width/2}}};s=BX.PopupMenu.create(r.menuId,r.anchor,r.menuItems,r.settings);if(this.isVisibleItem(o)){t.NODE=o}else{t.NODE=this.getItemAlias(o)}this.editItemData=t;if("menuItems"in s&&BX.type.isArray(s.menuItems)){s.menuItems.forEach(function(t){BX.bind(t.layout.item,"click",BX.delegate(this._onDocumentClick,this))},this)}BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onBeforeCreateEditMenu",[s,t,this]);this.editMenu=s;return s},setHome:function(){var t=this.getVisibleItems();var e=BX.type.isArray(t)&&t.length>0?t[0]:null;var i=BX.Buttons.Utils.getByTag(e,"a");if(!BX.type.isDomNode(i)){return}var s=i.getAttribute("href");if(s.charAt(0)==="?"){s=i.pathname+i.search}if(!this.lastHomeLink){this.lastHomeLink=s}if(this.lastHomeLink!==s){BX.userOptions.save("ui",this.listContainer.id,"firstPageLink",s);BX.onCustomEvent("BX.Main.InterfaceButtons:onFirstItemChange",[s,e])}this.lastHomeLink=s},isEditButton:function(t){return BX.hasClass(t,this.classEditItemButton)},isDragButton:function(t){return BX.hasClass(t,this.classDragItemButton)},isResetSettingsButton:function(t){return BX.hasClass(t,this.classSettingsResetButton)},getContainerHeight:function(){var t=this.getAllItems().map(function(t){var e=getComputedStyle(t);return BX.height(t)+parseInt(e.marginTop)+parseInt(e.marginBottom)});return Math.max.apply(Math,t)},setContainerHeight:function(){var t=this.getContainerHeight();var e=8;BX.height(this.listContainer,t-e)},setLicenseWindowParams:function(t){this.licenseParams=t||{}},message:function(t){var e;try{e=this.messages[t]}catch(t){e=""}return e},setCustomClasses:function(t){if(!BX.type.isPlainObject(t)){return}this.classItem=t.item||this.classItem;this.classItemSublink=t.itemSublink||this.classItemSublink;this.classItemText=t.itemText||this.classItemText;this.classItemCounter=t.itemCounter||this.classItemCounter;this.classItemIcon=t.itemIcon||this.classItemIcon;this.classItemMore=t.itemMore||this.classItemMore;this.classItemOver=t.itemOver||this.classItemOver;this.classItemActive=t.itemActive||this.classItemActive;this.classItemDisabled=t.itemDisabled||this.classItemDisabled;this.classOnDrag=t.onDrag||this.classOnDrag;this.classDropzone=t.dropzone||this.classDropzone;this.classSeporator=t.separator||this.classSeporator;this.classSubmenuItem=t.submenuItem||this.classSubmenuItem;this.classSubmenu=t.submenu||this.classSubmenu;this.classSecret=t.secret||this.classSecret;this.classItemLocked=t.itemLocked||this.classItemLocked},setMessages:function(t){if(!BX.type.isPlainObject(t)){return}this.messages=t},makeFullItemId:function(t){if(!BX.type.isNotEmptyString(t)){return}return[this.listContainer.id,t.replace("-","_")].join("_")},getItemById:function(t){var e=null;var i;if(BX.type.isNotEmptyString(t)){i=this.makeFullItemId(t);e=BX.Buttons.Utils.getBySelector(this.listContainer,"#"+i)}return e},getItemCounterObject:function(t){var e=null;if(BX.type.isDomNode(t)){e=BX.Buttons.Utils.getByClass(t,this.classItemCounter)}return e},setCounterValue:function(t,e){var i=this.getItemCounterObject(t);if(BX.type.isDomNode(i)){i.innerText=e>99?"99+":e>0?e:"";t.dataset.counter=e}this.updateMoreButtonCounter()},updateCounter:function(t,e){if(t.indexOf("crm")===0&&e<0){return}var i,s,n;var a=null;var o=this.getAllItems();if(BX.type.isArray(o)){o.forEach(function(e){try{s=JSON.parse(BX.data(e,"item"))}catch(t){s={}}if(BX.type.isPlainObject(s)&&"COUNTER_ID"in s&&s.COUNTER_ID===t){a=e}},this)}i=this.getItemCounterObject(a);if(BX.type.isDomNode(i)){a=this.getItem(i);i.innerText=e>99?"99+":e>0?e:"";a.dataset.counter=e}n=this.getItemAlias(a);if(BX.type.isDomNode(n)){i=this.getItemCounterObject(n);if(BX.type.isDomNode(i)){i.innerText=e>99?"99+":e>0?e:"";n.dataset.counter=e}}this.updateMoreButtonCounter()},setCounterValueByItemId:function(t,e){var i=e!==null?parseFloat(e):null;var s,n;if(!BX.type.isNotEmptyString(t)){throw"Bad first arg. Need string as item id"}if(i!==null&&!BX.type.isNumber(i)){throw"Bad two arg. Need number counter value - Integer, Float or string with number"}s=this.getItemById(t);if(!BX.type.isDomNode(s)){console.info("Not found node with id #"+t);return}n=this.getItemAlias(s);this.setCounterValue(s,i);this.setCounterValue(n,i)},getCounterValueByItemId:function(t){var e,i;var s=NaN;if(!BX.type.isNotEmptyString(t)){throw"Bad first arg. Need string item id"}else{e=this.getItemById(t);s=this.dataValue(e,"counter");s=parseFloat(s);if(!BX.type.isNumber(s)){i=this.getItemCounterObject(e);s=parseFloat(i.innerText)}}return s},setMoreButtonCounter:function(t){var e=this.getItemCounterObject(this.moreButton);var i=t>99?"99+":t>0?t:"";i=parseInt(i);i=BX.type.isNumber(i)?i:"";e.innerText=i},bindOnClickOnMoreButton:function(){BX.bind(this.moreButton,"click",BX.delegate(this._onClickMoreButton,this))},bindOnResizeFrame:function(){window.frames["maininterfacebuttonstmpframe-"+this.getId()].onresize=BX.throttle(this._onResizeHandler,20,this)},getId:function(){return BX.Buttons.Utils.getByClass(this.getContainer(),this.classInner).id},getAllItems:function(){return BX.Buttons.Utils.getByClass(this.listContainer,this.classItem,true)},getVisibleItems:function(){var t=this.getAllItems();var e=this;var i=[];if(t&&t.length){i=t.filter(function(t){return e.isVisibleItem(t)&&!e.isDisabled(t)})}return i},getHiddenItems:function(){var t=this.getAllItems();var e=[];var i=this;if(t&&t.length){e=t.filter(function(t){return!i.isVisibleItem(t)&&!i.isDisabled(t)})}return e},getDisabledItems:function(){return this.getAllItems().filter(function(t){return this.isDisabled(t)},this)},getMoreButton:function(){var t=null;this.getAllItems().forEach(function(e){!t&&BX.hasClass(e,this.classItemMore)&&(t=e)},this);return t},getLastVisibleItem:function(){var t=this.getVisibleItems();var e=null;if(BX.type.isArray(t)&&t.length){e=t[t.length-1]}if(!BX.type.isDomNode(e)){e=null}return e},adjustMoreButtonPosition:function(){var t=this.getLastVisibleItem();var e=this.isMoreButton(t);if(!e){this.listContainer.insertBefore(this.moreButton,t)}this.updateMoreButtonCounter()},getSubmenuId:function(t){var e="";if(BX.type.isDomNode(this.listContainer)&&BX.type.isNotEmptyString(this.listContainer.id)){e=this.submenuIdPrefix+this.listContainer.id}if(t){e=this.submenuWindowIdPrefix+e}return e},getChildMenuId:function(){var t="";if(BX.type.isDomNode(this.listContainer)&&BX.type.isNotEmptyString(this.listContainer.id)){t=this.childMenuIdPrefix+this.listContainer.id}return t},getSubmenuItemText:function(t){var e,i,s;if(!BX.type.isDomNode(t)){return null}e=this.findChildrenByClassName(t,this.classItemText);i=this.findChildrenByClassName(t,this.classItemCounter);if(BX.type.isDomNode(i)&&BX.type.isDomNode(e)){i.dataset.counter=this.dataValue(t,"counter");s=e.outerHTML+i.outerHTML}else{e=this.dataValue(t,"text");i=this.dataValue(t,"counter");s=e}return s},getChildMenuItemText:function(t){var e,i,s;if(!BX.type.isDomNode(t)){return null}e=this.findChildrenByClassName(t,this.classItemText);i=this.findChildrenByClassName(t,this.classItemCounter);if(BX.type.isDomNode(i)&&BX.type.isDomNode(e)){i.dataset.counter=this.dataValue(t,"counter");s=e.outerHTML+i.outerHTML}else{e=this.dataValue(t,"text");s=e}return s},getLockedClass:function(t){var e="";if(BX.type.isDomNode(t)&&this.isLocked(t)){e=this.classItemLocked}return e},getSubmenuItems:function(){var t=this.getAllItems();var e=this.getHiddenItems();var i=this.getDisabledItems();var s=[];var n,a;if(t.length){t.forEach(function(t){if(e.indexOf(t)===-1&&i.indexOf(t)===-1){s.push({text:this.getSubmenuItemText(t),href:this.dataValue(t,"url"),onclick:this.dataValue(t,"onclick"),title:t.getAttribute("title"),className:[this.classSubmenuItem,this.getIconClass(t),this.classSecret,this.getAliasLink(t),this.getLockedClass(t)].join(" ")})}},this)}if(e.length){e.forEach(function(t){try{n=JSON.parse(this.dataValue(t,"item"))}catch(t){n=null}a=[this.classSubmenuItem,this.getIconClass(t),this.getAliasLink(t),this.getLockedClass(t)];if(BX.type.isPlainObject(n)&&("IS_ACTIVE"in n&&n.IS_ACTIVE===true||n.IS_ACTIVE==="true"||n.IS_ACTIVE==="Y")){a.push(this.classItemActive)}s.push({text:this.getSubmenuItemText(t),href:this.dataValue(t,"url"),onclick:this.dataValue(t,"onclick"),title:t.getAttribute("title"),className:a.join(" "),items:this.getChildMenuItems(t)})},this)}if(this.isSettingsEnabled){s.push({text:"<span>"+this.message("MIB_HIDDEN")+"</span>",className:[this.classSeporator,this.classSubmenuItem,this.classHiddenLabel].join(" ")});if(!i.length){s.push({text:"<span>"+this.message("MIB_NO_HIDDEN")+"</span>",className:[this.classSubmenuItem,this.classSubmenuNoHiddenItem].join(" ")})}if(i.length){i.forEach(function(t){try{n=JSON.parse(this.dataValue(t,"item"))}catch(t){n=null}a=[this.classSubmenuItem,this.classItemDisabled,this.getIconClass(t),this.getAliasLink(t),this.getLockedClass(t)];if(BX.type.isPlainObject(n)&&("IS_ACTIVE"in n&&n.IS_ACTIVE===true||n.IS_ACTIVE==="true"||n.IS_ACTIVE==="Y")){a.push(this.classItemActive)}s.push({text:this.getSubmenuItemText(t),href:this.dataValue(t,"url"),onclick:this.dataValue(t,"onclick"),title:t.getAttribute("title"),className:a.join(" "),items:this.getChildMenuItems(t)})},this)}s.push({text:"<span>"+this.message("MIB_MANAGE")+"</span>",className:[this.classSeporator,this.classSubmenuItem,this.classHiddenLabel,this.classManage].join(" ")});s.push({text:this.message("MIB_SETTING_MENU_ITEM"),className:[this.classSettingMenuItem,this.classSubmenuItem].join(" ")});s.push({text:this.message("MIB_APPLY_SETTING_MENU_ITEM"),className:[this.classSettingsApplyButton,this.classSubmenuItem].join(" ")});s.push({text:this.message("MIB_RESET_SETTINGS"),className:[this.classSettingsResetButton,this.classSubmenuItem].join(" ")})}return s},getChildMenuItems:function(t){var e;try{e=JSON.parse(this.dataValue(t,"item"))}catch(t){e=null}if(!BX.type.isPlainObject(e)){return[]}if(!BX.type.isArray(this.listChildItems[t.id])){var i={};this.setListAllItems(i,e);var s=this.getListItems(i,"");if(s.length){this.listChildItems[t.id]=BX.type.isArray(s[0].items)?s[0].items:[]}}return this.listChildItems[t.id]},setListAllItems:function(t,e){var i=[];if(BX.type.isPlainObject(e)){i.push(e)}else{i=e}i.forEach(function(e){t[e["ID"].replace(this.containerId+"_","")]=e;if(BX.type.isArray(e["ITEMS"])){this.setListAllItems(t,e["ITEMS"])}},this)},getListItems:function(t,e){var i=[];for(var s in t){if(!t.hasOwnProperty(s)){continue}var n=t[s];if(n["PARENT_ID"]===e){var a,o={text:n["TEXT"],href:n["URL"],onclick:n["ON_CLICK"],title:n["TITLE"]};a=this.getListItems(t,s);if(a.length){o.items=a}i.push(o);delete t[s]}}return i},getSubmenuArgs:function(){var t=this.getSubmenuId();var e=this.moreButton;var i=BX.pos(e);var s=this.getSubmenuItems();var n={autoHide:true,offsetLeft:i.width/2-80,angle:{position:"top",offset:100},zIndex:0,events:{onPopupClose:BX.delegate(this._onSubmenuClose,this)}};return[t,e,s,n]},getChildMenuArgs:function(t){var e=this.getChildMenuId();var i=this.getChildMenuItems(t);if(!i||BX.type.isArray(i)&&!i.length){return[]}var s={autoHide:true,angle:true,offsetLeft:t.getBoundingClientRect().width/2};return[e,t,i,s]},visibleControlMoreButton:function(){var t=this.getHiddenItems();if(!t.length||t.length===1&&this.isMoreButton(t[0])){this.getMoreButton().style.display="none"}else{this.getMoreButton().style.display=""}},createSubmenu:function(){var t=BX.PopupMenu.create.apply(BX.PopupMenu,this.getSubmenuArgs());if(this.isSettingsEnabled){this.dragAndDropInitInSubmenu()}t.menuItems.forEach(function(t){BX.bind(t.layout.item,"click",BX.delegate(this._onDocumentClick,this))},this);return t},createChildMenu:function(t){return BX.PopupMenu.create.apply(BX.PopupMenu,this.getChildMenuArgs(t))},showSubmenu:function(){var t=this.getSubmenu();if(t!==null){t.popupWindow.show()}else{this.destroySubmenu();t=this.createSubmenu();t.popupWindow.show()}this.setSubmenuShown(true);this.activateItem(this.moreButton);if(this.isEditEnabled()){t.popupWindow.setAutoHide(false)}},showChildMenu:function(t){var e=BX.PopupMenu.getMenuById(this.getChildMenuId()),i=null;if(e&&e.bindElement){if(e.bindElement.id!==t.id){this.destroyChildMenu(t);i=this.createChildMenu(t);i.popupWindow.show()}else{e.popupWindow.show()}}else{this.destroyChildMenu(t);i=this.createChildMenu(t);i.popupWindow.show()}},closeSubmenu:function(){var t=this.getSubmenu();if(t===null){return}t.popupWindow.close();if(!this.isActiveInMoreMenu()){this.deactivateItem(this.moreButton)}this.setSubmenuShown(false)},closeChildMenu:function(t){var e=this.getChildMenu(t);if(e===null){return}e.popupWindow.close()},getSubmenu:function(){return BX.PopupMenu.getMenuById(this.getSubmenuId())},getChildMenu:function(){return BX.PopupMenu.getMenuById(this.getChildMenuId())},destroySubmenu:function(){BX.PopupMenu.destroy(this.getSubmenuId())},destroyChildMenu:function(){BX.PopupMenu.destroy(this.getChildMenuId())},refreshSubmenu:function(){var t=this.getSubmenu();var e;if(t===null){return}e=this.getSubmenuArgs();if(BX.type.isArray(e)){this.destroySubmenu();this.createSubmenu();this.showSubmenu()}},setSubmenuShown:function(t){this.isSubmenuShown=false;if(BX.type.isBoolean(t)){this.isSubmenuShown=t}},activateItem:function(t){if(!BX.type.isDomNode(t)){return}if(!BX.hasClass(t,this.classItemActive)){BX.addClass(t,this.classItemActive)}},deactivateItem:function(t){if(!BX.type.isDomNode(t)){return}if(BX.hasClass(t,this.classItemActive)){BX.removeClass(t,this.classItemActive)}},getCurrentSettings:function(){var t={};this.getAllItems().forEach(function(e,i){t[e.id]={sort:i,isDisabled:this.isDisabled(e)}},this);return t},saveSettings:function(){var t=this.getCurrentSettings();var e="settings";var i;if(!BX.type.isPlainObject(t)){return}if(BX.type.isDomNode(this.listContainer)){if("id"in this.listContainer){i=this.listContainer.id;t=JSON.stringify(t);BX.userOptions.save("ui",i,e,t);this.setHome()}}},resetSettings:function(){var t=null;var e=BX.PopupWindowManager.create(this.listContainer.id+"_reset_popup",null,{content:this.message("MIB_RESET_ALERT"),autoHide:false,overlay:true,closeByEsc:true,closeIcon:true,draggable:{restrict:true},titleBar:this.message("MIB_RESET_SETTINGS"),buttons:[t=new BX.PopupWindowButton({text:this.message("MIB_RESET_BUTTON"),className:"popup-window-button-create",events:{click:function(){if(BX.hasClass(t.buttonNode,"popup-window-button-wait")){return}BX.addClass(t.buttonNode,"popup-window-button-wait");this.handleResetSettings(function(i){if(i){BX.removeClass(t.buttonNode,"popup-window-button-wait");e.setContent(i)}else{var s="settings";BX.userOptions.save("ui",this.listContainer.id,s,JSON.stringify({}));BX.userOptions.save("ui",this.listContainer.id,"firstPageLink","");window.location.reload()}}.bind(this))}.bind(this)}}),new BX.PopupWindowButtonLink({text:this.message("MIB_CANCEL_BUTTON"),className:"popup-window-button-link-cancel",events:{click:function(){this.popupWindow.close()}}})]});e.show()},handleResetSettings:function(t){var e=[];BX.onCustomEvent("BX.Main.InterfaceButtons:onBeforeResetMenu",[e,this]);var i=new BX.Promise;var s=i;for(var n=0;n<e.length;n++){i=i.then(e[n])}i.then(function(e){t(null,e)},function(e){t(e,null)});s.fulfill()},moveButtonAlias:function(t){var e,i;if(!t||!this.dragItem){return}e=this.getItemAlias(this.dragItem);i=this.getItemAlias(t);if(this.isListItem(e)){if(!i){this.listContainer.appendChild(e)}else{this.listContainer.insertBefore(e,i)}}},moveButton:function(t){var e;if(!BX.type.isDomNode(t)||!BX.type.isDomNode(this.dragItem)){return}if(this.isListItem(t)){if(this.isDisabled(this.dragItem)){this.dragItem.dataset.disabled="false"}if(BX.type.isDomNode(t)){this.listContainer.insertBefore(this.dragItem,t)}else{this.listContainer.appendChild(this.dragItem)}}if(this.isSubmenuItem(t)){if(this.isDisabled(this.dragItem)&&!this.isDisabled(t)){this.enableItem(this.dragItem)}e=this.getSubmenuContainer();e.insertBefore(this.dragItem,t)}},getSubmenuContainer:function(){var t=this.getSubmenu();var e=null;if(t!==null){e=t.itemsContainer}return e},findNextSiblingByClass:function(t,e){var i=t;for(;!!t;t=t.nextElementSibling){if(e){if(BX.hasClass(t,e)&&t!==i){return t}}else{return null}}},findParentByClassName:function(t,e){for(;t&&t!==document;t=t.parentNode){if(e){if(BX.hasClass(t,e)){return t}}else{return null}}},findChildrenByClassName:function(t,e){var i=null;if(BX.type.isDomNode(t)&&BX.type.isNotEmptyString(e)){i=BX.Buttons.Utils.getByClass(t,e)}return i},dragAndDropInit:function(){this.getAllItems().forEach(function(t,e){if(!this.isSeparator(t)&&!this.isSettings(t)&&!this.isApplySettingsButton(t)&&!this.isResetSettingsButton(t)){t.setAttribute("draggable","true");t.setAttribute("tabindex","-1");t.dataset.link="item"+e;BX.bind(t,"dragstart",BX.delegate(this._onDragStart,this));BX.bind(t,"dragend",BX.delegate(this._onDragEnd,this));BX.bind(t,"dragenter",BX.delegate(this._onDragEnter,this));BX.bind(t,"dragover",BX.delegate(this._onDragOver,this));BX.bind(t,"dragleave",BX.delegate(this._onDragLeave,this));BX.bind(t,"drop",BX.delegate(this._onDrop,this))}BX.bind(t,"mouseover",BX.delegate(this._onMouse,this));BX.bind(t,"mouseout",BX.delegate(this._onMouse,this))},this)},dragAndDropInitInSubmenu:function(){var t=this.getSubmenu();var e=t.menuItems;e.forEach(function(t){if(!this.isSeparator(t.layout.item)&&!this.isSettings(t.layout.item)&&!this.isApplySettingsButton(t.layout.item)&&!this.isResetSettingsButton(t.layout.item)){t.layout.item.draggable=true;t.layout.item.dataset.sortable=true;BX.bind(t.layout.item,"dragstart",BX.delegate(this._onDragStart,this));BX.bind(t.layout.item,"dragenter",BX.delegate(this._onDragEnter,this));BX.bind(t.layout.item,"dragover",BX.delegate(this._onDragOver,this));BX.bind(t.layout.item,"dragleave",BX.delegate(this._onDragLeave,this));BX.bind(t.layout.item,"dragend",BX.delegate(this._onDragEnd,this));BX.bind(t.layout.item,"drop",BX.delegate(this._onDrop,this))}if(BX.hasClass(t.layout.item,this.classHiddenLabel)&&!BX.hasClass(t.layout.item,this.classManage)){BX.bind(t.layout.item,"dragover",BX.delegate(this._onDragOver,this))}},this)},getItem:function(t){if(!BX.type.isDomNode(t)){if(!t||!BX.type.isDomNode(t.target)){return null}}else{t={target:t}}var e=this.findParentByClassName(t.target,this.classItem);if(!BX.type.isDomNode(e)){e=this.findParentByClassName(t.target,this.classDefaultSubmenuItem)}return e},setOpacity:function(t){if(!BX.type.isDomNode(t)){return}BX.style(t,"opacity",".1")},unsetOpacity:function(t){if(!BX.type.isDomNode(t)){return}BX.style(t,"opacity","1")},setDragStyles:function(){BX.addClass(this.listContainer,this.classOnDrag);BX.addClass(BX(this.getSubmenuId(true)),this.classOnDrag);this.setOpacity(this.dragItem)},unsetDragStyles:function(){var t=this.getSubmenu();this.getAllItems().forEach(function(t){this.unsetOpacity(t);BX.removeClass(t,"over")},this);if(t&&"menuItems"in t&&BX.type.isArray(t.menuItems)&&t.menuItems.length){t.menuItems.forEach(function(t){this.unsetOpacity(t);BX.removeClass(t.layout.item,"over")},this)}BX.removeClass(this.listContainer,this.classOnDrag);BX.removeClass(BX(this.getSubmenuId(true)),this.classOnDrag)},getIconClass:function(t){var e="";if(BX.type.isDomNode(t)&&"dataset"in t&&"class"in t.dataset&&BX.type.isNotEmptyString(t.dataset.class)){e=t.dataset.class}return e},disableItem:function(t){var e=this.getItemAlias(t);if(t&&"dataset"in t){t.dataset.disabled="true";if(e){e.dataset.disabled="true"}}},enableItem:function(t){var e;if(!BX.type.isDomNode(t)){return}if(this.isSubmenuItem(t)){BX.removeClass(t,this.classItemDisabled);e=this.getItemAlias(t);if(BX.type.isDomNode(e)){e.dataset.disabled="false"}}},getAliasLink:function(t){return this.dataValue(t,"link")||""},getItemAlias:function(t){var e=null;if(!BX.type.isDomNode(t)){return e}var i=this.getAllItems();var s=this.isSubmenuItem(t);var n=this.isListItem(t);if(!s&&!n){return e}if(s){i.forEach(function(i){BX.hasClass(t,this.getAliasLink(i))&&(e=i)},this)}if(n){e=BX.Buttons.Utils.getByClass(document,this.getAliasLink(t))}return e},hideItem:function(t){!!t&&BX.addClass(t,this.classSecret)},showItem:function(t){!!t&&BX.removeClass(t,this.classSecret)},fakeDragItem:function(){var t=null;if(!BX.type.isDomNode(this.dragItem)||!BX.type.isDomNode(this.overItem)){return}if(this.isDragToSubmenu()){t=this.getItemAlias(this.dragItem);if(t!==this.dragItem){this.listContainer.appendChild(this.dragItem);this.dragItem=t;this.showItem(this.dragItem);this.adjustMoreButtonPosition();this.updateSubmenuItems();this.tmp.moved=false;this.tmp.movetToSubmenu=true;this.setOpacity(this.dragItem)}}if(this.isDragToList()&&!this.tmp.movetToSubmenu){t=this.getItemAlias(this.dragItem);if(t!==this.dragItem){this.hideItem(this.dragItem);this.dragItem=t;this.adjustMoreButtonPosition();this.updateSubmenuItems();this.setOpacity(this.dragItem)}}this.tmp.movetToSubmenu=false},updateSubmenuItems:function(){var t=this.getHiddenItems();var e=this.getDisabledItems();var i=this;var s=[];var n,a,o;n=this.getSubmenu();if(n===null){return}a=n.menuItems;if(!BX.type.isArray(a)||!a.length){return}s=e.concat(t);a.forEach(function(t){o=[].some.call(s,function(e){return BX.hasClass(t.layout.item,i.dataValue(e,"link"))||i.isDisabled(t.layout.item)||i.isSeparator(t.layout.item)||i.isDropzone(t.layout.item)});if(o||(i.isSettings(t.layout.item)||i.isApplySettingsButton(t.layout.item)||i.isResetSettingsButton(t.layout.item)||i.isNotHiddenItem(t.layout.item)||i.isSeparator(t.layout.item)||t.layout.item===i.dragItem)&&!i.isMoreButton(t.layout.item)){i.showItem(t.layout.item)}else{i.hideItem(t.layout.item)}})},isNotHiddenItem:function(t){return BX.hasClass(t,this.classSubmenuNoHiddenItem)},getNotHidden:function(){return BX.Buttons.Utils.getByClass(this.getSubmenuContainer(),this.classSubmenuNoHiddenItem)},setOverStyles:function(t){if(BX.type.isDomNode(t)&&!BX.hasClass(t,this.classItemOver)){BX.addClass(t,this.classItemOver)}},unsetOverStyles:function(t){if(BX.type.isDomNode(t)&&BX.hasClass(t,this.classItemOver)){BX.removeClass(t,this.classItemOver)}},dataValue:function(t,e){var i="";var s;if(BX.type.isDomNode(t)){s=BX.data(t,e);if(typeof s!=="undefined"){i=s}}return i},execScript:function(script){if(BX.type.isNotEmptyString(script)){eval(script)}},showLicenseWindow:function(){var t;if(!B24.licenseInfoPopup){return}t=B24.licenseInfoPopup;t.init({B24_LICENSE_BUTTON_TEXT:this.message("MIB_LICENSE_BUY_BUTTON"),B24_TRIAL_BUTTON_TEXT:this.message("MIB_LICENSE_TRIAL_BUTTON"),IS_FULL_DEMO_EXISTS:this.licenseParams.isFullDemoExists,HOST_NAME:this.licenseParams.hostname,AJAX_URL:this.licenseParams.ajaxUrl,LICENSE_ALL_PATH:this.licenseParams.licenseAllPath,LICENSE_DEMO_PATH:this.licenseParams.licenseDemoPath,FEATURE_GROUP_NAME:this.licenseParams.featureGroupName,AJAX_ACTIONS_URL:this.licenseParams.ajaxActionsUrl,B24_FEATURE_TRIAL_SUCCESS_TEXT:this.message("MIB_LICENSE_WINDOW_TRIAL_SUCCESS_TEXT")});t.show("main-buttons",this.message("MIB_LICENSE_WINDOW_HEADER_TEXT"),this.message("MIB_LICENSE_WINDOW_TEXT"))},_onDragStart:function(t){var e=this.getVisibleItems();var i=BX.type.isArray(e)?e.length:null;this.dragItem=this.getItem(t);if(!BX.type.isDomNode(this.dragItem)){return}if(i===2&&this.isListItem(this.dragItem)){t.preventDefault();BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onHideLastVisibleItem",[this.dragItem,this]);return}if(this.isMoreButton(this.dragItem)||this.isSeparator(this.dragItem)||this.isNotHiddenItem(this.dragItem)){t.preventDefault();return}this.isSubmenuShownOnDragStart=!!this.isSubmenuShown;if(this.isListItem(this.dragItem)){this.showSubmenu()}this.setDragStyles();if(!this.isEditEnabled()){this.enableEdit()}},_onDragEnd:function(t){t.preventDefault();var e=this.getItem(t);var i,s;if(!BX.type.isDomNode(e)){return}this.unsetDragStyles();if(!this.isSubmenuShownOnDragStart){this.refreshSubmenu();if(!this.isEditEnabled()){this.closeSubmenu()}}else{this.refreshSubmenu()}i=BX.findNextSibling(this.dragItem,BX.delegate(function(t){return this.isVisibleItem(t)},this));s=BX.findPreviousSibling(this.dragItem,BX.delegate(function(t){return this.isVisibleItem(t)},this));if(BX.type.isDomNode(s)&&(BX.hasClass(s,this.classHiddenLabel)||this.isDisabled(s)&&this.isSubmenuItem(s))||(BX.type.isDomNode(i)&&BX.hasClass(i,this.classManage)||this.isDisabled(i)&&this.isSubmenuItem(i))){this.disableItem(this.dragItem);this.refreshSubmenu()}if(this.isEditEnabled()){this.enableEdit();BX.show(this.getSettingsApplyButton());BX.hide(this.getSettingsButton())}else{this.disableEdit();BX.hide(this.getSettingsApplyButton());BX.show(this.getSettingsButton())}this.updateMoreButtonCounter();this.saveSettings();this.dragItem=null;this.overItem=null;this.tmp.moved=false},updateMoreButtonCounter:function(){var t,e,i,s;t=this.getHiddenItems();s=this.getDisabledItems();t=t.concat(s);e=0;if(BX.type.isArray(t)){t.forEach(function(t){e+=parseInt(this.dataValue(t,"counter"))||0},this)}if(BX.type.isNumber(e)){this.setMoreButtonCounter(e)}},_onDragEnter:function(t){var e=this.getItem(t);if(BX.type.isDomNode(e)&&this.isNotHiddenItem(e)){this.setOverStyles(e)}},_onDragOver:function(t){t.preventDefault();var e=null;this.overItem=this.getItem(t);if(!BX.type.isDomNode(this.overItem)||!BX.type.isDomNode(this.dragItem)||this.overItem===this.dragItem||this.isNotHiddenItem(this.overItem)){return}this.fakeDragItem();if(this.isNext(t)&&this.isGoodPosition(t)&&!this.isMoreButton(this.overItem)){e=this.findNextSiblingByClass(this.overItem,this.classItem);if(this.isMoreButton(e)&&!this.tmp.moved){e=e.previousElementSibling;this.tmp.moved=true}if(!BX.type.isDomNode(e)){e=this.findNextSiblingByClass(this.overItem,this.classSubmenuItem)}if(BX.type.isDomNode(e)){this.moveButton(e);this.moveButtonAlias(e);this.adjustMoreButtonPosition();this.updateSubmenuItems()}}if(!this.isNext(t)&&this.isGoodPosition(t)&&!this.isMoreButton(this.overItem)||!this.isGoodPosition(t)&&this.isMoreButton(this.overItem)&&this.getVisibleItems().length===1){this.moveButton(this.overItem);this.moveButtonAlias(this.overItem);this.adjustMoreButtonPosition();this.updateSubmenuItems()}},_onDragLeave:function(t){var e=this.getItem(t);if(BX.type.isDomNode(e)){this.unsetOverStyles(t.target)}},_onDrop:function(t){var e=this.getItem(t);if(!BX.type.isDomNode(e)){return}if(this.isNotHiddenItem(e)||this.isDisabled(e)){this.disableItem(this.dragItem);this.adjustMoreButtonPosition()}this.unsetDragStyles();t.preventDefault()},getIndex:function(t,e){return[].indexOf.call(t||[],e)},_onSubmenuClose:function(){this.setSubmenuShown(false);if(this.isEditEnabled()){this.activateItem(this.moreButton)}else{if(!this.isActiveInMoreMenu()){this.deactivateItem(this.moreButton)}}},_onResizeHandler:function(){this.adjustMoreButtonPosition();this.updateSubmenuItems();if(!this.isSettingsEnabled){this.visibleControlMoreButton()}},_onClickMoreButton:function(t){t.preventDefault();this.showSubmenu()},_onMouse:function(t){var e=this.getItem(t);if(t.type==="mouseover"&&!BX.hasClass(e,this.classItemOver)){if(!BX.hasClass(e,this.classItemMore)){this.showChildMenu(e)}BX.addClass(e,this.classItemOver)}if(t.type==="mouseout"&&BX.hasClass(e,this.classItemOver)){BX.removeClass(e,this.classItemOver)}},getSettingsResetButton:function(){return BX.Buttons.Utils.getByClass(this.getSubmenuContainer(),this.classSettingsResetButton)},_onScroll:function(){if(BX.style(this.pinContainer,"position")==="fixed"){this.closeSubmenu()}},isDisabled:function(t){var e=false;if(BX.type.isDomNode(t)){e=this.dataValue(t,"disabled")==="true"||BX.hasClass(t,this.classItemDisabled)}return e},isSettings:function(t){var e=false;if(BX.type.isDomNode(t)){e=BX.hasClass(t,this.classSettingMenuItem)}return e},isLocked:function(t){var e=false;if(BX.type.isDomNode(t)){e=this.dataValue(t,"locked")==="true"||BX.hasClass(t,this.classItemLocked)}return e},isDropzone:function(t){return BX.hasClass(t,this.classDropzone)},isNext:function(t){var e=this.dragItem.getBoundingClientRect();var i=this.overItem.getBoundingClientRect();var s=getComputedStyle(this.dragItem);var n=parseInt(s.marginRight.replace("px",""));var a=null;if(this.isListItem(this.overItem)){a=t.clientX>i.left-n&&t.clientX>e.right}if(this.isSubmenuItem(this.overItem)){a=t.clientY>e.top}return a},isGoodPosition:function(t){var e=this.overItem;var i,s;if(!BX.type.isDomNode(e)){return false}i=e.getBoundingClientRect();if(this.isListItem(e)){s=this.isNext(t)&&t.clientX>=i.left+i.width/2||!this.isNext(t)&&t.clientX<=i.left+i.width/2}if(this.isSubmenuItem(e)){s=this.isNext(t)&&t.clientY>=i.top+i.height/2||!this.isNext(t)&&t.clientY<=i.top+i.height/2}return s},isSubmenuItem:function(t){return BX.hasClass(t,this.classSubmenuItem)},isVisibleItem:function(t){if(!BX.type.isDomNode(t)){return false}return t.offsetTop===0},isMoreButton:function(t){var e=false;if(BX.type.isDomNode(t)&&BX.hasClass(t,this.classItemMore)){e=true}return e},isListItem:function(t){var e=false;if(BX.type.isDomNode(t)&&BX.hasClass(t,this.classItem)){e=true}return e},isSublink:function(t){var e=false;if(BX.type.isDomNode(t)){e=BX.hasClass(t,this.classItemSublink)}return e},isSeparator:function(t){var e=false;if(BX.type.isDomNode(t)){e=BX.hasClass(t,this.classSeporator)}return e},isDragToSubmenu:function(){return!this.isSubmenuItem(this.dragItem)&&this.isSubmenuItem(this.overItem)},isDragToList:function(){return this.isSubmenuItem(this.dragItem)&&!this.isSubmenuItem(this.overItem)}}}if(typeof BX.Main.interfaceButtonsManager==="undefined"){BX.Main.interfaceButtonsManager={data:{},init:function(t){var e=null;if(!BX.type.isPlainObject(t)||!("containerId"in t)){throw"BX.Main.interfaceButtonsManager: containerId not set in params Object"}e=BX(t.containerId);if(BX.type.isDomNode(e)){this.data[t.containerId]=new BX.Main.interfaceButtons(e,t)}else{BX(BX.delegate(function(){e=BX(t.containerId);if(!BX.type.isDomNode(e)){throw"BX.Main.interfaceButtonsManager: container is not dom node"}this.data[t.containerId]=new BX.Main.interfaceButtons(e,t)},this))}},getById:function(t){var e=null;if(BX.type.isString(t)&&BX.type.isNotEmptyString(t)){try{e=this.data[t]}catch(t){}}return e},getObjects:function(){return this.data}}}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:94:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.min.js?1544127384575";s:6:"source";s:76:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.js";s:3:"min";s:80:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.min.js";s:3:"map";s:80:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Buttons");BX.Buttons.Utils={getByClass:function(e,t,l){var n=[];if(t){n=(e||document.body).getElementsByClassName(t);if(!l){n=n.length?n[0]:null}else{n=[].slice.call(n)}}return n},getByTag:function(e,t,l){var n=[];if(t){n=(e||document.body).getElementsByTagName(t);if(!l){n=n.length?n[0]:null}else{n=[].slice.call(n)}}return n},getBySelector:function(e,t,l){var n=[];if(t){if(!l){n=(e||document.body).querySelector(t)}else{n=(e||document.body).querySelectorAll(t);n=[].slice.call(n)}}return n}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/logic.min.js?15441274611848";s:6:"source";s:77:"/bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/logic.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
"use strict";BX.namespace("Tasks.Component");(function(){if(typeof BX.Tasks.Component.TopMenu!="undefined"){return}BX.Tasks.Component.TopMenu=BX.Tasks.Component.extend({sys:{code:"topmenu"},methodsStatic:{instances:{},getInstance:function(t){return BX.Tasks.Component.TopMenu.instances[t]},addInstance:function(t,e){BX.Tasks.Component.TopMenu.instances[t]=e}},methods:{construct:function(){this.callConstruct(BX.Tasks.Component);BX.Tasks.Component.TopMenu.addInstance(this.sys.code,this)},bindEvents:function(){var t=this;try{var e=this.option("use_ajax_filter")?this.scope().getElementsByClassName("tasks_role_link"):{};if(e.length){for(var n=0;n<e.length;n++){BX.bind(e[n],"click",function(t){BX.PreventDefault(t);var e=this.dataset.id=="view_all"?"":this.dataset.id;var n=this.dataset.url;BX.onCustomEvent("Tasks.TopMenu:onItem",[e,n]);var s=this.parentElement.getElementsByClassName("tasks_role_link");if(s.length){for(var a=0;a<s.length;a++){BX.removeClass(s[a],"main-buttons-item-active")}}BX.addClass(this,"main-buttons-item-active")})}}}catch(t){}BX.addCustomEvent("BX.Main.Filter:apply",function(t,e,n,s,a){var o=n.getFilterFieldsValues();var i=o.ROLEID;try{var r=BX.Tasks.Component.TopMenu.getInstance("topmenu").scope();var l=r.querySelectorAll(".tasks_role_link");for(var c=0;c<l.length;c++){BX.removeClass(l[c],"main-buttons-item-active")}if(!i){i="view_all"}BX.addClass(BX("tasks_panel_menu_"+i),"main-buttons-item-active");var u=BX.Tasks.Component.TasksToolbar.getInstance();u.getToolbarData(i,function(){u.render()})}catch(t){}})},spotLightInit:function(){var t=this;var e=BX("tasks_panel_menu_more_button");var n=BX("tasks_panel_menu_view_effective");if(n){var s=new BX.SpotLight({id:"tasks_sl_effective",targetElement:n,content:t.option("text_sl_effective"),targetVertex:"middle-center",autoSave:true});s.show()}}}})}).call(this);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:87:"/bitrix/components/bitrix/main.ui.grid/templates/.default/script.min.js?154412738430926";s:6:"source";s:67:"/bitrix/components/bitrix/main.ui.grid/templates/.default/script.js";s:3:"min";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/script.min.js";s:3:"map";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Main");BX.Main.grid=function(t,e,i,n,s,o,a,r,l){this.settings=null;this.containerId="";this.container=null;this.wrapper=null;this.fadeContainer=null;this.scrollContainer=null;this.pagination=null;this.moreButton=null;this.table=null;this.rows=null;this.history=false;this.userOptions=null;this.checkAll=null;this.sortable=null;this.updater=null;this.data=null;this.fader=null;this.editor=null;this.isEditMode=null;this.pinHeader=null;this.pinPanel=null;this.arParams=null;this.resize=null;this.init(t,e,i,n,s,o,a,r,l)};BX.Main.grid.isNeedResourcesReady=function(t){return BX.hasClass(t,"main-grid-load-animation")};BX.Main.grid.prototype={init:function(t,e,i,n,s,o,a,r,l){this.baseUrl=window.location.pathname+window.location.search;this.container=BX(t);if(!BX.type.isNotEmptyString(t)){throw"BX.Main.grid.init: parameter containerId is empty"}if(BX.type.isPlainObject(e)){this.arParams=e}else{throw new Error("BX.Main.grid.init: arParams isn't object")}this.settings=new BX.Grid.Settings;this.containerId=t;this.userOptions=new BX.Grid.UserOptions(this,i,n,s);this.gridSettings=new BX.Grid.SettingsWindow(this);this.messages=new BX.Grid.Message(this,l);if(this.getParam("ALLOW_PIN_HEADER")){this.pinHeader=new BX.Grid.PinHeader(this);BX.addCustomEvent(window,"Grid::headerUpdated",BX.proxy(this.bindOnCheckAll,this))}this.bindOnCheckAll();if(this.getParam("ALLOW_HORIZONTAL_SCROLL")){this.fader=new BX.Grid.Fader(this)}this.pageSize=new BX.Grid.Pagesize(this);this.editor=new BX.Grid.InlineEditor(this,r);if(this.getParam("SHOW_ACTION_PANEL")){this.actionPanel=new BX.Grid.ActionPanel(this,o,a);this.pinPanel=new BX.Grid.PinPanel(this)}this.isEditMode=false;if(!BX.type.isDomNode(this.getContainer())){throw"BX.Main.grid.init: Failed to find container with id "+this.getContainerId()}if(!BX.type.isDomNode(this.getTable())){throw"BX.Main.grid.init: Failed to find table"}this.bindOnRowEvents();if(this.getParam("ALLOW_COLUMNS_RESIZE")){this.resize=new BX.Grid.Resize(this)}this.bindOnMoreButtonEvents();this.bindOnClickPaginationLinks();this.bindOnClickHeader();if(this.getParam("ALLOW_ROWS_SORT")){this.initRowsDragAndDrop()}if(this.getParam("ALLOW_COLUMNS_SORT")){this.initColsDragAndDrop()}this.getRows().initSelected();this.adjustEmptyTable(this.getRows().getSourceBodyChild());BX.onCustomEvent(this.getContainer(),"Grid::ready",[this]);BX.addCustomEvent(window,"Grid::unselectRow",BX.proxy(this._onUnselectRows,this));BX.addCustomEvent(window,"Grid::unselectRows",BX.proxy(this._onUnselectRows,this));BX.addCustomEvent(window,"Grid::allRowsUnselected",BX.proxy(this._onUnselectRows,this));BX.addCustomEvent(window,"Grid::updated",BX.proxy(this._onGridUpdated,this));window.frames[this.getFrameId()].onresize=BX.throttle(this._onFrameResize,20,this);this.initStickedColumns()},destroy:function(){BX.removeCustomEvent(window,"Grid::unselectRow",BX.proxy(this._onUnselectRows,this));BX.removeCustomEvent(window,"Grid::unselectRows",BX.proxy(this._onUnselectRows,this));BX.removeCustomEvent(window,"Grid::allRowsUnselected",BX.proxy(this._onUnselectRows,this));BX.removeCustomEvent(window,"Grid::headerPinned",BX.proxy(this.bindOnCheckAll,this));this.getPinHeader()&&this.getPinHeader().destroy();this.getFader()&&this.getFader().destroy();this.getResize()&&this.getResize().destroy();this.getColsSortable()&&this.getColsSortable().destroy();this.getRowsSortable()&&this.getRowsSortable().destroy();this.getSettingsWindow()&&this.getSettingsWindow().destroy()},_onFrameResize:function(){BX.onCustomEvent(window,"Grid::resize",[this])},_onGridUpdated:function(){this.initStickedColumns();this.adjustFadePosition(this.getFadeOffset())},getFrameId:function(){return"main-grid-tmp-frame-"+this.getContainerId()},enableActionsPanel:function(){if(this.getParam("SHOW_ACTION_PANEL")){var t=this.getActionsPanel().getPanel();if(BX.type.isDomNode(t)){BX.removeClass(t,this.settings.get("classDisable"))}}},disableActionsPanel:function(){if(this.getParam("SHOW_ACTION_PANEL")){var t=this.getActionsPanel().getPanel();if(BX.type.isDomNode(t)){BX.addClass(t,this.settings.get("classDisable"))}}},getSettingsWindow:function(){return this.gridSettings},_onUnselectRows:function(){var t=this.getActionsPanel();var e;if(t instanceof BX.Grid.ActionPanel){e=t.getForAllCheckbox();if(BX.type.isDomNode(e)){e.checked=null;this.disableForAllCounter()}}},isIE:function(){if(!BX.type.isBoolean(this.ie)){this.ie=BX.hasClass(document.documentElement,"bx-ie")}return this.ie},isTouch:function(){if(!BX.type.isBoolean(this.touch)){this.touch=BX.hasClass(document.documentElement,"bx-touch")}return this.touch},getParam:function(t,e){if(e===undefined){e=null}return this.arParams.hasOwnProperty(t)?this.arParams[t]:e},getCounterTotal:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classCounterTotal"),true)},getActionKey:function(){return"action_button_"+this.getId()},getPinHeader:function(){if(this.getParam("ALLOW_PIN_HEADER")){this.pinHeader=this.pinHeader||new BX.Grid.PinHeader(this)}return this.pinHeader},getResize:function(){if(!(this.resize instanceof BX.Grid.Resize)&&this.getParam("ALLOW_COLUMNS_RESIZE")){this.resize=new BX.Grid.Resize(this)}return this.resize},confirmForAll:function(t){var e;var i=this;if(BX.type.isDomNode(t)){e=BX.Grid.Utils.getByTag(t,"input",true)}if(e.checked){this.getActionsPanel().confirmDialog({CONFIRM:true,CONFIRM_MESSAGE:this.arParams.CONFIRM_FOR_ALL_MESSAGE},function(){if(BX.type.isDomNode(e)){e.checked=true}i.selectAllCheckAllCheckboxes();i.getRows().selectAll();i.enableForAllCounter();i.updateCounterDisplayed();i.updateCounterSelected();i.enableActionsPanel();BX.onCustomEvent(window,"Grid::allRowsSelected",[])},function(){if(BX.type.isDomNode(e)){e.checked=null;i.disableForAllCounter();i.updateCounterDisplayed();i.updateCounterSelected()}})}else{this.unselectAllCheckAllCheckboxes();this.getRows().unselectAll();this.disableForAllCounter();this.updateCounterDisplayed();this.updateCounterSelected();this.disableActionsPanel();BX.onCustomEvent(window,"Grid::allRowsUnselected",[])}},editSelected:function(){this.getRows().editSelected()},editSelectedSave:function(){var t={FIELDS:this.getRows().getEditSelectedValues()};if(this.getParam("ALLOW_VALIDATE")){this.tableFade();t[this.getActionKey()]="validate";this.getData().request("","POST",t,"validate",function(e){e=JSON.parse(e);if(e.messages.length){this.arParams["MESSAGES"]=e.messages;this.messages.show();var i=this.getActionsPanel().getButtons().find(function(t){return t.id==="grid_edit_button_control"});this.tableUnfade();BX.fireEvent(i,"click")}else{t[this.getActionKey()]="edit";this.reloadTable("POST",t)}}.bind(this));return}t[this.getActionKey()]="edit";this.reloadTable("POST",t)},getForAllKey:function(){return"action_all_rows_"+this.getId()},updateRow:function(t,e,i,n){var s=this.getRows().getById(t);if(s instanceof BX.Grid.Row){s.update(e,i,n)}},removeRow:function(t,e,i,n){var s=this.getRows().getById(t);if(s instanceof BX.Grid.Row){s.remove(e,i,n)}},addRow:function(t,e,i){var n=this.getUserOptions().getAction("GRID_ADD_ROW");var s={action:n,data:t};var o=this;this.tableFade();this.getData().request(e,"POST",s,null,function(){var e=this.getBodyRows();o.getUpdater().updateBodyRows(e);o.tableUnfade();o.getRows().reset();o.getUpdater().updateFootRows(this.getFootRows());o.getUpdater().updatePagination(this.getPagination());o.getUpdater().updateMoreButton(this.getMoreButton());o.getUpdater().updateCounterTotal(this.getCounterTotal());o.bindOnRowEvents();o.adjustEmptyTable(e);o.bindOnMoreButtonEvents();o.bindOnClickPaginationLinks();o.updateCounterDisplayed();o.updateCounterSelected();if(o.getParam("ALLOW_COLUMNS_SORT")){o.colsSortable.reinit()}if(o.getParam("ALLOW_ROWS_SORT")){o.rowsSortable.reinit()}BX.onCustomEvent(window,"Grid::rowAdded",[{data:t,grid:o,response:this}]);BX.onCustomEvent(window,"Grid::updated",[o]);if(BX.type.isFunction(i)){i({data:t,grid:o,response:this})}})},editSelectedCancel:function(){this.getRows().editSelectedCancel()},removeSelected:function(){var t={ID:this.getRows().getSelectedIds()};var e=this.getActionsPanel().getValues();t[this.getActionKey()]="delete";t[this.getForAllKey()]=this.getForAllKey()in e?e[this.getForAllKey()]:"N";this.reloadTable("POST",t)},sendSelected:function(){var t=this.getActionsPanel().getValues();var e=this.getRows().getSelectedIds();var i={rows:e,controls:t};this.reloadTable("POST",i)},getActionsPanel:function(){return this.actionPanel},getApplyButton:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classPanelButton"),true)},getEditor:function(){return this.editor},reload:function(t){this.reloadTable("GET",{},null,t)},getPanels:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classPanels"),true)},getEmptyBlock:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classEmptyBlock"),true)},adjustEmptyTable:function(t){requestAnimationFrame(function(){function e(t){var e=t.currentTarget;BX.Grid.Utils.requestAnimationFrame(function(){BX.style(a,"transform","translate3d("+BX.scrollLeft(e)+"px, 0px, 0")})}if(!BX.hasClass(document.documentElement,"bx-ie")&&BX.type.isArray(t)&&t.length===1&&BX.hasClass(t[0],this.settings.get("classEmptyRows"))){var i=BX.pos(this.getContainer());var n=BX.scrollTop(window)+BX.height(window);var s=i.bottom-n;var o=BX.height(this.getPanels());var a=this.getEmptyBlock();var r=BX.width(this.getContainer());if(r){BX.width(a,r)}BX.style(a,"transform","translate3d("+BX.scrollLeft(this.getScrollContainer())+"px, 0px, 0");BX.unbind(this.getScrollContainer(),"scroll",e);BX.bind(this.getScrollContainer(),"scroll",e);var l=this.getContainer();var d=0;while(l=l.parentElement){var h=parseFloat(BX.style(l,"padding-top"));var c=parseFloat(BX.style(l,"padding-bottom"));if(!isNaN(h)){d+=h}if(!isNaN(c)){d+=c}}if(s>0){BX.style(this.getTable(),"min-height",i.height-s-o-d+"px")}else{BX.style(this.getTable(),"min-height",i.height+Math.abs(s)-o-d+"px")}}else{BX.style(this.getTable(),"min-height","")}}.bind(this))},reloadTable:function(t,e,i,n){var s;if(!BX.type.isNotEmptyString(t)){t="GET"}if(!BX.type.isPlainObject(e)){e={}}var o=this;this.tableFade();if(!BX.type.isString(n)){n=""}this.getData().request(n,t,e,"",function(){o.getRows().reset();s=this.getBodyRows();o.getUpdater().updateHeadRows(this.getHeadRows());o.getUpdater().updateBodyRows(s);o.getUpdater().updateFootRows(this.getFootRows());o.getUpdater().updatePagination(this.getPagination());o.getUpdater().updateMoreButton(this.getMoreButton());o.getUpdater().updateCounterTotal(this.getCounterTotal());o.adjustEmptyTable(s);o.bindOnRowEvents();o.bindOnMoreButtonEvents();o.bindOnClickPaginationLinks();o.bindOnClickHeader();o.bindOnCheckAll();o.updateCounterDisplayed();o.updateCounterSelected();o.disableActionsPanel();o.disableForAllCounter();if(o.getParam("SHOW_ACTION_PANEL")){o.getUpdater().updateGroupActions(this.getActionPanel())}if(o.getParam("ALLOW_COLUMNS_SORT")){o.colsSortable.reinit()}if(o.getParam("ALLOW_ROWS_SORT")){o.rowsSortable.reinit()}o.tableUnfade();BX.onCustomEvent(window,"Grid::updated",[o]);if(BX.type.isFunction(i)){i()}})},getGroupEditButton:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classGroupEditButton"),true)},getGroupDeleteButton:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classGroupDeleteButton"),true)},enableGroupActions:function(){var t=this.getGroupEditButton();var e=this.getGroupDeleteButton();if(BX.type.isDomNode(t)){BX.removeClass(t,this.settings.get("classGroupActionsDisabled"))}if(BX.type.isDomNode(e)){BX.removeClass(e,this.settings.get("classGroupActionsDisabled"))}},disableGroupActions:function(){var t=this.getGroupEditButton();var e=this.getGroupDeleteButton();if(BX.type.isDomNode(t)){BX.addClass(t,this.settings.get("classGroupActionsDisabled"))}if(BX.type.isDomNode(e)){BX.addClass(e,this.settings.get("classGroupActionsDisabled"))}},closeActionsMenu:function(){var t=this.getRows().getRows();for(var e=0,i=t.length;e<i;e++){t[e].closeActionsMenu()}},getPageSize:function(){return this.pageSize},getFader:function(){return this.fader},getData:function(){this.data=this.data||new BX.Grid.Data(this);return this.data},getUpdater:function(){this.updater=this.updater||new BX.Grid.Updater(this);return this.updater},isSortableHeader:function(t){return BX.hasClass(t,this.settings.get("classHeaderSortable"))},isNoSortableHeader:function(t){return BX.hasClass(t,this.settings.get("classHeaderNoSortable"))},bindOnClickHeader:function(){var t=this;var e;BX.bind(this.getContainer(),"click",function(i){e=BX.findParent(i.target,{tag:"th"},true,false);if(e&&t.isSortableHeader(e)&&!t.preventSortableClick){t.preventSortableClick=false;t._clickOnSortableHeader(e,i)}})},enableEditMode:function(){this.isEditMode=true},disableEditMode:function(){this.isEditMode=false},isEditMode:function(){return this.isEditMode},getColumnHeaderCellByName:function(t){return BX.Grid.Utils.getBySelector(this.getContainer(),"#"+this.getId()+' th[data-name="'+t+'"]',true)},getColumnByName:function(t){var e=this.getParam("DEFAULT_COLUMNS");return!!t&&t in e?e[t]:null},adjustIndex:function(t){var e=this.getAllRows()[0].querySelectorAll(".main-grid-fixed-column").length;return t+e},getColumnByIndex:function(t){t=this.adjustIndex(t);return this.getAllRows().reduce(function(e,i){if(!i.classList.contains("main-grid-row-custom")&&!i.classList.contains("main-grid-row-empty")){e.push(i.children[t])}return e},[])},getAllRows:function(){var t=[].slice.call(this.getTable().rows);var e=this.getContainer().parentElement.querySelector(".main-grid-fixed-bar table");if(e){t.push(e.rows[0])}return t},initStickedColumns:function(){[].slice.call(this.getAllRows()[0].children).forEach(function(t,e){if(t.classList.contains("main-grid-sticked-column")){this.stickyColumnByIndex(e)}},this);this.getResize().destroy();this.getResize().init(this)},stickyColumnByIndex:function(t){var e=this.getColumnByIndex(t);var i=e[0].clientWidth;var n=e.map(function(t){return BX.height(t)});e.forEach(function(t,e){var s=BX.clone(t);t.style.minWidth=i+"px";t.style.width=i+"px";t.style.minHeight=n[e]+"px";var o=this.getLastStickyCellFromRowByIndex(e);if(o){var a=parseInt(BX.style(o,"left"));var r=parseInt(BX.style(o,"width"));a=isNaN(a)?0:a;r=isNaN(r)?0:r;t.style.left=a+r+"px"}t.classList.add("main-grid-fixed-column");t.classList.add("main-grid-cell-static");s.classList.add("main-grid-cell-static");if(this.getColsSortable()){this.getColsSortable().unregister(t);this.getColsSortable().unregister(s)}BX.insertAfter(s,t)},this);this.adjustFadePosition(this.getFadeOffset())},adjustFixedColumnsPosition:function(){var t=this.getAllRows()[0].querySelectorAll(".main-grid-fixed-column").length;var e=[].slice.call(this.getAllRows()[0].children).reduce(function(t,e,i,n){var s;var o;if(n[i-1]&&n[i-1].classList.contains("main-grid-fixed-column")){s=parseInt(BX.style(n[i-1],"left"));o=parseInt(BX.style(n[i-1],"width"));s=isNaN(s)?0:s;o=isNaN(o)?0:o;t.push({index:i+1,left:s+o})}return t},[]);e.forEach(function(i){var n=this.getColumnByIndex(i.index-t);n.forEach(function(t){if(i.index!==e[e.length-1].index){t.style.left=i.left+"px"}})},this);this.getAllRows().forEach(function(t){var e=BX.height(t);var i=[].slice.call(t.children);i.forEach(function(t){t.style.minHeight=e+"px"})})},getLastStickyCellFromRowByIndex:function(t){return[].slice.call(this.getAllRows()[t].children).reduceRight(function(t,e){if(!t&&e.classList.contains("main-grid-fixed-column")){t=e}return t},null)},getFadeOffset:function(){var t=0;var e=this.getLastStickyCellFromRowByIndex(0);if(e){var i=parseInt(BX.style(e,"left"));var n=e.offsetWidth;i=isNaN(i)?0:i;n=isNaN(n)?0:n;t=i+n}return t},adjustFadePosition:function(t){var e=this.getFader().getEarLeft();var i=this.getFader().getShadowLeft();e.style.left=t+"px";i.style.left=t+"px"},sortByColumn:function(t){var e=null;var i=null;if(!BX.type.isPlainObject(t)){e=this.getColumnHeaderCellByName(t);i=this.getColumnByName(t)}else{i=t;i.sort_url=this.prepareSortUrl(t)}if(i&&(!!e&&!BX.hasClass(e,this.settings.get("classLoad"))||!e)){!!e&&BX.addClass(e,this.settings.get("classLoad"));this.tableFade();var n=this;this.getUserOptions().setSort(i.sort_by,i.sort_order,function(){n.getData().request(i.sort_url,null,null,"sort",function(){n.rows=null;n.getUpdater().updateHeadRows(this.getHeadRows());n.getUpdater().updateBodyRows(this.getBodyRows());n.getUpdater().updatePagination(this.getPagination());n.getUpdater().updateMoreButton(this.getMoreButton());n.bindOnRowEvents();n.bindOnMoreButtonEvents();n.bindOnClickPaginationLinks();n.bindOnClickHeader();n.bindOnCheckAll();n.updateCounterDisplayed();n.updateCounterSelected();n.disableActionsPanel();n.disableForAllCounter();if(n.getParam("SHOW_ACTION_PANEL")){n.getActionsPanel().resetForAllCheckbox()}if(n.getParam("ALLOW_ROWS_SORT")){n.rowsSortable.reinit()}if(n.getParam("ALLOW_COLUMNS_SORT")){n.colsSortable.reinit()}BX.onCustomEvent(window,"BX.Main.grid:sort",[i,n]);BX.onCustomEvent(window,"Grid::updated",[n]);n.tableUnfade()})})}},prepareSortUrl:function(t){var e=window.location.toString();if("sort_by"in t){e=BX.util.add_url_param(e,{by:t.sort_by})}if("sort_order"in t){e=BX.util.add_url_param(e,{order:t.sort_order})}return e},_clickOnSortableHeader:function(t,e){e.preventDefault();this.sortByColumn(BX.data(t,"name"))},getObserver:function(){return BX.Grid.observer},initRowsDragAndDrop:function(){this.rowsSortable=new BX.Grid.RowsSortable(this)},initColsDragAndDrop:function(){this.colsSortable=new BX.Grid.ColsSortable(this)},getRowsSortable:function(){return this.rowsSortable},getColsSortable:function(){return this.colsSortable},getUserOptionsHandlerUrl:function(){return this.userOptionsHandlerUrl||""},getUserOptions:function(){return this.userOptions},getCheckAllCheckboxes:function(){var t=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classCheckAllCheckboxes"));return t.map(function(t){return new BX.Grid.Element(t)})},selectAllCheckAllCheckboxes:function(){this.getCheckAllCheckboxes().forEach(function(t){t.getNode().checked=true})},unselectAllCheckAllCheckboxes:function(){this.getCheckAllCheckboxes().forEach(function(t){t.getNode().checked=false})},adjustCheckAllCheckboxes:function(){var t=this.getRows().getBodyChild().filter(function(t){return t.isShown()}).length;var e=this.getRows().getSelected().filter(function(t){return t.isShown()}).length;t===e?this.selectAllCheckAllCheckboxes():this.unselectAllCheckAllCheckboxes()},bindOnCheckAll:function(){var t=this;this.getCheckAllCheckboxes().forEach(function(e){e.getObserver().add(e.getNode(),"change",t._clickOnCheckAll,t)})},_clickOnCheckAll:function(t){t.preventDefault();this.toggleSelectionAll()},toggleSelectionAll:function(){if(!this.getRows().isAllSelected()){this.getRows().selectAll();this.selectAllCheckAllCheckboxes();this.enableActionsPanel();BX.onCustomEvent(window,"Grid::allRowsSelected",[this])}else{this.getRows().unselectAll();this.unselectAllCheckAllCheckboxes();this.disableActionsPanel();BX.onCustomEvent(window,"Grid::allRowsUnselected",[this])}this.updateCounterSelected()},bindOnClickPaginationLinks:function(){var t=this;this.getPagination().getLinks().forEach(function(e){e.getObserver().add(e.getNode(),"click",t._clickOnPaginationLink,t)})},bindOnMoreButtonEvents:function(){var t=this;this.getMoreButton().getObserver().add(this.getMoreButton().getNode(),"click",t._clickOnMoreButton,t)},bindOnRowEvents:function(){var t=this.getObserver();var e=this.getParam("SHOW_ROW_CHECKBOXES");var i=this.getParam("ENABLE_COLLAPSIBLE_ROWS");this.getRows().getBodyChild().forEach(function(n){e&&t.add(n.getNode(),"click",this._onClickOnRow,this);n.getDefaultAction()&&t.add(n.getNode(),"dblclick",this._onRowDblclick,this);n.getActionsButton()&&t.add(n.getActionsButton(),"click",this._clickOnRowActionsButton,this);i&&n.getCollapseButton()&&t.add(n.getCollapseButton(),"click",this._onCollapseButtonClick,this)},this)},_onCollapseButtonClick:function(t){t.preventDefault();t.stopPropagation();var e=this.getRows().get(t.currentTarget);e.toggleChildRows();if(e.isCustom()){this.getUserOptions().setCollapsedGroups(this.getRows().getIdsCollapsedGroups())}else{this.getUserOptions().setExpandedRows(this.getRows().getIdsExpandedRows())}BX.fireEvent(document.body,"click")},_clickOnRowActionsButton:function(t){var e=this.getRows().get(t.target);t.preventDefault();if(!e.actionsMenuIsShown()){e.showActionsMenu()}else{e.closeActionsMenu()}},_onRowDblclick:function(event){event.preventDefault();var row=this.getRows().get(event.target);var defaultJs="";if(!row.isEdit()){clearTimeout(this.clickTimer);this.clickPrevent=true;try{defaultJs=row.getDefaultAction();eval(defaultJs)}catch(t){console.warn(t)}}},_onClickOnRow:function(t){var e=50;var i=window.getSelection();if(t.target.nodeName==="LABEL"){t.preventDefault()}if(t.shiftKey||i.toString().length===0){i.removeAllRanges();this.clickTimer=setTimeout(BX.delegate(function(){if(!this.clickPrevent){n.apply(this,[t])}this.clickPrevent=false},this),e)}function n(t){var e,i,n,s,o,a;var r=true;if(t.target.nodeName!=="A"&&t.target.nodeName!=="INPUT"){i=this.getRows().get(t.target);a=i.getContentContainer(t.target);if(BX.type.isDomNode(a)&&t.target.nodeName!=="TD"&&t.target!==a){r=BX.data(a,"prevent-default")==="true"}if(r){if(i.getCheckbox()){e=[];this.currentIndex=0;this.getRows().getRows().forEach(function(t,e){if(t===i){this.currentIndex=e}},this);this.lastIndex=this.lastIndex||this.currentIndex;if(!t.shiftKey){if(!i.isSelected()){i.select();BX.onCustomEvent(window,"Grid::selectRow",[i,this])}else{i.unselect();BX.onCustomEvent(window,"Grid::unselectRow",[i,this])}}else{s=Math.min(this.currentIndex,this.lastIndex);o=Math.max(this.currentIndex,this.lastIndex);while(s<=o){e.push(this.getRows().getRows()[s]);s++}n=e.some(function(t){return!t.isSelected()});if(n){e.forEach(function(t){t.select()});BX.onCustomEvent(window,"Grid::selectRows",[e,this])}else{e.forEach(function(t){t.unselect()});BX.onCustomEvent(window,"Grid::unselectRows",[e,this])}}this.updateCounterSelected();this.lastIndex=this.currentIndex}this.adjustRows();this.adjustCheckAllCheckboxes()}}}},adjustRows:function(){if(this.getRows().isSelected()){BX.onCustomEvent(window,"Grid::thereSelectedRows",[]);this.enableActionsPanel()}else{BX.onCustomEvent(window,"Grid::noSelectedRows",[]);this.disableActionsPanel()}},getPagination:function(){return new BX.Grid.Pagination(this)},getState:function(){return window.history.state},tableFade:function(){BX.addClass(this.getTable(),this.settings.get("classTableFade"));this.getLoader().show();BX.onCustomEvent("Grid::disabled",[this])},tableUnfade:function(){BX.removeClass(this.getTable(),this.settings.get("classTableFade"));this.getLoader().hide();BX.onCustomEvent("Grid::enabled",[this])},_clickOnPaginationLink:function(t){t.preventDefault();var e=this;var i=this.getPagination().getLink(t.target);if(!i.isLoad()){this.getUserOptions().resetExpandedRows();i.load();this.tableFade();this.getData().request(i.getLink(),null,null,"pagination",function(){e.rows=null;e.getUpdater().updateBodyRows(this.getBodyRows());e.getUpdater().updateHeadRows(this.getHeadRows());e.getUpdater().updateMoreButton(this.getMoreButton());e.getUpdater().updatePagination(this.getPagination());e.bindOnRowEvents();e.bindOnMoreButtonEvents();e.bindOnClickPaginationLinks();e.bindOnClickHeader();e.bindOnCheckAll();e.updateCounterDisplayed();e.updateCounterSelected();e.disableActionsPanel();e.disableForAllCounter();if(e.getParam("SHOW_ACTION_PANEL")){e.getActionsPanel().resetForAllCheckbox()}if(e.getParam("ALLOW_ROWS_SORT")){e.rowsSortable.reinit()}if(e.getParam("ALLOW_COLUMNS_SORT")){e.colsSortable.reinit()}i.unload();e.tableUnfade();BX.onCustomEvent(window,"Grid::updated",[e])})}},_clickOnMoreButton:function(t){t.preventDefault();var e=this;var i=this.getMoreButton();i.load();this.getData().request(i.getLink(),null,null,"more",function(){e.getUpdater().appendBodyRows(this.getBodyRows());e.getUpdater().updateMoreButton(this.getMoreButton());e.getUpdater().updatePagination(this.getPagination());e.getRows().reset();e.bindOnRowEvents();e.bindOnMoreButtonEvents();e.bindOnClickPaginationLinks();e.bindOnClickHeader();e.bindOnCheckAll();e.updateCounterDisplayed();e.updateCounterSelected();if(e.getParam("ALLOW_ROWS_SORT")){e.rowsSortable.reinit()}if(e.getParam("ALLOW_COLUMNS_SORT")){e.colsSortable.reinit()}e.unselectAllCheckAllCheckboxes()})},getAjaxId:function(){return BX.data(this.getContainer(),this.settings.get("ajaxIdDataProp"))},update:function(t,e){var i,n,s,o,a,r;if(!BX.type.isNotEmptyString(t)){return}o=BX.Grid.Utils.getByTag(this.getTable(),"tbody",true);a=BX.Grid.Utils.getByTag(this.getTable(),"thead",true);r=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classNavPanel"),true);t=BX.create("div",{html:t});n=BX.Grid.Utils.getByClass(t,this.settings.get("classHeadRow"));i=BX.Grid.Utils.getByClass(t,this.settings.get("classDataRows"));s=BX.Grid.Utils.getByClass(t,this.settings.get("classNavPanel"),true);if(e===this.settings.get("updateActionMore")){this.getRows().addRows(i);this.unselectAllCheckAllCheckboxes()}if(e===this.settings.get("updateActionPagination")){BX.cleanNode(o);this.getRows().addRows(i);this.unselectAllCheckAllCheckboxes()}if(e===this.settings.get("updateActionSort")){BX.cleanNode(a);BX.cleanNode(o);a.appendChild(n[0]);this.getRows().addRows(i)}r.innerHTML=s.innerHTML;this.bindOnRowEvents();this.bindOnMoreButtonEvents();this.bindOnClickPaginationLinks();this.bindOnClickHeader();this.bindOnCheckAll();this.updateCounterDisplayed();this.updateCounterSelected();this.sortable.reinit()},getCounterDisplayed:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classCounterDisplayed"))},getCounterSelected:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classCounterSelected"))},updateCounterDisplayed:function(){var t=this.getCounterDisplayed();var e;if(BX.type.isArray(t)){e=this.getRows();t.forEach(function(t){if(BX.type.isDomNode(t)){t.innerText=e.getCountDisplayed()}},this)}},updateCounterSelected:function(){var t=this.getCounterSelected();var e;if(BX.type.isArray(t)){e=this.getRows();t.forEach(function(t){if(BX.type.isDomNode(t)){t.innerText=e.getCountSelected()}},this)}},getContainerId:function(){return this.containerId},getId:function(){return this.containerId},getContainer:function(){return BX(this.getContainerId())},getCounter:function(){if(!this.counter){this.counter=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classCounter"))}return this.counter},enableForAllCounter:function(){var t=this.getCounter();if(BX.type.isArray(t)){t.forEach(function(t){BX.addClass(t,this.settings.get("classForAllCounterEnabled"))},this)}},disableForAllCounter:function(){var t=this.getCounter();if(BX.type.isArray(t)){t.forEach(function(t){BX.removeClass(t,this.settings.get("classForAllCounterEnabled"))},this)}},getScrollContainer:function(){if(!this.scrollContainer){this.scrollContainer=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classScrollContainer"),true)}return this.scrollContainer},getWrapper:function(){if(!this.wrapper){this.wrapper=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classWrapper"),true)}return this.wrapper},getFadeContainer:function(){if(!this.fadeContainer){this.fadeContainer=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classFadeContainer"),true)}return this.fadeContainer},getTable:function(){return BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classTable"),true)},getHeaders:function(){return BX.Grid.Utils.getBySelector(this.getWrapper(),'.main-grid-header[data-relative="'+this.getContainerId()+'"]')},getHead:function(){return BX.Grid.Utils.getByTag(this.getContainer(),"thead",true)},getBody:function(){return BX.Grid.Utils.getByTag(this.getContainer(),"tbody",true)},getFoot:function(){return BX.Grid.Utils.getByTag(this.getContainer(),"tfoot",true)},getRows:function(){if(!(this.rows instanceof BX.Grid.Rows)){this.rows=new BX.Grid.Rows(this)}return this.rows},getMoreButton:function(){var t=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classMoreButton"),true);return new BX.Grid.Element(t,this)},getLoader:function(){if(!(this.loader instanceof BX.Grid.Loader)){this.loader=new BX.Grid.Loader(this)}return this.loader},blockSorting:function(){var t=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classHeadCell"));t.forEach(function(t){if(this.isSortableHeader(t)){BX.removeClass(t,this.settings.get("classHeaderSortable"));BX.addClass(t,this.settings.get("classHeaderNoSortable"))}},this)},unblockSorting:function(){var t=BX.Grid.Utils.getByClass(this.getContainer(),this.settings.get("classHeadCell"));t.forEach(function(t){if(this.isNoSortableHeader(t)&&t.dataset.sortBy){BX.addClass(t,this.settings.get("classHeaderSortable"));BX.removeClass(t,this.settings.get("classHeaderNoSortable"))}},this)},confirmDialog:function(t,e,i){var n,s,o,a;if("CONFIRM"in t&&t.CONFIRM){t.CONFIRM_MESSAGE=t.CONFIRM_MESSAGE||this.arParams.CONFIRM_MESSAGE;t.CONFIRM_APPLY_BUTTON=t.CONFIRM_APPLY_BUTTON||this.arParams.CONFIRM_APPLY;t.CONFIRM_CANCEL_BUTTON=t.CONFIRM_CANCEL_BUTTON||this.arParams.CONFIRM_CANCEL;n=new BX.PopupWindow(this.getContainerId()+"-confirm-dialog",null,{content:'<div class="main-grid-confirm-content">'+t.CONFIRM_MESSAGE+"</div>",titleBar:"CONFIRM_TITLE"in t?t.CONFIRM_TITLE:"",autoHide:false,zIndex:9999,overlay:.4,offsetTop:-100,closeIcon:true,closeByEsc:true,events:{onClose:function(){BX.unbind(window,"keydown",r)}},buttons:[new BX.PopupWindowButton({text:t.CONFIRM_APPLY_BUTTON,id:this.getContainerId()+"-confirm-dialog-apply-button",events:{click:function(){BX.type.isFunction(e)?e():null;this.popupWindow.close();this.popupWindow.destroy();BX.onCustomEvent(window,"Grid::confirmDialogApply",[this]);BX.unbind(window,"keydown",r)}}}),new BX.PopupWindowButtonLink({text:t.CONFIRM_CANCEL_BUTTON,id:this.getContainerId()+"-confirm-dialog-cancel-button",events:{click:function(){BX.type.isFunction(i)?i():null;this.popupWindow.close();this.popupWindow.destroy();BX.onCustomEvent(window,"Grid::confirmDialogCancel",[this]);BX.unbind(window,"keydown",r)}}})]});if(!n.isShown()){n.show();s=n.popupContainer;BX.removeClass(s,this.settings.get("classCloseAnimation"));BX.addClass(s,this.settings.get("classShowAnimation"));o=BX(this.getContainerId()+"-confirm-dialog-apply-button");a=BX(this.getContainerId()+"-confirm-dialog-cancel-button");BX.bind(window,"keydown",r)}}else{BX.type.isFunction(e)?e():null}function r(t){if(t.code==="Enter"){t.preventDefault();t.stopPropagation();BX.fireEvent(o,"click")}if(t.code==="Escape"){t.preventDefault();t.stopPropagation();BX.fireEvent(a,"click")}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/action-panel.min.js?154412738411619";s:6:"source";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/action-panel.js";s:3:"min";s:80:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/action-panel.min.js";s:3:"map";s:80:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/action-panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.ActionPanel=function(t,e,n){this.parent=null;this.rel={};this.actions=null;this.types=null;this.lastActivated=[];this.init(t,e,n)};BX.Grid.ActionPanel.prototype={init:function(parent,actions,types){this.parent=parent;this.actions=eval(actions);this.types=eval(types);BX.addCustomEvent(window,"Dropdown::change",BX.proxy(function(t,e,n,a){this.isPanelControl(BX(t))&&this._dropdownChange(t,e,n,a)},this));BX.addCustomEvent(window,"Dropdown::load",BX.proxy(function(t,e,n,a){this.isPanelControl(BX(t))&&this._dropdownChange(t,e,n,a)},this));var panel=this.getPanel();BX.bind(panel,"change",BX.delegate(this._checkboxChange,this));BX.bind(panel,"click",BX.delegate(this._clickOnButton,this));BX.addCustomEvent(window,"Grid::updated",function(){var t=BX("grid_cancel_button");t&&BX.fireEvent(BX.firstChild(t),"click")})},resetForAllCheckbox:function(){var t=this.getForAllCheckbox();if(BX.type.isDomNode(t)){t.checked=null}},getForAllCheckbox:function(){return BX.Grid.Utils.getByClass(this.getPanel(),this.parent.settings.get("classForAllCheckbox"),true)},getPanel:function(){return BX.Grid.Utils.getByClass(this.parent.getContainer(),this.parent.settings.get("classActionPanel"),true)},getApplyButton:function(){return BX.Grid.Utils.getByClass(this.getPanel(),this.parent.settings.get("classPanelApplyButton"),true)},isPanelControl:function(t){return BX.hasClass(t,this.parent.settings.get("classPanelControl"))},getTextInputs:function(){return BX.Grid.Utils.getBySelector(this.getPanel(),'input[type="text"]')},getHiddenInputs:function(){return BX.Grid.Utils.getBySelector(this.getPanel(),'input[type="hidden"]')},getSelects:function(){return BX.Grid.Utils.getBySelector(this.getPanel(),"select")},getDropdowns:function(){return BX.Grid.Utils.getByClass(this.getPanel(),this.parent.settings.get("classDropdown"))},getCheckboxes:function(){return BX.Grid.Utils.getByClass(this.getPanel(),this.parent.settings.get("classPanelCheckbox"))},getButtons:function(){return BX.Grid.Utils.getByClass(this.getPanel(),this.parent.settings.get("classPanelButton"))},isDropdown:function(t){return BX.hasClass(t,this.parent.settings.get("classDropdown"))},isCheckbox:function(t){return BX.hasClass(t,this.parent.settings.get("classPanelCheckbox"))},isTextInput:function(t){return t.type==="text"},isHiddenInput:function(t){return t.type==="hidden"},isSelect:function(t){return t.tagName==="SELECT"},createDropdown:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.create("div",{props:{className:"main-dropdown main-grid-panel-control",id:t.ID+"_control"},attrs:{name:t.NAME,"data-name":t.NAME,"data-items":JSON.stringify(t.ITEMS),"data-value":t.ITEMS[0].VALUE,"data-popup-position":"fixed"},children:[BX.create("span",{props:{className:"main-dropdown-inner"},html:t.ITEMS[0].NAME})]});n.appendChild(a);return n},createCheckbox:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.create("span",{props:{className:"main-grid-checkbox-container"}});var i=BX.create("span",{props:{className:"main-grid-control-panel-content-title"}});var r=BX.create("input",{props:{type:"checkbox",className:this.parent.settings.get("classPanelCheckbox")+" main-grid-checkbox",id:t.ID+"_control"},attrs:{value:t.VALUE||"",title:t.TITLE||"",name:t.NAME||"","data-onchange":JSON.stringify(t.ONCHANGE)}});r.checked=t.CHECKED||null;n.appendChild(a);n.appendChild(i);a.appendChild(r);a.appendChild(BX.create("label",{props:{className:"main-grid-checkbox"},attrs:{for:t.ID+"_control",title:t.TITLE}}));i.appendChild(BX.create("label",{attrs:{for:t.ID+"_control",title:t.TITLE},html:t.LABEL}));return n},createText:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.type.isNotEmptyString(t["TITLE"])?t["TITLE"]:"";if(a!==""){n.appendChild(BX.create("label",{attrs:{title:a,for:t.ID+"_control"},text:a}))}n.appendChild(BX.create("input",{props:{className:"main-grid-control-panel-input-text main-grid-panel-control",id:t.ID+"_control"},attrs:{name:t.NAME,title:a,placeholder:t.PLACEHOLDER||"",value:t.VALUE||"",type:"text","data-onchange":JSON.stringify(t.ONCHANGE||[])}}));return n},createHidden:function(t,e){var n=this.createContainer(t.ID,e);n.appendChild(BX.create("input",{props:{id:t.ID+"_control",type:"hidden"},attrs:{name:t.NAME,value:t.VALUE||""}}));return n},createButton:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.create("button",{props:{className:"main-grid-buttons"+(t.CLASS?" "+t.CLASS:""),id:t.id+"_control"},attrs:{name:t.NAME||"","data-onchange":JSON.stringify(t.ONCHANGE||[])},html:t.TEXT});n.appendChild(a);return n},createLink:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.create("a",{props:{className:"main-grid-link"+(t.CLASS?" "+t.CLASS:""),id:t.ID+"_control"},attrs:{href:t.HREF||"","data-onchange":JSON.stringify(t.ONCHANGE||[])},html:t.TEXT});n.appendChild(a);return n},createCustom:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.create("div",{props:{className:"main-grid-panel-custom"+(t.CLASS?" "+t.CLASS:"")},html:t.VALUE});n.appendChild(a);return n},createContainer:function(t,e){t=t.replace("_control","");e=e.replace("_control","");return BX.create("span",{props:{className:this.parent.settings.get("classPanelControlContainer"),id:t},attrs:{"data-relative":e}})},removeItemsRelativeCurrent:function(t){var e=t;var n=t.id;var a=[];var i;while(e){i=BX.data(e,"relative");if(i===n||i===t.id){n=e.id;a.push(e)}e=e.nextElementSibling}a.forEach(function(t){BX.remove(t)})},validateData:function(t){return"ONCHANGE"in t&&BX.type.isArray(t.ONCHANGE)},activateControl:function(t){var e=BX(t);if(BX.type.isDomNode(e)){BX.removeClass(e,this.parent.settings.get("classDisable"));e.disabled=null}},deactivateControl:function(t){var e=BX(t);if(BX.type.isDomNode(e)){BX.addClass(e,this.parent.settings.get("classDisable"));e.disabled=true}},showControl:function(t){var e=BX(t);e&&BX.show(e)},hideControl:function(t){var e=BX(t);e&&BX.hide(e)},validateActionObject:function(t){return BX.type.isPlainObject(t)&&"ACTION"in t&&BX.type.isNotEmptyString(t.ACTION)&&(t.ACTION===this.actions.RESET_CONTROLS||"DATA"in t&&BX.type.isArray(t.DATA))},validateControlObject:function(t){return BX.type.isPlainObject(t)&&"TYPE"in t&&"ID"in t},createDate:function(t,e){var n=this.createContainer(t.ID,e);var a=BX.decl({block:"main-ui-date",mix:["main-grid-panel-date"],calendarButton:true,valueDelete:true,placeholder:"PLACEHOLDER"in t?t.PLACEHOLDER:"",name:"NAME"in t?t.NAME+"_from":"",tabindex:"TABINDEX"in t?t.TABINDEX:"",value:"VALUE"in t?t.VALUE:"",enableTime:"TIME"in t?t.TIME?"true":"false":"false"});n.appendChild(a);return n},createControl:function(t,e){var n=null;switch(t.TYPE){case this.types.DROPDOWN:n=this.createDropdown(t,e);break;case this.types.CHECKBOX:n=this.createCheckbox(t,e);break;case this.types.TEXT:n=this.createText(t,e);break;case this.types.HIDDEN:n=this.createHidden(t,e);break;case this.types.BUTTON:n=this.createButton(t,e);break;case this.types.LINK:n=this.createLink(t,e);break;case this.types.CUSTOM:n=this.createCustom(t,e);break;case this.types.DATE:n=this.createDate(t,e);break}return n},onChangeHandler:function(container,actions,isPseudo){var newElement,callback;var self=this;if(BX.type.isDomNode(container)&&BX.type.isArray(actions)){actions.forEach(function(action){if(self.validateActionObject(action)){if(action.ACTION===self.actions.CREATE){self.removeItemsRelativeCurrent(container);action.DATA.reverse();action.DATA.forEach(function(t){if(self.validateControlObject(t)){newElement=self.createControl(t,BX.data(container,"relative")||container.id);if(BX.type.isDomNode(newElement)){BX.insertAfter(newElement,container);if("ONCHANGE"in t&&t.TYPE===self.types.CHECKBOX&&"CHECKED"in t&&t.CHECKED){self.onChangeHandler(newElement,t.ONCHANGE)}if(t.TYPE===self.types.DROPDOWN&&BX.type.isArray(t.ITEMS)&&t.ITEMS.length&&"ONCHANGE"in t.ITEMS[0]&&BX.type.isArray(t.ITEMS[0].ONCHANGE)){self.onChangeHandler(newElement,t.ITEMS[0].ONCHANGE)}}}})}if(action.ACTION===self.actions.ACTIVATE){self.removeItemsRelativeCurrent(container);if(BX.type.isArray(action.DATA)){action.DATA.forEach(function(t){self.lastActivated.push(t.ID);self.activateControl(t.ID)})}}if(action.ACTION===self.actions.SHOW){if(BX.type.isArray(action.DATA)){action.DATA.forEach(function(t){self.showControl(t.ID)})}}if(action.ACTION===self.actions.HIDE){if(BX.type.isArray(action.DATA)){action.DATA.forEach(function(t){self.hideControl(t.ID)})}}if(action.ACTION===self.actions.HIDE_ALL_EXPECT){if(BX.type.isArray(action.DATA)){(self.getControls()||[]).forEach(function(t){if(!action.DATA.some(function(e){return e.ID===t.id})){self.hideControl(t.id)}})}}if(action.ACTION===self.actions.SHOW_ALL){(self.getControls()||[]).forEach(function(t){self.showControl(t.id)})}if(action.ACTION===self.actions.REMOVE){if(BX.type.isArray(action.DATA)){action.DATA.forEach(function(t){BX.remove(BX(t.ID))})}}if(action.ACTION===self.actions.CALLBACK){this.confirmDialog(action,BX.delegate(function(){if(BX.type.isArray(action.DATA)){action.DATA.forEach(function(currentCallback){if(currentCallback.JS.indexOf("Grid.")!==-1){callback=currentCallback.JS.replace("Grid","self.parent");callback=callback.replace("()","");callback+=".apply(self.parent, [container])";try{eval(callback)}catch(t){throw new Error(t)}}else if(BX.type.isNotEmptyString(currentCallback.JS)){try{eval(currentCallback.JS)}catch(t){throw new Error(t)}}})}},this))}if(action.ACTION===self.actions.RESET_CONTROLS){this.removeItemsRelativeCurrent(container)}}},this)}else{if(!isPseudo){this.removeItemsRelativeCurrent(container)}self.lastActivated.forEach(function(t){self.deactivateControl(t)});self.lastActivated=[]}},confirmDialog:function(t,e,n){this.parent.confirmDialog(t,e,n)},_dropdownChange:function(t,e,n,a){var i=BX(t);var r=i.parentNode;var s=a&&"ONCHANGE"in a?a.ONCHANGE:null;var o=a&&("PSEUDO"in a&&a.PSEUDO!==false);this.onChangeHandler(r,s,o)},_checkboxChange:function(event){var onChange;try{onChange=eval(BX.data(event.target,"onchange"))}catch(t){onChange=null}this.onChangeHandler(BX.findParent(event.target,{className:this.parent.settings.get("classPanelContainer")},true,false),event.target.checked||event.target.id.indexOf("actallrows_")!==-1?onChange:null)},_clickOnButton:function(event){var onChange;if(this.isButton(event.target)){event.preventDefault();try{onChange=eval(BX.data(event.target,"onchange"))}catch(t){onChange=null}this.onChangeHandler(BX.findParent(event.target,{className:this.parent.settings.get("classPanelContainer")},true,false),onChange)}},isButton:function(t){return BX.hasClass(t,this.parent.settings.get("classPanelButton"))},getSelectedIds:function(){var t=this.parent.getRows().getSelected().filter(function(t){return t.isShown()});return t.map(function(t){return t.getId()})},getControls:function(){return BX.findChild(this.getPanel(),{className:this.parent.settings.get("classPanelControlContainer")},true,true)},getValues:function(){var t={};var e=this;var n=[].concat(this.getDropdowns(),this.getTextInputs(),this.getHiddenInputs(),this.getSelects(),this.getCheckboxes(),this.getButtons());(n||[]).forEach(function(n){if(BX.type.isDomNode(n)){if(e.isDropdown(n)){var a=BX.data(n,"value");a=a!==null&&a!==undefined?a:"";t[BX.data(n,"name")]=a}if(e.isSelect(n)){t[n.getAttribute("name")]=n.options[n.selectedIndex].value}if(e.isCheckbox(n)&&n.checked){t[n.getAttribute("name")]=n.value}if(e.isTextInput(n)||e.isHiddenInput(n)){t[n.getAttribute("name")]=n.value}if(e.isButton(n)){var i=BX.data(n,"name");var r=BX.data(n,"value");r=r!==null&&r!==undefined?r:"";if(i){t[i]=r}}}});return t}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/baseclass.min.js?1544127384207";s:6:"source";s:73:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/baseclass.js";s:3:"min";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/baseclass.min.js";s:3:"map";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/baseclass.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.BaseClass=function(t){this.parent=t};BX.Grid.BaseClass.prototype={getParent:function(){return this.parent}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/cols-sortable.min.js?15441273845645";s:6:"source";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/cols-sortable.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.ColsSortable=function(t){this.parent=null;this.dragItem=null;this.targetItem=null;this.rowsList=null;this.colsList=null;this.dragRect=null;this.offset=null;this.startDragOffset=null;this.dragColumn=null;this.targetColumn=null;this.isDrag=null;this.init(t)};BX.Grid.ColsSortable.prototype={init:function(t){this.parent=t;this.colsList=this.getColsList();this.rowsList=this.getRowsList();if(!this.inited){this.inited=true;BX.addCustomEvent("Grid::updated",BX.proxy(this.reinit,this));BX.addCustomEvent("Grid::headerUpdated",BX.proxy(this.reinit,this))}this.registerObjects()},destroy:function(){BX.removeCustomEvent("Grid::updated",BX.proxy(this.reinit,this));this.unregisterObjects()},reinit:function(){this.unregisterObjects();this.reset();this.init(this.parent)},reset:function(){this.dragItem=null;this.targetItem=null;this.rowsList=null;this.colsList=null;this.dragRect=null;this.offset=null;this.startDragOffset=null;this.dragColumn=null;this.targetColumn=null;this.isDrag=null;this.fixedTableColsList=null},isActive:function(){return this.isDrag},registerObjects:function(){this.unregisterObjects();this.getColsList().forEach(this.register,this);this.getFixedHeaderColsList().forEach(this.register,this)},unregisterObjects:function(){this.getColsList().forEach(this.unregister,this);this.getFixedHeaderColsList().forEach(this.unregister,this)},unregister:function(t){jsDD.unregisterObject(t)},register:function(t){t.onbxdragstart=BX.proxy(this._onDragStart,this);t.onbxdrag=BX.proxy(this._onDrag,this);t.onbxdragstop=BX.proxy(this._onDragEnd,this);jsDD.registerObject(t)},getColsList:function(){if(!this.colsList){this.colsList=BX.Grid.Utils.getByTag(this.parent.getRows().getHeadFirstChild().getNode(),"th");this.colsList=this.colsList.filter(function(t){return!this.isStatic(t)},this)}return this.colsList},getFixedHeaderColsList:function(){if(!this.fixedTableColsList&&this.parent.getParam("ALLOW_PIN_HEADER")){this.fixedTableColsList=BX.Grid.Utils.getByTag(this.parent.getPinHeader().getFixedTable(),"th");this.fixedTableColsList=this.fixedTableColsList.filter(function(t){return!this.isStatic(t)},this)}return this.fixedTableColsList||[]},getRowsList:function(){var t=this.parent.getRows().getSourceRows();if(this.parent.getParam("ALLOW_PIN_HEADER")){t=t.concat(BX.Grid.Utils.getByTag(this.parent.getPinHeader().getFixedTable(),"tr"))}return t},isStatic:function(t){return BX.hasClass(t,this.parent.settings.get("classCellStatic"))&&!BX.hasClass(t,"main-grid-fixed-column")},getDragOffset:function(){var t=this.parent.getScrollContainer().scrollLeft-this.startScrollOffset;return jsDD.x-this.startDragOffset-this.dragRect.left+t},getColumn:function(t){var i=[];if(t instanceof HTMLTableCellElement){i=this.rowsList.map(function(i){return i.cells[t.cellIndex]})}return i},_onDragStart:function(){if(this.parent.getParam("ALLOW_PIN_HEADER")&&this.parent.getPinHeader().isPinned()){this.colsList=this.getFixedHeaderColsList()}else{this.colsList=this.getColsList()}this.startScrollOffset=this.parent.getScrollContainer().scrollLeft;this.isDrag=true;this.dragItem=jsDD.current_node;this.dragRect=this.dragItem.getBoundingClientRect();this.offset=Math.ceil(this.dragRect.width);this.startDragOffset=jsDD.start_x-this.dragRect.left;this.dragColumn=this.getColumn(this.dragItem);this.dragIndex=BX.Grid.Utils.getIndex(this.colsList,this.dragItem);this.parent.preventSortableClick=true},isDragToRight:function(t,i){var s=t.getBoundingClientRect();var e=Math.ceil(s.left+s.width/2+BX.scrollLeft(window));var r=this.dragIndex;var n=jsDD.x;return i>r&&n>e},isDragToLeft:function(t,i){var s=t.getBoundingClientRect();var e=Math.ceil(s.left+s.width/2+BX.scrollLeft(window));var r=this.dragIndex;var n=jsDD.x;return i<r&&n<e},isDragToBack:function(t,i){var s=t.getBoundingClientRect();var e=Math.ceil(s.left+s.width/2+BX.scrollLeft(window));var r=this.dragIndex;var n=jsDD.x;return i>r&&n<e||i<r&&n>e},isMovedToRight:function(t){return t.style.transform==="translate3d("+-this.offset+"px, 0px, 0px)"},isMovedToLeft:function(t){return t.style.transform==="translate3d("+this.offset+"px, 0px, 0px)"},isMoved:function(t){return t.style.transform!=="translate3d(0px, 0px, 0px)"&&t.style.transform!==""},moveColumn:function(t,i,s){s=BX.type.isNumber(s)?s:300;BX.Grid.Utils.styleForEach(t,{transition:s+"ms",transform:"translate3d("+i+"px, 0px, 0px)"})},_onDrag:function(){this.dragOffset=this.getDragOffset();this.targetItem=this.targetItem||this.dragItem;this.targetColumn=this.targetColumn||this.dragColumn;var t=-this.offset;var i=this.offset;var s=0;var e=0;this.moveColumn(this.dragColumn,this.dragOffset,e);[].forEach.call(this.colsList,function(e,r){if(e&&!e.classList.contains("main-grid-cell-static")){if(this.isDragToRight(e,r)&&!this.isMovedToRight(e)){this.targetColumn=this.getColumn(e);this.moveColumn(this.targetColumn,t)}if(this.isDragToLeft(e,r)&&!this.isMovedToLeft(e)){this.targetColumn=this.getColumn(e);this.moveColumn(this.targetColumn,i)}if(this.isDragToBack(e,r)&&this.isMoved(e)){this.targetColumn=this.getColumn(e);this.moveColumn(this.targetColumn,s)}}},this)},_onDragEnd:function(){[].forEach.call(this.dragColumn,function(t,i){BX.Grid.Utils.collectionSort(t,this.targetColumn[i])},this);this.rowsList.forEach(function(t){BX.Grid.Utils.styleForEach(t.cells,{transition:"",transform:""})});this.reinit();var t=this.colsList.map(function(t){return BX.data(t,"name")});this.parent.getUserOptions().setColumns(t);BX.onCustomEvent(this.parent.getContainer(),"Grid::columnMoved",[this.parent]);setTimeout(function(){this.parent.preventSortableClick=false}.bind(this),10)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:87:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/data.min.js?15441273845089";s:6:"source";s:68:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/data.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Data=function(t){this.parent=t;this.reset()};BX.Grid.Data.prototype.reset=function(){this.response=null;this.xhr=null;this.headRows=null;this.bodyRows=null;this.footRows=null;this.moreButton=null;this.pagination=null;this.counterDisplayed=null;this.counterSelected=null;this.counterTotal=null;this.limit=null;this.actionPanel=null;this.rowsByParentId={};this.rowById={};this.isValidResponse=null};BX.Grid.Data.prototype.getParent=function(){return this.parent};BX.Grid.Data.prototype.validateResponse=function(){if(!BX.type.isBoolean(this.isValidResponse)){this.isValidResponse=!!this.getResponse()&&!!BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classContainer"),true)}return this.isValidResponse};BX.Grid.Data.prototype.request=function(t,e,i,s,r,n){if(!BX.type.isString(t)){t=""}if(!BX.type.isNotEmptyString(e)){e="GET"}if(!BX.type.isPlainObject(i)){i={}}var a={gridId:this.parent.getId(),url:t,method:e,data:i};BX.onCustomEvent(window,"Grid::beforeRequest",[this,a]);t=a.url;if(!BX.type.isNotEmptyString(t)){t=this.parent.baseUrl}t=BX.Grid.Utils.addUrlParams(t,{sessid:BX.bitrix_sessid(),internal:"true",grid_id:this.parent.getId()});if("apply_filter"in i&&i.apply_filter==="Y"){t=BX.Grid.Utils.addUrlParams(t,{apply_filter:"Y"})}else{t=BX.util.remove_url_param(t,"apply_filter")}if("clear_nav"in i&&i.clear_nav==="Y"){t=BX.Grid.Utils.addUrlParams(t,{clear_nav:"Y"})}else{t=BX.util.remove_url_param(t,"clear_nav")}t=BX.Grid.Utils.addUrlParams(t,{grid_action:s||"showpage"});e=a.method;i=a.data;this.reset();var o=this;setTimeout(function(){var a=BX.ajax({url:BX.Grid.Utils.ajaxUrl(t,o.getParent().getAjaxId()),data:i,method:e,dataType:"html",headers:[{name:"X-Ajax-Grid-UID",value:o.getParent().getAjaxId()},{name:"X-Ajax-Grid-Req",value:JSON.stringify({action:s||"showpage"})}],processData:true,scriptsRunFirst:false,onsuccess:function(t){o.response=BX.create("div",{html:t});o.response=o.response.querySelector("#"+o.parent.getContainerId());o.xhr=a;if(BX.type.isFunction(r)){BX.delegate(r,o)(t,a)}},onerror:function(t){o.error=n;o.xhr=a;if(BX.type.isFunction(n)){BX.delegate(n,o)(a,t)}}})},0)};BX.Grid.Data.prototype.getResponse=function(){return this.response};BX.Grid.Data.prototype.getHeadRows=function(){if(!this.headRows){this.headRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classHeadRow"))}return this.headRows};BX.Grid.Data.prototype.getBodyRows=function(){if(!this.bodyRows){this.bodyRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classBodyRow"))}return this.bodyRows};BX.Grid.Data.prototype.getRowsByParentId=function(t){if(!(t in this.rowsByParentId)){this.rowsByParentId[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-parent-id="'+t+'"]')}return this.rowsByParentId[t]};BX.Grid.Data.prototype.getRowById=function(t){if(!(t in this.rowById)){this.rowById[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-id="'+t+'"]',true)}return this.rowById[t]};BX.Grid.Data.prototype.getFootRows=function(){if(!this.footRows){this.footRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classFootRow"))}return this.footRows};BX.Grid.Data.prototype.getMoreButton=function(){if(!this.moreButton){this.moreButton=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classMoreButton"),true)}return this.moreButton};BX.Grid.Data.prototype.getPagination=function(){if(!this.pagination){this.pagination=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPagination"),true);if(BX.type.isDomNode(this.pagination)){this.pagination=BX.firstChild(this.pagination)}}return this.pagination};BX.Grid.Data.prototype.getCounterDisplayed=function(){if(!this.counterDisplayed){this.counterDisplayed=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterDisplayed"),true)}return this.counterDisplayed};BX.Grid.Data.prototype.getCounterSelected=function(){if(!this.counterSelected){this.counterSelected=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterSelected"),true)}return this.counterSelected};BX.Grid.Data.prototype.getCounterTotal=function(){if(!BX.type.isDomNode(this.counterTotal)){var t="."+this.getParent().settings.get("classCounterTotal")+" ."+this.getParent().settings.get("classPanelCellContent");this.counterTotal=BX.Grid.Utils.getBySelector(this.getResponse(),t,true)}return this.counterTotal};BX.Grid.Data.prototype.getLimit=function(){if(!this.limit){this.limit=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPageSize"),true)}return this.limit};BX.Grid.Data.prototype.getPageSize=function(){return this.getLimit()};BX.Grid.Data.prototype.getActionPanel=function(){if(!this.actionPanel){this.actionPanel=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classActionPanel"),true)}return this.actionPanel}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown-manager.min.js?1544127384996";s:6:"source";s:80:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown-manager.js";s:3:"min";s:84:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown-manager.min.js";s:3:"map";s:84:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown-manager.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Main");BX.Main.dropdownManager={dropdownClass:"main-dropdown",data:{},init:function(){var self=this;var result;var onLoadItems;var items;BX.bind(document,"click",BX.delegate(function(t){if(BX.hasClass(t.target,this.dropdownClass)){t.preventDefault();result=this.getById(t.target.id);if(result&&result.dropdown===t.target){self.push(t.target.id,this.getById(t.target.id))}else{self.push(t.target.id,new BX.Main.dropdown(t.target))}}},this));onLoadItems=BX.Grid.Utils.getByClass(document.body,this.dropdownClass);if(BX.type.isArray(onLoadItems)){onLoadItems.forEach(function(current){result=self.getById(current.id);try{items=eval(BX.data(current,"items"))}catch(err){}BX.onCustomEvent(window,"Dropdown::load",[current.id,{},null,BX.type.isArray(items)&&items.length?items[0]:[],BX.data(current,"value")])})}},push:function(t,e){this.data[t]=e},getById:function(t){return t in this.data?this.data[t]:null}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown.min.js?15441273843586";s:6:"source";s:72:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown.js";s:3:"min";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown.min.js";s:3:"map";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Main");BX.Main.dropdown=function(t){this.id=null;this.dropdown=null;this.items=null;this.value=null;this.menuId=null;this.menu=null;this.menuItems=null;this.dataItems="items";this.dataValue="value";this.dataPseudo="pseudo";this.dropdownItemClass="main-dropdown-item";this.activeClass="main-dropdown-active";this.selectedClass="main-dropdown-item-selected";this.notSelectedClass="main-dropdown-item-not-selected";this.menuItemClass="menu-popup-item";this.init(t)};BX.Main.dropdown.prototype={init:function(t){this.id=t.id;this.dropdown=t;this.items=this.getItems();this.value=this.getValue();this.menuId=this.getMenuId();this.menu=this.createMenu();this.menu.popupWindow.show();BX.bind(this.dropdown,"click",BX.delegate(this.showMenu,this))},getMenuId:function(){return this.id+"_menu"},getItems:function(){var result;try{var str=BX.data(this.dropdown,this.dataItems);result=eval(str)}catch(err){result=[]}return result},getValue:function(){return BX.data(this.dropdown,this.dataValue)},prepareMenuItems:function(){var t=this;var e,s;var n=this.getValue();function i(a){return a.map(function(a){e={};e["data-"+t.dataValue]=a.VALUE;e["data-"+t.dataPseudo]="PSEUDO"in a&&a.PSEUDO?"true":"false";s=BX.create("div",{children:[BX.create("span",{props:{className:t.dropdownItemClass},attrs:e,text:a.NAME})]});return{text:s.innerHTML,className:n===a.VALUE?t.selectedClass:t.notSelectedClass,delimiter:a.DELIMITER,items:"ITEMS"in a?i(a.ITEMS):null}})}return i(this.getItems())},createMenu:function(){var t=this;return BX.PopupMenu.create(this.getMenuId(),this.dropdown,this.prepareMenuItems(),{autoHide:true,offsetTop:-8,offsetLeft:40,angle:{position:"bottom",offset:0},events:{onPopupClose:BX.delegate(this._onCloseMenu,this),onPopupShow:function(){t._onShowMenu()}}})},showMenu:function(){this.menu=BX.PopupMenu.getMenuById(this.menuId);if(!this.menu){this.menu=this.createMenu();this.menu.popupWindow.show()}},getSubItem:function(t){return BX.Grid.Utils.getByClass(t,this.dropdownItemClass,true)},refresh:function(t){var e=this.getSubItem(t);var s=BX.data(e,this.dataValue);BX.firstChild(this.dropdown).innerText=e.innerText;this.dropdown.dataset[this.dataValue]=s},selectItem:function(t){var e=this;(this.menu.menuItems||[]).forEach(function(s){BX.removeClass(s.layout.item,e.selectedClass);if(t!==s.layout.item){BX.addClass(s.layout.item,e.notSelectedClass)}else{BX.removeClass(s.layout.item,e.notSelectedClass)}});BX.addClass(t,this.selectedClass)},getDataItemIndexByValue:function(t,e){var s;if(BX.type.isArray(t)){t.map(function(t,n){if(t.VALUE===e){s=n;return false}})}return false},getDataItemByValue:function(t){var e=this.getItems().filter(function(e){return e.VALUE===t});return e.length>0?e[0]:null},_onShowMenu:function(){var t=this;BX.addClass(this.dropdown,this.activeClass);(this.menu.menuItems||[]).forEach(function(e){BX.bind(e.layout.item,"click",BX.delegate(t._onItemClick,t))})},_onCloseMenu:function(){BX.removeClass(this.dropdown,this.activeClass);BX.PopupMenu.destroy(this.menuId)},_onItemClick:function(t){var e=this.getMenuItem(t.target);var s,n;var i=this.getSubItem(e);var a=BX.data(i,"pseudo");if(!(a==="true")){this.refresh(e);this.selectItem(e);this.menu.popupWindow.close();s=this.getValue();n=this.getDataItemByValue(s)}else{s=BX.data(i,"value");n=this.getDataItemByValue(s)}BX.onCustomEvent(window,"Dropdown::change",[this.dropdown.id,t,e,n,s])},getMenuItem:function(t){var e=t;if(!BX.hasClass(e,this.menuItemClass)){e=BX.findParent(e,{"class":this.menuItemClass})}return e}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/element.min.js?1544127384857";s:6:"source";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/element.js";s:3:"min";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/element.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/element.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Element=function(t,e){this.node=null;this.href=null;this.parent=null;this.init(t,e)};BX.Grid.Element.prototype={init:function(t,e){this.node=t;this.parent=e;this.resetOnclickAttr()},getParent:function(){return this.parent},load:function(){BX.addClass(this.getNode(),this.getParent().settings.get("classLoad"))},unload:function(){BX.removeClass(this.getNode(),this.getParent().settings.get("classLoad"))},isLoad:function(){return BX.hasClass(this.getNode(),this.getParent().settings.get("classLoad"))},resetOnclickAttr:function(){if(BX.type.isDomNode(this.getNode())){this.getNode().onclick=null}},getObserver:function(){return BX.Grid.observer},getNode:function(){return this.node},getLink:function(){var t;try{t=this.getNode().href}catch(e){t=null}return t}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:88:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/fader.min.js?15441273846023";s:6:"source";s:69:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/fader.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Fader=function(t){this.parent=null;this.table=null;this.container=null;this.init(t)};BX.Grid.Fader.prototype={init:function(t){this.parent=t;this.table=this.parent.getTable();this.container=this.table.parentNode;this.scrollStartEventName=this.parent.isTouch()?"touchstart":"mouseenter";this.scrollEndEventName=this.parent.isTouch()?"touchend":"mouseleave";if(this.parent.getParam("ALLOW_PIN_HEADER")){this.fixedTable=this.parent.getPinHeader().getFixedTable()}this.debounceScrollHandler=BX.debounce(this._onWindowScroll,400,this);BX.bind(window,"resize",BX.proxy(this.toggle,this));document.addEventListener("scroll",this.debounceScrollHandler,BX.Grid.Utils.listenerParams({passive:true}));this.container.addEventListener("scroll",BX.proxy(this.toggle,this),BX.Grid.Utils.listenerParams({passive:true}));BX.addCustomEvent(window,"Grid::updated",BX.proxy(this.toggle,this));BX.addCustomEvent(window,"Grid::resize",BX.proxy(this.toggle,this));BX.addCustomEvent(window,"Grid::headerUpdated",BX.proxy(this._onHeaderUpdated,this));BX.addCustomEvent(window,"Grid::columnResize",BX.proxy(this.toggle,this));BX.bind(this.getEarLeft(),this.scrollStartEventName,BX.proxy(this._onMouseoverLeft,this));BX.bind(this.getEarRight(),this.scrollStartEventName,BX.proxy(this._onMouseoverRight,this));BX.bind(this.getEarLeft(),this.scrollEndEventName,BX.proxy(this.stopScroll,this));BX.bind(this.getEarRight(),this.scrollEndEventName,BX.proxy(this.stopScroll,this));this.toggle();this.adjustEarOffset(true)},destroy:function(){BX.unbind(window,"resize",BX.proxy(this.toggle,this));document.removeEventListener("scroll",this.debounceScrollHandler,BX.Grid.Utils.listenerParams({passive:true}));this.container.removeEventListener("scroll",BX.proxy(this.toggle,this),BX.Grid.Utils.listenerParams({passive:true}));BX.removeCustomEvent(window,"Grid::updated",BX.proxy(this.toggle,this));BX.removeCustomEvent(window,"Grid::headerUpdated",BX.proxy(this._onHeaderUpdated,this));BX.removeCustomEvent(window,"Grid::columnResize",BX.proxy(this.toggle,this));BX.unbind(this.getEarLeft(),this.scrollStartEventName,BX.proxy(this._onMouseoverLeft,this));BX.unbind(this.getEarRight(),this.scrollStartEventName,BX.proxy(this._onMouseoverRight,this));BX.unbind(this.getEarLeft(),this.scrollEndEventName,BX.proxy(this.stopScroll,this));BX.unbind(this.getEarRight(),this.scrollEndEventName,BX.proxy(this.stopScroll,this));this.hideLeftEar();this.hideRightEar();this.stopScroll()},_onHeaderUpdated:function(){this.fixedTable=this.parent.getPinHeader().getFixedTable()},_onMouseoverLeft:function(t){this.parent.isTouch()&&t.preventDefault();this.startScrollByDirection("left")},_onMouseoverRight:function(t){this.parent.isTouch()&&t.preventDefault();this.startScrollByDirection("right")},stopScroll:function(){clearTimeout(this.scrollTimer);clearInterval(this.scrollInterval)},startScrollByDirection:function(t){var e=this.container;var i=e.scrollLeft;var s=this;var r=8;var o=1e3/60/2;this.scrollTimer=setTimeout(function(){s.scrollInterval=setInterval(function(){e.scrollLeft=t=="right"?i+=r:i-=r},o)},100)},getEarLeft:function(){if(!this.earLeft){this.earLeft=BX.Grid.Utils.getByClass(this.parent.getContainer(),this.parent.settings.get("classEarLeft"),true)}return this.earLeft},getEarRight:function(){if(!this.earRight){this.earRight=BX.Grid.Utils.getByClass(this.parent.getContainer(),this.parent.settings.get("classEarRight"),true)}return this.earRight},getShadowLeft:function(){return this.parent.getContainer().querySelector(".main-grid-fade-shadow-left")},getShadowRight:function(){return this.parent.getContainer().querySelector(".main-grid-fade-shadow-right")},adjustEarOffset:function(t){if(t){this.windowHeight=BX.height(window);this.tbodyPos=BX.pos(this.table.tBodies[0]);this.headerPos=BX.pos(this.table.tHead)}var e=window.scrollY;if(this.parent.isIE()){e=document.documentElement.scrollTop}var i=e+this.windowHeight-this.tbodyPos.top;var s=e-this.tbodyPos.top;if(i>this.tbodyPos.bottom-this.tbodyPos.top){i=this.tbodyPos.bottom-this.tbodyPos.top}if(s<this.headerPos.height){s=this.headerPos.height}else{i-=s;i+=this.headerPos.height}BX.Grid.Utils.requestAnimationFrame(BX.proxy(function(){if(s!==this.lastPosTop){var t="translate3d(0px, "+s+"px, 0)";this.getEarLeft().style.transform=t;this.getEarRight().style.transform=t}if(i!==this.lastBottomPos){this.getEarLeft().style.height=i+"px";this.getEarRight().style.height=i+"px"}this.lastPosTop=s;this.lastBottomPos=i},this))},_onWindowScroll:function(){this.adjustEarOffset()},hasScroll:function(){return this.table.offsetWidth>this.container.clientWidth},hasScrollLeft:function(){return this.container.scrollLeft>0},hasScrollRight:function(){return this.table.offsetWidth>this.container.scrollLeft+this.container.clientWidth},showLeftEar:function(){BX.addClass(this.container.parentNode,this.parent.settings.get("classFadeContainerLeft"));BX.addClass(this.getEarLeft(),this.parent.settings.get("classShow"))},hideLeftEar:function(){BX.removeClass(this.container.parentNode,this.parent.settings.get("classFadeContainerLeft"));BX.removeClass(this.getEarLeft(),this.parent.settings.get("classShow"))},showRightEar:function(){BX.addClass(this.container.parentNode,this.parent.settings.get("classFadeContainerRight"));BX.addClass(this.getEarRight(),this.parent.settings.get("classShow"))},hideRightEar:function(){BX.removeClass(this.container.parentNode,this.parent.settings.get("classFadeContainerRight"));BX.removeClass(this.getEarRight(),this.parent.settings.get("classShow"))},adjustFixedTablePosition:function(){var t=this.container.scrollLeft;BX.Grid.Utils.requestAnimationFrame(BX.delegate(function(){this.fixedTable.style.marginLeft=-t+"px"},this))},toggle:function(){this.adjustEarOffset(true);this.fixedTable&&this.adjustFixedTablePosition();if(this.hasScroll()){this.hasScrollLeft()?this.showLeftEar():this.hideLeftEar();this.hasScrollRight()?this.showRightEar():this.hideRightEar()}else{this.hideLeftEar();this.hideRightEar()}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:94:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/gridupdater.min.js?15441273842660";s:6:"source";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/gridupdater.js";s:3:"min";s:79:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/gridupdater.min.js";s:3:"map";s:79:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/gridupdater.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Updater=function(t){this.parent=t};BX.Grid.Updater.prototype.getParent=function(){return this.parent};BX.Grid.Updater.prototype.updateHeadRows=function(t){var e;if(BX.type.isArray(t)&&t.length){e=this.getParent().getHeaders();e.forEach(function(e){e=BX.cleanNode(e);t.forEach(function(t){if(BX.type.isDomNode(t)){e.appendChild(BX.clone(t))}})})}};BX.Grid.Updater.prototype.appendHeadRows=function(t){var e;if(BX.type.isArray(t)&&t.length){e=this.getParent().getHeaders();e.forEach(function(e){t.forEach(function(t){if(BX.type.isDomNode(t)){e.appendChild(BX.clone(t))}})})}};BX.Grid.Updater.prototype.prependHeadRows=function(t){var e;if(BX.type.isArray(t)&&t.length){e=this.getParent().getHeaders();e.forEach(function(e){e=BX.cleanNode(e);t.forEach(function(t){if(BX.type.isDomNode(t)){e.prepend(BX.clone(t))}})})}};BX.Grid.Updater.prototype.updateBodyRowById=function(t,e){if((BX.type.isNumber(t)||BX.type.isNotEmptyString(t))&&BX.type.isDomNode(e)){var o=this.getParent().getRows().getById(t);if(o){var i=o.getNode();BX.insertAfter(e,i);BX.remove(i)}}};BX.Grid.Updater.prototype.updateBodyRows=function(t){if(BX.type.isArray(t)){var e=this.getParent().getBody();e.innerHTML="";t.forEach(function(t){!!t&&e.appendChild(t)})}};BX.Grid.Updater.prototype.appendBodyRows=function(t){var e;if(BX.type.isArray(t)){e=this.getParent().getBody();t.forEach(function(t){if(BX.type.isDomNode(t)){e.appendChild(t)}})}};BX.Grid.Updater.prototype.prependBodyRows=function(t){var e;if(BX.type.isArray(t)){e=this.getParent().getBody();t.forEach(function(t){if(BX.type.isDomNode(t)){BX.prepend(e,t)}})}};BX.Grid.Updater.prototype.updateFootRows=function(t){var e;if(BX.type.isArray(t)){e=BX.cleanNode(this.getParent().getFoot());t.forEach(function(t){if(BX.type.isDomNode(t)){e.appendChild(t)}})}};BX.Grid.Updater.prototype.updateCounterTotal=function(t){var e;if(BX.type.isDomNode(t)){e=BX.cleanNode(this.getParent().getCounterTotal());e.appendChild(t)}};BX.Grid.Updater.prototype.updatePagination=function(t){var e=this.getParent().getPagination().getContainer();if(!!e){e.innerHTML="";if(BX.type.isDomNode(t)){e.appendChild(t)}}};BX.Grid.Updater.prototype.updateMoreButton=function(t){if(BX.type.isDomNode(t)){var e=BX.Grid.Utils.closestParent(this.getParent().getMoreButton().getNode());e.innerHTML="";e.appendChild(t)}};BX.Grid.Updater.prototype.updateGroupActions=function(t){var e=this.parent.getActionsPanel();if(!!e&&BX.type.isDomNode(t)){var o=e.getPanel();if(BX.type.isDomNode(o)){o.innerHTML="";var i=BX.firstChild(t);if(BX.type.isDomNode(i)){o.appendChild(i)}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/inline-editor.min.js?15441273844903";s:6:"source";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/inline-editor.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.InlineEditor=function(t,e){this.parent=null;this.types=null;this.init(t,e)};BX.Grid.InlineEditor.prototype={init:function(parent,types){this.parent=parent;try{this.types=eval(types)}catch(t){this.types=null}},createContainer:function(){return BX.create("div",{props:{className:this.parent.settings.get("classEditorContainer")}})},createTextarea:function(t,e){var n=BX.create("textarea",{props:{className:[this.parent.settings.get("classEditor"),this.parent.settings.get("classEditorTextarea")].join(" ")},attrs:{name:t.NAME,style:"height:"+e+"px"},html:t.VALUE});return n},createInput:function(t){var e=this.parent.settings.get("classEditorText");var n={value:t.VALUE!==undefined&&t.VALUE!==null?BX.util.htmlspecialcharsback(t.VALUE):"",name:t.NAME!==undefined&&t.NAME!==null?t.NAME:""};if(t.TYPE===this.types.CHECKBOX){e=this.parent.settings.get("classEditorCheckbox");n.type="checkbox";n.checked=n.value=="Y"}if(t.TYPE===this.types.DATE){e=[e,this.parent.settings.get("classEditorDate")].join(" ")}if(t.TYPE===this.types.NUMBER){e=[e,this.parent.settings.get("classEditorNumber")].join(" ");n.type="number"}if(t.TYPE===this.types.RANGE){e=[e,this.parent.settings.get("classEditorRange")].join(" ");n.type="range";if(BX.type.isPlainObject(t.DATA)){n.min=t.DATA.MIN||"0";n.max=t.DATA.MAX||99999;n.step=t.DATA.STEP||""}}e=[this.parent.settings.get("classEditor"),e].join(" ");return BX.create("input",{props:{className:e,id:t.NAME+"_control"},attrs:n})},createCustom:function(t){var e=this.parent.settings.get("classEditorCustom");e=[this.parent.settings.get("classEditor"),e].join(" ");return BX.create("div",{props:{className:e},attrs:{"data-name":t.NAME},html:t.VALUE||""})},createOutput:function(t){return BX.create("output",{props:{className:this.parent.settings.get("classEditorOutput")||""},attrs:{for:t.NAME+"_control"},text:t.VALUE||""})},getDropdownValueItemByValue:function(t,e){var n=t.filter(function(t){return t.VALUE===e});return n.length>0?n[0]:t[0]},createDropdown:function(t){var e=this.getDropdownValueItemByValue(t.DATA.ITEMS,t.VALUE);return BX.create("div",{props:{className:[this.parent.settings.get("classEditor"),"main-dropdown main-grid-editor-dropdown"].join(" "),id:t.NAME+"_control"},attrs:{name:t.NAME,"data-items":JSON.stringify(t.DATA.ITEMS),"data-value":e.VALUE},children:[BX.create("span",{props:{className:"main-dropdown-inner"},html:e.NAME})]})},validateEditObject:function(t){return BX.type.isPlainObject(t)&&"TYPE"in t&&"NAME"in t&&"VALUE"in t&&(!("items"in t)||BX.type.isArray(t.items)&&t.items.length)},initCalendar:function(t){BX.calendar({node:t.target,field:t.target})},bindOnRangeChange:function(t,e){function n(t,e){BX.html(e,t.value);var n=parseFloat(t.value);var i=parseFloat(t.getAttribute("max"));var a=parseFloat(t.getAttribute("min"));var s=16;var r=i-a;var o=(n-a)/r*100;var c=Math.round(s*o/100)-s/2;e.style.left=o+"%";e.style.marginLeft=-c+"px"}setTimeout(function(){n(t,e)},0);BX.bind(t,"input",function(){n(t,e)})},getEditor:function(t,e){var n,i;var a=this.createContainer();if(this.validateEditObject(t)){t.VALUE=t.VALUE===null?"":t.VALUE;switch(t.TYPE){case this.types.TEXT:{n=this.createInput(t);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.DATE:{n=this.createInput(t);BX.bind(n,"click",this.initCalendar);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.NUMBER:{n=this.createInput(t);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.RANGE:{n=this.createInput(t);i=this.createOutput(t);this.bindOnRangeChange(n,i);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.CHECKBOX:{n=this.createInput(t);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.TEXTAREA:{n=this.createTextarea(t,e);BX.bind(n,"click",function(t){t.stopPropagation()});BX.bind(n,"keydown",BX.delegate(this._onControlKeydown,this));break}case this.types.DROPDOWN:{n=this.createDropdown(t);break}case this.types.CUSTOM:{n=this.createCustom(t);requestAnimationFrame(function(){if(t.HTML){var e=BX.processHTML(t.HTML);e.SCRIPT.forEach(function(t){if(t.isInternal&&t.JS){BX.evalGlobal(t.JS)}})}});BX.bind(n,"click",function(t){t.stopPropagation()});break}default:{break}}}if(BX.type.isDomNode(i)){a.appendChild(i)}if(BX.type.isDomNode(n)){a.appendChild(n)}return a},_onControlKeydown:function(t){if(t.code==="Enter"){t.stopPropagation();t.preventDefault();var e=BX.Grid.Utils.getBySelector(this.parent.getContainer(),"#grid_save_button > button",true);if(e){BX.fireEvent(e,"click")}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/loader.min.js?15441273841753";s:6:"source";s:70:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/loader.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Loader=function(t){this.parent=null;this.container=null;this.windowHeight=null;this.tbodyPos=null;this.headerPos=null;this.lastPosTop=null;this.lastBottomPos=null;this.table=null;this.loader=null;this.adjustLoaderOffset=this.adjustLoaderOffset.bind(this);this.init(t)};BX.Grid.Loader.prototype={init:function(t){this.parent=t;this.table=this.parent.getTable();this.loader=new BX.Loader({target:this.getContainer()})},adjustLoaderOffset:function(){this.windowHeight=BX.height(window);this.tbodyPos=BX.pos(this.table.tBodies[0]);this.headerPos=BX.pos(this.table.tHead);var t=window.scrollY;if(this.parent.isIE()){t=document.documentElement.scrollTop}var i=t+this.windowHeight-this.tbodyPos.top;var s=t-this.tbodyPos.top;if(i>this.tbodyPos.bottom-this.tbodyPos.top){i=this.tbodyPos.bottom-this.tbodyPos.top}if(s<this.headerPos.height){s=this.headerPos.height}else{i-=s;i+=this.headerPos.height}requestAnimationFrame(function(){if(s!==this.lastPosTop){this.getContainer().style.transform="translate3d(0px, "+s+"px, 0)"}if(i!==this.lastBottomPos){this.getContainer().style.height=i+"px"}this.lastPosTop=s;this.lastBottomPos=i}.bind(this))},getContainer:function(){if(!this.container){this.container=BX.Grid.Utils.getByClass(this.parent.getContainer(),this.parent.settings.get("classLoader"),true)}return this.container},show:function(){if(!this.loader.isShown()){this.adjustLoaderOffset();this.getContainer().style.display="block";this.getContainer().style.opacity="1";this.getContainer().style.visibility="visible";this.loader.show()}},hide:function(){if(this.loader.isShown()){this.adjustLoaderOffset();this.loader.hide().then(function(){this.getContainer().style.display="none"}.bind(this))}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/manager.min.js?1544127384903";s:6:"source";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/manager.js";s:3:"min";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/manager.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/manager.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Main");if(BX.Main.gridManager){return}BX.Main.gridManager={data:[],push:function(t,n){if(BX.type.isNotEmptyString(t)&&n){var i={id:t,instance:n,old:null};if(this.getById(t)===null){this.data.push(i)}else{this.data[0]=i}}},getById:function(t){var n=this.data.filter(function(n){return n.id===t||n.id.replace("main_grid_","")===t});return n.length===1?n[0]:null},getInstanceById:function(t){var n=this.getById(t);return BX.type.isPlainObject(n)?n["instance"]:null},reload:function(t,n){var i=this.getInstanceById(t);if(i){i.reload(n)}},getDataIndex:function(t){var n=null;this.data.forEach(function(i,a){if(i.id===t){n=a}});return n},destroy:function(t){if(BX.type.isNotEmptyString(t)){var n=this.getInstanceById(t);if(n instanceof BX.Main.grid){n.destroy();var i=this.getDataIndex(t);if(i!==null){delete this.data[i]}}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/message.min.js?15441273841603";s:6:"source";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/message.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Message=function(t,e){this.parent=null;this.types=null;this.messages=null;this.popup=null;this.init(t,e)};BX.Grid.Message.prototype={init:function(t,e){this.parent=t;this.types=e;this.show();BX.addCustomEvent("BX.Main.grid:paramsUpdated",BX.proxy(this.onUpdated,this))},onUpdated:function(){this.show()},getData:function(){return this.parent.arParams.MESSAGES},isNeedShow:function(){return this.getData().length>0},show:function(){if(this.isNeedShow()){this.getPopup().setContent(this.getContent());this.getPopup().show()}},getContent:function(){var t=this.getData();var e=null;if(BX.type.isArray(t)&&t.length){var n={block:"main-grid-messages",content:[]};t.forEach(function(t){var e={block:"main-grid-message",mix:"main-grid-message-"+t.TYPE.toLowerCase(),content:[]};if(BX.type.isNotEmptyString(t.TITLE)){e.content.push({block:"main-grid-message-title",content:BX.create("div",{html:t.TITLE}).innerText})}if(BX.type.isNotEmptyString(t.TEXT)){e.content.push({block:"main-grid-message-text",content:BX.create("div",{html:t.TEXT}).innerText})}n.content.push(e)});e=BX.decl(n)}return e},getPopup:function(){if(this.popup===null){this.popup=new BX.PopupWindow(this.getPopupId(),null,{autoHide:true,overlay:.3,width:400,contentNoPaddings:true,closeByEsc:true,buttons:[new BX.PopupWindowButton({text:this.parent.getParam("CLOSE"),className:"webform-small-button-blue webform-small-button",events:{click:function(){this.popupWindow.close()}}})]})}return this.popup},getPopupId:function(){return this.parent.getContainerId()+"-main-grid-message"}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/observer.min.js?1544127384175";s:6:"source";s:72:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/observer.js";s:3:"min";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/observer.min.js";s:3:"map";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/observer.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.observer={handlers:[],add:function(n,r,d,e){BX.bind(n,r,e?BX.proxy(d,e):d)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/oldgrid.min.js?154412738437682";s:6:"source";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/oldgrid.js";s:3:"min";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/oldgrid.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/oldgrid.map.js";}"*/
function BxUniversalGrid(e){"use strict";this.oColsMeta={};this.oColsNames={};this.customNames={};this.columnsSizes={};this.oEditData={};this.oSaveData={};this.oOptions={};this.oVisibleCols={};this.vars={};this.menu=null;this.settingsMenu=[];this.filterMenu=[];this.checkBoxCount=0;this.bColsChanged=false;this.bViewsChanged=false;this.oFilterRows={};this.activeRow=null;this.hasActions=false;this.editMode=false;this.resizeMeta={};this.table_id=e+"_table";this.grid_id=e;var t=this;var i=null;var s=false;this.InitTable=function(){i=BX.Main.gridManager.getById(t.grid_id).instance;this.checkBoxCount=0;var e=i.getTable();if(!e||e.rows.length<1||e.rows[0].cells.length<1){return}var s=e.rows[0].cells;for(var a=0;a<s.length;a++){if(BX.hasClass(s[a],"main-grid-cell-action")||BX.hasClass(s[a],"main-grid-cell-checkbox")){s[a].__fixed=true;continue}var n=BX.findChildByClassName(s[a],"main-grid-cell-head-container",false);BX.addClass(n,"main-grid-cell-head-dragable");BX.removeClass(s[a],"main-grid-cell-sortable")}this.initResizeMeta();this.toogleFader();BX.bind(window,"resize",BX.delegate(this.toogleFader,this));BX.bind(e.parentNode,"scroll",this.toogleFader);if(i.getParam("ALLOW_COLUMNS_RESIZE")){for(var a=0;a<s.length;a++){if(s[a].__fixed){continue}var l=BX.findChildByClassName(s[a],"main-grid-resize-button");if(l){l.onbxdragstart=t.resizeColumnStart;l.onbxdragstop=t.resizeColumnStop;l.onbxdrag=t.resizeColumn;jsDD.registerObject(l)}}var r=function(){var e=i.getPinHeader().getFixedTable();var s=BX.findChild(e,{"class":"main-grid-resize-button"},true,true);s.forEach(function(e){e.onbxdragstart=t.resizeColumnStart;e.onbxdragstop=t.resizeColumnStop;e.onbxdrag=t.resizeColumn;jsDD.registerObject(e)})};BX.addCustomEvent(window,"Grid::headerPinned",r);BX.addCustomEvent(window,"Grid::updated",r)}};this.CheckColumn=function(e,t){var s;var a=this.menu.GetMenuByItemId(t.id);var n=!(a.GetItemInfo(t).ICON=="checked");a.SetItemIcon(t,n?"checked":"");if(e){s=i.getUserOptions().getCurrentOptions().columns.split(",");if(BX.type.isArray(s)&&BX.type.isNotEmptyString(e)){if(s.some(function(t){return t===e})){s=s.filter(function(t){return t!==e});BX.removeClass("menu_"+i.getContainerId()+"_columns_item_","checked")}else{s.unshift(e);BX.addClass("menu_"+i.getContainerId()+"_columns_item_","checked")}}i.tableFade();i.getUserOptions().setColumns(s,function(){i.reloadTable();BX.onCustomEvent(i.getContainer(),"Grid::columnsChanged",[i])})}};this.reinitColumnSize=function(e,t){var i=this.GetColumnId(e);if(i!==false){var s=BX(this.table_id);var a=s.offsetWidth;var n=s.rows[0].cells[i];var l=BX.findChildByClassName(n,"main-grid-cell-head-container",false);l.style.height="";BX.removeClass(l,"main-grid-cell-head-dragable");n.style.width="";n.style.width=n.offsetWidth+"px";BX.addClass(l,"main-grid-cell-head-dragable");l.style.height=s.rows[0].cells[0].clientHeight+"px";if(t){n.setAttribute("data-resize",1)}}};this.initResizeMeta=function(){var e=i.getTable();var t=e.rows[0].cells;this.resizeMeta.fixed=0;this.resizeMeta.minPx=e.offsetWidth;var s=false;for(var a=0;a<t.length;a++){var n=BX.width(t[a]);if(t[a].__fixed){this.resizeMeta.fixed+=n;continue}if(n>0){var l=t[a].getAttribute("data-name");if(this.resizeMeta.columns[l]!=n){s=true}this.resizeMeta.columns[l]=n}}if(s){this.resizeMeta.expand=1}};this.reinitResizeMeta=function(){var e=BX(t.table_id);var i=e.rows[0].cells;for(var s=0;s<i.length;s++){if(i[s].__fixed){continue}if(i[s].offsetWidth>0){var a=i[s].getAttribute("data-name");t.resizeMeta.columns[a]=i[s].offsetWidth}}var n=e.offsetWidth;var l=e.parentNode.clientWidth;t.resizeMeta.minPx=n;t.resizeMeta.expand=n<l?n/l:1;t.saveColumnsSizes()};this.toogleFader=function(){var e=BX.Main.gridManager.getById(t.grid_id).instance;var i=e.getTable();var s=e.getScrollContainer();if(i.offsetWidth>s.clientWidth){if(s.scrollLeft>0){BX.addClass(s.parentNode,"main-grid-fade-left")}else{BX.removeClass(s.parentNode,"main-grid-fade-left")}if(i.offsetWidth>s.scrollLeft+s.clientWidth){BX.addClass(s.parentNode,"main-grid-fade-right")}else{BX.removeClass(s.parentNode,"main-grid-fade-right")}}else{BX.removeClass(s.parentNode,"main-grid-fade-left");BX.removeClass(s.parentNode,"main-grid-fade-right")}};this.OnRowContext=function(e){if(!t.menu){return}if(!e){e=window.event}if(!phpVars.opt_context_ctrl&&e.ctrlKey||phpVars.opt_context_ctrl&&!e.ctrlKey){return}var i;if(e.target){i=e.target}else if(e.srcElement){i=e.srcElement}var s=i;while(s&&!(s.tagName&&s.tagName.match(/(th|td)/i)&&s.oncontextmenu)){s=BX.findParent(s,{tagName:/(th|td)/i})}var a=null;if(s&&s.oncontextmenu){a=s.oncontextmenu();a[a.length]={SEPARATOR:true}}s=i;while(s&&!(s.tagName&&s.tagName.toUpperCase()==="TR"&&s.oncontextmenu)){s=jsUtils.FindParentObject(s,"tr")}var n=t.menu;n.PopupHide();t.activeRow=s;if(t.activeRow&&!BX.hasClass(s,"main-grid-row-head")){t.activeRow.className+=" active"}n.OnClose=function(){if(t.activeRow){t.activeRow.className=t.activeRow.className.replace(/\s*active/i,"");t.activeRow=null}};var l=BX.util.array_merge(a,s.oncontextmenu());if(l.length==0){return}n.SetItems(l);n.BuildItems();var r=jsUtils.GetWindowScrollPos();var o=e.clientX+r.scrollLeft;var d=e.clientY+r.scrollTop;var h={};h.left=h.right=o;h.top=h.bottom=d;n.PopupShow(h);e.returnValue=false;if(e.preventDefault){e.preventDefault()}};this.ShowActionMenu=function(e,i){t.menu.PopupHide();t.activeRow=jsUtils.FindParentObject(e,"tr");if(t.activeRow){t.activeRow.className+=" active"}var s=BX("datarow_"+this.table_id+"_"+i);var a=BX.data(s,"actions");if(s&&a){var n=JSON.parse(a);if(n&&n.length>0){t.menu.ShowMenu(e,n,false,false,function(){if(t.activeRow){t.activeRow.className=t.activeRow.className.replace(/\s*active/i,"");t.activeRow=null}})}}};this.SelectRow=function(e,t){t=t?t:window.event;var i=BX.findParent(e,{className:"main-grid-row"});var a=document.getElementById(this.table_id+"_selected_span");var n=parseInt(a.innerHTML);var l=[i];if(t&&t.shiftKey&&s&&s!==i){var r=document.getElementById(this.table_id);for(var o=Math.min(s.rowIndex,i.rowIndex)+1;o<Math.max(s.rowIndex,i.rowIndex);o++){l.push(r.rows[o])}if(BX.findChildByClassName(s.cells[0],"main-grid-checkbox").checked){l.push(s)}}for(var o in l){var d=BX.findChildByClassName(l[o].cells[0],"main-grid-checkbox");if(d&&(e===d||d.checked!==e.checked)){d.checked=e.checked;if(e.checked){BX.addClass(l[o],"main-grid-row-checked");n++}else{BX.removeClass(l[o],"main-grid-row-checked");n--}}}a.innerHTML=n.toString();var h=BX(this.table_id+"_check_all");h.checked=this.checkBoxCount>0&&n===this.checkBoxCount;s=i};this.SelectAllRows=function(e){};this.EnableActions=function(){var e=document.forms["form_"+this.table_id];if(!e)return;var t=this.IsActionEnabled();var i=this.IsActionEnabled("edit");var s=BX("edit_button_"+this.table_id);var a=BX("delete_button_"+this.table_id);if(e.apply){e.apply.disabled=!t;BX[t?"removeClass":"addClass"](e.apply,"webform-button-disable")}if(s)BX[i?"removeClass":"addClass"](s,"main-grid-control-panel-action-icon-disable");if(a)BX[t?"removeClass":"addClass"](a,"main-grid-control-panel-action-icon-disable")};this.IsActionEnabled=function(e){var t=document.forms["form_"+this.table_id];if(!t)return;var i=false;var s=document.getElementById(this.table_id+"_selected_span");if(s&&parseInt(s.innerHTML)>0)i=true;var a=t["action_all_rows_"+this.table_id];if(e=="edit")return!(a&&a.checked)&&i;else return a&&a.checked||i};this.SwitchActionButtons=function(e){var t=BX("bx_grid_"+this.table_id+"_action_buttons");var i=t;while(i=jsUtils.FindNextSibling(i,"div"))i.style.display=e?"none":"";t.style.display=e?"":"none"};this.ActionEdit=function(){if(this.IsActionEnabled("edit")){var e=document.forms["form_"+this.table_id];if(!e)return;this.editMode=true;this.SwitchActionButtons(true);var i=e["ID[]"];if(!i.length)i=new Array(i);for(var s=0;s<i.length;s++){var a=i[s];if(a.checked){var n=jsUtils.FindParentObject(a,"tr");BX.denyEvent(n,"dblclick");var l=jsUtils.FindParentObject(a,"td");l=jsUtils.FindNextSibling(l,"td");if(BX.hasClass(l,"main-grid-cell-action"))l=jsUtils.FindNextSibling(l,"td");var r=a.value;this.oSaveData[r]={};for(var o in this.oVisibleCols){if(this.oVisibleCols[o]==true&&this.oColsMeta[o].editable==true&&this.oEditData[r][o]!==false){this.oSaveData[r][o]=l.innerHTML;l.innerHTML="";var d=this.oEditData[r][o];var h="FIELDS["+r+"]["+o+"]";var c=BX.create("SPAN",{props:{className:"main-grid-cell-content"}});switch(this.oColsMeta[o].type){case"checkbox":c.appendChild(BX.create("INPUT",{props:{type:"hidden",name:h,value:"N"}}));c.appendChild(BX.create("INPUT",{props:{className:"main-grid-cell-content-edit",type:"checkbox",name:h,value:"Y",checked:d=="Y",defaultChecked:d=="Y"}}));break;case"list":var f=[];for(var v in this.oColsMeta[o].items){f[f.length]=BX.create("OPTION",{props:{value:v,selected:v==d},text:this.oColsMeta[o].items[v]})}c.appendChild(BX.create("SELECT",{props:{className:"main-grid-cell-content-edit",name:h},children:f}));break;case"date":var _={props:{className:"main-grid-cell-content-edit",type:"text",name:h,value:d,size:this.oColsMeta[o].size?this.oColsMeta[o].size:20},style:{paddingRight:"20px"}};if(this.oColsMeta[o].size)_.props.size=this.oColsMeta[o].size;else _.style.width="100%";c.appendChild(BX.create("INPUT",_));c.appendChild(BX.create("A",{props:{href:"javascript:void(0);",title:this.vars.mess.calend_title},style:{border:"none",position:"relative",right:"22px"},children:[BX.create("IMG",{props:{className:"calendar-icon",src:this.vars.calendar_image,alt:this.vars.mess.calend_title,onclick:function(e){return function(){BX.calendar({node:this,field:e,bTime:true,currentTime:t.vars.server_time})}}(h),onmouseover:function(){BX.addClass(this,"calendar-icon-hover")},onmouseout:function(){BX.removeClass(this,"calendar-icon-hover")}}})]}));BX.addClass(c,"main-grid-cell-text-line");break;case"textarea":var _={props:{className:"main-grid-cell-content-edit",name:h},text:d};if(this.oColsMeta[o].cols)_.props.cols=this.oColsMeta[o].cols;else _.style={width:"100%"};if(this.oColsMeta[o].rows)_.props.rows=this.oColsMeta[o].rows;if(this.oColsMeta[o].maxlength)_.props.maxLength=this.oColsMeta[o].maxlength;c.appendChild(BX.create("TEXTAREA",_));break;case"file":c.appendChild(BX.create("INPUT",{props:{className:"main-grid-cell-content-edit",type:"file",name:h}}));break;default:var _={props:{className:"main-grid-cell-content-edit",type:"text",name:h,value:d}};if(this.oColsMeta[o].size)_.props.size=this.oColsMeta[o].size;else _.style={width:"100%"};if(this.oColsMeta[o].maxlength)_.props.maxLength=this.oColsMeta[o].maxlength;c.appendChild(BX.create("INPUT",_));break}l.appendChild(c)}l=jsUtils.FindNextSibling(l,"td")}}a.disabled=true}BX(this.table_id+"_check_all").disabled=true;e.elements["action_button_"+this.table_id].value="edit"}};this.ActionCancel=function(){var e=document.forms["form_"+this.table_id];if(!e)return;this.editMode=false;this.SwitchActionButtons(false);var t=e["ID[]"];if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){var s=t[i];if(s.checked){var a=jsUtils.FindParentObject(s,"tr");BX.allowEvent(a,"dblclick");var n=jsUtils.FindParentObject(s,"td");n=jsUtils.FindNextSibling(n,"td");if(BX.hasClass(n,"main-grid-cell-action"))n=jsUtils.FindNextSibling(n,"td");var l=s.value;for(var r in this.oVisibleCols){if(typeof this.oSaveData[l][r]!="undefined")n.innerHTML=this.oSaveData[l][r];n=jsUtils.FindNextSibling(n,"td")}}}this.toggleCheckboxes();e.elements["action_button_"+this.table_id].value=""};this.ActionDelete=function(){var e=document.forms["form_"+this.table_id];if(!e)return;e.elements["action_button_"+this.table_id].value="delete";BX.submit(e)};this.ForAllClick=function(e){if(e.checked&&!confirm(this.vars.mess.for_all_confirm)){e.checked=false;return}var t=e.form["ID[]"];if(t){if(!t.length)t=new Array(t);for(var i=0;i<t.length;i++){if(t[i].getAttribute("data-disabled"))continue;t[i].disabled=e.checked}}BX(this.table_id+"_check_all").disabled=e.checked;this.editMode=e.checked;this.EnableActions()};this.Sort=function(e,i,s,a,n){var l;if(s==""){var r=null,o=false;if(n.length>0)r=n[0];if(!r)r=window.event;if(r)o=r.ctrlKey;l=o?a=="acs"?"desc":"asc":a}else if(s=="asc")l="desc";else l="asc";e+=l;BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.ajax.php?GRID_ID="+t.table_id+"&action=savesort&by="+i+"&order="+l+"&sessid="+t.vars.sessid,function(){t.Reload(e)})};this.GetColumnId=function(e){var t=false;var i=BX(this.table_id);for(var s=0;s<i.rows[0].cells.length;s++){if(i.rows[0].cells[s].getAttribute("data-name")==e){t=s;break}}return t};this.animation=function(e,i,s,a){t.animation.stop(e);var n=function(){e.__animation.step++;var i=e.__animation;for(var s in i.props){var a=i.props[s];e.style[s]=a.from*1+(a.to-a.from)*i.step/i.steps+a.unit}if(i.step>=i.steps)t.animation.stop(e)};e.__animation={props:i,steps:Math.round(s/10),step:0,callback:a};e.__animation.interval=setInterval(n,s/e.__animation.steps)};this.animation.stop=function(e){if(e.__animation&&e.__animation.interval){e.__animation.interval=clearInterval(e.__animation.interval);if(e.__animation.callback)e.__animation.callback()}};this.toogleColumnCells=function(e,i,s){var a=BX(t.table_id);for(var n=0;n<a.rows.length;n++){var l=a.rows[n].cells;if(l[e]){l[e].style.display=i?"":"none";var r=BX.findChildByClassName(l[e],"main-grid-cell-content",false);if(r&&r.style)r.style.width=s?r.clientWidth+"px":""}}};this.toggleCheckboxes=function(){var e=BX(this.table_id);for(var t=1;t<e.rows.length;t++){if(BX.hasClass(e.rows[t],"main-grid-data-row")){var i=BX.findChildByClassName(e.rows[t].cells[0],"main-grid-checkbox");var s=i.value;var a=false;if(this.hasActions){if(!i.getAttribute("data-disabled"))a=true}else if(typeof this.oEditData[s]!="undefined"){for(var n in this.oVisibleCols){if(this.oVisibleCols[n]&&this.oColsMeta[n].editable&&this.oEditData[s][n]!==false)a=true}}if(a){if(i.getAttribute("data-disabled"))this.checkBoxCount++;i.disabled=this.editMode;i.removeAttribute("data-disabled")}else{if(!i.getAttribute("data-disabled"))this.checkBoxCount--;i.disabled=true;i.setAttribute("data-disabled",1)}}}if(this.checkBoxCount==0){BX(this.table_id+"_check_all").disabled=true;if(!this.editMode){for(var t=1;t<e.rows.length;t++){if(BX.hasClass(e.rows[t],"main-grid-data-row")){var i=BX.findChildByClassName(e.rows[t].cells[0],"main-grid-checkbox");if(i.checked){i.checked=false;this.SelectRow(i)}}}BX(this.table_id+"_action_bar_fade").style.display=""}}else{if(!this.editMode)BX(this.table_id+"_check_all").disabled=false;BX(this.table_id+"_action_bar_fade").style.display="none"}};this.SaveColumns=function(e,i){var s="";if(e){s=e}else{if(!t.bColsChanged)return;for(var a in t.oVisibleCols)if(t.oVisibleCols[a])s+=(s!=""?",":"")+a}t.oOptions.views[t.oOptions.current_view].columns=s;if(t.vars.user_authorized){BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.ajax.php",{GRID_ID:t.table_id,action:"showcolumns",columns:s,sessid:t.vars.sessid},i)}};this.saveColumnsSizes=function(){i.getUserOptions().setColumnSizes(t.resizeMeta.columns,t.resizeMeta.expand)};this.Reload=function(e){var i=BX.Main.gridManager.getById(t.grid_id).instance;var s=i.getScrollContainer();var a;jsDD.Disable();if(!e){e=this.vars.current_url[this.vars.current_url.length-1]}if(this.vars.ajax.AJAX_ID!=""){a=BX.ajax.insertToNode(e+(e.indexOf("?")==-1?"?":"&")+"bxajaxid="+this.vars.ajax.AJAX_ID,"comp_"+this.vars.ajax.AJAX_ID);a.onprogress=function(){t.scrollContainerLeft=s.scrollLeft};a.onload=function(){i.getScrollContainer().scrollLeft=t.scrollContainerLeft;i.reloadTable()}}else{window.location=e}};this.SetView=function(e){var i=t.oOptions.views[e].saved_filter;var s=i&&t.oOptions.filters[i]?function(){t.ApplyFilter(i)}:function(){t.Reload()};BX.ajax.get("/bitrix/components"+t.vars.component_path+"/settings.ajax.php?GRID_ID="+t.table_id+"&action=setview&view_id="+e+"&sessid="+t.vars.sessid,s)};this.EditCurrentView=function(){this.ShowSettings(this.oOptions.views[this.oOptions.current_view],function(){t.SaveSettings(t.oOptions.current_view,true)})};this.AddView=function(){var e="view_"+Math.round(Math.random()*1e6);var i={};for(var s in this.oOptions.views[this.oOptions.current_view])i[s]=this.oOptions.views[this.oOptions.current_view][s];i.name=this.vars.mess.viewsNewView;this.ShowSettings(i,function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter,custom_names:i.custom_names,columns_sizes:i.columns_sizes};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.length]=new Option(i.name!=""?i.name:t.vars.mess.viewsNoName,e,true,true)})};this.EditView=function(e){this.ShowSettings(this.oOptions.views[e],function(){var i=t.SaveSettings(e);t.oOptions.views[e]={name:i.name,columns:i.columns,sort_by:i.sort_by,sort_order:i.sort_order,page_size:i.page_size,saved_filter:i.saved_filter,custom_names:i.custom_names,columns_sizes:i.columns_sizes};t.bViewsChanged=true;var s=document["views_"+t.table_id];s.views_list.options[s.views_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName})};this.DeleteView=function(e){if(!confirm(this.vars.mess.viewsDelete))return;var i=document["views_"+this.table_id];var s=i.views_list.selectedIndex;i.views_list.remove(s);i.views_list.selectedIndex=s<i.views_list.length?s:i.views_list.length-1;this.bViewsChanged=true;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.ajax.php?GRID_ID="+this.table_id+"&action=delview&view_id="+e+"&sessid="+t.vars.sessid)};this.ShowSettings=function(e,t){var i=false;if(!window["settingsDialog"+this.table_id]){window["settingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="settings_'+this.table_id+'"></form>',title:this.vars.mess.settingsTitle,width:this.vars.settingWndSize.width,height:this.vars.settingWndSize.height,resize_id:"InterfaceGridSettingWnd"});i=true}window["settingsDialog"+this.table_id].ClearButtons();window["settingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["settingsDialog"+this.table_id].Show();var s=document["settings_"+this.table_id];if(i)s.appendChild(BX("view_settings_"+this.table_id));this.customNames=e.custom_names?e.custom_names:{};this.columnsSizes=e.columns_sizes?e.columns_sizes:{};s.view_name.focus();s.view_name.value=e.name;var a=[];if(e.columns!=""){a=e.columns.split(",")}else{for(var n in this.oVisibleCols){if(this.oVisibleCols[n])a[a.length]=n}}var l={},r;for(n=0,r=a.length;n<r;n++)l[a[n]]=true;jsSelectUtils.deleteAllOptions(s.view_all_cols);for(n in this.oColsNames){if(!l[n]){var o=this.customNames[n]?this.customNames[n]+" ("+this.oColsNames[n]+")":this.oColsNames[n];s.view_all_cols.options[s.view_all_cols.length]=new Option(o,n,false,false)}}jsSelectUtils.deleteAllOptions(s.view_cols);for(n in l){o=this.customNames[n]?this.customNames[n]+" ("+this.oColsNames[n]+")":this.oColsNames[n];s.view_cols.options[s.view_cols.length]=new Option(o,n,false,false)}s.reset_columns_sizes.checked=false;jsSelectUtils.selectOption(s.view_sort_by,e.sort_by);jsSelectUtils.selectOption(s.view_sort_order,e.sort_order);jsSelectUtils.selectOption(s.view_page_size,e.page_size);jsSelectUtils.deleteAllOptions(s.view_filters);s.view_filters.options[0]=new Option(this.vars.mess.viewsFilter,"");for(n in this.oOptions.filters)s.view_filters.options[s.view_filters.length]=new Option(this.oOptions.filters[n].name,n,n==e.saved_filter,n==e.saved_filter);if(s.set_default_settings){s.set_default_settings.checked=false;s.delete_users_settings.checked=false;s.delete_users_settings.disabled=true}s.up_btn.disabled=s.down_btn.disabled=s.rename_btn.disabled=s.add_btn.disabled=s.del_btn.disabled=true};this.RenameColumn=function(){var e=false;if(!window["renameDialog"+this.table_id]){window["renameDialog"+this.table_id]=new BX.CDialog({content:'<form name="rename_'+this.table_id+'"></form>',title:this.vars.mess.renameTitle,width:this.vars.renameWndSize.width,height:this.vars.renameWndSize.height,resize_id:"InterfaceGridRenameWnd",buttons:[{title:this.vars.mess.settingsSave,action:function(){var e=s.view_cols.value;var a=i.col_name.value;if(a.length>0){t.customNames[e]=a;a=a+" ("+t.oColsNames[e]+")"}else{a=t.oColsNames[e];delete t.customNames[e]}s.view_cols.options[s.view_cols.selectedIndex].text=a;this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]});e=true}window["renameDialog"+this.table_id].Show();var i=document["rename_"+this.table_id];var s=document["settings_"+this.table_id];if(e)i.appendChild(BX("rename_column_"+this.table_id));var a=s.view_cols.value;i.col_name.focus();i.col_name_def.value=this.oColsNames[a];i.col_name.value=this.customNames[a]?this.customNames[a]:this.oColsNames[a]};this.SaveSettings=function(e,s){var a=document["settings_"+this.table_id];var n="";var l=a.view_cols.length;for(var r=0;r<l;r++)n+=(n!=""?",":"")+a.view_cols[r].value;var o={GRID_ID:this.grid_id,view_id:e,action:i.getUserOptions().getAction("GRID_SAVE_SETTINGS"),sessid:this.vars.sessid,name:a.view_name.value,columns:n,sort_by:a.view_sort_by.value,sort_order:a.view_sort_order.value,page_size:a.view_page_size.value,saved_filter:a.view_filters.value,custom_names:this.customNames,columns_sizes:!a.reset_columns_sizes.checked?this.columnsSizes:{}};if(a.set_default_settings){o.set_default_settings=a.set_default_settings.checked?"Y":"N";o.delete_users_settings=a.delete_users_settings.checked?"Y":"N"}var d=null;if(s===true){d=function(){if(o.saved_filter&&t.oOptions.filters[o.saved_filter]){t.ApplyFilter(o.saved_filter)}else{i.reloadTable()}}}BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.ajax.php",o,d);return o};this.ReloadViews=function(){if(t.bViewsChanged)t.Reload()};this.ShowViews=function(){this.bViewsChanged=false;var e=false;if(!window["viewsDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.viewsApply,hint:this.vars.mess.viewsApplyTitle,action:function(){var e=document["views_"+t.table_id];if(e.views_list.selectedIndex!=-1)t.SetView(e.views_list.value);window["bxGrid_"+t.table_id].bViewsChanged=false;this.parentWindow.Close()}});window["viewsDialog"+this.table_id]=new BX.CDialog({content:'<form name="views_'+this.table_id+'"></form>',title:this.vars.mess.viewsTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.viewsWndSize.width,height:this.vars.viewsWndSize.height,resize_id:"InterfaceGridViewsWnd"});BX.addCustomEvent(window["viewsDialog"+this.table_id],"onWindowUnRegister",this.ReloadViews);e=true}window["viewsDialog"+this.table_id].Show();var s=document["views_"+this.table_id];if(e)s.appendChild(BX("views_list_"+this.table_id))};this.DragStart=function(){t.onDragStart(this);var e=BX.Main.gridManager.getById(t.grid_id).instance;var i=e.getContainer();var s=e.getTable();var a=e.getRows().getHeadChild()[0].getCells();var n=BX.pos(this);var l=BX.pos(i);var r=n.left-l.left;var o=BX.findChildByClassName(this,"main-grid-cell-head-container",false);this.__cursor=BX.create("div",{props:{className:e.settings.get("classCursor")}});i.appendChild(this.__cursor);o.style.width=this.clientWidth+"px";o.style.height=this.clientHeight+"px";this.__dragNode=document.createElement("DIV");this.__dragNode.className="main-grid-cell-head-drag";this.__dragNode.appendChild(o);BX.style(this.__dragNode,"left",r+"px");s.parentNode.insertBefore(this.__dragNode,s);this.style.height=n.height+"px";this.innerHTML='<span class="main-grid-cell-head-container" style="z-index: 25; "></span>';BX.addClass(this,"main-grid-cell-head-drag-dest");this.__dragDest=this.cellIndex;this.__dragX=r-jsDD.start_x;this.__dragCells=[];for(var d=0;d<a.length;d++){if(a[d].__fixed)continue;var h=BX.pos(a[d]);if(!h.width)continue;var c=BX.findChildByClassName(a[d],"main-grid-cell-head-container",false);BX.addClass(a[d],"main-grid-cell-head-ondrag");this.__cursor.style.left=h.left-l.left+"px";if(d==this.cellIndex){c.style.height=h.height-2+"px";this.__dragCells.ref=this.__dragCells.length}this.__dragCells.push({index:d,node:c,offset:h.left-l.left,width:h.width,move:0})}if(this.__dragCells.length>1&&this.__dragCells.ref==this.__dragCells.length-1){var f=this.__dragCells[this.__dragCells.length-2].index;BX.addClass(a[f],"main-grid-cell-last")}};this.Drag=function(e){var i=this;var s=BX.Main.gridManager.getById(t.grid_id).instance;var a=s.getContainer();var n=e+this.__dragX;var l=BX.pos(a);var r,o,d;this.__dragNode.style.left=n+"px";for(var h=this.__dragCells.length-1;h>=0;h--){if(e-l.left>this.__dragCells[h].offset){this.__dest=this.__dragCells[h].index;break}}r=this.__dragCells.filter(function(e){return e.index==i.__dragDest})[0];o=this.__dragCells.filter(function(e){return e.index==i.__dest})[0];d=o.offset;if(this.__dest>this.__dragDest){d=o.offset+o.width}r.node.style.left=d+"px";this.__cursor.style.left=d+"px"};this.DragStop=function(){t.onDragStop(this);var e=this;var i=BX.Main.gridManager.getById(t.grid_id).instance;var s=i.getRows().getList();var a,n,l,r,o;var d=BX.findChildByClassName(this.__dragNode,i.settings.get("classCellHeadContainer"),false);this.innerHTML="";this.appendChild(d);this.style.height="";BX.removeClass(this,"main-grid-cell-head-drag-dest");BX.remove(this.__cursor);BX.remove(this.__dragNode);s.map(function(t){a=t.getCells();n=a[e.__dragDest];l=a[e.__dest];if(t.isHeadChild()||t.isBodyChild()||t.isFootChild()){if(e.__dest<e.__dragDest){t.getNode().insertBefore(n,l)}if(e.__dest>e.__dragDest){if(BX.type.isDomNode(l.nextElementSibling)){t.getNode().insertBefore(n,l.nextElementSibling)}else{t.getNode().appendChild(n)}}for(var s=0;s<a.length;s++){var r=BX.findChildByClassName(a[s],i.settings.get("classCellHeadContainer"),false);if(r&&r.style){r.style.width="";r.style.left=""}BX.removeClass(a[s],i.settings.get("classCellHeadOndrag"))}}});if(this.__dest!==this.__dragDest){a=i.getRows().getHeadChild()[0].getCells();o=t.oVisibleCols;t.oVisibleCols={};[].forEach.call(a,function(e){r=BX.data(e,"name");if(r){t.oVisibleCols[r]=o[r]}});t.bColsChanged=true;t.SaveColumns()}};this.resizeColumnStart=function(){var e=BX.findParent(this,{className:"main-grid-cell-head"});var s=i.getRows().getHeadFirstChild().getCells();var a=Object.keys(s);var n;t.onDragStart(e);this.__overlay=BX.create("div",{props:{className:"main-grid-cell-overlay"}});BX.append(this.__overlay,e);this.__resizeCell=e.cellIndex;a.forEach(function(e){if(BX.hasClass(s[e],"main-grid-special-empty")){BX.style(s[e],"width","100%")}else{BX.width(s[e],BX.width(s[e]));n=BX.firstChild(s[e]);BX.width(n,BX.width(s[e]))}})};this.resizeColumn=function(e){var s=BX(t.table_id);var a=i.getPinHeader().getFixedTable();var n=s.rows[0].cells[this.__resizeCell];var l,r;var o=BX.pos(s);var d=BX.pos(n);var h=BX.firstChild(n);var c=parseFloat(n.style.width);var f;e-=d.left;f=e;if(d.width>c){e=d.width}e=f>e?f:e;if(e!==d.width){n.style.width=e+"px";h.style.width=e+"px";if(BX.type.isDomNode(a)&&BX.type.isDomNode(a.rows[0])){l=a.rows[0].cells[this.__resizeCell];r=BX.firstChild(l);r.style.width=e+"px";l.style.width=e+"px"}}t.toogleFader()};this.resizeColumnStop=function(){var e=BX(t.table_id);var i=e.rows[0].cells;t.reinitResizeMeta();t.toogleFader();t.onDragStop(i[this.__resizeCell]);BX.remove(this.__resizeCell)};this.onDragStart=function(e){if(e.getAttribute("onclick")){e.setAttribute("data-onclick",e.getAttribute("onclick"));e.removeAttribute("onclick")}};this.onDragStop=function(e){if(e.getAttribute("data-onclick")){setTimeout(function(){e.setAttribute("onclick",e.getAttribute("data-onclick"));e.removeAttribute("data-onclick")},10)}};this.InitFilter=function(){var e=BX("flt_header_"+this.table_id);if(e)jsUtils.addEvent(e,"contextmenu",this.OnRowContext)};this.SwitchFilterRow=function(e,t){if(t){var i=this.menu.GetMenuByItemId(t.id);i.SetItemIcon(t,this.oFilterRows[e]?"":"checked")}else{var s=this.filterMenu[0].MENU;for(var a=0;a<s.length;a++){if(s[a].ID=="flt_"+this.table_id+"_"+e){s[a].ICONCLASS=this.oFilterRows[e]?"":"checked";break}}}var n=BX("flt_row_"+this.table_id+"_"+e);n.style.display=this.oFilterRows[e]?"none":"";this.oFilterRows[e]=this.oFilterRows[e]?false:true;var l=BX("a_minmax_"+this.table_id);if(l&&l.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(l);this.SaveFilterRows()};this.SwitchFilterRows=function(e){this.menu.PopupHide();var t=0;for(var i in this.oFilterRows){t++;if(t==1&&e==false)continue;this.oFilterRows[i]=e;var s=BX("flt_row_"+this.table_id+"_"+i);s.style.display=e?"":"none"}var a=this.filterMenu[0].MENU;for(t=0;t<a.length;t++){if(t==0&&e==false)continue;if(a[t].SEPARATOR==true)break;a[t].ICONCLASS=e?"checked":""}var n=BX("a_minmax_"+this.table_id);if(n&&n.className.indexOf("bx-filter-max")!=-1)this.SwitchFilter(n);this.SaveFilterRows()};this.SaveFilterRows=function(){var e="";for(var t in this.oFilterRows)if(this.oFilterRows[t])e+=(e!=""?",":"")+t;BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.ajax.php?GRID_ID="+this.table_id+"&action=filterrows&rows="+e+"&sessid="+this.vars.sessid)};this.SwitchFilter=function(e){var t=e.className.indexOf("bx-filter-min")!=-1;e.className=t?"bx-filter-btn bx-filter-max":"bx-filter-btn bx-filter-min";e.title=t?this.vars.mess.filterShow:this.vars.mess.filterHide;var i=BX("flt_content_"+this.table_id);i.style.display=t?"none":"";BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.ajax.php?GRID_ID="+this.table_id+"&action=filterswitch&show="+(t?"N":"Y")+"&sessid="+this.vars.sessid)};this.ClearFilter=function(e){for(var t=0,i=e.elements.length;t<i;t++){var s=e.elements[t];switch(s.type.toLowerCase()){case"text":case"textarea":s.value="";break;case"select-one":s.selectedIndex=0;break;case"select-multiple":for(var a=0,n=s.options.length;a<n;a++)s.options[a].selected=false;break;case"checkbox":s.checked=false;break;default:break}if(s.onchange)s.onchange()}BX.onCustomEvent(e,"onGridClearFilter",[]);e.clear_filter.value="Y";BX.submit(e)};this.ShowFilters=function(){var e=false;if(!window["filtersDialog"+this.table_id]){var i=new BX.CWindowButton({title:this.vars.mess.filtersApply,hint:this.vars.mess.filtersApplyTitle,action:function(){var e=document["filters_"+t.table_id];if(e.filters_list.value)t.ApplyFilter(e.filters_list.value);this.parentWindow.Close()}});window["filtersDialog"+this.table_id]=new BX.CDialog({content:'<form name="filters_'+this.table_id+'"></form>',title:this.vars.mess.filtersTitle,buttons:[i,BX.CDialog.prototype.btnClose],width:this.vars.filtersWndSize.width,height:this.vars.filtersWndSize.height,resize_id:"InterfaceGridFiltersWnd"});e=true}window["filtersDialog"+this.table_id].Show();var s=document["filters_"+this.table_id];if(e)s.appendChild(BX("filters_list_"+this.table_id))};this.AddFilter=function(e){if(!e)e={};var i="filter_"+Math.round(Math.random()*1e6);var s={name:this.vars.mess.filtersNew,fields:e};this.ShowFilterSettings(s,function(){var e=t.SaveFilter(i);t.oOptions.filters[i]={name:e.name,fields:e.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.length]=new Option(e.name!=""?e.name:t.vars.mess.viewsNoName,i,true,true);if(t.filterMenu.length==4)t.filterMenu=BX.util.insertIntoArray(t.filterMenu,1,{SEPARATOR:true});var a={ID:"mnu_"+t.table_id+"_"+i,TEXT:BX.util.htmlspecialchars(e.name),TITLE:t.vars.mess.ApplyTitle,ONCLICK:"bxGrid_"+t.table_id+".ApplyFilter('"+i+"')"};t.filterMenu=BX.util.insertIntoArray(t.filterMenu,2,a)})};this.AddFilterAs=function(){var e=document.forms["filter_"+this.table_id];var t=this.GetFilterFields(e);this.ShowFilters();this.AddFilter(t)};this.EditFilter=function(e){this.ShowFilterSettings(this.oOptions.filters[e],function(){var i=t.SaveFilter(e);t.oOptions.filters[e]={name:i.name,fields:i.fields};var s=document["filters_"+t.table_id];s.filters_list.options[s.filters_list.selectedIndex].text=i.name!=""?i.name:t.vars.mess.viewsNoName;for(var a=0,n=t.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){
t.filterMenu[a].TEXT=BX.util.htmlspecialchars(i.name);break}}})};this.DeleteFilter=function(e){if(!confirm(this.vars.mess.filtersDelete))return;var i=document["filters_"+this.table_id];var s=i.filters_list.selectedIndex;i.filters_list.remove(s);i.filters_list.selectedIndex=s<i.filters_list.length?s:i.filters_list.length-1;for(var a=0,n=this.filterMenu.length;a<n;a++){if(t.filterMenu[a].ID&&t.filterMenu[a].ID=="mnu_"+t.table_id+"_"+e){this.filterMenu=BX.util.deleteFromArray(this.filterMenu,a);if(this.filterMenu.length==5)this.filterMenu=BX.util.deleteFromArray(this.filterMenu,1);break}}delete this.oOptions.filters[e];BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.ajax.php?GRID_ID="+this.table_id+"&action=delfilter&filter_id="+e+"&sessid="+t.vars.sessid)};this.ShowFilterSettings=function(e,t){var i=false;if(!window["filterSettingsDialog"+this.table_id]){window["filterSettingsDialog"+this.table_id]=new BX.CDialog({content:'<form name="flt_settings_'+this.table_id+'"></form>',title:this.vars.mess.filterSettingsTitle,width:this.vars.filterSettingWndSize.width,height:this.vars.filterSettingWndSize.height,resize_id:"InterfaceGridFilterSettingWnd"});i=true}window["filterSettingsDialog"+this.table_id].ClearButtons();window["filterSettingsDialog"+this.table_id].SetButtons([{title:this.vars.mess.settingsSave,action:function(){t();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["filterSettingsDialog"+this.table_id].Show();var s=document["flt_settings_"+this.table_id];if(i)s.appendChild(BX("filter_settings_"+this.table_id));s.filter_name.focus();s.filter_name.value=e.name;this.SetFilterFields(s,e.fields)};this.SetFilterFields=function(e,t){for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;var n=t[a.name]||"";switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":a.value=n;break;case"radio":case"checkbox":a.checked=a.value==n;break;case"select-multiple":var l=a.name.substr(0,a.name.length-2);var r=false;for(var o=0,d=a.options.length;o<d;o++){var h=t[l]?t[l]["sel"+a.options[o].value]:null;a.options[o].selected=a.options[o].value==h;if(a.options[o].value==h)r=true}if(!r&&a.options.length>0&&a.options[0].value=="")a.options[0].selected=true;break;default:break}if(a.onchange)a.onchange()}};this.GetFilterFields=function(e){var t={};for(var i=0,s=e.elements.length;i<s;i++){var a=e.elements[i];if(a.name=="filter_name")continue;switch(a.type.toLowerCase()){case"select-one":case"text":case"textarea":t[a.name]=a.value;break;case"radio":case"checkbox":if(a.checked)t[a.name]=a.value;break;case"select-multiple":var n=a.name.substr(0,a.name.length-2);t[n]={};for(var l=0,r=a.options.length;l<r;l++)if(a.options[l].selected)t[n]["sel"+a.options[l].value]=a.options[l].value;break;default:break}}return t};this.SaveFilter=function(e){var i=document["flt_settings_"+this.table_id];var s={GRID_ID:this.table_id,filter_id:e,action:"savefilter",sessid:this.vars.sessid,name:i.filter_name.value,fields:this.GetFilterFields(i)};BX.ajax.post("/bitrix/components"+t.vars.component_path+"/settings.ajax.php",s);return s};this.ApplyFilter=function(e){var t=document.forms["filter_"+this.table_id];this.SetFilterFields(t,this.oOptions.filters[e].fields);BX.submit(t)};this.OnDateChange=function(e){var t=false,i=false,s=false,a=false,n=false;if(e.value=="interval")n=t=i=s=true;else if(e.value=="before")i=true;else if(e.value=="after"||e.value=="exact")t=true;else if(e.value=="days")a=true;BX.findNextSibling(e,{tag:"span","class":"bx-filter-from"}).style.display=t?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-to"}).style.display=i?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-hellip"}).style.display=s?"":"none";BX.findNextSibling(e,{tag:"span","class":"bx-filter-days"}).style.display=a?"":"none";var l=BX.findNextSibling(e,{tag:"span","class":"bx-filter-br"});if(l)l.style.display=n?"":"none"};this.loadColumn=function(e){var i=BX(this.table_id);var s=this.GetColumnId(e);var a=i.rows[0].cells[s];a.removeAttribute("data-empty");if(a.getAttribute("data-resize"))jsDD.Disable();var n=[];var l=function(l){n.push(l);for(var r in l.edit){if(typeof l.edit[r][e]!="undefined"){if(typeof t.oEditData[r]=="undefined")t.oEditData[r]={};t.oEditData[r][e]=l.edit[r][e]}}if(n.length<t.vars.current_url.length)return;for(var r in n){for(var o in n[r].data){var d=BX("datarow_"+t.table_id+"_"+o).cells[s];BX.findChildByClassName(d,"main-grid-cell-content").innerHTML=n[r].data[o][e]}}if(a.getAttribute("data-resize")){a.removeAttribute("data-resize");var h=i.offsetWidth;var c=a.offsetWidth;t.animation.stop(a);if(a.offsetWidth>0){t.reinitColumnSize(e);var f=a.offsetWidth;a.style.width=c+"px";t.toogleColumnCells(s,true,true);var v={width:{from:c,to:f,unit:"px"}};t.animation(a,v,100,function(){t.toogleColumnCells(s,true,false);t.reinitResizeMeta();t.toogleFader()})}jsDD.Enable()}t.toggleCheckboxes()};for(var r in this.vars.current_url){BX.ajax({url:this.vars.current_url[r],method:"GET",dataType:"json",headers:[{name:"X-Ajax-Grid-UID",value:this.vars.ajax.GRID_AJAX_UID},{name:"X-Ajax-Grid-Req",value:JSON.stringify({action:"showcolumn",column:e})}],onsuccess:l,onfailure:function(){a.setAttribute("data-empty",1);jsDD.Enable()}})}};this.getData=function(e,t){BX.ajax({url:e+(e.indexOf("?")!==-1?"&":"?")+"bxajaxid="+this.vars.ajax.AJAX_ID,method:"GET",dataType:"html",headers:[{name:"X-Ajax-Grid-UID",value:this.vars.ajax.GRID_AJAX_UID},{name:"X-Ajax-Grid-Req",value:JSON.stringify({action:"showpage",columns:this.oVisibleCols})}],processData:true,scriptsRunFirst:true,onsuccess:function(e){t(e)}})}}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagesize.min.js?1544127384593";s:6:"source";s:72:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagesize.js";s:3:"min";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagesize.min.js";s:3:"map";s:76:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagesize.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Pagesize=function(t){this.parent=null;this.init(t)};BX.Grid.Pagesize.prototype={init:function(t){this.parent=t;BX.addCustomEvent("Dropdown::change",BX.delegate(this.onChange,this))},onChange:function(t,e,n,i,a){var s=this;if(t===this.parent.getContainerId()+"_"+this.parent.settings.get("pageSizeId")){if(a>=0){this.parent.tableFade();this.parent.getUserOptions().setPageSize(a,function(){s.parent.reloadTable();BX.onCustomEvent(s.parent.getContainer(),"Grid::pageSizeChanged",[s.parent])})}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:92:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagination.min.js?1544127384842";s:6:"source";s:74:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagination.js";s:3:"min";s:78:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagination.min.js";s:3:"map";s:78:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagination.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Pagination=function(t){this.parent=null;this.container=null;this.links=null;this.init(t)};BX.Grid.Pagination.prototype={init:function(t){this.parent=t},getParent:function(){return this.parent},getContainer:function(){if(!this.container){this.container=BX.Grid.Utils.getByClass(this.getParent().getContainer(),this.getParent().settings.get("classPagination"),true)}return this.container},getLinks:function(){var t=this;var n=BX.Grid.Utils.getByTag(this.getContainer(),"a");this.links=[];if(n){this.links=n.map(function(n){return new BX.Grid.Element(n,t.getParent())})}return this.links},getLink:function(t){var n=null;var i;if(BX.type.isDomNode(t)){i=this.getLinks().filter(function(n){return t===n.getNode()});if(i.length){n=i[0]}}return n}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:93:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-header.min.js?15441273843104";s:6:"source";s:74:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-header.js";s:3:"min";s:78:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-header.min.js";s:3:"map";s:78:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-header.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.PinHeader=function(t){this.parent=null;this.table=null;this.header=null;this.container=null;this.parentNodeResizeObserver=null;this.init(t)};BX.Grid.PinHeader.prototype={init:function(t){this.parent=t;this.rect=BX.pos(this.parent.getHead());this.gridRect=BX.pos(this.parent.getTable());var e=BX.Grid.Utils.getBySelector(document,"#workarea-content",true);if(!e){e=this.parent.getContainer().parentNode;e=!!e?e.parentNode:e}if(!!e){this.parentNodeResizeObserver=new BX.ResizeObserver(BX.proxy(this.refreshRect,this));this.parentNodeResizeObserver.observe(e)}this.create();document.addEventListener("scroll",BX.proxy(this._onScroll,this),BX.Grid.Utils.listenerParams({passive:true}));document.addEventListener("resize",BX.proxy(this._onResize,this),BX.Grid.Utils.listenerParams({passive:true}));BX.addCustomEvent("Grid::updated",BX.proxy(this._onGridUpdate,this));BX.addCustomEvent("Grid::resize",BX.proxy(this._onGridUpdate,this));BX.bind(window,"resize",BX.proxy(this._onGridUpdate,this))},refreshRect:function(){this.gridRect=BX.pos(this.parent.getTable());this.rect=BX.pos(this.parent.getHead())},_onGridUpdate:function(){var t=this.isPinned();BX.remove(this.getContainer());this.create();t&&this.pin();this.table=null;this.refreshRect();BX.onCustomEvent(window,"Grid::headerUpdated",[])},create:function(){var t=BX.Grid.Utils.getByTag(this.parent.getHead(),"th");var e=t.length-1;var i=BX.clone(this.parent.getHead());var n=BX.Grid.Utils.getByTag(i,"th");t.forEach(function(t,i){var s=BX.width(t);n[i].firstElementChild&&(n[i].firstElementChild.style.width=s+"px");if(e!==i){n[i].style.width=s+"px"}else{if(this.parent.getRows().getCountDisplayed()>0){n[i].style.width="100%"}}},this);this.container=BX.decl({block:"main-grid-fixed-bar",mix:"main-grid-fixed-top",attrs:{style:"width: "+BX.width(this.parent.getContainer())+"px"},content:{block:"main-grid-table",tag:"table",content:i}});this.container.hidden=true;this.parent.getWrapper().appendChild(this.container)},getContainer:function(){return this.container},getFixedTable:function(){return this.table||(this.table=BX.Grid.Utils.getByTag(this.getContainer(),"table",true))},pin:function(){!!this.getContainer()&&(this.getContainer().hidden=false);BX.onCustomEvent(window,"Grid::headerPinned",[])},unpin:function(){!!this.getContainer()&&(this.getContainer().hidden=true);BX.onCustomEvent(window,"Grid::headerUnpinned",[])},stopPin:function(){BX.Grid.Utils.styleForEach([this.getContainer()],{position:"absolute",top:this.gridRect.bottom-this.rect.height-this.gridRect.top+"px","box-shadow":"none"})},startPin:function(){BX.Grid.Utils.styleForEach([this.getContainer()],{position:"fixed",top:0,"box-shadow":""})},isPinned:function(){return!this.getContainer().hidden},_onScroll:function(){if(this.gridRect.bottom>window.scrollY+this.rect.height){this.startPin();if(this.rect.top<=window.scrollY){!this.isPinned()&&this.pin()}else{this.isPinned()&&this.unpin()}}else{this.stopPin()}},_onResize:function(){this.rect=BX.pos(this.parent.getHead())}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:92:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-panel.min.js?15441273844993";s:6:"source";s:73:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-panel.js";s:3:"min";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-panel.min.js";s:3:"map";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.PinPanel=function(t){this.parent=null;this.panel=null;this.panelRect=null;this.isSelected=null;this.offset=null;this.animationDuration=null;this.lastIsSelected=null;this.init(t)};BX.Grid.PinPanel.prototype={init:function(t){this.parent=t;this.offset=10;this.animationDuration=200;this.panel=this.getPanel();this.bindOnRowsEvents()},bindOnRowsEvents:function(){BX.addCustomEvent("Grid::thereSelectedRows",BX.delegate(this._onThereSelectedRows,this));BX.addCustomEvent("Grid::allRowsSelected",BX.delegate(this._onThereSelectedRows,this));BX.addCustomEvent("Grid::noSelectedRows",BX.delegate(this._onNoSelectedRows,this));BX.addCustomEvent("Grid::allRowsUnselected",BX.delegate(this._onNoSelectedRows,this));BX.addCustomEvent("Grid::updated",BX.delegate(this._onNoSelectedRows,this))},bindOnWindowEvents:function(){BX.bind(window,"resize",BX.proxy(this._onResize,this));document.addEventListener("scroll",BX.proxy(this._onScroll,this),BX.Grid.Utils.listenerParams({passive:true}))},unbindOnWindowEvents:function(){BX.unbind(window,"resize",BX.proxy(this._onResize,this));document.removeEventListener("scroll",BX.proxy(this._onScroll,this),BX.Grid.Utils.listenerParams({passive:true}))},getPanel:function(){this.panel=this.panel||this.parent.getActionsPanel().getPanel();return this.panel},getScrollBottom:function(){return BX.scrollTop(window)+this.getWindowHeight()},getPanelRect:function(){if(!BX.type.isPlainObject(this.panelRect)){this.panelRect=BX.pos(this.getPanel())}return this.panelRect},getPanelPrevBottom:function(){var t=BX.previousSibling(this.getPanel());return BX.pos(t).bottom+parseFloat(BX.style(t,"margin-bottom"))},getWindowHeight:function(){this.windowHeight=this.windowHeight||BX.height(window);return this.windowHeight},pinPanel:function(){BX.style(this.getPanel(),"width",BX.width(this.getPanel().parentNode)+"px");BX.style(this.getPanel().parentNode,"height",BX.height(this.getPanel().parentNode)+"px");BX.addClass(this.getPanel(),"main-grid-fixed-bottom");BX.style(this.getPanel(),"bottom","");setTimeout(BX.delegate(function(){BX.style(this.getPanel(),"transition","none")},this),200)},unpinPanel:function(){BX.removeClass(this.getPanel(),"main-grid-fixed-bottom");BX.style(this.getPanel(),"width","");BX.style(this.getPanel().parentNode,"height","");BX.style(this.getPanel(),"bottom","");setTimeout(BX.delegate(function(){BX.style(this.getPanel(),"transition","")},this),200)},isSelectedRows:function(){return this.isSelected},isNeedPinAbsolute:function(){return BX.pos(this.parent.getBody()).top+this.getPanelRect().height>=this.getScrollBottom()},isNeedPin:function(){return this.getScrollBottom()-this.getPanelRect().height<=this.getPanelPrevBottom()},adjustPanelPosition:function(){var t=window.pageXOffset;this.lastScrollX=this.lastScrollX!==null?this.lastScrollX:t;BX.Grid.Utils.requestAnimationFrame(BX.proxy(function(){if(t!==this.lastScrollX){var e=this.getPanelRect();BX.style(this.getPanel(),"left",e.left-t+"px")}},this));this.lastScrollX=t},pinController:function(t){if(!this.getPanel()){return}var e=this;if(this.isNeedPin()&&this.isSelectedRows()){if(t){BX.style(this.getPanel(),"bottom",-this.getStartDiffPanelPosition()+"px");setTimeout(function(){e.pinPanel()},200)}else{this.pinPanel()}if(this.isNeedPinAbsolute()&&!this.absolutePin){this.absolutePin=true;BX.style(this.getPanel(),"transition","");BX.style(this.getPanel(),"top",BX.pos(this.parent.getBody()).top-parseFloat(BX.style(this.getPanel(),"margin-top"))+"px");BX.style(e.getPanel(),"position","absolute")}else if(!this.isNeedPinAbsolute()&&this.absolutePin){this.absolutePin=false;BX.style(this.getPanel(),"position","");BX.style(this.getPanel(),"top","")}this.adjustPanelPosition()}else{if(t){BX.style(this.getPanel(),"bottom",-this.getEndDiffPanelPosition()+"px");setTimeout(function(){e.unpinPanel()},200)}else{this.unpinPanel()}}},getEndDiffPanelPosition:function(){var t=BX.pos(this.getPanel());var e=BX.pos(BX.previousSibling(this.getPanel()));var i=BX.scrollTop(window);var n=i+BX.height(window);var s=t.height+this.offset;var o=e.bottom+parseFloat(BX.style(this.getPanel(),"margin-top"));if(o<n&&o+t.height>n){s=Math.abs(n-(o+t.height))}return s},getStartDiffPanelPosition:function(){var t=BX.pos(this.getPanel());var e=BX.scrollTop(window);var i=e+BX.height(window);var n=t.height+this.offset;if(t.bottom>i&&t.top<i){n=t.bottom-i}return n},_onThereSelectedRows:function(){this.bindOnWindowEvents();this.isSelected=true;if(this.lastIsSelected){this.pinController()}else{this.lastIsSelected=true;this.pinController(true)}},_onNoSelectedRows:function(){this.unbindOnWindowEvents();this.isSelected=false;this.pinController(true);this.lastIsSelected=false},_onScroll:function(){this.pinController()},_onResize:function(){this.windowHeight=BX.height(window);this.panel=this.parent.getActionsPanel().getPanel();this.panelRect=this.getPanel().getBoundingClientRect();this.pinController()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/resize.min.js?15441273843776";s:6:"source";s:70:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/resize.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Resize=function(t){this.parent=null;this.lastRegisterButtons=null;this.init(t)};BX.Grid.Resize.prototype={init:function(t){this.parent=t;BX.addCustomEvent(window,"Grid::updated",BX.proxy(this.registerTableButtons,this));BX.addCustomEvent(window,"Grid::headerUpdated",BX.proxy(this.registerPinnedTableButtons,this));this.registerTableButtons();this.registerPinnedTableButtons()},destroy:function(){BX.removeCustomEvent(window,"Grid::updated",BX.proxy(this.registerTableButtons,this));BX.removeCustomEvent(window,"Grid::headerUpdated",BX.proxy(this.registerPinnedTableButtons,this));BX.type.isArray(this.lastRegisterButtons)&&this.lastRegisterButtons.forEach(jsDD.unregisterObject);(this.getButtons()||[]).forEach(jsDD.unregisterObject)},registerTableButtons:function(){(this.getButtons()||[]).forEach(this.register,this);this.registerPinnedTableButtons()},register:function(t){if(BX.type.isDomNode(t)){t.onbxdragstart=BX.delegate(this._onDragStart,this);t.onbxdragstop=BX.delegate(this._onDragEnd,this);t.onbxdrag=BX.delegate(this._onDrag,this);jsDD.registerObject(t)}},registerPinnedTableButtons:function(){if(this.parent.getParam("ALLOW_PIN_HEADER")){var t=this.getPinnedTableButtons();if(BX.type.isArray(this.lastRegisterButtons)&&this.lastRegisterButtons.length){this.lastRegisterButtons.forEach(jsDD.unregisterObject)}this.lastRegisterButtons=t;(this.getPinnedTableButtons()||[]).forEach(this.register,this)}},getButtons:function(){return BX.Grid.Utils.getByClass(this.parent.getRows().getHeadFirstChild().getNode(),this.parent.settings.get("classResizeButton"))},getPinnedTableButtons:function(){return BX.Grid.Utils.getByClass(this.parent.getPinHeader().getFixedTable(),this.parent.settings.get("classResizeButton"))},_onDragStart:function(){var t=BX.findParent(jsDD.current_node,{className:this.parent.settings.get("classHeadCell")});var e=this.parent.getRows().getHeadFirstChild().getCells();var i=Object.keys(e);var s;this.__overlay=BX.create("div",{props:{className:"main-grid-cell-overlay"}});BX.append(this.__overlay,t);this.__resizeCell=t.cellIndex;i.forEach(function(t){if(BX.hasClass(e[t],"main-grid-special-empty")){BX.style(e[t],"width","100%")}else{BX.width(e[t],BX.width(e[t]));s=BX.firstChild(e[t]);BX.width(s,BX.width(e[t]))}})},_onDrag:function(t){var e=this.parent.getTable();var i=this.parent.getParam("ALLOW_PIN_HEADER")?this.parent.getPinHeader().getFixedTable():null;var s=e.rows[0].cells[this.__resizeCell];var n,r;var a=BX.pos(s);var o=parseFloat(s.style.width);var l;t-=a.left;l=t;if(a.width>o){t=a.width}t=l>t?l:t;t=Math.max(t,80);if(t!==a.width){var h=this.parent.getAllRows()[0].querySelectorAll(".main-grid-fixed-column").length;var d=this.parent.getColumnByIndex(this.__resizeCell-h);d.forEach(function(e){e.style.width=t+"px";e.style.minWidth=t+"px";e.style.maxWidth=t+"px"});if(d[0].classList.contains("main-grid-fixed-column")){d=this.parent.getColumnByIndex(this.__resizeCell-h+1);d.forEach(function(e){e.style.width=t+"px";e.style.minWidth=t+"px";e.style.maxWidth=t+"px"})}this.parent.adjustFixedColumnsPosition();this.parent.adjustFadePosition(this.parent.getFadeOffset());if(BX.type.isDomNode(i)&&BX.type.isDomNode(i.rows[0])){n=i.rows[0].cells[this.__resizeCell];r=BX.firstChild(n);r.style.width=t+"px";r.style.minWidth=t+"px";n.style.width=t+"px";n.style.minWidth=t+"px"}}BX.onCustomEvent(window,"Grid::columnResize",[])},_onDragEnd:function(){this.saveSizes()},getColumnSizes:function(){var t=this.parent.getRows().getHeadFirstChild().getCells();var e={};var i;[].forEach.call(t,function(t){i=BX.data(t,"name");if(BX.type.isNotEmptyString(i)){e[i]=BX.width(t)}},this);return e},saveSizes:function(){this.parent.getUserOptions().setColumnSizes(this.getColumnSizes(),1)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:87:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/row.min.js?154412738416243";s:6:"source";s:67:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/row.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Row=function(t,e){this.node=null;this.checkbox=null;this.sort=null;this.actions=null;this.settings=null;this.index=null;this.actionsButton=null;this.parent=null;this.depth=null;this.parentId=null;this.editData=null;this.custom=null;this.init(t,e)};BX.Grid.Row.prototype={init:function(t,e){if(BX.type.isDomNode(e)){this.node=e;this.parent=t;this.settings=new BX.Grid.Settings;this.bindNodes=[];if(this.isBodyChild()){this.bindNodes=[].slice.call(this.node.parentNode.querySelectorAll('tr[data-bind="'+this.getId()+'"]'));if(this.bindNodes.length){this.node.addEventListener("mouseover",this.onMouseOver.bind(this));this.node.addEventListener("mouseleave",this.onMouseLeave.bind(this));this.bindNodes.forEach(function(t){t.addEventListener("mouseover",this.onMouseOver.bind(this));t.addEventListener("mouseleave",this.onMouseLeave.bind(this));t.addEventListener("click",function(){if(this.isSelected()){this.unselect()}else{this.select()}}.bind(this))},this)}}if(this.parent.getParam("ALLOW_CONTEXT_MENU")){BX.bind(this.getNode(),"contextmenu",BX.delegate(this._onRightClick,this))}}},onMouseOver:function(){this.node.classList.add("main-grid-row-over");this.bindNodes.forEach(function(t){t.classList.add("main-grid-row-over")})},onMouseLeave:function(){this.node.classList.remove("main-grid-row-over");this.bindNodes.forEach(function(t){t.classList.remove("main-grid-row-over")})},isCustom:function(){if(this.custom===null){this.custom=BX.hasClass(this.getNode(),this.parent.settings.get("classRowCustom"))}return this.custom},_onRightClick:function(t){t.preventDefault();this.showActionsMenu(t)},getDefaultAction:function(){return BX.data(this.getNode(),"default-action")},editGetValues:function(){var t=this;var e=this.getCells();var i={};var s;[].forEach.call(e,function(e){s=t.getCellEditorValue(e);if(BX.type.isArray(s)){s.forEach(function(t){i[t.NAME]=t.VALUE!==undefined?t.VALUE:"";if(t.RAW_NAME&&t.RAW_VALUE){i[t.NAME+"_custom"]=i[t.NAME+"_custom"]||{};i[t.NAME+"_custom"][t.RAW_NAME]=t.RAW_VALUE}})}else if(s){i[s.NAME]=s.VALUE!==undefined?s.VALUE:""}});return i},getCellEditorValue:function(t){var e=BX.Grid.Utils.getByClass(t,this.parent.settings.get("classEditor"),true);var i=null;if(BX.type.isDomNode(e)){if(BX.hasClass(e,"main-grid-editor-checkbox")){i={NAME:e.getAttribute("name"),VALUE:e.checked?"Y":"N"}}else if(BX.hasClass(e,"main-grid-editor-custom")){i=[];e.querySelectorAll("input, select, checkbox, textarea").forEach(function(t){switch(t.tagName){case"SELECT":if(t.multiple){var s=[];t.querySelectorAll("option").forEach(function(t){if(t.selected){s.push(t.value)}});i.push({NAME:e.getAttribute("data-name"),RAW_NAME:t.name,RAW_VALUE:s,VALUE:s})}else{i.push({NAME:e.getAttribute("data-name"),RAW_NAME:t.name,RAW_VALUE:t.value,VALUE:t.value})}break;case"INPUT":switch(t.type.toUpperCase()){case"RADIO":case"CHECKBOX":i.push({NAME:e.getAttribute("data-name"),RAW_NAME:t.name,RAW_VALUE:t.checked?t.value:"",VALUE:t.checked?t.value:""});break;default:i.push({NAME:e.getAttribute("data-name"),RAW_NAME:t.name,RAW_VALUE:t.value,VALUE:t.value})}break;default:i.push({NAME:e.getAttribute("data-name"),RAW_NAME:t.name,RAW_VALUE:t.value,VALUE:t.value})}})}else{if(e.value){i={NAME:e.getAttribute("name"),VALUE:e.value}}else{i={NAME:e.getAttribute("name"),VALUE:BX.data(e,"value")}}}}return i},isEdit:function(){return BX.hasClass(this.getNode(),"main-grid-row-edit")},hide:function(){BX.addClass(this.getNode(),this.parent.settings.get("classHide"))},show:function(){BX.removeClass(this.getNode(),this.parent.settings.get("classHide"))},isShown:function(){return!BX.hasClass(this.getNode(),this.parent.settings.get("classHide"))},isNotCount:function(){return BX.hasClass(this.getNode(),this.parent.settings.get("classNotCount"))},getContentContainer:function(t){var e=null;if(!BX.hasClass(t,this.parent.settings.get("classCellContainer"))){if(t.nodeName==="TD"||t.nodeName==="TR"){e=BX.Grid.Utils.getByClass(t,this.parent.settings.get("classCellContainer"),true)}else{e=BX.findParent(t,{className:this.parent.settings.get("classCellContainer")},true,false)}}else{e=t}return e},getContent:function(t){var e=this.getContentContainer(t);var i;if(BX.type.isDomNode(e)){i=BX.html(e)}return i},getEditorContainer:function(t){return BX.Grid.Utils.getByClass(t,this.parent.settings.get("classEditorContainer"),true)},getCollapseButton:function(){if(!this.collapseButton){this.collapseButton=BX.Grid.Utils.getByClass(this.getNode(),this.parent.settings.get("classCollapseButton"),true)}return this.collapseButton},stateLoad:function(){BX.addClass(this.getNode(),this.parent.settings.get("classRowStateLoad"))},stateUnload:function(){BX.removeClass(this.getNode(),this.parent.settings.get("classRowStateLoad"))},stateExpand:function(){BX.addClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},stateCollapse:function(){BX.removeClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},getParentId:function(){if(this.parentId===null){this.parentId=BX.data(this.getNode(),"parent-id");if(typeof this.parentId!=="undefined"&&this.parentId!==null){this.parentId=this.parentId.toString()}}return this.parentId},getDataset:function(){return this.getNode().dataset},getDepth:function(){if(this.depth===null){this.depth=BX.data(this.getNode(),"depth")}return this.depth},setDepth:function(t){t=parseInt(t);if(BX.type.isNumber(t)){var e=t-parseInt(this.getDepth());var i=this.parent.getRows();this.getDataset().depth=t;this.getShiftCells().forEach(function(e){BX.data(e,"depth",t);BX.style(e,"padding-left",t*20+"px")},this);i.getRowsByParentId(this.getId(),true).forEach(function(t){var i=parseInt(e)+parseInt(t.getDepth());t.getDataset().depth=i;t.getShiftCells().forEach(function(t){BX.data(t,"depth",i);BX.style(t,"padding-left",i*20+"px")})})}},setParentId:function(t){this.getDataset()["parentId"]=t},getShiftCells:function(){return BX.Grid.Utils.getBySelector(this.getNode(),'td[data-shift="true"]')},showChildRows:function(){var t=this.getChildren();var e=this.isCustom();t.forEach(function(t){t.show();if(!e&&t.isExpand()){t.showChildRows()}});this.parent.updateCounterDisplayed();this.parent.updateCounterSelected();this.parent.adjustCheckAllCheckboxes();this.parent.adjustRows()},getChildren:function(){var t=this.isCustom()?"getRowsByGroupId":"getRowsByParentId";var e=this.isCustom()?this.getGroupId():this.getId();return this.parent.getRows()[t](e,true)},hideChildRows:function(){var t=this.getChildren();t.forEach(function(t){t.hide()});this.parent.updateCounterDisplayed();this.parent.updateCounterSelected();this.parent.adjustCheckAllCheckboxes();this.parent.adjustRows()},isChildsLoaded:function(){if(!BX.type.isBoolean(this.childsLoaded)){this.childsLoaded=this.isCustom()||BX.data(this.getNode(),"child-loaded")==="true"}return this.childsLoaded},expand:function(){var t=this;this.stateExpand();if(this.isChildsLoaded()){this.showChildRows()}else{this.stateLoad();this.loadChildRows(function(e){e.reverse().forEach(function(e){BX.insertAfter(e,t.getNode())});t.parent.getRows().reset();t.parent.bindOnRowEvents();if(t.parent.getParam("ALLOW_ROWS_SORT")){t.parent.getRowsSortable().reinit()}if(t.parent.getParam("ALLOW_COLUMNS_SORT")){t.parent.getColsSortable().reinit()}t.stateUnload();BX.data(t.getNode(),"child-loaded","true");t.parent.updateCounterDisplayed();t.parent.updateCounterSelected();t.parent.adjustCheckAllCheckboxes()})}},collapse:function(){this.stateCollapse();this.hideChildRows()},isExpand:function(){return BX.hasClass(this.getNode(),this.parent.settings.get("classRowStateExpand"))},toggleChildRows:function(){if(!this.isExpand()){this.expand()}else{this.collapse()}},loadChildRows:function(t){if(BX.type.isFunction(t)){var e=this;var i=parseInt(this.getDepth());var s=this.parent.getUserOptions().getAction("GRID_GET_CHILD_ROWS");i=BX.type.isNumber(i)?i+1:1;this.parent.getData().request("","POST",{action:s,parent_id:this.getId(),depth:i},null,function(){var i=this.getRowsByParentId(e.getId());t.apply(null,[i])})}},update:function(t,e,i){t=!!t?t:"";var s=this.parent.getUserOptions().getAction("GRID_UPDATE_ROW");var n=this.getDepth();var a=this.getId();var o=this.getParentId();var r={id:a,parentId:o,action:s,depth:n,data:t};var d=this;this.stateLoad();this.parent.getData().request(e,"POST",r,null,function(){var e=this.getBodyRows();d.parent.getUpdater().updateBodyRows(e);d.stateUnload();d.parent.getRows().reset();d.parent.getUpdater().updateFootRows(this.getFootRows());d.parent.getUpdater().updatePagination(this.getPagination());d.parent.getUpdater().updateMoreButton(this.getMoreButton());d.parent.getUpdater().updateCounterTotal(this.getCounterTotal());d.parent.bindOnRowEvents();d.parent.adjustEmptyTable(e);d.parent.bindOnMoreButtonEvents();d.parent.bindOnClickPaginationLinks();d.parent.updateCounterDisplayed();d.parent.updateCounterSelected();if(d.parent.getParam("ALLOW_COLUMNS_SORT")){d.parent.colsSortable.reinit()}if(d.parent.getParam("ALLOW_ROWS_SORT")){d.parent.rowsSortable.reinit()}BX.onCustomEvent(window,"Grid::rowUpdated",[{id:a,data:t,grid:d.parent,response:this}]);BX.onCustomEvent(window,"Grid::updated",[d.parent]);if(BX.type.isFunction(i)){i({id:a,data:t,grid:d.parent,response:this})}})},remove:function(t,e,i){t=!!t?t:"";var s=this.parent.getUserOptions().getAction("GRID_DELETE_ROW");var n=this.getDepth();var a=this.getId();var o=this.getParentId();var r={id:a,parentId:o,action:s,depth:n,data:t};var d=this;this.stateLoad();this.parent.getData().request(e,"POST",r,null,function(){var e=this.getBodyRows();d.parent.getUpdater().updateBodyRows(e);d.stateUnload();d.parent.getRows().reset();d.parent.getUpdater().updateFootRows(this.getFootRows());d.parent.getUpdater().updatePagination(this.getPagination());d.parent.getUpdater().updateMoreButton(this.getMoreButton());d.parent.getUpdater().updateCounterTotal(this.getCounterTotal());d.parent.bindOnRowEvents();d.parent.adjustEmptyTable(e);d.parent.bindOnMoreButtonEvents();d.parent.bindOnClickPaginationLinks();d.parent.updateCounterDisplayed();d.parent.updateCounterSelected();if(d.parent.getParam("ALLOW_COLUMNS_SORT")){d.parent.colsSortable.reinit()}if(d.parent.getParam("ALLOW_ROWS_SORT")){d.parent.rowsSortable.reinit()}BX.onCustomEvent(window,"Grid::rowRemoved",[{id:a,data:t,grid:d.parent,response:this}]);BX.onCustomEvent(window,"Grid::updated",[d.parent]);if(BX.type.isFunction(i)){i({id:a,data:t,grid:d.parent,response:this})}})},editCancel:function(){var t=this.getCells();var e=this;var i;[].forEach.call(t,function(t){i=e.getEditorContainer(t);if(BX.type.isDomNode(i)){BX.remove(e.getEditorContainer(t));BX.show(e.getContentContainer(t))}});BX.removeClass(this.getNode(),"main-grid-row-edit")},getCellByIndex:function(t){return this.getCells()[t]},getEditDataByCellIndex:function(index){return eval(BX.data(this.getCellByIndex(index),"edit"))},getCellNameByCellIndex:function(t){return BX.data(this.getCellByIndex(t),"name")},getEditData:function(){if(this.editData===null){var t=this.parent.getParam("EDITABLE_DATA");var e=this.getId();if(BX.type.isPlainObject(t)&&e in t){this.editData=t[e]}else{this.editData={}}}return this.editData},getCellEditDataByCellIndex:function(t){var e=this.getEditData();var i=null;t=parseInt(t);if(BX.type.isNumber(t)&&BX.type.isPlainObject(e)){var s=this.parent.getRows().getHeadFirstChild().getEditDataByCellIndex(t);if(BX.type.isPlainObject(s)){i=s;i.VALUE=e[s.NAME]}}return i},edit:function(){var t=this.getCells();var e=this;var i,s,n,a;[].forEach.call(t,function(t,o){try{i=e.getCellEditDataByCellIndex(o)}catch(t){throw new Error(t)}if(e.parent.getEditor().validateEditObject(i)){a=e.getContentContainer(t);n=BX.height(a);s=e.parent.getEditor().getEditor(i,n);if(!e.getEditorContainer(t)&&BX.type.isDomNode(s)){t.appendChild(s);BX.hide(a)}}});BX.addClass(this.getNode(),"main-grid-row-edit")},setDraggable:function(t){if(!t){BX.addClass(this.getNode(),this.parent.settings.get("classDisableDrag"));this.parent.getRowsSortable().unregister(this.getNode())}else{BX.removeClass(this.getNode(),this.parent.settings.get("classDisableDrag"));this.parent.getRowsSortable().register(this.getNode())}},isDraggable:function(){return!BX.hasClass(this.getNode(),this.parent.settings.get("classDisableDrag"))},getNode:function(){return this.node},getIndex:function(){return this.getNode().rowIndex},getId:function(){return BX.data(this.getNode(),"id").toString()},getGroupId:function(){return BX.data(this.getNode(),"group-id").toString()},getObserver:function(){return BX.Grid.observer},getCheckbox:function(){if(!this.checkbox){this.checkbox=BX.Grid.Utils.getByClass(this.getNode(),this.settings.get("classRowCheckbox"),true)}return this.checkbox},getActionsMenu:function(){if(!this.actionsMenu){var t=this.getActionsButton().getBoundingClientRect();this.actionsMenu=BX.PopupMenu.create("main-grid-actions-menu-"+this.getId(),this.getActionsButton(),this.getMenuItems(),{autoHide:true,offsetTop:-(t.height/2+26),offsetLeft:30,angle:{position:"left",offset:t.height/2-8},events:{onPopupClose:BX.delegate(this._onCloseMenu,this),onPopupShow:BX.delegate(this._onPopupShow,this)}});BX.addCustomEvent("Grid::updated",function(){if(this.actionsMenu){this.actionsMenu.destroy();this.actionsMenu=null}}.bind(this));BX.bind(this.actionsMenu.popupWindow.popupContainer,"click",BX.delegate(function(t){var e=this.getActionsMenu();if(e){var i=BX.getEventTarget(t);var s=BX.findParent(i,{className:"menu-popup-item"},10);if(!s||!s.dataset.preventCloseContextMenu){e.close()}}},this))}return this.actionsMenu},_onCloseMenu:function(){},_onPopupShow:function(t){t.setBindElement(this.getActionsButton())},actionsMenuIsShown:function(){return this.getActionsMenu().popupWindow.isShown()},showActionsMenu:function(t){BX.fireEvent(document.body,"click");this.getActionsMenu().popupWindow.show();if(t){this.getActionsMenu().popupWindow.popupContainer.style.top=t.pageY-25+BX.PopupWindow.getOption("offsetTop")+"px";this.getActionsMenu().popupWindow.popupContainer.style.left=t.pageX+20+BX.PopupWindow.getOption("offsetLeft")+"px"}else{var e=BX.pos(this.getActionsButton());e.forceBindPosition=true;this.getActionsMenu().popupWindow.adjustPosition(e)}},closeActionsMenu:function(){if(this.actionsMenu){if(this.actionsMenu.popupWindow){this.actionsMenu.popupWindow.close()}}},getMenuItems:function(){return this.getActions()||[]},getActions:function(){try{this.actions=this.actions||eval(BX.data(this.getActionsButton(),this.settings.get("dataActionsKey")))}catch(t){this.actions=null}return this.actions},getActionsButton:function(){if(!this.actionsButton){this.actionsButton=BX.Grid.Utils.getByClass(this.getNode(),this.settings.get("classRowActionButton"),true)}return this.actionsButton},initSelect:function(){if(this.isSelected()&&!BX.hasClass(this.getNode(),this.settings.get("classCheckedRow"))){BX.addClass(this.getNode(),this.settings.get("classCheckedRow"))}},getParentNode:function(){var t;try{t=this.getNode().parentNode}catch(e){t=null}return t},getParentNodeName:function(){var t;try{t=this.getParentNode().nodeName}catch(e){t=null}return t},select:function(){var t;if(!this.isEdit()){t=this.getCheckbox();if(t){if(!BX.data(t,"disabled")){BX.addClass(this.getNode(),this.settings.get("classCheckedRow"));this.bindNodes.forEach(function(t){BX.addClass(t,this.settings.get("classCheckedRow"))},this);t.checked=true}}}},unselect:function(){if(!this.isEdit()){BX.removeClass(this.getNode(),this.settings.get("classCheckedRow"));this.bindNodes.forEach(function(t){BX.removeClass(t,this.settings.get("classCheckedRow"))},this);if(this.getCheckbox()){this.getCheckbox().checked=false}}},getCells:function(){return this.getNode().cells},isSelected:function(){return this.getCheckbox()&&this.getCheckbox().checked||BX.hasClass(this.getNode(),this.settings.get("classCheckedRow"))},isHeadChild:function(){return this.getParentNodeName()==="THEAD"&&BX.hasClass(this.getNode(),this.settings.get("classHeadRow"))},isBodyChild:function(){return BX.hasClass(this.getNode(),this.settings.get("classBodyRow"))&&!BX.hasClass(this.getNode(),this.settings.get("classEmptyRows"))},isFootChild:function(){return this.getParentNodeName()==="TFOOT"&&BX.hasClass(this.getNode(),this.settings.get("classFootRow"))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:97:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows-sortable.min.js?154412738410600";s:6:"source";s:77:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows-sortable.js";s:3:"min";s:81:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows-sortable.min.js";s:3:"map";s:81:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows-sortable.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.RowDragEvent=function(t){this.allowMoveRow=true;this.allowInsertBeforeTarget=true;this.dragItem=null;this.targetItem=null;this.eventName=!!t?t:"";this.errorMessage=""};BX.Grid.RowDragEvent.prototype={allowMove:function(){this.allowMoveRow=true;this.errorMessage=""},allowInsertBefore:function(){this.allowInsertBeforeTarget=true},disallowMove:function(t){this.allowMoveRow=false;this.errorMessage=t||""},disallowInsertBefore:function(){this.allowInsertBeforeTarget=false},getDragItem:function(){return this.dragItem},getTargetItem:function(){return this.targetItem},getEventName:function(){return this.eventName},setDragItem:function(t){return this.dragItem=t},setTargetItem:function(t){return this.targetItem=t},setEventName:function(t){return this.eventName=t},isAllowedMove:function(){return this.allowMoveRow},isAllowedInsertBefore:function(){return this.allowInsertBeforeTarget},getErrorMessage:function(){return this.errorMessage}};BX.Grid.RowsSortable=function(t){this.parent=null;this.list=null;this.setDefaultProps();this.init(t)};BX.Grid.RowsSortable.prototype={init:function(t){this.parent=t;this.list=this.getList();this.prepareListItems();jsDD.Enable();if(!this.inited){this.inited=true;this.onscrollDebounceHandler=BX.debounce(this._onWindowScroll,300,this);BX.addCustomEvent("Grid::thereEditedRows",BX.proxy(this.disable,this));BX.addCustomEvent("Grid::noEditedRows",BX.proxy(this.enable,this));document.addEventListener("scroll",this.onscrollDebounceHandler,BX.Grid.Utils.listenerParams({passive:true}))}},destroy:function(){BX.removeCustomEvent("Grid::thereEditedRows",BX.proxy(this.disable,this));BX.removeCustomEvent("Grid::noEditedRows",BX.proxy(this.enable,this));document.removeEventListener("scroll",this.onscrollDebounceHandler,BX.Grid.Utils.listenerParams({passive:true}));this.unregisterObjects()},_onWindowScroll:function(){this.windowScrollTop=BX.scrollTop(window);this.rowsRectList=null},disable:function(){this.unregisterObjects()},enable:function(){this.reinit()},reinit:function(){this.unregisterObjects();this.setDefaultProps();this.init(this.parent)},getList:function(){return this.parent.getRows().getSourceBodyChild()},unregisterObjects:function(){this.list.forEach(this.unregister,this)},prepareListItems:function(){this.list.forEach(this.register,this)},register:function(t){var e=this.parent.getRows();if(e.get(t).isDraggable()){t.onbxdragstart=BX.delegate(this._onDragStart,this);t.onbxdrag=BX.delegate(this._onDrag,this);t.onbxdragstop=BX.delegate(this._onDragEnd,this);jsDD.registerObject(t)}},unregister:function(t){jsDD.unregisterObject(t)},getIndex:function(t){return BX.Grid.Utils.getIndex(this.list,t)},calcOffset:function(){var t=this.dragRect.height;if(this.additionalDragItems.length){this.additionalDragItems.forEach(function(e){t+=e.clientHeight})}return t},getTheadCells:function(t){return[].map.call(t,function(e,r){return{block:"",tag:"th",attrs:{style:"width: "+BX.width(t[r])+"px;"}}})},createFake:function(){var t=[];this.cloneDragItem=BX.clone(this.dragItem);this.cloneDragAdditionalDragItems=[];this.cloneDragAdditionalDragItemRows=[];var e=this.getTheadCells(this.dragItem.cells);t.push(this.cloneDragItem);this.additionalDragItems.forEach(function(e){var r=BX.clone(e);t.push(r);this.cloneDragAdditionalDragItems.push(r);this.cloneDragAdditionalDragItemRows.push(new BX.Grid.Row(this.parent,r))},this);var r=BX.width(this.parent.getTable());this.fake=BX.decl({block:"main-grid-fake-container",attrs:{style:"position: absolute; top: "+this.getDragStartRect().top+"px; width: "+r+"px"},content:{block:"main-grid-table",mix:"main-grid-table-fake",tag:"table",attrs:{style:"width: "+r+"px"},content:[{block:"main-grid-header",tag:"thead",content:{block:"main-grid-row-head",tag:"tr",content:e}},{block:"",tag:"tbody",content:t}]}});BX.insertAfter(this.fake,this.parent.getTable());this.cloneDragItem=new BX.Grid.Row(this.parent,this.cloneDragItem);return this.fake},getDragStartRect:function(){return BX.pos(this.dragItem,this.parent.getTable())},_onDragStart:function(){this.dragItem=jsDD.current_node;this.targetItem=this.dragItem;this.additionalDragItems=this.getAdditionalDragItems(this.dragItem);this.dragIndex=this.getIndex(this.dragItem);this.dragRect=this.getRowRect(this.dragItem,this.dragIndex);this.offset=this.calcOffset();this.dragStartOffset=jsDD.start_y-this.dragRect.top;this.dragEvent=new BX.Grid.RowDragEvent;this.dragEvent.setEventName("BX.Main.grid:rowDragStart");this.dragEvent.setDragItem(this.dragItem);this.dragEvent.setTargetItem(this.targetItem);this.dragEvent.allowInsertBefore();var t=this.parent.getRows().get(this.dragItem);this.startDragDepth=t.getDepth();this.startDragParentId=t.getParentId();this.createFake();BX.addClass(this.parent.getContainer(),this.parent.settings.get("classOnDrag"));BX.addClass(this.dragItem,this.parent.settings.get("classDragActive"));BX.onCustomEvent(window,"BX.Main.grid:rowDragStart",[this.dragEvent,this.parent])},getAdditionalDragItems:function(t){var e=this.parent.getRows();return e.getRowsByParentId(e.get(t).getId(),true).map(function(t){return t.getNode()})},moveRow:function(t,e,r){if(!!t){var i=BX.type.isNumber(r)?r:300;t.style.transition=i+"ms";t.style.transform="translate3d(0px, "+e+"px, 0px)"}},getDragOffset:function(){return jsDD.y-this.dragRect.top-this.dragStartOffset},getWindowScrollTop:function(){if(this.windowScrollTop===null){this.windowScrollTop=BX.scrollTop(window)}return this.windowScrollTop},getSortOffset:function(){return jsDD.y},getRowRect:function(t,e){if(!this.rowsRectList){this.rowsRectList={};this.list.forEach(function(t,e){this.rowsRectList[e]=t.getBoundingClientRect()},this)}return this.rowsRectList[e]},getRowCenter:function(t,e){var r=this.getRowRect(t,e);return r.top+this.getWindowScrollTop()+r.height/2},isDragToBottom:function(t,e){var r=this.getRowCenter(t,e);var i=this.getSortOffset();return e>this.dragIndex&&r<i},isMovedToBottom:function(t){return t.style.transform==="translate3d(0px, "+-this.offset+"px, 0px)"},isDragToTop:function(t,e){var r=this.getRowCenter(t,e);var i=this.getSortOffset();return e<this.dragIndex&&r>i},isMovedToTop:function(t){return t.style.transform==="translate3d(0px, "+this.offset+"px, 0px)"},isDragToBack:function(t,e){var r=this.getRowCenter(t,e);var i=this.dragIndex;var s=jsDD.y;return e>i&&s<r||e<i&&s>r},isMoved:function(t){return t.style.transform!=="translate3d(0px, 0px, 0px)"&&t.style.transform!==""},_onDrag:function(){var t=0;var e=0;this.moveRow(this.dragItem,this.getDragOffset(),t);this.moveRow(this.fake,this.getDragOffset(),t);BX.Grid.Utils.styleForEach(this.additionalDragItems,{transition:t+"ms",transform:"translate3d(0px, "+this.getDragOffset()+"px, 0px)"});this.list.forEach(function(t,r){if(!!t&&t!==this.dragItem&&this.additionalDragItems.indexOf(t)===-1){if(this.isDragToTop(t,r)&&!this.isMovedToTop(t)){this.targetItem=t;this.moveRow(t,this.offset);this.dragEvent.setEventName("BX.Main.grid:rowDragMove");this.dragEvent.setTargetItem(this.targetItem);BX.onCustomEvent(window,"BX.Main.grid:rowDragMove",[this.dragEvent,this.parent]);this.checkError(this.dragEvent);this.updateProperties(this.dragItem,this.targetItem);this.isDragetToTop=true}if(this.isDragToBottom(t,r)&&!this.isMovedToBottom(t)){this.targetItem=this.findNextVisible(this.list,r);this.moveRow(t,-this.offset);this.dragEvent.setEventName("BX.Main.grid:rowDragMove");this.dragEvent.setTargetItem(this.targetItem);BX.onCustomEvent(window,"BX.Main.grid:rowDragMove",[this.dragEvent,this.parent]);this.checkError(this.dragEvent);this.updateProperties(this.dragItem,this.targetItem);this.isDragetToTop=false}if(this.isDragToBack(t,r)&&this.isMoved(t)){this.moveRow(t,e);this.targetItem=t;if(this.isDragetToTop){this.targetItem=this.findNextVisible(this.list,r)}this.dragEvent.setEventName("BX.Main.grid:rowDragMove");this.dragEvent.setTargetItem(this.targetItem);BX.onCustomEvent(window,"BX.Main.grid:rowDragMove",[this.dragEvent,this.parent]);this.checkError(this.dragEvent);this.updateProperties(this.dragItem,this.targetItem)}}},this)},createError:function(t,e){var r=BX.decl({block:"main-grid-error",content:!!e?e:""});!!t&&t.appendChild(r);setTimeout(function(){BX.addClass(r,"main-grid-error-show")},0);return r},checkError:function(t){if(!t.isAllowedMove()&&!this.error){this.error=this.createError(this.fake,t.getErrorMessage())}if(t.isAllowedMove()&&this.error){BX.remove(this.error);this.error=null}},findNextVisible:function(t,e){var r=null;var i=this.parent.getRows();t.forEach(function(t,s){if(!r&&s>e){var n=i.get(t);if(n.isShown()){r=t}}});return r},updateProperties:function(t,e){var r=this.parent.getRows();var i=r.get(t);var s=0;var n=0;if(!!e){var a=r.get(e);s=a.getDepth();n=a.getParentId()}i.setDepth(s);i.setParentId(n);this.cloneDragItem.setDepth(s);this.cloneDragAdditionalDragItemRows.forEach(function(t,e){t.setDepth(BX.data(this.additionalDragItems[e],"depth"))},this)},resetDragProperties:function(){var t=this.parent.getRows().get(this.dragItem);t.setDepth(this.startDragDepth);t.setParentId(this.startDragParentId)},_onDragOver:function(){},_onDragLeave:function(){},_onDragEnd:function(){BX.onCustomEvent(window,"BX.Main.grid:rowDragEnd",[this.dragEvent,this.parent]);BX.removeClass(this.parent.getContainer(),this.parent.settings.get("classOnDrag"));BX.removeClass(this.dragItem,this.parent.settings.get("classDragActive"));BX.Grid.Utils.styleForEach(this.list,{transition:"",transform:""});if(this.dragEvent.isAllowedMove()){this.sortRows(this.dragItem,this.targetItem);this.sortAdditionalDragItems(this.dragItem,this.additionalDragItems);this.list=this.getList();this.parent.getRows().reset();var t=this.parent.getRows().get(this.dragItem);var e=this.parent.getRows().getBodyChild().map(function(t){return t.getId()});this.saveRowsSort(e);BX.onCustomEvent(window,"Grid::rowMoved",[e,t,this.parent])}else{this.resetDragProperties()}BX.remove(this.fake);this.setDefaultProps()},sortAdditionalDragItems:function(t,e){e.reduce(function(t,e){!!e&&BX.insertAfter(e,t);return e},t)},sortRows:function(t,e){if(!!e){e.parentNode.insertBefore(t,e)}else{t.parentNode.appendChild(t)}},saveRowsSort:function(t){var e={ids:t,action:this.parent.getUserOptions().getAction("GRID_SAVE_ROWS_SORT")};this.parent.getData().request(null,"POST",e)},setDefaultProps:function(){this.dragItem=null;this.targetItem=null;this.dragRect=null;this.dragIndex=null;this.offset=null;this.realX=null;this.realY=null;this.dragStartOffset=null;this.windowScrollTop=null;this.rowsRectList=null;this.error=false}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:87:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows.min.js?15441273845499";s:6:"source";s:68:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Rows=function(t){this.parent=null;this.rows=null;this.headChild=null;this.bodyChild=null;this.footChild=null;this.init(t)};BX.Grid.Rows.prototype={init:function(t){this.parent=t},reset:function(){this.rows=null;this.headChild=null;this.bodyChild=null;this.footChild=null},enableDragAndDrop:function(){this.parent.arParams["ALLOW_ROWS_SORT"]=true;if(!(this.parent.getRowsSortable()instanceof BX.Grid.RowsSortable)){this.parent.rowsSortable=new BX.Grid.RowsSortable(this.parent)}},disableDragAndDrop:function(){this.parent.arParams["ALLOW_ROWS_SORT"]=false;if(this.parent.getRowsSortable()instanceof BX.Grid.RowsSortable){this.parent.getRowsSortable().destroy();this.parent.rowsSortable=null}},getFootLastChild:function(){return this.getLast(this.getFootChild())},getFootFirstChild:function(){return this.getFirst(this.getFootChild())},getBodyLastChild:function(){return this.getLast(this.getBodyChild())},getBodyFirstChild:function(){return this.getFirst(this.getBodyChild())},getHeadLastChild:function(){return this.getLast(this.getHeadChild())},getHeadFirstChild:function(){return this.getFirst(this.getHeadChild())},getEditSelectedValues:function(){var t=this.getSelected();var e={};t.forEach(function(t){e[t.getId()]=t.editGetValues()});return e},getSelectedIds:function(){return this.getSelected().map(function(t){return t.getId()})},initSelected:function(){var t=this.getSelected();if(BX.type.isArray(t)&&t.length){t.forEach(function(t){t.initSelect()});this.parent.enableActionsPanel()}},editSelected:function(){this.getSelected().forEach(function(t){t.edit()});BX.onCustomEvent(window,"Grid::thereEditedRows",[])},editSelectedCancel:function(){this.getSelected().forEach(function(t){t.editCancel()});BX.onCustomEvent(window,"Grid::noEditedRows",[])},isSelected:function(){return this.getBodyChild().some(function(t){return t.isShown()&&t.isSelected()})},isAllSelected:function(){return!this.getBodyChild().some(function(t){return!t.isSelected()})},getParent:function(){return this.parent},getCountSelected:function(){var t;try{t=this.getSelected().filter(function(t){return!t.isNotCount()&&t.isShown()}).length}catch(e){t=0}return t},getCountDisplayed:function(){var t;try{t=this.getBodyChild().filter(function(t){return t.isShown()&&!t.isNotCount()}).length}catch(e){t=0}return t},addRows:function(t){var e=BX.findChild(this.getParent().getTable(),{tag:"TBODY"},true,false);t.forEach(function(t){e.appendChild(t)})},getRows:function(){var t;var e=this;if(!this.rows){t=[].slice.call(this.getParent().getTable().querySelectorAll("tr[data-id], thead > tr"));this.rows=t.map(function(t){return new BX.Grid.Row(e.parent,t)})}return this.rows},getSelected:function(){return this.getBodyChild().filter(function(t){return t.isShown()&&t.isSelected()})},normalizeNode:function(t){if(!BX.hasClass(t,this.getParent().settings.get("classBodyRow"))){t=BX.findParent(t,{className:this.getParent().settings.get("classBodyRow")},true,false)}return t},getById:function(t){t=t.toString();var e=this.getBodyChild();var n=e.filter(function(e){return e.getId()===t});return n.length===1?n[0]:null},get:function(t){var e=null;var n;if(BX.type.isDomNode(t)){t=this.normalizeNode(t);n=this.getRows().filter(function(e){return t===e.getNode()});if(n.length){e=n[0]}}return e},getLast:function(t){var e;try{e=t[t.length-1]}catch(t){e=null}return e},getFirst:function(t){var e;try{e=t[0]}catch(t){e=null}return e},getHeadChild:function(){this.headChild=this.headChild||this.getRows().filter(function(t){return t.isHeadChild()});return this.headChild},getBodyChild:function(){this.bodyChild=this.bodyChild||this.getRows().filter(function(t){return t.isBodyChild()});return this.bodyChild},getFootChild:function(){this.footChild=this.footChild||this.getRows().filter(function(t){return t.isFootChild()});return this.footChild},selectAll:function(){this.getRows().map(function(t){t.isShown()&&t.select()})},unselectAll:function(){this.getRows().map(function(t){t.unselect()})},getByIndex:function(t){var e=this.getBodyChild().filter(function(t){return t}).filter(function(e){return e.getNode().rowIndex===t});return e.length?e[0]:null},getRowsByParentId:function(t,e){var n=[];var i=this;if(!t){return n}t=t.toString();function r(t){i.getBodyChild().forEach(function(i){if(i.getParentId()===t){n.push(i);e&&r(i.getId())}},i)}r(t);return n},getRowsByGroupId:function(t){var e=[];var n=this;if(!t){return e}t=t.toString();function i(t){n.getBodyChild().forEach(function(n){if(n.getGroupId()===t&&!n.isCustom()){e.push(n)}},n)}i(t);return e},getExpandedRows:function(){return this.getRows().filter(function(t){return t.isShown()&&t.isExpand()})},getIdsExpandedRows:function(){return this.getExpandedRows().map(function(t){return t.getId()})},getIdsCollapsedGroups:function(){return this.getRows().filter(function(t){return t.isCustom()&&!t.isExpand()}).map(function(t){return t.getId()})},getSourceRows:function(){return BX.Grid.Utils.getBySelector(this.getParent().getTable(),[".main-grid-header > tr",".main-grid-header + tbody > tr"].join(", "))},getSourceBodyChild:function(){return this.getSourceRows().filter(function(t){return BX.Grid.Utils.closestParent(t).nodeName==="TBODY"})},getSourceHeadChild:function(){return this.getSourceRows().filter(function(t){return BX.Grid.Utils.closestParent(t).nodeName==="THEAD"})},getSourceFootChild:function(){return this.getSourceRows().filter(function(t){return BX.Grid.Utils.closestParent(t).nodeName==="TFOOT"})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:105:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window-column.min.js?15441273843904";s:6:"source";s:86:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window-column.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.SettingsWindowColumn=function(t,e){this.node=null;this.label=null;this.checkbox=null;this.editButton=null;this.settings=null;this.parent=null;this.default=null;this.defaultTitle=null;this.state=null;this.lastTitle=null;this.init(t,e)};BX.Grid.SettingsWindowColumn.inited={};BX.Grid.SettingsWindowColumn.prototype={init:function(t,e){this.parent=t;this.node=e;try{this.lastTitle=e.querySelector("label").innerText.trim()}catch(t){}this.updateState();if(!BX.Grid.SettingsWindowColumn.inited[this.getId()]){BX.Grid.SettingsWindowColumn.inited[this.getId()]=true;BX.bind(this.getEditButton(),"click",BX.proxy(this.onEditButtonClick,this));BX.bind(this.getStickyButton(),"click",BX.proxy(this.onStickyButtonClick,this))}},getStickyButton:function(){return this.node.querySelector(".main-grid-settings-window-list-item-sticky-button")},isSticked:function(){return this.node.classList.contains("main-grid-settings-window-list-item-sticked")},onStickyButtonClick:function(){if(this.isSticked()){this.unstick()}else{this.stick()}},stick:function(){this.node.classList.add("main-grid-settings-window-list-item-sticked")},unstick:function(){this.node.classList.remove("main-grid-settings-window-list-item-sticked")},onEditButtonClick:function(t){t.stopPropagation();this.isEditEnabled()?this.disableEdit():this.enableEdit()},setState:function(t){this.state=t},getState:function(){return this.state},updateState:function(){this.setState({selected:this.isSelected(),sticked:this.isSticked(),title:this.getTitle()})},restoreState:function(){var t=this.getState();t.selected?this.select():this.unselect();t.sticked?this.stick():this.unstick();this.setTitle(t.title)},getId:function(){return this.getNode().dataset.name},getTitle:function(){return this.getLabel().innerText},setTitle:function(t){this.getLabel().innerText=!!t&&t!=="undefined"?t:this.getDefaultTitle()},isEdited:function(){return this.getTitle()!==this.getDefaultTitle()},getSettings:function(){if(this.settings===null){var t=this.parent.getParam("DEFAULT_COLUMNS");this.settings=this.getId()in t?t[this.getId()]:{}}return this.settings},isDefault:function(){if(this.default===null){var t=this.getSettings();this.default="default"in t?t.default:false}return this.default},restore:function(){this.isDefault()?this.select():this.unselect();this.setTitle(this.getDefaultTitle());this.node.dataset.stickedDefault==="true"?this.stick():this.unstick();this.disableEdit();this.updateState()},getDefaultTitle:function(){if(this.defaultTitle===null){var t=this.getSettings();this.defaultTitle="name"in t?t.name:this.lastTitle}return this.defaultTitle},getNode:function(){return this.node},getLabel:function(){if(this.label===null){this.label=BX.Grid.Utils.getByTag(this.getNode(),"label",true)}return this.label},getCheckbox:function(){if(this.checkbox===null){this.checkbox=BX.Grid.Utils.getBySelector(this.getNode(),'input[type="checkbox"]',true)}return this.checkbox},getEditButton:function(){if(this.editButton===null){this.editButton=BX.Grid.Utils.getByClass(this.getNode(),this.parent.settings.get("classSettingsWindowColumnEditButton"),true)}return this.editButton},enableEdit:function(){this.getLabel().contentEditable=true;this.getCheckbox().disabled=true;this.adjustCaret()},disableEdit:function(){this.getLabel().contentEditable=false;this.getCheckbox().disabled=false},isEditEnabled:function(){return this.getLabel().isContentEditable},isSelected:function(){return this.getCheckbox().checked},select:function(){this.getCheckbox().checked=true},unselect:function(){this.getCheckbox().checked=false},adjustCaret:function(){var t=document.createRange();var e=window.getSelection();var i=this.getLabel().innerText.length;var s=this.getLabel().childNodes;var n=s[s.length-1];t.setStart(n,i);t.setEnd(n,i);t.collapse(true);e.removeAllRanges();e.addRange(t);BX.fireEvent(this.getNode(),"focus")}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:99:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window.min.js?154412738410469";s:6:"source";s:79:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.SettingsWindow=function(t){this.parent=null;this.popupItems=null;this.items=null;this.popup=null;this.sourceContent=null;this.applyButton=null;this.resetButton=null;this.cancelButton=null;this.init(t);BX.onCustomEvent(window,"BX.Grid.SettingsWindow:init",[this])};BX.Grid.SettingsWindow.prototype={init:function(t){this.parent=t;BX.bind(this.parent.getContainer(),"click",BX.proxy(this._onContainerClick,this));BX.addCustomEvent(window,"Grid::columnMoved",BX.proxy(this._onColumnMoved,this))},destroy:function(){BX.unbind(this.parent.getContainer(),"click",BX.proxy(this._onContainerClick,this));BX.removeCustomEvent(window,"Grid::columnMoved",BX.proxy(this._onColumnMoved,this));this.getPopup().close()},getSelectAllButton:function(){if(!this.selectAllButton){this.selectAllButton=BX.Grid.Utils.getByClass(this.getPopup().contentContainer,this.parent.settings.get("classSettingsWindowSelectAll"),true)}return this.selectAllButton},getUnselectAllButton:function(){if(!this.unselectAllButton){this.unselectAllButton=BX.Grid.Utils.getByClass(this.getPopup().contentContainer,this.parent.settings.get("classSettingsWindowUnselectAll"),true)}return this.unselectAllButton},reset:function(){this.popupItems=null;this.allColumns=null;this.items=null},_onContainerClick:function(t){if(BX.hasClass(t.target,this.parent.settings.get("classSettingsButton"))){this._onSettingsButtonClick(t)}},_onSettingsButtonClick:function(){BX.onCustomEvent(window,"BX.Grid.SettingsWindow:show",[this]);this.getPopup().show()},fetchColumns:function(){var t=new BX.Promise;BX.ajax({url:this.parent.getParam("LAZY_LOAD")["GET_LIST"],method:"GET",dataType:"json",onsuccess:t.fulfill.bind(t)});return t},prepareColumnOptions:function(t){var e=this.parent.getUserOptions().getCurrentOptions().custom_names;if(BX.type.isPlainObject(t)){if(BX.type.isPlainObject(e)){if(t.id in e){t.name=e[t.id]}}if(this.parent.getColumnHeaderCellByName(t.id)){t.selected=true}}return t},createColumnElement:function(t){var e='<div data-name="'+t.id+'" class="main-grid-settings-window-list-item">'+'<input id="'+t.id+'-checkbox" type="checkbox" class="main-grid-settings-window-list-item-checkbox"'+(t.selected?" checked":"")+">"+'<label for="'+t.id+'-checkbox" class="main-grid-settings-window-list-item-label">'+t.name+"</label>"+'<span class="main-grid-settings-window-list-item-edit-button"></span>'+"</div>";return BX.create("div",{html:e}).firstElementChild},useLazyLoadColumns:function(){return!!this.parent.getParam("LAZY_LOAD")},getSourceContent:function(){if(!this.sourceContent){this.sourceContent=BX.Grid.Utils.getByClass(this.parent.getContainer(),this.parent.settings.get("classSettingsWindow"),true);if(this.useLazyLoadColumns()){this.contentList=this.sourceContent.querySelector(".main-grid-settings-window-list");this.contentList.innerHTML="";var t=new BX.Loader({target:this.contentList});t.show();this.fetchColumns().then(function(e){e.forEach(function(t){t=this.prepareColumnOptions(t);this.contentList.appendChild(this.createColumnElement(t))},this);t.hide().then(function(){t.destroy()});this.reset();this.getItems().forEach(function(t){BX.bind(t.getNode(),"click",BX.delegate(this.onItemClick,this))},this);this.fixedFooter=BX.create("div",{props:{className:"main-grid-popup-window-buttons-wrapper"},children:[this.sourceContent.querySelector(".popup-window-buttons")]});requestAnimationFrame(function(){this.popup.popupContainer.appendChild(this.fixedFooter);this.fixedFooter.style.width=this.popup.popupContainer.clientWidth+"px"}.bind(this))}.bind(this))}}return this.sourceContent},getPopupItems:function(){var t;if(!this.popupItems){t=this.getPopup().contentContainer;this.popupItems=BX.Grid.Utils.getByClass(t,this.parent.settings.get("classSettingsWindowColumn"))}return this.popupItems},getSelectedColumns:function(){var t=[];this.getItems().forEach(function(e){e.isSelected()&&t.push(e.getId())});return t},restoreColumns:function(){this.getItems().forEach(function(t){t.restore()});this.sortItems();this.reset()},restoreLastColumns:function(){this.getItems().forEach(function(t){t.restoreState()})},updateColumnsState:function(){this.getItems().forEach(function(t){t.updateState()})},getStickedColumns:function(){return this.getItems().reduce(function(t,e){if(e.isSticked()){t.push(e.getId())}return t},[])},saveColumns:function(t,e){var n=this.parent.getUserOptions();var i=this.getColumnNames();var s=this.getStickedColumns();var o=[];o.push({action:n.getAction("GRID_SET_COLUMNS"),columns:t.join(",")});o.push({action:n.getAction("SET_CUSTOM_NAMES"),custom_names:i});o.push({action:n.getAction("GRID_SET_STICKED_COLUMNS"),stickedColumns:s});if(this.isForAll()){o.push({action:n.getAction("GRID_SAVE_SETTINGS"),view_id:"default",set_default_settings:"Y",delete_user_settings:"Y"})}n.batch(o,BX.delegate(function(){this.parent.reloadTable(null,null,e)},this));this.updateColumnsState()},disableAllColumnslabelEdit:function(){this.getItems().forEach(function(t){t.disableEdit()})},getAllColumns:function(){if(!this.allColumns){this.allColumns=this.getItems().map(function(t){return t.getId()})}return this.allColumns},isShowedColumn:function(t){return this.getSelectedColumns().some(function(e){return e===t})},getShowedColumns:function(){var t=[];var e=this.parent.getRows().getHeadFirstChild().getCells();[].slice.call(e).forEach(function(e){if("name"in e.dataset){t.push(e.dataset.name)}});return t},sortItems:function(){var t=this.getShowedColumns();var e={};this.getAllColumns().forEach(function(t){e[t]=t},this);var n=0;Object.keys(e).forEach(function(i){if(this.isShowedColumn(i)){e[i]=t[n];n++}var s=this.getColumnByName(e[i]);s&&s.parentNode.appendChild(s)},this)},getColumnNames:function(){var t={};this.getItems().map(function(e){if(e.isEdited()){t[e.getId()]=e.getTitle()}});return t},getColumnByName:function(t){return BX.Grid.Utils.getBySelector(this.getPopup().popupContainer,"."+this.parent.settings.get("classSettingsWindowColumn")+'[data-name="'+t+'"]',true)},_onColumnMoved:function(){this.sortItems();this.reset()},onResetButtonClick:function(){this.parent.confirmDialog({CONFIRM:true,CONFIRM_MESSAGE:this.parent.arParams.CONFIRM_RESET_MESSAGE},BX.delegate(function(){this.enableWait(this.getApplyButton());this.parent.getUserOptions().reset(this.isForAll(),BX.delegate(function(){this.parent.reloadTable(null,null,BX.delegate(function(){this.restoreColumns();this.disableWait(this.getApplyButton());this.getPopup().close()},this))},this))},this))},getResetButtonId:function(){return this.parent.getContainerId()+"-grid-settings-reset-button"},onApplyButtonClick:function(){this.parent.confirmDialog({CONFIRM:this.isForAll(),CONFIRM_MESSAGE:this.parent.getParam("SETTINGS_FOR_ALL_CONFIRM_MESSAGE")},BX.delegate(function(){this.enableWait(this.getApplyButton());this.saveColumns(this.getSelectedColumns(),BX.delegate(function(){this.getPopup().close();this.disableWait(this.getApplyButton());this.unselectForAllCheckbox()},this));BX.onCustomEvent(window,"BX.Grid.SettingsWindow:save",[this])},this),BX.delegate(function(){this.unselectForAllCheckbox()},this))},getApplyButtonId:function(){return this.parent.getContainerId()+"-grid-settings-apply-button"},getApplyButton:function(){if(this.applyButton===null){this.applyButton=BX(this.getApplyButtonId())}return this.applyButton},getCancelButtonId:function(){return this.parent.getContainerId()+"-grid-settings-cancel-button"},getCancelButton:function(){if(this.cancelButton===null){this.cancelButton=BX(this.getCancelButtonId())}return this.cancelButton},unselectForAllCheckbox:function(){var t=this.getForAllCheckbox();t&&(t.checked=null)},enableWait:function(t){BX.addClass(t,"webform-small-button-wait");BX.removeClass(t,"popup-window-button")},disableWait:function(t){BX.removeClass(t,"webform-small-button-wait");BX.addClass(t,"popup-window-button")},createTitle:function(){var t=BX.create("div");var e=BX("pagetitle");var n=!!e?"&laquo;"+e.innerText+"&raquo;":"";t.innerHTML="<span>"+this.parent.getParam("SETTINGS_TITLE")+" "+n+"</span>";return t.firstChild.innerText},getPopupId:function(){return this.parent.getContainerId()+"-grid-settings-window"},createPopup:function(){if(!this.popup){this.popup=new BX.PopupWindow(this.getPopupId(),null,{titleBar:this.createTitle(),autoHide:false,overlay:.6,width:1e3,closeIcon:true,closeByEsc:true,contentNoPaddings:true,content:this.getSourceContent(),events:{onPopupClose:BX.delegate(this.onPopupClose,this)}});this.getItems().forEach(function(t){BX.bind(t.getNode(),"click",BX.delegate(this.onItemClick,this))},this);BX.bind(this.getResetButton(),"click",BX.proxy(this.onResetButtonClick,this));BX.bind(this.getApplyButton(),"click",BX.proxy(this.onApplyButtonClick,this));BX.bind(this.getCancelButton(),"click",BX.proxy(this.popup.close,this.popup));BX.bind(this.getSelectAllButton(),"click",BX.delegate(this.onSelectAll,this));BX.bind(this.getUnselectAllButton(),"click",BX.delegate(this.onUnselectAll,this))}return this.popup},onItemClick:function(){this.adjustActionButtonsState()},getItems:function(){if(this.items===null){this.items=this.getPopupItems().map(function(t){return new BX.Grid.SettingsWindowColumn(this.parent,t)},this)}return this.items},onPopupClose:function(){BX.onCustomEvent(window,"BX.Grid.SettingsWindow:close",[this]);this.restoreLastColumns();this.disableAllColumnslabelEdit();this.adjustActionButtonsState()},getPopup:function(){return!!this.popup?this.popup:this.popup=this.createPopup()},onSelectAll:function(){this.selectAll();this.enableActions()},onUnselectAll:function(){this.unselectAll();this.disableActions()},selectAll:function(){this.getItems().forEach(function(t){t.select()})},unselectAll:function(){this.getItems().forEach(function(t){t.unselect()})},isForAll:function(){var t=this.getForAllCheckbox();return t&&!!t.checked},getForAllCheckbox:function(){return BX.Grid.Utils.getByClass(this.getPopup().popupContainer,"main-grid-settings-window-for-all-checkbox",true)},getResetButton:function(){if(this.resetButton===null){this.resetButton=BX(this.getResetButtonId())}return this.resetButton},disableActions:function(){var t=this.getApplyButton();if(!!t){BX.addClass(t,this.parent.settings.get("classDisable"))}},enableActions:function(){var t=this.getApplyButton();if(!!t){BX.removeClass(t,this.parent.settings.get("classDisable"))}},adjustActionButtonsState:function(){if(this.getSelectedColumns().length){this.enableActions()}else{this.disableActions()}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings.min.js?15441273845162";s:6:"source";s:72:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Settings=function(){this.settings={};this.defaultSettings={classContainer:"main-grid",classWrapper:"main-grid-wrapper",classTable:"main-grid-table",classScrollContainer:"main-grid-container",classFadeContainer:"main-grid-fade",classFadeContainerRight:"main-grid-fade-right",classFadeContainerLeft:"main-grid-fade-left",classNavPanel:"main-grid-nav-panel",classActionPanel:"main-grid-action-panel",classCursor:"main-grid-cursor",classRowCustom:"main-grid-row-custom",classMoreButton:"main-grid-more-btn",classRow:"main-grid-row",classHeadRow:"main-grid-row-head",classBodyRow:"main-grid-row-body",classFootRow:"main-grid-row-foot",classDataRows:"main-grid-row-data",classPanels:"main-grid-bottom-panels",classCellHeadContainer:"main-grid-cell-head-container",classCellHeadOndrag:"main-grid-cell-head-ondrag",classEmptyRows:"main-grid-row-empty",classEmptyBlock:"main-grid-empty-block",classCheckAllCheckboxes:"main-grid-check-all",classCheckedRow:"main-grid-row-checked",classRowCheckbox:"main-grid-row-checkbox",classPagination:"main-grid-panel-cell-pagination",classActionCol:"main-grid-cell-action",classCounterDisplayed:"main-grid-counter-displayed",classCounterSelected:"main-grid-counter-selected",classCounterTotal:"main-grid-panel-total",classTableFade:"main-grid-table-fade",classDragActive:"main-grid-on-row-drag",classResizeButton:"main-grid-resize-button",classOnDrag:"main-grid-ondrag",classDisableDrag:"main-grid-row-drag-disabled",classPanelCellContent:"main-grid-panel-content",classCollapseButton:"main-grid-plus-button",classRowStateLoad:"main-grid-load-row",classRowStateExpand:"main-grid-row-expand",classHeaderSortable:"main-grid-col-sortable",classHeaderNoSortable:"main-grid-col-no-sortable",classCellStatic:"main-grid-cell-static",classHeadCell:"main-grid-cell-head",classPageSize:"main-grid-panel-select-pagesize",classGroupEditButton:"main-grid-control-panel-action-edit",classGroupDeleteButton:"main-grid-control-panel-action-remove",classGroupActionsDisabled:"main-grid-control-panel-action-icon-disable",classPanelButton:"main-grid-buttons",classPanelApplyButton:"main-grid-control-panel-apply-button",classPanelCheckbox:"main-grid-panel-checkbox",classEditor:"main-grid-editor",classEditorContainer:"main-grid-editor-container",classEditorText:"main-grid-editor-text",classEditorDate:"main-grid-editor-date",classEditorNumber:"main-grid-editor-number",classEditorRange:"main-grid-editor-range",classEditorCheckbox:"main-grid-editor-checkbox",classEditorTextarea:"main-grid-editor-textarea",classEditorCustom:"main-grid-editor-custom",classCellContainer:"main-grid-cell-content",classEditorOutput:"main-grid-editor-output",classSettingsWindow:"main-grid-settings-window",classSettingsWindowColumn:"main-grid-settings-window-list-item",classSettingsWindowColumnLabel:"main-grid-settings-window-list-item-label",classSettingsWindowColumnEditState:"main-grid-settings-window-list-item-edit",classSettingsWindowColumnEditInput:"main-grid-settings-window-list-item-edit-input",classSettingsWindowColumnEditButton:"main-grid-settings-window-list-item-edit-button",classSettingsWindowColumnCheckbox:"main-grid-settings-window-list-item-checkbox",classSettingsWindowShow:"main-grid-settings-window-show",classSettingsWindowSelectAll:"main-grid-settings-window-select-all",classSettingsWindowUnselectAll:"main-grid-settings-window-unselect-all",classSettingsButton:"main-grid-interface-settings-icon",classSettingsButtonActive:"main-grid-interface-settings-icon-active",classSettingsWindowClose:"main-grid-settings-window-actions-item-close",classSettingsWindowReset:"main-grid-settings-window-actions-item-reset",classSettingsWindowColumnChecked:"main-grid-settings-window-list-item-checked",classShowAnimation:"main-grid-show-popup-animation",classCloseAnimation:"main-grid-close-popup-animation",classLoader:"main-grid-loader-container",classLoaderShow:"main-grid-show-loader",classLoaderHide:"main-grid-hide-loader",classRowError:"main-grid-error",loaderHideAnimationName:"hideLoader",classHide:"main-grid-hide",classEar:"main-grid-ear",classEarLeft:"main-grid-ear-left",classEarRight:"main-grid-ear-right",classNotCount:"main-grid-not-count",classCounter:"main-grid-panel-counter",classForAllCounterEnabled:"main-grid-panel-counter-for-all-enable",classLoad:"load",classRowActionButton:"main-grid-row-action-button",classDropdown:"main-dropdown",classPanelControl:"main-grid-panel-control",classPanelControlContainer:"main-grid-panel-control-container",classForAllCheckbox:"main-grid-for-all-checkbox",classDisable:"main-grid-disable",dataActionsKey:"actions",updateActionMore:"more",classShow:"show",classGridShow:"main-grid-show",updateActionPagination:"pagination",updateActionSort:"sort",ajaxIdDataProp:"ajaxid",pageSizeId:"grid_page_size",sortableRows:true,sortableColumns:true,animationDuration:300};this.prepare()};BX.Grid.Settings.prototype={prepare:function(){this.settings=this.defaultSettings},getDefault:function(){return this.defaultSettings},get:function(i){var a;try{a=this.getDefault()[i]}catch(i){a=null}return a},getList:function(){return this.getDefault()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/submenu.min.js?15441273841316";s:6:"source";s:71:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/submenu.js";s:3:"min";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/submenu.min.js";s:3:"map";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/submenu.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Main");BX.Main.submenu={data:[],init:function(t,n,i,o){this.id=n;this.anchor=t;this.menuItems=o;this.level=i;this.anchorRect=BX.pos(this.anchor);this.toggleMenu()},toggleMenu:function(){var t;var n;var i;var o=this.anchor.menu;var e=o?this.anchor.menu.popupWindow:null;if(o&&e.isShown()){t=e.bindOptions.left;this.data.forEach(function(o){i=o.popupWindow;n=i.bindOptions.left;if(t<=n){o.popupWindow.close()}})}else{BX.PopupMenu.destroy(this.id);this.anchor.menu=this.createMenu();this.pushMenu(this.anchor.menu);this.anchor.menu.popupWindow.adjustPosition(BX.pos(this.anchor));this.anchor.menu.popupWindow.show();o=this.anchor.menu;e=o.popupWindow;t=e.bindOptions.left;this.data.forEach(function(e){i=e.popupWindow;n=i.bindOptions.left;if(t<=n&&o.id!==e.id){e.popupWindow.close()}})}},pushMenu:function(t){var n=this.getMenu(t);if(t){if(n===null){this.data.push(t)}else{this.data[n]=t}}},getMenu:function(t){var n=null;this.data.forEach(function(i,o){if(i.id===t.id){n=o;return false}});return n},createMenu:function(){return BX.PopupMenu.create(this.id,this.anchor,this.menuItems,{autoHide:true,offsetTop:-(this.anchorRect.height/2+26),offsetLeft:this.anchorRect.width+4,angle:{position:"left",offset:this.anchorRect.height/2-8}})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:94:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/useroptions.min.js?15441273842994";s:6:"source";s:75:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/useroptions.js";s:3:"min";s:79:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/useroptions.min.js";s:3:"map";s:79:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/useroptions.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.UserOptions=function(t,i,e,s){this.options=null;this.actions=null;this.parent=null;this.url=null;this.init(t,i,e,s)};BX.Grid.UserOptions.prototype={init:function(parent,userOptions,userOptionsActions,url){this.url=url;this.parent=parent;try{this.options=eval(userOptions)}catch(err){console.warn("BX.Grid.UserOptions.init: Failed parse user options json string")}try{this.actions=eval(userOptionsActions)}catch(err){console.warn("BX.Grid.UserOptions.init: Failed parse user options actions json string")}},getCurrentViewName:function(){var t=this.getOptions();return"current_view"in t?t.current_view:null},getViewsList:function(){var t=this.getOptions();return"views"in t?t.views:{}},getCurrentOptions:function(){var t=this.getCurrentViewName();var i=this.getViewsList();var e=null;if(t in i){e=i[t]}if(!BX.type.isPlainObject(e)){e={}}return e},getUrl:function(t){return BX.util.add_url_param(this.url,{GRID_ID:this.parent.getContainerId(),bxajaxid:this.parent.getAjaxId(),action:t})},getOptions:function(){return this.options||{}},getActions:function(){return this.actions},getAction:function(t){var i=null;try{i=this.getActions()[t]}catch(e){i=null}return i},update:function(t){this.options=t},setColumns:function(t,i){var e=this.getCurrentOptions();if(BX.type.isPlainObject(e)){e.columns=t.join(",");this.save(this.getAction("GRID_SET_COLUMNS"),{columns:e.columns},i)}return this},setColumnsNames:function(t,i){var e={view_id:"default"};if(BX.type.isPlainObject(e)){e.custom_names=t;this.save(this.getAction("SET_CUSTOM_NAMES"),e,i)}return this},setColumnSizes:function(t,i){this.save(this.getAction("GRID_SET_COLUMN_SIZES"),{sizes:t,expand:i})},reset:function(t,i){var e={};if(!!t){e={view_id:"default",set_default_settings:"Y",delete_user_settings:"Y",view_settings:this.getCurrentOptions()}}this.save(this.getAction("GRID_RESET"),e,i)},setSort:function(t,i,e){if(t&&i){this.save(this.getAction("GRID_SET_SORT"),{by:t,order:i},e)}return this},setPageSize:function(t,i){if(BX.type.isNumber(parseInt(t))){this.save(this.getAction("GRID_SET_PAGE_SIZE"),{pageSize:t},i)}},setExpandedRows:function(t,i){BX.type.isArray(t)&&this.save(this.getAction("GRID_SET_EXPANDED_ROWS"),{ids:t},i)},setCollapsedGroups:function(t,i){BX.type.isArray(t)&&this.save(this.getAction("GRID_SET_COLLAPSED_GROUPS"),{ids:t},i)},resetExpandedRows:function(){this.save(this.getAction("GRID_RESET_EXPANDED_ROWS"),{})},saveForAll:function(t){this.save(this.getAction("GRID_SAVE_SETTINGS"),{view_id:"default",set_default_settings:"Y",delete_user_settings:"Y",view_settings:this.getCurrentOptions()},t)},batch:function(t,i){this.save(this.getAction("GRID_SAVE_BATH"),{bath:t},i)},save:function(t,i,e){var s=this;BX.ajax.post(this.getUrl(t),i,function(t){try{t=JSON.parse(t);if(!t.error){s.update(t);if(BX.type.isFunction(e)){e(t)}BX.onCustomEvent(s.parent.getContainer(),"Grid::optionsChanged",[s.parent])}}catch(i){}})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:88:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/utils.min.js?15441273842120";s:6:"source";s:69:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/utils.js";s:3:"min";s:73:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/utils.min.js";s:3:"map";s:73:"/bitrix/components/bitrix/main.ui.grid/templates/.default/js/utils.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Grid");BX.Grid.Utils={ajaxUrl:function(e,n){return this.addUrlParams(e,{bxajaxid:n})},addUrlParams:function(e,n){return BX.util.add_url_param(e,n)},arrayMove:function(e,n,t){if(t>=e.length){var i=t-e.length;while(i--+1){e.push(undefined)}}e.splice(t,0,e.splice(n,1)[0]);return e},getIndex:function(e,n){return[].indexOf.call(e||[],n)},getNext:function(e){if(e){return e.nextElementSibling||null}},getPrev:function(e){if(e){return e.previousElementSibling||null}},closestParent:function(e,n){if(e){if(!n){return e.parentNode||null}else{return BX.findParent(e,{className:n})}}},closestChilds:function(e){if(e){return e.children||null}},collectionSort:function(e,n){var t,i,l,r,a;if(e&&n&&e!==n&&e.parentNode===n.parentNode){t=this.closestParent(n);i=this.closestChilds(t);l=i.length;r=this.getIndex(i,e);a=this.getIndex(i,n);if(l===a){t.appendChild(n)}if(r>a){t.insertBefore(e,n)}if(r<a&&l!==a){t.insertBefore(e,this.getNext(n))}}},getColumn:function(e,n){var t=this.getIndex(this.closestChilds(this.closestParent(n)),n);var i=[];[].forEach.call(e.rows,function(e){i.push(e.cells[t])});return i},styleForEach:function(e,n){n=BX.type.isPlainObject(n)?n:null;var t=Object.keys(n);[].forEach.call(e||[],function(e){t.forEach(function(t){BX.style(e,t,n[t])})})},requestAnimationFrame:function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};e.apply(window,arguments)},getByClass:function(e,n,t){var i=[];if(n){i=e?e.getElementsByClassName(n):[];if(t){i=i.length?i[0]:null}else{i=[].slice.call(i)}}return i},getByTag:function(e,n,t){var i=[];if(n){i=e?e.getElementsByTagName(n):[];if(t){i=i.length?i[0]:null}else{i=[].slice.call(i)}}return i},getBySelector:function(e,n,t){var i=[];if(n){if(t){i=e?e.querySelector(n):null}else{i=e?e.querySelectorAll(n):[];i=[].slice.call(i)}}return i},listenerParams:function(e){try{window.addEventListener("test",null,e)}catch(n){e=false}return e}}})();
/* End */
;; /* /bitrix/components/bitrix/socialnetwork.admin.set/templates/.default/script.js?15441274532527*/
; /* /bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/script.min.js?154412746160*/
; /* /bitrix/components/bitrix/main.interface.buttons/templates/.default/script.min.js?154412738440309*/
; /* /bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.min.js?1544127384575*/
; /* /bitrix/components/bitrix/tasks.interface.topmenu/templates/.default/logic.min.js?15441274611848*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/script.min.js?154412738430926*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/action-panel.min.js?154412738411619*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/baseclass.min.js?1544127384207*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/cols-sortable.min.js?15441273845645*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/data.min.js?15441273845089*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown-manager.min.js?1544127384996*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/dropdown.min.js?15441273843586*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/element.min.js?1544127384857*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/fader.min.js?15441273846023*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/gridupdater.min.js?15441273842660*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/inline-editor.min.js?15441273844903*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/loader.min.js?15441273841753*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/manager.min.js?1544127384903*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/message.min.js?15441273841603*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/observer.min.js?1544127384175*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/oldgrid.min.js?154412738437682*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagesize.min.js?1544127384593*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/pagination.min.js?1544127384842*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-header.min.js?15441273843104*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/pin-panel.min.js?15441273844993*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/resize.min.js?15441273843776*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/row.min.js?154412738416243*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows-sortable.min.js?154412738410600*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/rows.min.js?15441273845499*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window-column.min.js?15441273843904*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings-window.min.js?154412738410469*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/settings.min.js?15441273845162*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/submenu.min.js?15441273841316*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/useroptions.min.js?15441273842994*/
; /* /bitrix/components/bitrix/main.ui.grid/templates/.default/js/utils.min.js?15441273842120*/

//# sourceMappingURL=page_eb75e665c92d210befd22a16a51f46ce.map.js
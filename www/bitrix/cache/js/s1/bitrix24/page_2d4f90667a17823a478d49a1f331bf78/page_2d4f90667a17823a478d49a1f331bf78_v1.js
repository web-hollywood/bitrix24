
; /* Start:"a:4:{s:4:"full";s:92:"/bitrix/components/bitrix/lists.element.edit/templates/.default/script.min.js?15441274328268";s:6:"source";s:73:"/bitrix/components/bitrix/lists.element.edit/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
BX.namespace("BX.Lists");BX.Lists.ListsElementEditClass=function(){var t=function(t){this.randomString=t.randomString;this.urlTabBp=t.urlTabBp;this.iblockTypeId=t.iblockTypeId;this.iblockId=t.iblockId;this.elementId=t.elementId;this.socnetGroupId=t.socnetGroupId;this.sectionId=t.sectionId;this.jsClass="ListsElementEditClass_"+t.randomString;this.elementUrl=t.elementUrl;this.listAction=t.listAction;this.isConstantsTuned=t.isConstantsTuned;this.init()};t.prototype.init=function(){this.ajaxUrl="/bitrix/components/bitrix/lists.element.edit/ajax.php";this.actionButton=BX("lists-title-action");this.actionPopupItems=[];this.actionPopupObject=null;this.actionPopupId="lists-title-action";BX.bind(this.actionButton,"click",BX.delegate(this.showListAction,this));if(this.isConstantsTuned)this.setConstants()};t.prototype.showListAction=function(){if(!this.actionPopupItems.length){for(var t=0;t<this.listAction.length;t++){this.actionPopupItems.push({text:this.listAction[t].text,onclick:this.listAction[t].action})}}if(!BX.PopupMenu.getMenuById(this.actionPopupId)){var s=this.actionButton.getBoundingClientRect();this.actionPopupObject=BX.PopupMenu.create(this.actionPopupId,this.actionButton,this.actionPopupItems,{closeByEsc:true,angle:true,offsetLeft:s.width/2,events:{onPopupShow:BX.proxy(function(){BX.addClass(this.actionButton,"webform-button-active")},this),onPopupClose:BX.proxy(function(){BX.removeClass(this.actionButton,"webform-button-active")},this)}})}if(this.actionPopupObject)this.actionPopupObject.popupWindow.show()};t.prototype.completeWorkflow=function(t,s){BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","completeWorkflow"),data:{workflowId:t,iblockTypeId:this.iblockTypeId,elementId:this.elementId,iblockId:this.iblockId,socnetGroupId:this.socnetGroupId,sectionId:this.sectionId,action:s},onsuccess:BX.delegate(function(t){if(t.status=="success"){BX.Lists.showModalWithStatusAction({status:"success",message:t.message});setTimeout(BX.delegate(function(){document.location.href=this.urlTabBp},this),1e3)}else{t.errors=t.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:t.errors.pop().message})}},this)})};t.prototype.setConstants=function(){BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","isConstantsTuned"),data:{iblockTypeId:this.iblockTypeId,iblockId:this.iblockId,socnetGroupId:this.socnetGroupId,sectionId:this.sectionId},onsuccess:BX.delegate(function(t){if(t.status=="success"){if(t.admin===false){this.notifyAdmin()}else{this.fillConstants(t.templateData)}}else{t.errors=t.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:t.errors.pop().message})}},this)})};t.prototype.fillConstants=function(t){if(!t){return}var s="";BX.Lists.ajax({method:"POST",dataType:"html",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","fillConstants"),data:{iblockId:this.iblockId,listTemplateId:t},onsuccess:BX.delegate(function(t){s=BX.create("div",{props:{className:"lists-fill-constants-content"},html:t});var e=BX.Lists.modalWindow({modalId:"bx-lists-popup",withoutWindowManager:true,title:BX.message("CT_BLEE_BIZPROC_CONSTANTS_FILL_TITLE"),autoHide:false,overlay:false,draggable:true,contentStyle:{width:"600px",paddingTop:"10px",paddingBottom:"10px"},content:[s],events:{onPopupClose:function(){this.destroy()}},buttons:[BX.create("a",{text:BX.message("CT_BLEE_BIZPROC_SAVE_BUTTON"),props:{className:"webform-small-button webform-small-button-accept"},events:{click:BX.delegate(function(t){var i=BX.findChild(s,{tag:"FORM"},true);if(i){i.modalWindow=e;i.onsubmit(i,t)}})}}),BX.create("a",{text:BX.message("CT_BLEE_BIZPROC_CANCEL_BUTTON"),props:{className:"webform-small-button webform-button-cancel"},events:{click:BX.delegate(function(t){if(!!e)e.close()},this)}})]})},this)})};t.prototype.notifyAdmin=function(){BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","getListAdmin"),data:{iblockId:this.iblockId,iblockTypeId:this.iblockTypeId,socnetGroupId:this.socnetGroupId,sectionId:this.sectionId},onsuccess:BX.delegate(function(t){if(t.status=="success"){var s=this.createHtmlNotifyAdmin(t.listAdmin);BX("lists-notify-admin-popup-content").appendChild(s);BX.Lists.modalWindow({modalId:"bx-lists-popup",title:BX.message("CT_BLEE_BIZPROC_NOTIFY_TITLE"),overlay:false,draggable:true,contentStyle:{width:"600px",paddingTop:"10px",paddingBottom:"10px"},content:[BX("lists-notify-admin-popup-content")],events:{onPopupClose:function(){BX("lists-notify-admin-popup").appendChild(BX("lists-notify-admin-popup-content"));this.destroy()}},buttons:[BX.create("a",{text:BX.message("CT_BLEE_BIZPROC_NOTIFY_ADMIN_BUTTON_CLOSE"),props:{className:"webform-small-button webform-button-cancel"},events:{click:BX.delegate(function(t){BX.PopupWindowManager.getCurrentPopup().close()},this)}})]})}else{t.errors=t.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:t.errors.pop().message})}},this)})};t.prototype.notify=function(t){if(!BX("lists-notify-button-"+t)){return}BX("lists-notify-button-"+t).setAttribute("onclick","");BX.Lists.ajax({method:"POST",dataType:"json",url:BX.Lists.addToLinkParam(this.ajaxUrl,"action","notifyAdmin"),data:{iblockId:this.iblockId,userId:t,iblockTypeId:this.iblockTypeId,socnetGroupId:this.socnetGroupId,sectionId:this.sectionId,elementUrl:this.elementUrl},onsuccess:BX.delegate(function(s){if(s.status=="success"){BX.Lists.removeElement(BX("lists-notify-button-"+t));BX("lists-notify-success-"+t).innerHTML=s.message}else{BX("lists-notify-button-"+t).setAttribute("onclick",'BX.Lists["'+this.jsClass+'"].notify("'+t+'");');s.errors=s.errors||[{}];BX.Lists.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}},this)})};t.prototype.createHtmlNotifyAdmin=function(t){if(!t){return null}var s;s=BX.create("div",{children:[BX.create("span",{props:{className:"lists-notify-question"},children:[BX.create("span",{props:{innerHTML:"!",className:"icon"}}),BX.create("span",{props:{innerHTML:BX.message("CT_BLEE_BIZPROC_SELECT_STAFF_SET_RESPONSIBLE")}})]}),BX.create("p",{html:BX.message("CT_BLEE_BIZPROC_NOTIFY_ADMIN_TEXT_ONE")}),BX.create("p",{html:BX.message("CT_BLEE_BIZPROC_NOTIFY_ADMIN_TEXT_TWO")}),BX.create("span",{props:{className:"lists-notify-question-title"},html:BX.message("CT_BLEE_BIZPROC_NOTIFY_ADMIN_MESSAGE")})]});for(var e in t){var i;if(t[e].img){i=BX.create("img",{attrs:{src:t[e].img}})}s.appendChild(BX.create("div",{props:{className:"lists-notify-question-item"},children:[BX.create("a",{props:{className:"lists-notify-question-item-avatar"},attrs:{href:"javascript:void(0)"},children:[BX.create("span",{props:{id:"lists-notify-question-item-avatar-inner",className:"lists-notify-question-item-avatar-inner"},children:[i]})]}),BX.create("span",{props:{className:"lists-notify-question-item-info"},children:[BX.create("span",{html:t[e].name})]}),BX.create("span",{props:{id:"lists-notify-success-"+t[e].id,className:"lists-notify-success"}}),BX.create("a",{props:{id:"lists-notify-button-"+t[e].id,className:"webform-small-button lists-notify-small-button webform-small-button-blue"},attrs:{href:"javascript:void(0)",onclick:'BX.Lists["'+this.jsClass+'"].notify("'+t[e].id+'");'},html:BX.message("CT_BLEE_BIZPROC_NOTIFY_ADMIN_MESSAGE_BUTTON")})]}))}return s};t.prototype.elementDelete=function(t,s){var e=document.getElementById(t);var i=document.getElementById("action");if(e&&i){BX.Lists.modalWindow({modalId:"bx-lists-migrate-list",title:BX.message("CT_BLEE_DELETE_POPUP_TITLE"),contentClassName:"",draggable:true,contentStyle:{width:"400px",padding:"20px 20px 20px 20px"},events:{onPopupClose:function(){this.destroy()}},content:s,buttons:[BX.create("span",{text:BX.message("CT_BLEE_DELETE_POPUP_ACCEPT_BUTTON"),props:{className:"webform-small-button webform-small-button-accept"},events:{click:BX.delegate(function(){BX.PopupWindowManager.getCurrentPopup().close();i.value="delete";e.submit()},this)}}),BX.create("span",{text:BX.message("CT_BLEE_DELETE_POPUP_CANCEL_BUTTON"),props:{className:"popup-window-button popup-window-button-link popup-window-button-link-cancel"},events:{click:BX.delegate(function(){BX.PopupWindowManager.getCurrentPopup().close()},this)}})]})}};return t}();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:100:"/bitrix/components/bitrix/intranet.user.selector.new/templates/.default/users.min.js?154412742413982";s:6:"source";s:80:"/bitrix/components/bitrix/intranet.user.selector.new/templates/.default/users.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){if(window.IntranetUsers)return;window.IntranetUsers=function(e,t,a){this.name=e;this.multiple=t;this.arSelected=[];this.arFixed=[];this.bSubordinateOnly=a;this.ajaxUrl="";this.lastSearchTime=0};IntranetUsers.arStructure={};IntranetUsers.bSectionsOnly=false;IntranetUsers.arEmployees={group:{}};IntranetUsers.arEmployeesData={};IntranetUsers.ajaxUrl="";IntranetUsers.prototype.loadGroup=function(e){var t=BX(this.name+"_group_section_"+e);function a(t){IntranetUsers.arEmployees["group"][e]=t;this.show(e,t,"g")}e=parseInt(e);if(IntranetUsers.arEmployees["group"][e]!=null){this.show(e,IntranetUsers.arEmployees["group"][e],"g")}else{var s=this.getAjaxUrl()+"&MODE=EMPLOYEES&GROUP_ID="+e;BX.ajax.loadJSON(s,BX.proxy(a,this))}BX.toggleClass(t,"company-department-opened");BX.toggleClass(BX(this.name+"_gchildren_"+e),"company-department-children-opened")};IntranetUsers.prototype.load=function(e,t,a,s){this.bSectionsOnly=s;function n(t){IntranetUsers.arStructure[e]=t.STRUCTURE;IntranetUsers.arEmployees[e]=t.USERS;this.show(e,false,"",this.bSectionsOnly)}if(null==t)t=false;if(null==a)a=false;if(null==s)s=false;if(e!="extranet")e=parseInt(e);var r=BX(this.name+"_employee_section_"+e);if(!r.BX_LOADED){if(IntranetUsers.arEmployees[e]!=null){this.show(e,false,"",this.bSectionsOnly)}else{var i=this.getAjaxUrl()+"&MODE=EMPLOYEES&SECTION_ID="+e;BX.ajax.loadJSON(i,BX.proxy(n,this))}}if(a){BX(this.name+"_employee_search_layout").scrollTop=r.offsetTop-40}BX.toggleClass(r,"company-department-opened");BX.toggleClass(BX(this.name+"_children_"+e),"company-department-children-opened")};IntranetUsers.prototype.show=function(e,t,a,s){s=!!s;a=a||"";var n=BX(this.name+"_"+a+"employee_section_"+e);var r=t||IntranetUsers.arEmployees[e];if(n!==null){n.BX_LOADED=true}var i=BX(this.name+"_"+a+"employees_"+e);if(i){if(IntranetUsers.arStructure[e]!=null&&!a){var l=IntranetUsers.arStructure[e];var o=BX(this.name+"_"+a+"children_"+e);if(o){for(var c=0;c<l.length;c++){obSectionRow1=BX.create("div",{props:{className:"company-department"},children:[s?BX.create("span",{props:{className:"company-department-inner",id:this.name+"_employee_section_"+l[c].ID},children:[BX.create("div",{props:{className:"company-department-arrow"},attrs:{onclick:"O_"+this.name+".load("+l[c].ID+", false, false, true)"}}),BX.create("div",{props:{className:"company-department-text"},attrs:{"data-section-id":l[c].ID,onclick:"O_"+this.name+".selectSection("+this.name+"_employee_section_"+l[c].ID+")"},text:l[c].NAME})]}):BX.create("span",{props:{className:"company-department-inner",id:this.name+"_employee_section_"+l[c].ID},attrs:{onclick:"O_"+this.name+".load("+l[c].ID+")"},children:[BX.create("div",{props:{className:"company-department-arrow"}}),BX.create("div",{props:{className:"company-department-text"},text:l[c].NAME})]})]});obSectionRow2=BX.create("div",{props:{className:"company-department-children",id:this.name+"_children_"+l[c].ID},children:[BX.create("div",{props:{className:"company-department-employees",id:this.name+"_employees_"+l[c].ID},children:[BX.create("span",{props:{className:"company-department-employees-loading"},text:BX.message("INTRANET_EMP_WAIT")})]})]});o.appendChild(obSectionRow1);o.appendChild(obSectionRow2)}o.appendChild(i)}}i.innerHTML="";for(var c=0;c<r.length;c++){var p;var d=false;IntranetUsers.arEmployeesData[r[c].ID]={id:r[c].ID,name:r[c].NAME,sub:r[c].SUBORDINATE=="Y"?true:false,sup:r[c].SUPERORDINATE=="Y"?true:false,position:r[c].WORK_POSITION,photo:r[c].PHOTO};var m=BX.create("input",{props:{className:"intranet-hidden-input"}});if(this.multiple){m.name=this.name+"[]";m.type="checkbox"}else{m.name=this.name;m.type="radio"}var h=document.getElementsByName(m.name);var u=0;while(!d&&u<h.length){if(h[u].value==r[c].ID&&h[u].checked){d=true}u++}m.value=r[c].ID;p=BX.create("div",{props:{className:"company-department-employee"+(d?" company-department-employee-selected":"")},events:{click:BX.proxy(this.select,this)},children:[m,BX.create("div",{props:{className:"company-department-employee-avatar"},style:{background:r[c].PHOTO?"url('"+r[c].PHOTO+"') no-repeat center center":"",backgroundSize:r[c].PHOTO?"cover":""}}),BX.create("div",{props:{className:"company-department-employee-icon"}}),BX.create("div",{props:{className:"company-department-employee-info"},children:[BX.create("div",{props:{className:"company-department-employee-name"},text:r[c].NAME}),BX.create("div",{props:{className:"company-department-employee-position"},html:!r[c].HEAD&&!r[c].WORK_POSITION?"&nbsp;":BX.util.htmlspecialchars(r[c].WORK_POSITION)+(r[c].HEAD&&r[c].WORK_POSITION?", ":"")+(r[c].HEAD?BX.message("INTRANET_EMP_HEAD"):"")})]})]});i.appendChild(p)}}};IntranetUsers.prototype.select=function(e){var t;var a=0;var s=e.target||e.srcElement;if(e.currentTarget){t=e.currentTarget}else{t=s;while(!BX.hasClass(t,"finder-box-item")&&!BX.hasClass(t,"company-department-employee")){t=t.parentNode}}var n=BX.findChild(t,{tag:"input"});if(!this.multiple){var r=document.getElementsByName(this.name);for(var a=0;a<r.length;a++){if(r[a].value!=n.value){BX.removeClass(r[a].parentNode,BX.hasClass(r[a].parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}else{BX.addClass(r[a].parentNode,BX.hasClass(r[a].parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}}n.checked=true;BX.addClass(t,BX.hasClass(t,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected");this.searchInput.value=IntranetUsers.arEmployeesData[n.value].name;this.arSelected=[];this.arSelected[n.value]={id:n.value,name:IntranetUsers.arEmployeesData[n.value].name,sub:IntranetUsers.arEmployeesData[n.value].sub,sup:IntranetUsers.arEmployeesData[n.value].sup,position:IntranetUsers.arEmployeesData[n.value].position,photo:IntranetUsers.arEmployeesData[n.value].photo}}else{var r=document.getElementsByName(this.name+"[]");if(!BX.util.in_array(n,r)&&!BX.util.in_array(n.value,this.arFixed)){n.checked=false;BX.toggleClass(n.parentNode,BX.hasClass(n.parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}for(var a=0;a<r.length;a++){if(r[a].value==n.value&&!BX.util.in_array(n.value,this.arFixed)){r[a].checked=false;BX.toggleClass(r[a].parentNode,BX.hasClass(r[a].parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}}if(BX.hasClass(n.parentNode,"finder-box-item-selected")||BX.hasClass(n.parentNode,"company-department-employee-selected")){n.checked=true}if(n.checked){var i=BX.findChild(BX(this.name+"_selected_users"),{className:"finder-box-selected-items"});if(!BX(this.name+"_employee_selected_"+n.value)){var l=BX.create("DIV");l.id=this.name+"_employee_selected_"+n.value;l.className="finder-box-selected-item";var o=BX.findChild(t,{tag:"DIV",className:"finder-box-item-text"},true)||BX.findChild(t,{tag:"DIV",className:"company-department-employee-name"},true);l.innerHTML='<div class="finder-box-selected-item-icon" id="'+this.name+"-user-selector-unselect-"+n.value+'" onclick="O_'+this.name+".unselect("+n.value+', this);"></div><span class="finder-box-selected-item-text">'+o.innerHTML+"</span>";i.appendChild(l);var c=BX(this.name+"_current_count");c.innerHTML=parseInt(c.innerHTML)+1;this.arSelected[n.value]={id:n.value,name:IntranetUsers.arEmployeesData[n.value].name,sub:IntranetUsers.arEmployeesData[n.value].sub,sup:IntranetUsers.arEmployeesData[n.value].sup,position:IntranetUsers.arEmployeesData[n.value].position,photo:IntranetUsers.arEmployeesData[n.value].photo}}}else{BX.remove(BX(this.name+"_employee_selected_"+n.value));var c=BX(this.name+"_current_count");c.innerHTML=parseInt(c.innerHTML)-1;this.arSelected[n.value]=null}}var p=BX.util.array_search(n.value,IntranetUsers.lastUsers);if(p>=0)IntranetUsers.lastUsers.splice(p,1);IntranetUsers.lastUsers.unshift(n.value);BX.userOptions.save("intranet","user_search","last_selected",IntranetUsers.lastUsers.slice(0,10));if(this.onSelect){var d=this.arSelected.pop();this.arSelected.push(d);this.onSelect(d)}BX.onCustomEvent(this,"on-change",[this.toObject(this.arSelected)]);if(this.onChange){this.onChange(this.arSelected)}};IntranetUsers.prototype.toObject=function(e){var t={};for(var a in e){a=parseInt(a);if(typeof a=="number"&&e[a]!==null){t[a]=BX.clone(e[a])}}return t};IntranetUsers.prototype.selectSection=function(e){var t=BX(e);if(!t){return false}else{var a=BX.findChild(t,{tag:"div",className:"company-department-text"});if(a){if(this.onSectionSelect){this.onSectionSelect({id:a.getAttribute("data-section-id"),name:a.innerHTML})}}}};IntranetUsers.prototype.unselect=function(e){var t=BX(this.name+"-user-selector-unselect-"+e);var a=document.getElementsByName(this.name+(this.multiple?"[]":""));for(var s=0;s<a.length;s++){if(a[s].value==e){a[s].checked=false;BX.removeClass(a[s].parentNode,BX.hasClass(a[s].parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}}if(this.multiple){if(t){BX.remove(t.parentNode)}var n=BX(this.name+"_current_count");n.innerHTML=parseInt(n.innerHTML)-1}this.arSelected[e]=null;BX.onCustomEvent(this,"on-change",[this.toObject(this.arSelected)]);if(this.onChange){this.onChange(this.arSelected)}};IntranetUsers.prototype.getSelected=function(){return this.arSelected};IntranetUsers.prototype.setSelected=function(e){for(var t=0,a=this.arSelected.length;t<a;t++){if(this.arSelected[t]&&this.arSelected[t].id)this.unselect(this.arSelected[t].id)}if(!this.multiple){e=[e[0]]}this.arSelected=[];for(var t=0,a=e.length;t<a;t++){this.arSelected[e[t].id]=e[t];var s=BX.create("input",{props:{className:"intranet-hidden-input",value:e[t].id,checked:"checked",name:this.name+(this.multiple?"[]":"")}});BX(this.name+"_last").appendChild(s);if(this.multiple){var n=BX.findChild(BX(this.name+"_selected_users"),{className:"finder-box-selected-items"});var r=BX.create("div",{props:{className:"finder-box-selected-item",id:this.name+"_employee_selected_"+e[t].id},html:'<div class="finder-box-selected-item-icon" id="'+this.name+"-user-selector-unselect-"+e[t].id+'" onclick="O_'+this.name+".unselect("+e[t].id+', this);"></div><span class="finder-box-selected-item-text">'+BX.util.htmlspecialchars(e[t].name)+"</span>"});n.appendChild(r)}var i=document.getElementsByName(this.name+(this.multiple?"[]":""));for(var l=0;l<i.length;l++){if(i[l].value==e[t].id){BX.toggleClass(i[l].parentNode,BX.hasClass(i[l].parentNode,"finder-box-item")?"finder-box-item-selected":"company-department-employee-selected")}}}if(this.multiple){BX.adjust(BX(this.name+"_current_count"),{text:e.length})}};IntranetUsers.prototype.setFixed=function(e){if(typeof e!="object")e=[];this.arFixed=e;var t=BX.findChildren(BX(this.name+"_selected_users"),{className:"finder-box-selected-item-icon"},true);for(i=0;i<t.length;i++){var a=t[i].id.replace(this.name+"-user-selector-unselect-","");BX.adjust(t[i],{style:{visibility:BX.util.in_array(a,this.arFixed)?"hidden":"visible"}})}};IntranetUsers.prototype.search=function(e){this.searchRqstTmt=clearTimeout(this.searchRqstTmt);if(typeof this.searchRqst=="object"){this.searchRqst.abort();this.searchRqst=false}if(!e)e=window.event;if(this.searchInput.value.length>0){this.displayTab("search");var t=this.getAjaxUrl()+"&MODE=SEARCH&SEARCH_STRING="+encodeURIComponent(this.searchInput.value);if(this.bSubordinateOnly)t+="&S_ONLY=Y";var a=this;this.searchRqstTmt=setTimeout(function(){var e=(new Date).getTime();a.lastSearchTime=e;a.searchRqst=BX.ajax.loadJSON(t,BX.proxy(function(t){if(a.lastSearchTime==e)a.showResults(t)},a))},400)}};IntranetUsers.prototype.showResults=function(e){var t=e;var a=BX(this.name+"_search");var s=a.getElementsByTagName("input");var n=null;for(n=0,count=s.length;n<count;n++){if(s[n].checked){BX(this.name+"_last").appendChild(s[n])}}if(a){a.innerHTML="";var r=BX.create("table",{props:{className:"finder-box-tab-columns",cellspacing:"0"},children:[BX.create("tbody")]});var i=BX.create("tr");r.firstChild.appendChild(i);var l=BX.create("td");i.appendChild(l);a.appendChild(r);for(n=0;n<t.length;n++){var o;var c=false;IntranetUsers.arEmployeesData[t[n].ID]={id:t[n].ID,name:t[n].NAME,sub:t[n].SUBORDINATE=="Y"?true:false,sup:t[n].SUPERORDINATE=="Y"?true:false,position:t[n].WORK_POSITION,photo:t[n].PHOTO};var p=BX.create("input",{props:{className:"intranet-hidden-input"}});if(this.multiple){p.name=this.name+"[]";p.type="checkbox"}else{p.name=this.name;p.type="radio"}s=document.getElementsByName(p.name);var d=0;while(!c&&d<s.length){if(s[d].value==t[n].ID&&s[d].checked){c=true}d++}p.value=t[n].ID;var m=t[n].NAME;o=BX.create("div",{props:{className:"finder-box-item"+(c?" finder-box-item-selected":"")},events:{click:BX.proxy(this.select,this)},children:[p,BX.create("div",{props:{className:"finder-box-item-text"},attrs:{"bx-tooltip-user-id":t[n].ID,"bx-tooltip-classname":"intrantet-user-selector-tooltip"},text:m}),BX.create("div",{props:{className:"finder-box-item-icon"}})]});l.appendChild(o);if(n==Math.ceil(t.length/2)-1){l=BX.create("td");r.firstChild.appendChild(l)}}}};IntranetUsers.prototype.displayTab=function(e){BX.removeClass(BX(this.name+"_last"),"finder-box-tab-content-selected");BX.removeClass(BX(this.name+"_search"),"finder-box-tab-content-selected");BX.removeClass(BX(this.name+"_structure"),"finder-box-tab-content-selected");BX.removeClass(BX(this.name+"_groups"),"finder-box-tab-content-selected");BX.addClass(BX(this.name+"_"+e),"finder-box-tab-content-selected");BX.removeClass(BX(this.name+"_tab_last"),"finder-box-tab-selected");BX.removeClass(BX(this.name+"_tab_search"),"finder-box-tab-selected");BX.removeClass(BX(this.name+"_tab_structure"),"finder-box-tab-selected");BX.removeClass(BX(this.name+"_tab_groups"),"finder-box-tab-selected");BX.addClass(BX(this.name+"_tab_"+e),"finder-box-tab-selected")};IntranetUsers.prototype._onFocus=function(){this.searchInput.value=""};IntranetUsers.prototype.getAjaxUrl=function(){return this.ajaxUrl||IntranetUsers.ajaxUrl}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:94:"/bitrix/components/bitrix/main.interface.form/templates/.default/script.min.js?154412738413243";s:6:"source";s:74:"/bitrix/components/bitrix/main.interface.form/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
function BxInterfaceForm(t,e){var s=this;this.name=t;this.aTabs=e;this.bExpandTabs=false;this.vars={};this.oTabsMeta={};this.aTabsEdit=[];this.oFields={};this.menu=new PopupMenu("bxFormMenu_"+this.name,1010);this.settingsMenu=[];this.tabSettingsWnd=null;this.fieldSettingsWnd=null;this.SelectTab=function(t){var e=document.getElementById("inner_tab_"+t);if(e.style.display!="none")return;for(var s=0,i=this.aTabs.length;s<i;s++){var a=document.getElementById("inner_tab_"+this.aTabs[s]);if(a.style.display!="none"){this.ShowTab(this.aTabs[s],false);a.style.display="none";break}}this.ShowTab(t,true);e.style.display="block";var n=document.getElementById(this.name+"_active_tab");if(n)n.value=t};this.ShowTab=function(t,e){var s=e?"-selected":"";document.getElementById("tab_cont_"+t).className="bx-tab-container"+s;document.getElementById("tab_left_"+t).className="bx-tab-left"+s;document.getElementById("tab_"+t).className="bx-tab"+s;document.getElementById("tab_right_"+t).className="bx-tab-right"+s};this.HoverTab=function(t,e){var s=document.getElementById("tab_"+t);if(s.className=="bx-tab-selected")return;document.getElementById("tab_left_"+t).className=e?"bx-tab-left-hover":"bx-tab-left";s.className=e?"bx-tab-hover":"bx-tab";var i=document.getElementById("tab_right_"+t);i.className=e?"bx-tab-right-hover":"bx-tab-right"};this.ShowDisabledTab=function(t,e){var i=document.getElementById("tab_cont_"+t);if(e){i.className="bx-tab-container-disabled";i.onclick=null;i.onmouseover=null;i.onmouseout=null}else{i.className="bx-tab-container";i.onclick=function(){s.SelectTab(t)};i.onmouseover=function(){s.HoverTab(t,true)};i.onmouseout=function(){s.HoverTab(t,false)}}};this.ToggleTabs=function(t){this.bExpandTabs=!this.bExpandTabs;var e=document.getElementById("bxForm_"+this.name+"_expand_link");if(!e){return}e.title=this.bExpandTabs?this.vars.mess.collapseTabs:this.vars.mess.expandTabs;e.className=this.bExpandTabs?e.className.replace(/\s*bx-down/gi," bx-up"):e.className.replace(/\s*bx-up/gi," bx-down");var s;for(var i in this.aTabs){var a=this.aTabs[i];this.ShowTab(a,false);this.ShowDisabledTab(a,this.bExpandTabs);s=document.getElementById("inner_tab_"+a);s.style.display=this.bExpandTabs?"block":"none"}if(!this.bExpandTabs){this.ShowTab(this.aTabs[0],true);s=document.getElementById("inner_tab_"+this.aTabs[0]);s.style.display="block"}if(t!==true)BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?FORM_ID="+this.name+"&action=expand&expand="+(this.bExpandTabs?"Y":"N")+"&sessid="+this.vars.sessid)};this.SetTheme=function(t,e){BX.loadCSS(this.vars.template_path+"/themes/"+e+"/style.css");var i=this.menu.GetMenuByItemId(t.id);i.SetAllItemsIcon("");i.SetItemIcon(t,"checked");BX.ajax.get("/bitrix/components"+s.vars.component_path+"/settings.php?FORM_ID="+this.name+"&GRID_ID="+this.vars.GRID_ID+"&action=settheme&theme="+e+"&sessid="+this.vars.sessid)};this.ShowSettings=function(){var t=false;if(!window["formSettingsDialog"+this.name]){window["formSettingsDialog"+this.name]=new BX.CDialog({content:'<form name="form_settings_'+this.name+'"></form>',title:this.vars.mess.settingsTitle,width:this.vars.settingWndSize.width,height:this.vars.settingWndSize.height,resize_id:"InterfaceFormSettingWnd"});t=true}window["formSettingsDialog"+this.name].ClearButtons();window["formSettingsDialog"+this.name].SetButtons([{title:this.vars.mess.settingsSave,action:function(){s.SaveSettings();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);window["formSettingsDialog"+this.name].Show();var e=document["form_settings_"+this.name];if(t)e.appendChild(BX("form_settings_"+this.name));var i;this.aTabsEdit=[];for(i in this.oTabsMeta){var a=[];for(var n in this.oTabsMeta[i].fields)a[a.length]=BX.clone(this.oTabsMeta[i].fields[n]);this.aTabsEdit[this.aTabsEdit.length]=BX.clone(this.oTabsMeta[i]);this.aTabsEdit[this.aTabsEdit.length-1].fields=a}jsSelectUtils.deleteAllOptions(e.tabs);for(i in this.aTabsEdit)e.tabs.options[e.tabs.length]=new Option(this.aTabsEdit[i].name,this.aTabsEdit[i].id,false,false);e.tabs.selectedIndex=0;this.OnSettingsChangeTab();this.aAvailableFields=BX.clone(this.oFields);jsSelectUtils.deleteAllOptions(e.all_fields);for(i in this.aAvailableFields)e.all_fields.options[e.all_fields.length]=new Option(this.aAvailableFields[i].name,this.aAvailableFields[i].id,false,false);jsSelectUtils.sortSelect(e.all_fields);this.HighlightSections(e.all_fields);this.ProcessButtons();e.tabs.focus()};this.OnSettingsChangeTab=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;jsSelectUtils.deleteAllOptions(t.fields);for(var s in this.aTabsEdit[e].fields){var i=new Option(this.aTabsEdit[e].fields[s].name,this.aTabsEdit[e].fields[s].id,false,false);if(this.aTabsEdit[e].fields[s].type=="section")i.className="bx-section";t.fields.options[t.fields.length]=i}this.ProcessButtons()};this.TabMoveUp=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e>0){var s=BX.clone(this.aTabsEdit[e]);this.aTabsEdit[e]=BX.clone(this.aTabsEdit[e-1]);this.aTabsEdit[e-1]=s}jsSelectUtils.moveOptionsUp(t.tabs)};this.TabMoveDown=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e<t.tabs.length-1){var s=BX.clone(this.aTabsEdit[e]);this.aTabsEdit[e]=BX.clone(this.aTabsEdit[e+1]);this.aTabsEdit[e+1]=s}jsSelectUtils.moveOptionsDown(t.tabs)};this.TabEdit=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e<0)return;this.ShowTabSettings(this.aTabsEdit[e],function(){var i=document["tab_settings_"+s.name];s.aTabsEdit[e].name=i.tab_name.value;s.aTabsEdit[e].title=i.tab_title.value;t.tabs[e].text=i.tab_name.value})};this.TabAdd=function(){this.ShowTabSettings({name:"",title:""},function(){var t="tab_"+Math.round(Math.random()*1e6);var e=document["tab_settings_"+s.name];s.aTabsEdit[s.aTabsEdit.length]={id:t,name:e.tab_name.value,title:e.tab_title.value,fields:[]};var i=document["form_settings_"+s.name];i.tabs[i.tabs.length]=new Option(e.tab_name.value,t,true,true);s.OnSettingsChangeTab()})};this.TabDelete=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e<0)return;var s;for(s in this.aTabsEdit[e].fields){this.aAvailableFields[this.aTabsEdit[e].fields[s].id]=this.aTabsEdit[e].fields[s];jsSelectUtils.addNewOption(t.all_fields,this.aTabsEdit[e].fields[s].id,this.aTabsEdit[e].fields[s].name,true,false)}this.HighlightSections(t.all_fields);this.aTabsEdit=BX.util.deleteFromArray(this.aTabsEdit,e);t.tabs.remove(e);if(t.tabs.length>0){s=e<t.tabs.length?e:t.tabs.length-1;t.tabs[s].selected=true;this.OnSettingsChangeTab()}else{jsSelectUtils.deleteAllOptions(t.fields);this.ProcessButtons()}};this.ShowTabSettings=function(t,e){var s=this.tabSettingsWnd;if(!s){this.tabSettingsWnd=s=new BX.CDialog({content:'<form name="tab_settings_'+this.name+'">'+'<table width="100%">'+"<tr>"+'<td width="50%" align="right">'+this.vars.mess.tabSettingsName+"</td>"+'<td><input type="text" name="tab_name" size="30" value="" style="width:90%"></td>'+"</tr>"+"<tr>"+'<td align="right">'+this.vars.mess.tabSettingsCaption+"</td>"+'<td><input type="text" name="tab_title" size="30" value="" style="width:90%"></td>'+"</tr>"+"</table>"+"</form>",title:this.vars.mess.tabSettingsTitle,width:this.vars.tabSettingWndSize.width,height:this.vars.tabSettingWndSize.height,resize_id:"InterfaceFormTabSettingWnd"})}s.ClearButtons();s.SetButtons([{title:this.vars.mess.tabSettingsSave,action:function(){e();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);s.Show();var i=document["tab_settings_"+this.name];i.tab_name.value=t.name;i.tab_title.value=t.title;i.tab_name.focus()};this.ShowFieldSettings=function(t,e){var s=this.fieldSettingsWnd;if(!s){this.fieldSettingsWnd=s=new BX.CDialog({content:'<form name="field_settings_'+this.name+'">'+'<table width="100%">'+"<tr>"+'<td width="50%" align="right" id="field_name_'+this.name+'"></td>'+'<td><input type="text" name="field_name" size="30" value="" style="width:90%"></td>'+"</tr>"+"</table>"+"</form>",width:this.vars.fieldSettingWndSize.width,height:this.vars.fieldSettingWndSize.height,resize_id:"InterfaceFormFieldSettingWnd"})}s.SetTitle(t.type&&t.type=="section"?this.vars.mess.sectSettingsTitle:this.vars.mess.fieldSettingsTitle);BX("field_name_"+this.name).innerHTML=t.type&&t.type=="section"?this.vars.mess.sectSettingsName:this.vars.mess.fieldSettingsName;s.ClearButtons();s.SetButtons([{title:this.vars.mess.tabSettingsSave,action:function(){e();this.parentWindow.Close()}},BX.CDialog.prototype.btnCancel]);s.Show();var i=document["field_settings_"+this.name];i.field_name.value=t.name;i.field_name.focus()};this.FieldEdit=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;var i=t.fields.selectedIndex;if(e<0||i<0)return;this.ShowFieldSettings(this.aTabsEdit[e].fields[i],function(){var a=document["field_settings_"+s.name];s.aTabsEdit[e].fields[i].name=a.field_name.value;t.fields[i].text=a.field_name.value})};this.FieldAdd=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e<0)return;this.ShowFieldSettings({name:"",type:"section"},function(){var i="field_"+Math.round(Math.random()*1e6);var a=document["field_settings_"+s.name];s.aTabsEdit[e].fields[s.aTabsEdit[e].fields.length]={id:i,name:a.field_name.value,type:"section"};var n=new Option(a.field_name.value,i,true,true);n.className="bx-section";t.fields[t.fields.length]=n;s.ProcessButtons()})};this.FieldsMoveUp=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;var s=t.fields.length;for(var i=0;i<s;i++){if(t.fields[i].selected&&i>0&&t.fields[i-1].selected==false){var a=BX.clone(this.aTabsEdit[e].fields[i]);this.aTabsEdit[e].fields[i]=BX.clone(this.aTabsEdit[e].fields[i-1]);this.aTabsEdit[e].fields[i-1]=a;var n=new Option(t.fields[i].text,t.fields[i].value);var l=new Option(t.fields[i-1].text,t.fields[i-1].value);n.className=t.fields[i].className;l.className=t.fields[i-1].className;t.fields[i]=l;t.fields[i].selected=false;t.fields[i-1]=n;t.fields[i-1].selected=true}}};this.FieldsMoveDown=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;var s=t.fields.length;for(var i=s-1;i>=0;i--){if(t.fields[i].selected&&i<s-1&&t.fields[i+1].selected==false){var a=BX.clone(this.aTabsEdit[e].fields[i]);this.aTabsEdit[e].fields[i]=BX.clone(this.aTabsEdit[e].fields[i+1]);this.aTabsEdit[e].fields[i+1]=a;var n=new Option(t.fields[i].text,t.fields[i].value);var l=new Option(t.fields[i+1].text,t.fields[i+1].value);n.className=t.fields[i].className;l.className=t.fields[i+1].className;t.fields[i]=l;t.fields[i].selected=false;t.fields[i+1]=n;t.fields[i+1].selected=true}}};this.FieldsAdd=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e==-1)return;var s=this.aTabsEdit[e].fields;var i=t.all_fields.length,a;for(a=0;a<i;a++)if(t.all_fields[a].selected)s[s.length]={id:t.all_fields[a].value,name:t.all_fields[a].text,type:this.aAvailableFields[t.all_fields[a].value].type};jsSelectUtils.addSelectedOptions(t.all_fields,t.fields,false,false);jsSelectUtils.deleteSelectedOptions(t.all_fields);for(a=0,i=t.fields.length;a<i;a++)if(s[a].type=="section")t.fields[a].className="bx-section";this.ProcessButtons()};this.FieldsDelete=function(){var t=document["form_settings_"+this.name];var e=t.tabs.selectedIndex;if(e==-1)return;var s=t.fields.length;var i=0;for(var a=0;a<s;a++){if(t.fields[a].selected){this.aAvailableFields[t.fields[a].value]=this.aTabsEdit[e].fields[a-i];this.aTabsEdit[e].fields=BX.util.deleteFromArray(this.aTabsEdit[e].fields,a-i);i++}}jsSelectUtils.addSelectedOptions(t.fields,t.all_fields,false,true);jsSelectUtils.deleteSelectedOptions(t.fields);this.HighlightSections(t.all_fields);this.ProcessButtons()};this.ProcessButtons=function(){var t=document["form_settings_"+this.name];t.add_btn.disabled=t.all_fields.selectedIndex==-1||t.tabs.selectedIndex==-1;t.del_btn.disabled=t.up_btn.disabled=t.down_btn.disabled=t.field_edit_btn.disabled=t.fields.selectedIndex==-1;t.tab_up_btn.disabled=t.tab_down_btn.disabled=t.tab_edit_btn.disabled=t.tab_del_btn.disabled=t.field_add_btn.disabled=t.tabs.selectedIndex==-1};this.HighlightSections=function(t){for(var e=0,s=t.length;e<s;e++)if(this.aAvailableFields[t[e].value].type=="section")t[e].className="bx-section"};this.SaveSettings=function(){var t={FORM_ID:this.name,action:"savesettings",sessid:this.vars.sessid,tabs:this.aTabsEdit};var e=document["form_settings_"+this.name];if(e["set_default_settings"]){t.set_default_settings=e.set_default_settings.checked?"Y":"N";t.delete_users_settings=e.delete_users_settings.checked?"Y":"N"}BX.ajax.post("/bitrix/components"+s.vars.component_path+"/settings.php",t,function(){s.Reload()})};this.EnableSettings=function(t){BX.ajax.get("/bitrix/components"+this.vars.component_path+"/settings.php?FORM_ID="+this.name+"&action=enable&enabled="+(t?"Y":"N")+"&sessid="+this.vars.sessid,function(){s.Reload()})};this.Reload=function(){if(this.vars.ajax.AJAX_ID!="")BX.ajax.insertToNode(this.vars.current_url+(this.vars.current_url.indexOf("?")==-1?"?":"&")+"bxajaxid="+this.vars.ajax.AJAX_ID,"comp_"+this.vars.ajax.AJAX_ID);else window.location=window.location.href}}
/* End */
;; /* /bitrix/components/bitrix/lists.element.edit/templates/.default/script.min.js?15441274328268*/
; /* /bitrix/components/bitrix/intranet.user.selector.new/templates/.default/users.min.js?154412742413982*/
; /* /bitrix/components/bitrix/main.interface.form/templates/.default/script.min.js?154412738413243*/

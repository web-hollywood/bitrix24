
; /* Start:"a:4:{s:4:"full";s:97:"/bitrix/components/bitrix/imopenlines.lines.edit/templates/.default/script.min.js?154412742322291";s:6:"source";s:77:"/bitrix/components/bitrix/imopenlines.lines.edit/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(e){if(!!e.BX.OpenLinesConfigEdit)return;var i=function(e,i){this.p=!!e?e:{};if(!!e["SELECTED"]){var t={},n,o;for(n in e["SELECTED"]){if(e["SELECTED"].hasOwnProperty(n)&&typeof e["SELECTED"][n]=="object"){for(o in e["SELECTED"][n]){if(e["SELECTED"][n].hasOwnProperty(o)){if(n=="USERS")t["U"+e["SELECTED"][n][o]]="users";else if(n=="SG")t["SG"+e["SELECTED"][n][o]]="sonetgroups";else if(n=="DR")t["DR"+e["SELECTED"][n][o]]="department"}}}}this.p["SELECTED"]=t}this.nodes={};var s=function(e,i){var t={},n,o,a;if(i[e]){for(a in i[e]){if(i[e].hasOwnProperty(a)){n=i[e][a];o=[];if(i[n]&&i[n].length>0)o=s(n,i);t[n]={id:n,type:"category",items:o}}}}return t},a=function(e){var i={},t;for(var n in e){if(e.hasOwnProperty(n)){t=e[n]["parent"];if(!i[t])i[t]=[];i[t][i[t].length]=n}}return s("DR0",i)};if(true||i=="users"){this.params={name:null,searchInput:null,extranetUser:this.p["EXTRANET_USER"]=="Y",bindMainPopup:{node:null,offsetTop:"5px",offsetLeft:"15px"},bindSearchPopup:{node:null,offsetTop:"5px",offsetLeft:"15px"},departmentSelectDisable:true,callback:{select:BX.delegate(this.select,this),unSelect:BX.delegate(this.unSelect,this),openDialog:BX.delegate(this.openDialog,this),closeDialog:BX.delegate(this.closeDialog,this),openSearch:BX.delegate(this.openDialog,this),closeSearch:BX.delegate(this.closeSearch,this)},items:{users:!!this.p["USERS"]?this.p["USERS"]:{},groups:{},sonetgroups:{},department:!!this.p["DEPARTMENT"]?this.p["DEPARTMENT"]:{},departmentRelation:!!this.p["DEPARTMENT"]?a(this.p["DEPARTMENT"]):{},contacts:{},companies:{},leads:{},deals:{}},itemsLast:{users:!!this.p["LAST"]&&!!this.p["LAST"]["USERS"]?this.p["LAST"]["USERS"]:{},sonetgroups:{},department:{},groups:{},contacts:{},companies:{},leads:{},deals:{},crm:[]},itemsSelected:!!this.p["SELECTED"]?BX.clone(this.p["SELECTED"]):{},isCrmFeed:false,destSort:!!this.p["DEST_SORT"]?BX.clone(this.p["DEST_SORT"]):{}}}},t=null;i.prototype={setInput:function(e,i){e=BX(e);if(!!e&&!e.hasAttribute("bx-destination-id")){var t="destination"+(""+(new Date).getTime()).substr(6),o;e.setAttribute("bx-destination-id",t);o=new n(t,e,i);this.nodes[t]=e;BX.defer_proxy(function(){this.params.name=o.id;this.params.searchInput=o.nodes.input;this.params.bindMainPopup.node=o.nodes.container;this.params.bindSearchPopup.node=o.nodes.container;BX.SocNetLogDestination.init(this.params)},this)()}},select:function(i,t,n,o,s){var a=t,l="S";if(t=="groups"){a="all-users"}else if(BX.util.in_array(t,["contacts","companies","leads","deals"])){a="crm"}if(t=="sonetgroups"){l="SG"}else if(t=="groups"){l="UA"}else if(t=="users"){l="U"}else if(t=="department"){l="DR"}else if(t=="contacts"){l="CRMCONTACT"}else if(t=="companies"){l="CRMCOMPANY"}else if(t=="leads"){l="CRMLEAD"}else if(t=="deals"){l="CRMDEAL"}var r=o?" bx-destination-undelete":"";r+=t=="sonetgroups"&&typeof e["arExtranetGroupID"]!="undefined"&&BX.util.in_array(i.entityId,e["arExtranetGroupID"])?" bx-destination-extranet":"";var d=BX.create("span",{attrs:{"data-id":i.id},props:{className:"bx-destination bx-destination-"+a+r},children:[BX.create("span",{props:{className:"bx-destination-text"},html:i.name})]});if(!o){d.appendChild(BX.create("span",{props:{className:"imopenlines-remove-btn"},events:{click:function(e){BX.SocNetLogDestination.deleteItem(i.id,t,s);BX.PreventDefault(e)},mouseover:function(){BX.addClass(this.parentNode,"bx-destination-hover")},mouseout:function(){BX.removeClass(this.parentNode,"bx-destination-hover")}}}))}BX.onCustomEvent(this.nodes[s],"select",[i,d,l])},unSelect:function(e,i,t,n){BX.onCustomEvent(this.nodes[n],"unSelect",[e])},openDialog:function(e){BX.onCustomEvent(this.nodes[e],"openDialog",[])},closeDialog:function(e){if(!BX.SocNetLogDestination.isOpenSearch()){BX.onCustomEvent(this.nodes[e],"closeDialog",[]);this.disableBackspace()}},closeSearch:function(e){if(!BX.SocNetLogDestination.isOpenSearch()){BX.onCustomEvent(this.nodes[e],"closeSearch",[]);this.disableBackspace()}},disableBackspace:function(){if(BX.SocNetLogDestination.backspaceDisable||BX.SocNetLogDestination.backspaceDisable!==null)BX.unbind(e,"keydown",BX.SocNetLogDestination.backspaceDisable);BX.bind(e,"keydown",BX.SocNetLogDestination.backspaceDisable=function(e){if(e.keyCode==8){BX.PreventDefault(e);return false}return true});setTimeout(function(){BX.unbind(e,"keydown",BX.SocNetLogDestination.backspaceDisable);BX.SocNetLogDestination.backspaceDisable=null},5e3)}};var n=function(e,i,t){this.node=i;this.id=e;this.inputName=t;this.node.appendChild(BX.create("SPAN",{props:{className:"bx-destination-wrap"},html:['<span id="',this.id,'-container"><span class="bx-destination-wrap-item"></span></span>','<span class="bx-destination-input-box" id="',this.id,'-input-box">','<input type="text" value="" class="bx-destination-input" id="',this.id,'-input">',"</span>",'<a href="#" class="bx-destination-add" id="',this.id,'-add-button"></a>'].join("")}));BX.defer_proxy(this.bind,this)()};n.prototype={bind:function(){this.nodes={inputBox:BX(this.id+"-input-box"),input:BX(this.id+"-input"),container:BX(this.id+"-container"),button:BX(this.id+"-add-button")};BX.bind(this.nodes.input,"keyup",BX.proxy(this.search,this));BX.bind(this.nodes.input,"keydown",BX.proxy(this.searchBefore,this));BX.bind(this.nodes.button,"click",BX.proxy(function(e){BX.SocNetLogDestination.openDialog(this.id);BX.PreventDefault(e)},this));BX.bind(this.nodes.container,"click",BX.proxy(function(e){BX.SocNetLogDestination.openDialog(this.id);BX.PreventDefault(e)},this));this.onChangeDestination();BX.addCustomEvent(this.node,"select",BX.proxy(this.select,this));BX.addCustomEvent(this.node,"unSelect",BX.proxy(this.unSelect,this));BX.addCustomEvent(this.node,"delete",BX.proxy(this.delete,this));BX.addCustomEvent(this.node,"openDialog",BX.proxy(this.openDialog,this));BX.addCustomEvent(this.node,"closeDialog",BX.proxy(this.closeDialog,this));BX.addCustomEvent(this.node,"closeSearch",BX.proxy(this.closeSearch,this))},select:function(e,i,t){if(BX.message("LM_BUSINESS_USERS_ON")=="Y"&&BX.message("LM_BUSINESS_USERS").split(",").indexOf(e.id)==-1){BX.SocNetLogDestination.closeDialog(this.id);BX.imolTrialHandler.openPopup("imol_queue",BX.message("LM_BUSINESS_USERS_TEXT"));return false}if(!BX.findChild(this.nodes.container,{attr:{"data-id":e.id}},false,false)){i.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"CONFIG["+this.inputName+"]"+"["+t+"][]",value:e.id}}));this.nodes.container.appendChild(i)}this.onChangeDestination()},unSelect:function(e){var i=BX.findChildren(this.nodes.container,{attribute:{"data-id":""+e.id+""}},true);if(i!==null){for(var t=0;t<i.length;t++)BX.remove(i[t])}this.onChangeDestination()},onChangeDestination:function(){var e=[];var i=BX.findChildrenByClassName(this.nodes.container,"bx-destination",false);for(var t=0;t<i.length;t++){e.push({id:i[t].getAttribute("data-id").substr(1),name:i[t].innerText})}BX.onCustomEvent("onChangeDestination",[e]);this.nodes.input.innerHTML="";this.nodes.button.innerHTML=BX.SocNetLogDestination.getSelectedCount(this.id)<=0?BX.message("LM_ADD1"):BX.message("LM_ADD2")},openDialog:function(){BX.style(this.nodes.inputBox,"display","inline-block");BX.style(this.nodes.button,"display","none");BX.focus(this.nodes.input)},closeDialog:function(){if(this.nodes.input.value.length<=0){BX.style(this.nodes.inputBox,"display","none");BX.style(this.nodes.button,"display","inline-block");this.nodes.input.value=""}},closeSearch:function(){if(this.nodes.input.value.length>0){BX.style(this.nodes.inputBox,"display","none");BX.style(this.nodes.button,"display","inline-block");this.nodes.input.value=""}},searchBefore:function(e){if(e.keyCode==8&&this.nodes.input.value.length<=0){BX.SocNetLogDestination.sendEvent=false;BX.SocNetLogDestination.deleteLastItem(this.id)}return true},search:function(e){if(e.keyCode==16||e.keyCode==17||e.keyCode==18||e.keyCode==20||e.keyCode==244||e.keyCode==224||e.keyCode==91)return false;if(e.keyCode==13){BX.SocNetLogDestination.selectFirstSearchItem(this.id);return true}if(e.keyCode==27){this.nodes.input.value="";BX.style(this.nodes.button,"display","inline")}else{BX.SocNetLogDestination.search(this.nodes.input.value,true,this.id)}if(!BX.SocNetLogDestination.isOpenDialog()&&this.nodes.input.value.length<=0){BX.SocNetLogDestination.openDialog(this.id)}else if(BX.SocNetLogDestination.sendEvent&&BX.SocNetLogDestination.isOpenDialog()){BX.SocNetLogDestination.closeDialog()}if(e.keyCode==8){BX.SocNetLogDestination.sendEvent=true}return true}};e.BX.OpenLinesConfigEdit={popupTooltip:{},initDestination:function(e,n,o){if(t===null)t=new i(o);t.setInput(BX(e),n);this.receiveReloadUsersMessage()},addEventForTooltip:function(){BX.UI.Hint.init(BX("imopenlines-field-container"))},showTooltip:function(e,i,t){if(this.popupTooltip[e])this.popupTooltip[e].close();this.popupTooltip[e]=new BX.PopupWindow("bx-imopenlines-tooltip",i,{lightShadow:true,autoHide:false,darkMode:true,offsetLeft:0,offsetTop:2,bindOptions:{position:"top"},zIndex:200,events:{onPopupClose:function(){this.destroy()}},content:BX.create("div",{attrs:{style:"padding-right: 5px; width: 250px;"},html:t})});this.popupTooltip[e].setAngle({offset:13,position:"bottom"});this.popupTooltip[e].show();return true},hideTooltip:function(e){this.popupTooltip[e].close();this.popupTooltip[e]=null},addPreloader:function(){var e=BX.create("div",{props:{className:"side-panel-overlay side-panel-overlay-open",style:"position: fixed; background-color: rgba(255, 255, 255, .7);"},children:[BX.create("div",{props:{className:"side-panel-default-loader-container"},html:'<svg class="side-panel-default-loader-circular" viewBox="25 25 50 50">'+"<circle "+'class="side-panel-default-loader-path" '+'cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"'+"/>"+"</svg>"})]});document.body.appendChild(e)},actionClose:function(){BX.OpenLinesConfigEdit.toggleSelectFormOrText(BX("imol_action_close"),BX("imol_action_close_form"),BX("imol_action_close_text"))},actionAutoClose:function(){BX.OpenLinesConfigEdit.toggleSelectFormOrText(BX("imol_action_auto_close"),BX("imol_action_auto_close_form"),BX("imol_action_auto_close_text"))},changeTitle:function(){BX("bx-line-title").innerText=BX("bx-line-title-input").value},changeNoAnswerBox:function(e){var i=BX("imol_no_answer_rule");if(typeof noAnswerBoxValue=="undefined"||i.options[i.options.selectedIndex].value!="queue")noAnswerBoxValue=i.options[i.options.selectedIndex].value;i.innerHTML="";var t=false;if(e.options[e.selectedIndex].value=="strictly"||e.options[e.selectedIndex].value=="all"){i.options[i.length]=BX.create("option",{attrs:{value:"text"},html:BX.message("IMOL_CONFIG_EDIT_NO_ANSWER_RULE_TEXT")});i.options[i.length]=BX.create("option",{attrs:{value:"none"},html:BX.message("IMOL_CONFIG_EDIT_NO_ANSWER_RULE_NONE")});if(e.options[e.selectedIndex].value=="all"){BX("imol_queue_time_title").innerHTML=BX.message("IMOL_CONFIG_EDIT_NA_TIME");BX("imol_workers_time_link").innerHTML=BX.message("IMOL_CONFIG_EDIT_NA_TIME");BX.animationHandler.fadeSlideToggleByClass(BX("imol_limitation_max_chat_block"),false);t=true}else if(BX("imol_queue_time_title").innerHTML!=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME")){BX("imol_queue_time_title").innerHTML=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME");BX("imol_workers_time_link").innerHTML=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME");BX.animationHandler.fadeSlideToggleByClass(BX("imol_limitation_max_chat_block"),true);t=true}}else{i.options[i.length]=BX.create("option",{attrs:{value:"text"},html:BX.message("IMOL_CONFIG_EDIT_NO_ANSWER_RULE_TEXT")});i.options[i.length]=BX.create("option",{attrs:{value:"queue"},html:BX.message("IMOL_CONFIG_EDIT_NO_ANSWER_RULE_QUEUE")});i.options[i.length]=BX.create("option",{attrs:{value:"none"},html:BX.message("IMOL_CONFIG_EDIT_NO_ANSWER_RULE_NONE")});if(BX("imol_queue_time_title").innerHTML!=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME")){BX("imol_queue_time_title").innerHTML=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME");BX("imol_workers_time_link").innerHTML=BX.message("IMOL_CONFIG_EDIT_QUEUE_TIME");BX.animationHandler.fadeSlideToggleByClass(BX("imol_limitation_max_chat_block"),true);t=true}}if(t){BX.fx.colorAnimate.addRule("animationRule1","#525c69","#ccc","color",100,1,true);BX.fx.colorAnimate(BX("imol_queue_time_title"),"animationRule1");BX.fx.colorAnimate(BX("imol_workers_time_link"),"animationRule1")}for(var n=0;n<i.options.length;n++){if(i.options[n].value==noAnswerBoxValue){i.options.selectedIndex=n}}},toggleCrmBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_crm_block"))},toggleCheckOnlineBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_check_online_block"))},toggleCrmSourceRule:function(){var e=BX("imol_crm_create");if(e.options[e.selectedIndex].value!="none"){BX.removeClass(BX("imol_crm_source_rule"),"invisible")}else{BX.addClass(BX("imol_crm_source_rule"),"invisible")}},toggleQueueSettingsBlock:function(e){e.preventDefault();BX.animationHandler.fadeSlideToggleByClass(BX("imol_queue_settings_block"));BX.OpenLinesConfigEdit.toggleBoolInputValue(BX("imol_queue_settings_input"))},toggleAutoActionSettingsBlock:function(e){e.preventDefault();BX.animationHandler.fadeSlideToggleByClass(BX("imol_auto_action_settings_block"));BX.OpenLinesConfigEdit.toggleBoolInputValue(BX("imol_auto_action_settings_input"))},toggleAutoMessageBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_action_welcome"))},toggleAgreementBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_agreement_message_block"))},toggleVoteBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_vote_message_block"))},toggleBotBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_welcome_bot_block"))},toggleWorkersTimeBlock:function(e){e.preventDefault();BX.animationHandler.fadeSlideToggleByClass(BX("imol_workers_time_block"));BX.OpenLinesConfigEdit.toggleBoolInputValue(BX("imol_workers_time_input"))},toggleWorktimeBlock:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_worktime_block"))},toggleNoAnswerRule:function(){BX.OpenLinesConfigEdit.toggleSelectFormText(BX("imol_no_answer_rule"),BX("imol_no_answer_rule_form_form"),BX("imol_no_answer_rule_text"))},toggleQueueMaxChat:function(){BX.animationHandler.fadeSlideToggleByClass(BX("imol_max_chat"))},toggleWorktimeDayoffRule:function(){BX.OpenLinesConfigEdit.toggleSelectFormText(BX("imol_worktime_dayoff_rule"),BX("imol_worktime_dayoff_rule_form"),BX("imol_worktime_dayoff_rule_text"))},openExtraContainer:function(){BX.addClass(BX("imol_extra_btn"),"imopenlines-extra-btn-container-active");BX.removeClass(BX("imol_extra_container"),"ui-form-border-bottom");BX.animationHandler.fadeSlideToggleByClass(BX("imol_setting_container"),true);BX("imol_config_opened").setAttribute("value","Y")},receiveReloadUsersMessage:function(){BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(function(e){if(e.getEventId()==="ImOpenlines:reloadUsersList"){var i=BX("users_for_queue").getAttribute("bx-destination-id");var n=BX(i+"-container");var o=BX.findChild(n,{class:"bx-destination-users"},false,true);for(var s=0;s<o.length;s++){BX.SocNetLogDestination.deleteItem(o[s].dataset.id,"users",i)}var a=e.getData();if(typeof a==="object"){a=Object.values(a)}for(s=0;s<a.length;s++){t.select(a[s],"users",false,false,i)}}},this))},toggleSelectFormText:function(e,i,t){if(e.options[e.selectedIndex].value=="form"){BX.animationHandler.fadeSlideToggleByClass(i,true);BX.animationHandler.fadeSlideToggleByClass(t,true)}else if(e.options[e.selectedIndex].value=="text"){BX.animationHandler.fadeSlideToggleByClass(i,false);BX.animationHandler.fadeSlideToggleByClass(t,true)}else{BX.animationHandler.fadeSlideToggleByClass(i,false);BX.animationHandler.fadeSlideToggleByClass(t,false)}},toggleSelectFormOrText:function(e,i,t){if(e.options[e.selectedIndex].value=="form"){BX.animationHandler.fadeSlideToggleByClass(i,true);BX.animationHandler.fadeSlideToggleByClass(t,false)}else if(e.options[e.selectedIndex].value=="text"||e.options[e.selectedIndex].value=="quality"){BX.animationHandler.fadeSlideToggleByClass(i,false);BX.animationHandler.fadeSlideToggleByClass(t,true)}else{BX.animationHandler.fadeSlideToggleByClass(i,false);BX.animationHandler.fadeSlideToggleByClass(t,false)}},toggleTitleEdit:function(){var e=["imopenlines-show-inline","imopenlines-show-none"],i=BX("bx-line-title"),t=BX("bx-line-title-input");BX.toggleClass(i,e);BX.toggleClass(t,e)},toggleExtraContainer:function(){BX.toggleClass(BX("imol_extra_btn"),["imopenlines-extra-btn-container-active",""]);BX.toggleClass(BX("imol_extra_container"),["ui-form-border-bottom",""]);BX.animationHandler.fadeSlideToggleByClass(BX("imol_setting_container"));var e=BX.hasClass(BX("imol_extra_btn"),"imopenlines-extra-btn-container-active")?"Y":"N";BX("imol_config_opened").setAttribute("value",e)},toggleBoolInputValue:function(e){e.value=e.value==="Y"?"N":"Y"},bindEvents:function(){BX.bind(BX("imol_config_edit_form"),"submit",BX.OpenLinesConfigEdit.addPreloader);BX.bind(BX("bx-title-edit-btn"),"click",BX.OpenLinesConfigEdit.toggleTitleEdit);BX.bind(BX("bx-line-title-input"),"change",BX.OpenLinesConfigEdit.changeTitle);BX.bind(BX("imol_crm_create"),"change",BX.OpenLinesConfigEdit.toggleCrmSourceRule);BX.bind(BX("imol_extra_btn"),"click",BX.OpenLinesConfigEdit.toggleExtraContainer);BX.bind(BX("imol_no_answer_rule"),"change",BX.OpenLinesConfigEdit.toggleNoAnswerRule);BX.bind(BX("imol_worktime_dayoff_rule"),"change",BX.OpenLinesConfigEdit.toggleWorktimeDayoffRule);BX.bind(BX("imol_queue_settings_link"),"click",BX.OpenLinesConfigEdit.toggleQueueSettingsBlock);BX.bind(BX("imol_auto_action_settings_link"),"click",BX.OpenLinesConfigEdit.toggleAutoActionSettingsBlock);BX.bind(BX("imol_workers_time_link"),"click",BX.OpenLinesConfigEdit.toggleWorkersTimeBlock);BX.bind(BX("imol_agreement_message"),"change",BX.OpenLinesConfigEdit.toggleAgreementBlock);BX.bind(BX("imol_vote_message"),"change",BX.OpenLinesConfigEdit.toggleVoteBlock);BX.bind(BX("imol_crm_checkbox"),"change",BX.OpenLinesConfigEdit.toggleCrmBlock);BX.bind(BX("imol_check_online"),"change",BX.OpenLinesConfigEdit.toggleCheckOnlineBlock);BX.bind(BX("imol_welcome_message"),"change",BX.OpenLinesConfigEdit.toggleAutoMessageBlock);BX.bind(BX("imol_worktime_checkbox"),"change",BX.OpenLinesConfigEdit.toggleWorktimeBlock);BX.bind(BX("imol_action_close"),"change",BX.OpenLinesConfigEdit.actionClose);BX.bind(BX("imol_action_auto_close"),"change",BX.OpenLinesConfigEdit.actionAutoClose);BX.bind(BX("imol_queue_type"),"change",function(e){BX.OpenLinesConfigEdit.changeNoAnswerBox(this);BX.OpenLinesConfigEdit.changeNoAnswerBox(this);BX.OpenLinesConfigEdit.toggleNoAnswerRule()});BX.bind(BX("imol_limitation_max_chat"),"change",BX.OpenLinesConfigEdit.toggleQueueMaxChat);BX.bindDelegate(document.body,"click",{className:"ui-form-settings-extra-link-item"},function(e){var i=this.dataset.itemId;if(BX.hasClass(BX("imol_setting_container"),"invisible")){BX.OpenLinesConfigEdit.openExtraContainer();setTimeout(function(){BX.animationHandler.smoothScroll(BX(i))},300)}else{BX.animationHandler.smoothScroll(BX(i))}})},onLoad:function(){BX.OpenLinesConfigEdit.toggleNoAnswerRule();BX.OpenLinesConfigEdit.toggleWorktimeDayoffRule();BX.OpenLinesConfigEdit.actionClose();BX.OpenLinesConfigEdit.actionAutoClose()}};e.BX.imolTrialHandler={openPopup:function(e,i){if(typeof B24!="undefined"&&typeof B24.licenseInfoPopup!="undefined"){B24.licenseInfoPopup.show(e,BX.message("IMOL_CONFIG_EDIT_POPUP_LIMITED_TITLE"),i)}else{alert(i)}},openPopupQueueAll:function(){BX.imolTrialHandler.openPopup("imol_queue_all",BX.message("IMOL_CONFIG_EDIT_POPUP_LIMITED_QUEUE_ALL"))},openPopupQueueVote:function(){BX.imolTrialHandler.openPopup("imol_vote",BX.message("IMOL_CONFIG_EDIT_POPUP_LIMITED_VOTE"))},init:function(){BX.bind(BX("imol_queue_all"),"click",BX.imolTrialHandler.openPopupQueueAll);BX.bind(BX("imol_vote"),"click",BX.imolTrialHandler.openPopupQueueVote)}};e.BX.animationHandler={animate:function(e){e=e||{};var i=e.node||null;var t=new BX.Promise;if(!BX.type.isElementNode(i)){t.reject();return t}var n=e.duration||300;var o={};o.animations=[];var s=null;if(s===null){var a=new BX.easing({duration:n,start:e.start,finish:e.finish,transition:BX.easing.transitions.linear,step:e.step,complete:function(){for(var n in o.animations){if(o.animations[n].node==i){o.animations[n].easing=null;o.animations[n].node=null;o.animations.splice(n,1);break}}i=null;s=null;e.complete.call(this);if(t){t.fulfill()}}});s={node:i,easing:a};o.animations.push(s)}else{s.easing.stop();if(t){t.reject()}}s.easing.animate();return t},animateShowHide:function(e){e=e||{};var i=e.node||null;if(!BX.type.isElementNode(i)){var t=new BX.Promise;t.reject();return t}var n=BX.hasClass(i,"invisible");var o=typeof e.way=="undefined"||e.way===null?n:!!e.way;if(n!=o){var t=new BX.Promise;t.resolve();return t}var s=e.toShow||{};var a=e.toHide||{};return BX.animationHandler.animate({node:i,duration:e.duration,start:!o?s:a,finish:o?s:a,complete:function(){BX[!o?"addClass":"removeClass"](i,"invisible");i.style.cssText="";if(BX.type.isFunction(e.complete)){e.complete.call(this)}},step:function(e){if(typeof e.opacity!="undefined"){i.style.opacity=e.opacity/100}if(typeof e.height!="undefined"){i.style.height=e.height+"px"}if(typeof e.width!="undefined"){i.style.width=e.width+"px"}}})},fadeSlideToggleByClass:function(e,i,t,n){return BX.animationHandler.animateShowHide({node:e,duration:t,toShow:{opacity:100,height:BX.animationHandler.getInvisibleSize(e).height},toHide:{opacity:0,height:0},complete:n,way:i})},getInvisibleSize:function(e){var i=BX.hasClass(e,"invisible");if(i){BX.removeClass(e,"invisible")}var t=BX.pos(e);if(i){BX.addClass(e,"invisible")}return t},smoothScroll:function(e){var i=BX.GetWindowScrollPos().scrollTop,t=BX.pos(e).top-Math.round(BX.GetWindowInnerSize().innerHeight/2),n=i<t,o=Math.abs(t-i),s=Math.round(o/100)>20?20:Math.round(o/100),a=4*s,l=n?i+a:i-a,r=0;if(n){for(var d=i;d<t;d+=a){setTimeout("window.scrollTo(0,"+l+")",r*s);l+=a;if(l>t){l=t}r++}}else{for(var d=i;d>t;d-=a){setTimeout("window.scrollTo(0,"+l+")",r*s);l-=a;if(l<t){l=t}r++}}}};BX.ready(function(){BX.imolTrialHandler.init();BX.OpenLinesConfigEdit.onLoad();BX.OpenLinesConfigEdit.bindEvents();BX.OpenLinesConfigEdit.addEventForTooltip()})})(window);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:100:"/bitrix/components/bitrix/imconnector.settings.status/templates/.default/script.min.js?1544127421497";s:6:"source";s:82:"/bitrix/components/bitrix/imconnector.settings.status/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
BX.namespace("BX.ImConnectorSettingStatus");BX.ImConnectorSettingStatus.reload=function(e){var n=new BX.Loader({target:document.querySelector("#bx-imconnector-status-wrap")});n.show();BX.ajax.runComponentAction(e.componentName,"reload",{mode:"class",signedParameters:e.signedParameters}).then(function(e){var t=BX.create("div");t.innerHTML=e.data.html;BX("bx-imconnector-status-wrap").innerHTML=t.querySelector("#bx-imconnector-status-wrap").innerHTML;t.remove();n.hide()},function(e){n.hide()})};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:99:"/bitrix/components/bitrix/main.userconsent.selector/templates/.default/script.min.js?15441273842966";s:6:"source";s:80:"/bitrix/components/bitrix/main.userconsent.selector/templates/.default/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
var MainUserConsentSelectorManager=function(e){this.selectors=[];this.init=function(e){this.actionRequestUrl=e.actionRequestUrl;this.initSlider();var t=document.querySelectorAll("[data-bx-user-consent-selector]");t=BX.convert.nodeListToArray(t);t.forEach(this.initByContext,this)};this.initByContext=function(e){var t=e.querySelector("select[data-bx-selector]");var i=e.querySelector("a[data-bx-link-edit]");var n=e.querySelector("a[data-bx-link-view]");if(!t||!i||!n){return}this.selectors.push(t);BX.bind(t,"change",this.onChange.bind(this,t,i,n));this.onChange(t,i,n);this.initSliderButtons(e)};this.onChange=function(e,t,i){t.style.display=e.value?"":"none";i.style.display=e.value?"":"none";this.fillHrefByTemplate(t,e.value);this.fillHrefByTemplate(i,e.value)};this.fillHrefByTemplate=function(e,t){var i=e.getAttribute("data-bx-link-tmpl");if(!i){return}e.href=i.replace(new RegExp("#id#","g"),t)};this.fillDropDownControl=function(e,t,i){t=t||[];var n=e.children[0];e.innerHTML="";if(i&&n){e.appendChild(n)}t.forEach(function(t){if(!t||!t.caption){return}var i=document.createElement("option");i.value=t.value;i.selected=!!t.selected;i.innerText=t.caption;e.appendChild(i)})};this.initSliderButtons=function(e){var t=e.querySelectorAll("[data-bx-slider-href]");t=BX.convert.nodeListToArray(t);t.forEach(this.slider.bindOpen,this.slider)};this.initSlider=function(){this.slider.caller=this;top.BX.addCustomEvent(top,"main-user-consent-to-list",function(){top.BX.SidePanel.Instance.close()})};this.onSliderClose=function(){this.sendActionRequest("getAgreements",{},function(e){if(!e.list){return}this.selectors.forEach(function(t){var i=t.value;if(!i){i=e.list[0].ID}var n=e.list.map(function(e){return{caption:e.NAME,value:e.ID,selected:e.ID==i}});this.fillDropDownControl(t,n,true);BX.fireEvent(t,"change")},this)})};this.slider={caller:null,init:function(e){top.BX.SidePanel.Instance.bindAnchors({rules:[{condition:e.condition,loader:e.loader,stopParameters:[]}]})},onSaved:function(){this.onClose();top.BX.SidePanel.Instance.close()},onClose:function(){if(this.caller&&this.caller.onSliderClose){this.caller.onSliderClose.apply(this.caller)}},bindOpen:function(e){BX.bind(e,"click",this.openHref.bind(this,e))},openHref:function(e,t){t.preventDefault();this.open(e.getAttribute("href"),e.getAttribute("data-bx-slider-reload"))},open:function(e,t){top.BX.SidePanel.Instance.open(e,{cacheable:false,events:{onClose:t?this.onClose.bind(this):null}});if(t){top.BX.addCustomEvent(top,"main-user-consent-saved",this.onSaved.bind(this))}}};this.sendActionRequest=function(e,t,i,n){i=i||null;n=n||null;t.action=e;t.sessid=BX.bitrix_sessid();t.action=e;BX.ajax({url:this.actionRequestUrl,method:"POST",data:t,timeout:10,dataType:"json",processData:true,onsuccess:BX.proxy(function(e){e=e||{};if(e.error){n.apply(this,[e])}else if(i){i.apply(this,[e])}},this),onfailure:BX.proxy(function(){var e={error:true,text:""};if(n){n.apply(this,[e])}},this)})};this.init(e)};
/* End */
;; /* /bitrix/components/bitrix/imopenlines.lines.edit/templates/.default/script.min.js?154412742322291*/
; /* /bitrix/components/bitrix/imconnector.settings.status/templates/.default/script.min.js?1544127421497*/
; /* /bitrix/components/bitrix/main.userconsent.selector/templates/.default/script.min.js?15441273842966*/
